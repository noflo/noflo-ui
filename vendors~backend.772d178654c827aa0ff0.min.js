(window.webpackJsonp=window.webpackJsonp||[]).push([[4],[,,,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.asComponent=t.asPromise=t.asCallback=t.saveFile=t.loadFile=t.createNetwork=t.IP=t.internalSocket=t.OutPort=t.InPort=t.OutPorts=t.InPorts=t.Component=t.ComponentLoader=t.isBrowser=t.Journal=t.journal=t.Graph=t.graph=void 0;var o=r(23),i=r(111),a=r(479),s=r(37),c=r(23);Object.defineProperty(t,"graph",{enumerable:!0,get:function(){return c.graph}}),Object.defineProperty(t,"Graph",{enumerable:!0,get:function(){return c.Graph}}),Object.defineProperty(t,"journal",{enumerable:!0,get:function(){return c.journal}}),Object.defineProperty(t,"Journal",{enumerable:!0,get:function(){return c.Journal}});var u=r(37);Object.defineProperty(t,"isBrowser",{enumerable:!0,get:function(){return u.isBrowser}});var p=r(84);Object.defineProperty(t,"ComponentLoader",{enumerable:!0,get:function(){return p.ComponentLoader}});var l=r(158);Object.defineProperty(t,"Component",{enumerable:!0,get:function(){return l.Component}});var d=r(159);Object.defineProperty(t,"InPorts",{enumerable:!0,get:function(){return d.InPorts}}),Object.defineProperty(t,"OutPorts",{enumerable:!0,get:function(){return d.OutPorts}});var h=r(160);Object.defineProperty(t,"InPort",{enumerable:!0,get:function(){return h.default}});var f=r(162);Object.defineProperty(t,"OutPort",{enumerable:!0,get:function(){return f.default}});var m=r(83);t.internalSocket=m;var g=r(46);function y(e,t,r){"object"!==n(t)&&(t={}),void 0===t.subscribeGraph&&(t.subscribeGraph=!1);var o=new(t.subscribeGraph?a.LegacyNetwork:i.Network)(e,t),c=o.loader.listComponents().then((function(){return t.delay?Promise.resolve(o):o.connect().then((function(){return o.start()}))}));return r&&(s.deprecated("Providing a callback to NoFlo.createNetwork is deprecated, use Promises"),c.then((function(e){r(null,e)}),r)),c}Object.defineProperty(t,"IP",{enumerable:!0,get:function(){return g.default}}),t.createNetwork=y,t.loadFile=function(e,t,r){var n=o.graph.loadFile(e).then((function(e){return y(e,t)}));return r&&(s.deprecated("Providing a callback to NoFlo.loadFile is deprecated, use Promises"),n.then((function(e){r(null,e)}),r)),n},t.saveFile=function(e,t,r){return e.save(t,r)};var v=r(483);Object.defineProperty(t,"asCallback",{enumerable:!0,get:function(){return v.asCallback}}),Object.defineProperty(t,"asPromise",{enumerable:!0,get:function(){return v.asPromise}});var b=r(484);Object.defineProperty(t,"asComponent",{enumerable:!0,get:function(){return b.asComponent}})},,,,,,,,,,,function(e,t,r){(function(n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))}),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(266)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,r(13))},,,,,function(e,t,r){"use strict";var n=r(59),o=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],i=["scalar","sequence","mapping"];e.exports=function(e,t){var r,a;if(t=t||{},Object.keys(t).forEach((function(t){if(-1===o.indexOf(t))throw new n('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.defaultStyle=t.defaultStyle||null,this.styleAliases=(r=t.styleAliases||null,a={},null!==r&&Object.keys(r).forEach((function(e){r[e].forEach((function(t){a[String(t)]=e}))})),a),-1===i.indexOf(this.kind))throw new n('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}},,,,,,,,,,,,function(e,t){
/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,r){var n=e.__flags||(e.__flags=Object.create(null));if(3!==arguments.length)return n[t];n[t]=r}},function(e,t,r){"use strict";r.r(t),r.d(t,"v1",(function(){return u})),r.d(t,"v3",(function(){return w})),r.d(t,"v4",(function(){return x.a})),r.d(t,"v5",(function(){return _})),r.d(t,"NIL",(function(){return S})),r.d(t,"version",(function(){return C})),r.d(t,"validate",(function(){return p.a})),r.d(t,"stringify",(function(){return a.a})),r.d(t,"parse",(function(){return l}));var n,o,i=r(78),a=r(38),s=0,c=0;var u=function(e,t,r){var u=t&&r||0,p=t||new Array(16),l=(e=e||{}).node||n,d=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==d){var h=e.random||(e.rng||i.a)();null==l&&(l=n=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==d&&(d=o=16383&(h[6]<<8|h[7]))}var f=void 0!==e.msecs?e.msecs:Date.now(),m=void 0!==e.nsecs?e.nsecs:c+1,g=f-s+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||f>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,c=m,o=d;var y=(1e4*(268435455&(f+=122192928e5))+m)%4294967296;p[u++]=y>>>24&255,p[u++]=y>>>16&255,p[u++]=y>>>8&255,p[u++]=255&y;var v=f/4294967296*1e4&268435455;p[u++]=v>>>8&255,p[u++]=255&v,p[u++]=v>>>24&15|16,p[u++]=v>>>16&255,p[u++]=d>>>8|128,p[u++]=255&d;for(var b=0;b<6;++b)p[u+b]=l[b];return t||Object(a.a)(p)},p=r(39);var l=function(e){if(!Object(p.a)(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};var d=function(e,t,r){function n(e,n,o,i){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=l(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),(s=r(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,o){i=i||0;for(var c=0;c<16;++c)o[i+c]=s[c];return o}return Object(a.a)(s)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n};function h(e){return 14+(e+64>>>9<<4)+1}function f(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function m(e,t,r,n,o,i){return f((a=f(f(t,e),f(n,i)))<<(s=o)|a>>>32-s,r);var a,s}function g(e,t,r,n,o,i,a){return m(t&r|~t&n,e,t,o,i,a)}function y(e,t,r,n,o,i,a){return m(t&n|r&~n,e,t,o,i,a)}function v(e,t,r,n,o,i,a){return m(t^r^n,e,t,o,i,a)}function b(e,t,r,n,o,i,a){return m(r^(t|~n),e,t,o,i,a)}var w=d("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n=0;n<r;n+=8){var o=e[n>>5]>>>n%32&255,i=parseInt("0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[h(t)-1]=t;for(var r=1732584193,n=-271733879,o=-1732584194,i=271733878,a=0;a<e.length;a+=16){var s=r,c=n,u=o,p=i;r=g(r,n,o,i,e[a],7,-680876936),i=g(i,r,n,o,e[a+1],12,-389564586),o=g(o,i,r,n,e[a+2],17,606105819),n=g(n,o,i,r,e[a+3],22,-1044525330),r=g(r,n,o,i,e[a+4],7,-176418897),i=g(i,r,n,o,e[a+5],12,1200080426),o=g(o,i,r,n,e[a+6],17,-1473231341),n=g(n,o,i,r,e[a+7],22,-45705983),r=g(r,n,o,i,e[a+8],7,1770035416),i=g(i,r,n,o,e[a+9],12,-1958414417),o=g(o,i,r,n,e[a+10],17,-42063),n=g(n,o,i,r,e[a+11],22,-1990404162),r=g(r,n,o,i,e[a+12],7,1804603682),i=g(i,r,n,o,e[a+13],12,-40341101),o=g(o,i,r,n,e[a+14],17,-1502002290),n=g(n,o,i,r,e[a+15],22,1236535329),r=y(r,n,o,i,e[a+1],5,-165796510),i=y(i,r,n,o,e[a+6],9,-1069501632),o=y(o,i,r,n,e[a+11],14,643717713),n=y(n,o,i,r,e[a],20,-373897302),r=y(r,n,o,i,e[a+5],5,-701558691),i=y(i,r,n,o,e[a+10],9,38016083),o=y(o,i,r,n,e[a+15],14,-660478335),n=y(n,o,i,r,e[a+4],20,-405537848),r=y(r,n,o,i,e[a+9],5,568446438),i=y(i,r,n,o,e[a+14],9,-1019803690),o=y(o,i,r,n,e[a+3],14,-187363961),n=y(n,o,i,r,e[a+8],20,1163531501),r=y(r,n,o,i,e[a+13],5,-1444681467),i=y(i,r,n,o,e[a+2],9,-51403784),o=y(o,i,r,n,e[a+7],14,1735328473),n=y(n,o,i,r,e[a+12],20,-1926607734),r=v(r,n,o,i,e[a+5],4,-378558),i=v(i,r,n,o,e[a+8],11,-2022574463),o=v(o,i,r,n,e[a+11],16,1839030562),n=v(n,o,i,r,e[a+14],23,-35309556),r=v(r,n,o,i,e[a+1],4,-1530992060),i=v(i,r,n,o,e[a+4],11,1272893353),o=v(o,i,r,n,e[a+7],16,-155497632),n=v(n,o,i,r,e[a+10],23,-1094730640),r=v(r,n,o,i,e[a+13],4,681279174),i=v(i,r,n,o,e[a],11,-358537222),o=v(o,i,r,n,e[a+3],16,-722521979),n=v(n,o,i,r,e[a+6],23,76029189),r=v(r,n,o,i,e[a+9],4,-640364487),i=v(i,r,n,o,e[a+12],11,-421815835),o=v(o,i,r,n,e[a+15],16,530742520),n=v(n,o,i,r,e[a+2],23,-995338651),r=b(r,n,o,i,e[a],6,-198630844),i=b(i,r,n,o,e[a+7],10,1126891415),o=b(o,i,r,n,e[a+14],15,-1416354905),n=b(n,o,i,r,e[a+5],21,-57434055),r=b(r,n,o,i,e[a+12],6,1700485571),i=b(i,r,n,o,e[a+3],10,-1894986606),o=b(o,i,r,n,e[a+10],15,-1051523),n=b(n,o,i,r,e[a+1],21,-2054922799),r=b(r,n,o,i,e[a+8],6,1873313359),i=b(i,r,n,o,e[a+15],10,-30611744),o=b(o,i,r,n,e[a+6],15,-1560198380),n=b(n,o,i,r,e[a+13],21,1309151649),r=b(r,n,o,i,e[a+4],6,-145523070),i=b(i,r,n,o,e[a+11],10,-1120210379),o=b(o,i,r,n,e[a+2],15,718787259),n=b(n,o,i,r,e[a+9],21,-343485551),r=f(r,s),n=f(n,c),o=f(o,u),i=f(i,p)}return[r,n,o,i]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(h(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))})),x=r(113);function E(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function k(e,t){return e<<t|e>>>32-t}var _=d("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var o=0;o<n.length;++o)e.push(n.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var i=e.length/4+2,a=Math.ceil(i/16),s=new Array(a),c=0;c<a;++c){for(var u=new Uint32Array(16),p=0;p<16;++p)u[p]=e[64*c+4*p]<<24|e[64*c+4*p+1]<<16|e[64*c+4*p+2]<<8|e[64*c+4*p+3];s[c]=u}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<a;++l){for(var d=new Uint32Array(80),h=0;h<16;++h)d[h]=s[l][h];for(var f=16;f<80;++f)d[f]=k(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);for(var m=r[0],g=r[1],y=r[2],v=r[3],b=r[4],w=0;w<80;++w){var x=Math.floor(w/20),_=k(m,5)+E(x,g,y,v)+b+t[x]+d[w]>>>0;b=v,v=y,y=k(g,30)>>>0,g=m,m=_}r[0]=r[0]+m>>>0,r[1]=r[1]+g>>>0,r[2]=r[2]+y>>>0,r[3]=r[3]+v>>>0,r[4]=r[4]+b>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),S="00000000-0000-0000-0000-000000000000";var C=function(e){if(!Object(p.a)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},,,function(e,t,r){e.exports=r(207)},,function(e,t,r){"use strict";(function(e,r){function n(){return void 0===e||!e.execPath||!e.execPath.match(/node|iojs/)}Object.defineProperty(t,"__esModule",{value:!0}),t.makeAsync=t.deprecated=t.isBrowser=void 0,t.isBrowser=n,t.deprecated=function(t){if(n())console.warn(t);else{if(e.env.NOFLO_FATAL_DEPRECATED)throw new Error(t);console.warn(t)}},t.makeAsync=function(e){n()?setTimeout(e,0):r((function(){e()}))}}).call(this,r(13),r(137).setImmediate)},,,,,function(e,t,r){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=[];
/*!
 * Chai version
 */t.version="4.2.0",
/*!
 * Assertion Error
 */
t.AssertionError=r(150);
/*!
 * Utils for plugins (not exported)
 */
var o=r(361);t.use=function(e){return~n.indexOf(e)||(e(t,o),n.push(e)),t},
/*!
 * Utility Functions
 */
t.util=o;
/*!
 * Configuration
 */
var i=r(54);t.config=i;
/*!
 * Primary `Assertion` prototype
 */
var a=r(378);t.use(a);
/*!
 * Core Assertions
 */
var s=r(379);t.use(s);
/*!
 * Expect interface
 */
var c=r(380);t.use(c);
/*!
 * Should interface
 */
var u=r(381);t.use(u);
/*!
 * Assert interface
 */
var p=r(382);t.use(p)},function(e,t){
/*!
 * Chai - transferFlags utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,r){var n=e.__flags||(e.__flags=Object.create(null));for(var o in t.__flags||(t.__flags=Object.create(null)),r=3!==arguments.length||r,n)(r||"object"!==o&&"ssfi"!==o&&"lockSsfi"!==o&&"message"!=o)&&(t.__flags[o]=n[o])}},,,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(this,e),this.type=t||"data",this.data=i,this.isIP=!0,this.scope=null,this.owner=null,this.clonable=!1,this.index=null,this.schema=null,this.datatype="all",this.initial=!1,"object"===n(a)&&Object.keys(a).forEach((function(e){r[e]=a[e]})),this}var t,r,a;return t=e,a=[{key:"isIP",value:function(e){return e&&"object"===n(e)&&!0===e.isIP}}],(r=[{key:"clone",value:function(){var t=this,r=new e(this.type);return Object.keys(this).forEach((function(e){var o=t[e];"owner"!==e&&null!==o&&("object"===n(o)?r[e]=JSON.parse(JSON.stringify(o)):r[e]=o)})),r}},{key:"move",value:function(e){return this.owner=e,this}},{key:"drop",value:function(){var e=this;Object.keys(this).forEach((function(t){delete e[t]}))}}])&&i(t.prototype,r),a&&i(t,a),e}();t.default=a},,function(e,t,r){"use strict";var n={};function o(e,t,r){r||(r=Error);var o=function(e){var r,n;function o(r,n,o){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,o))||this}return n=e,(r=o).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,o}(r);o.prototype.name=r.name,o.prototype.code=e,n[e]=o}function i(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}o("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,o,a,s;if("string"==typeof t&&(o="not ",t.substr(!a||a<0?0:+a,o.length)===o)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(i(t,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(i(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var o=r(121),i=r(125);r(58)(u,o);for(var a=n(i.prototype),s=0;s<a.length;s++){var c=a[s];u.prototype[c]||(u.prototype[c]=i.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);o.call(this,e),i.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",p)))}function p(){this._writableState.ended||t.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(13))},function(e,t,r){"use strict";function n(e,t,r,n){var o=n?" !== ":" === ",i=n?" || ":" && ",a=n?"!":"",s=n?"":"!";switch(e){case"null":return t+o+"null";case"array":return a+"Array.isArray("+t+")";case"object":return"("+a+t+i+"typeof "+t+o+'"object"'+i+s+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+o+'"number"'+i+s+"("+t+" % 1)"+i+t+o+t+(r?i+a+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+o+'"'+e+'"'+(r?i+a+"isFinite("+t+")":"")+")";default:return"typeof "+t+o+'"'+e+'"'}}e.exports={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:n,checkDataTypes:function(e,t,r){switch(e.length){case 1:return n(e[0],t,r,!0);default:var o="",a=i(e);for(var s in a.array&&a.object&&(o=a.null?"(":"(!"+t+" || ",o+="typeof "+t+' !== "object")',delete a.null,delete a.array,delete a.object),a.number&&delete a.integer,a)o+=(o?" && ":"")+n(s,t,r,!0);return o}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],n=0;n<t.length;n++){var i=t[n];(o[i]||"array"===e&&"array"===i)&&(r[r.length]=i)}if(r.length)return r}else{if(o[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:i,getProperty:c,escapeQuotes:u,equal:r(90),ucs2length:r(289),varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var n in e)if(n!=r&&t[n])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var r in e)if(!t[r])return r},toQuotedString:p,getPathExpr:function(e,t,r,n){return h(e,r?"'/' + "+t+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){var n=p(r?"/"+f(t):c(t));return h(e,n)},getData:function(e,t,r){var n,o,i,a;if(""===e)return"rootData";if("/"==e[0]){if(!l.test(e))throw new Error("Invalid JSON-pointer: "+e);o=e,i="rootData"}else{if(!(a=e.match(d)))throw new Error("Invalid JSON-pointer: "+e);if(n=+a[1],"#"==(o=a[2])){if(n>=t)throw new Error("Cannot access property/index "+n+" levels up, current level is "+t);return r[t-n]}if(n>t)throw new Error("Cannot access data "+n+" levels up, current level is "+t);if(i="data"+(t-n||""),!o)return i}for(var s=i,u=o.split("/"),p=0;p<u.length;p++){var h=u[p];h&&(i+=c(m(h)),s+=" && "+i)}return s},unescapeFragment:function(e){return m(decodeURIComponent(e))},unescapeJsonPointer:m,escapeFragment:function(e){return encodeURIComponent(f(e))},escapeJsonPointer:f};var o=i(["string","number","integer","boolean","null"]);function i(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var a=/^[a-z$_][a-z$_0-9]*$/i,s=/'|\\/g;function c(e){return"number"==typeof e?"["+e+"]":a.test(e)?"."+e:"['"+u(e)+"']"}function u(e){return e.replace(s,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function p(e){return"'"+u(e)+"'"}var l=/^\/(?:[^~]|~0|~1)*$/,d=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function h(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function f(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function m(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},function(e,t,r){(function(n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))}),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(324)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,r(13))},function(e,t,r){"use strict";function n(e){return null==e}e.exports.isNothing=n,e.exports.isObject=function(e){return"object"==typeof e&&null!==e},e.exports.toArray=function(e){return Array.isArray(e)?e:n(e)?[]:[e]},e.exports.repeat=function(e,t){var r,n="";for(r=0;r<t;r+=1)n+=e;return n},e.exports.isNegativeZero=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},e.exports.extend=function(e,t){var r,n,o,i;if(t)for(r=0,n=(i=Object.keys(t)).length;r<n;r+=1)e[o=i[r]]=t[o];return e}},function(e,t,r){"use strict";var n=r(52),o=r(59),i=r(19);function a(e,t,r){var n=[];return e.include.forEach((function(e){r=a(e,t,r)})),e[t].forEach((function(e){r.forEach((function(t,r){t.tag===e.tag&&t.kind===e.kind&&n.push(r)})),r.push(e)})),r.filter((function(e,t){return-1===n.indexOf(t)}))}function s(e){this.include=e.include||[],this.implicit=e.implicit||[],this.explicit=e.explicit||[],this.implicit.forEach((function(e){if(e.loadKind&&"scalar"!==e.loadKind)throw new o("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=a(this,"implicit",[]),this.compiledExplicit=a(this,"explicit",[]),this.compiledTypeMap=function(){var e,t,r={scalar:{},sequence:{},mapping:{},fallback:{}};function n(e){r[e.kind][e.tag]=r.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(n);return r}(this.compiledImplicit,this.compiledExplicit)}s.DEFAULT=null,s.create=function(){var e,t;switch(arguments.length){case 1:e=s.DEFAULT,t=arguments[0];break;case 2:e=arguments[0],t=arguments[1];break;default:throw new o("Wrong number of arguments for Schema.create function")}if(e=n.toArray(e),t=n.toArray(t),!e.every((function(e){return e instanceof s})))throw new o("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!t.every((function(e){return e instanceof i})))throw new o("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new s({include:e,explicit:t})},e.exports=s},function(e,t){e.exports={includeStack:!1,showDiff:!0,truncateThreshold:40,useProxy:!0,proxyExcludedKeys:["then","catch","inspect","toJSON"]}},,function(e,t,r){"use strict";var n=r(213),o=r(215);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=b(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),p=["'"].concat(u),l=["%","/","?",";","#"].concat(p),d=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(65);function b(e,t,r){if(e&&o.isObject(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),s=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(s);u[0]=u[0].replace(/\\/g,"/");var b=e=u.join(s);if(b=b.trim(),!r&&1===e.split("#").length){var w=c.exec(b);if(w)return this.path=b,this.href=b,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var x=a.exec(b);if(x){var E=(x=x[0]).toLowerCase();this.protocol=E,b=b.substr(x.length)}if(r||x||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===b.substr(0,2);!k||x&&g[x]||(b=b.substr(2),this.slashes=!0)}if(!g[x]&&(k||x&&!y[x])){for(var _,S,C=-1,P=0;P<d.length;P++){-1!==(D=b.indexOf(d[P]))&&(-1===C||D<C)&&(C=D)}-1!==(S=-1===C?b.lastIndexOf("@"):b.lastIndexOf("@",C))&&(_=b.slice(0,S),b=b.slice(S+1),this.auth=decodeURIComponent(_)),C=-1;for(P=0;P<l.length;P++){var D;-1!==(D=b.indexOf(l[P]))&&(-1===C||D<C)&&(C=D)}-1===C&&(C=b.length),this.host=b.slice(0,C),b=b.slice(C),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var O=this.hostname.split(/\./),j=(P=0,O.length);P<j;P++){var T=O[P];if(T&&!T.match(h)){for(var F="",I=0,N=T.length;I<N;I++)T.charCodeAt(I)>127?F+="x":F+=T[I];if(!F.match(h)){var R=O.slice(0,P),B=O.slice(P+1),L=T.match(f);L&&(R.push(L[1]),B.unshift(L[2])),B.length&&(b="/"+B.join(".")+b),this.hostname=R.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=n.toASCII(this.hostname));var M=this.port?":"+this.port:"",q=this.hostname||"";this.host=q+M,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[E])for(P=0,j=p.length;P<j;P++){var U=p[P];if(-1!==b.indexOf(U)){var $=encodeURIComponent(U);$===U&&($=escape(U)),b=b.split(U).join($)}}var z=b.indexOf("#");-1!==z&&(this.hash=b.substr(z),b=b.slice(0,z));var G=b.indexOf("?");if(-1!==G?(this.search=b.substr(G),this.query=b.substr(G+1),t&&(this.query=v.parse(this.query)),b=b.slice(0,G)):t&&(this.search="",this.query={}),b&&(this.pathname=b),y[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){M=this.pathname||"";var H=this.search||"";this.path=M+H}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,a="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(a=v.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||y[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(o.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),a=0;a<n.length;a++){var s=n[a];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var p=c[u];"protocol"!==p&&(r[p]=e[p])}return y[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!y[e.protocol]){for(var l=Object.keys(e),d=0;d<l.length;d++){var h=l[d];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||g[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",v=r.search||"";r.path=m+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var b=r.pathname&&"/"===r.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),x=w||b||r.host&&e.pathname,E=x,k=r.pathname&&r.pathname.split("/")||[],_=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!y[r.protocol]);if(_&&(r.hostname="",r.port=null,r.host&&(""===k[0]?k[0]=r.host:k.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),x=x&&(""===f[0]||""===k[0])),w)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,k=f;else if(f.length)k||(k=[]),k.pop(),k=k.concat(f),r.search=e.search,r.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(_)r.hostname=r.host=k.shift(),(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift());return r.search=e.search,r.query=e.query,o.isNull(r.pathname)&&o.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!k.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var S=k.slice(-1)[0],C=(r.host||e.host||k.length>1)&&("."===S||".."===S)||""===S,P=0,D=k.length;D>=0;D--)"."===(S=k[D])?k.splice(D,1):".."===S?(k.splice(D,1),P++):P&&(k.splice(D,1),P--);if(!x&&!E)for(;P--;P)k.unshift("..");!x||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),C&&"/"!==k.join("/").substr(-1)&&k.push("");var A,O=""===k[0]||k[0]&&"/"===k[0].charAt(0);_&&(r.hostname=r.host=O?"":k.length?k.shift():"",(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift()));return(x=x||r.host&&k.length)&&!O&&k.unshift(""),k.length?r.pathname=k.join("/"):(r.pathname=null,r.path=null),o.isNull(r.pathname)&&o.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){const n=r(66);class o extends n.EventEmitter{constructor(e){super(),this.definition=e,this.definition.capabilities||(this.definition.capabilities=[]),this.graph=null}setMain(e){this.graph=e}getType(){return this.definition.protocol}getAddress(){return this.definition.address}canDo(e){return-1!==this.definition.capabilities.indexOf(e)}isConnected(){return!1}connect(){}disconnect(){}reconnect(){return this.disconnect(),this.connect()}start(){if(!this.graph)throw new Error("No graph defined for execution");return this.sendNetwork("start",{graph:this.graph.name||this.graph.properties.id})}stop(){if(!this.graph)throw new Error("No graph defined for execution");return this.sendNetwork("stop",{graph:this.graph.name||this.graph.properties.id})}setParentElement(){}getElement(){}recvMessage(e){switch(this.emit("message",e),e.protocol){case"runtime":return this.recvRuntime(e.command,e.payload);case"graph":return this.recvGraph(e.command,e.payload);case"network":return this.recvNetwork(e.command,e.payload);case"component":return this.recvComponent(e.command,e.payload);case"trace":return this.recvTrace(e.command,e.payload);default:return null}}recvRuntime(e,t){"runtime"===e&&(Object.keys(t).forEach(e=>{const r=t[e];this.definition[e]=r}),this.emit("capabilities",t.capabilities||[])),this.emit("runtime",{command:e,payload:t})}recvComponent(e,t){switch(e){case"error":return void this.emit("network",{command:e,payload:t});default:this.emit("component",{command:e,payload:t})}}recvGraph(e,t){this.emit("graph",{command:e,payload:t})}recvNetwork(e,t){switch(e){case"started":return void this.emit("execution",{running:null==t||null==t.running||t.running,started:null==t||!t.started||t.started});case"stopped":return void this.emit("execution",{running:null!=t&&null!=t.running&&t.running,started:!(null==t||!t.started)&&t.started});case"status":return void this.emit("execution",{running:t.running,started:t.started});case"icon":return void this.emit("icon",t);default:this.emit("network",{command:e,payload:t})}}recvTrace(e,t){this.emit("trace",{command:e,payload:t})}sendRuntime(e,t={}){return this.send("runtime",e,{...t,secret:this.definition.secret})}sendGraph(e,t={}){return this.send("graph",e,{...t,secret:this.definition.secret})}sendNetwork(e,t={}){return this.send("network",e,{...t,secret:this.definition.secret})}sendComponent(e,t={}){return this.send("component",e,{...t,secret:this.definition.secret})}sendTrace(e,t={}){return this.send("trace",e,{...t,secret:this.definition.secret})}send(){}}e.exports=o},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){"use strict";function n(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n.prototype.toString=function(e){var t=this.name+": ";return t+=this.reason||"(unknown reason)",!e&&this.mark&&(t+=" "+this.mark.toString()),t},e.exports=n},function(e,t,r){"use strict";var n=r(53);e.exports=new n({include:[r(147)],implicit:[r(349),r(350)],explicit:[r(351),r(352),r(353),r(354)]})},,,,,function(e,t,r){"use strict";t.decode=t.parse=r(216),t.encode=t.stringify=r(217)},function(e,t,r){(function(t){const{EventEmitter:n}=r(11),o=()=>!(void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node"));e.exports={isBrowser:o,EventEmitter:n,WebSocket:o()?window.WebSocket:r(259).w3cwebsocket}}).call(this,r(13))},function(e,t,r){(function(e){const n=r(92);t.isBrowser=function(){return void 0===e||!e.execPath||!e.execPath.match(/node|iojs/)},t.randomString=function(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0,o=e,i=o>=0;i?n<o:n>o;i?n+=1:n-=1){const e=Math.floor(Math.random()*r.length);t+=r.charAt(e)}return t},t.asyncSeries=function(e,t,r){const n=e.slice(0),o=[];!function e(){if(0===n.length)return void r(null,o);const i=n.shift();t(i,(t,n)=>{t?r(t):(o.push(n),e())})}()},t.isArray=Array.isArray||(e=>"[object Array]"==={}.toString.call(e)),t.startsWith=(e,t)=>0===e.indexOf(t);const o=function(e){return t=>new n((r,n)=>setTimeout(n.bind(null,t),e))};t.retryUntil=function(e,t,r=500,i=5){let a=n.reject(new Error("retry starter"));for(let n=0,s=i,c=s>=0;c?n<=s:n>=s;c?n+=1:n-=1)a=a.catch(e).then(t).catch(o(r));return a}}).call(this,r(13))},function(e,t,r){"use strict";var n=r(53);e.exports=n.DEFAULT=new n({include:[r(60)],explicit:[r(355),r(356),r(357)]})},function(e,t,r){var n=r(54);
/*!
 * Chai - isProxyEnabled helper
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */e.exports=function(){return n.useProxy&&"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect}},function(e,t){var r=Object.getOwnPropertyDescriptor((function(){}),"length");
/*!
 * Chai - addLengthGuard utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */e.exports=function(e,t,n){return r.configurable?(Object.defineProperty(e,"length",{get:function(){if(n)throw Error("Invalid Chai property: "+t+'.length. Due to a compatibility issue, "length" cannot directly follow "'+t+'". Use "'+t+'.lengthOf" instead.');throw Error("Invalid Chai property: "+t+'.length. See docs for proper usage of "'+t+'".')}}),e):e}},function(e,t,r){var n=r(54),o=r(31),i=r(154),a=r(69),s=["__flags","__methods","_obj","assert"];e.exports=function(e,t){return a()?new Proxy(e,{get:function e(r,a){if("string"==typeof a&&-1===n.proxyExcludedKeys.indexOf(a)&&!Reflect.has(r,a)){if(t)throw Error("Invalid Chai property: "+t+"."+a+'. See docs for proper usage of "'+t+'".');var c=null,u=4;throw i(r).forEach((function(e){if(!Object.prototype.hasOwnProperty(e)&&-1===s.indexOf(e)){var t=function(e,t,r){if(Math.abs(e.length-t.length)>=r)return r;for(var n=[],o=0;o<=e.length;o++)n[o]=Array(t.length+1).fill(0),n[o][0]=o;for(var i=0;i<t.length;i++)n[0][i]=i;for(o=1;o<=e.length;o++){var a=e.charCodeAt(o-1);for(i=1;i<=t.length;i++)Math.abs(o-i)>=r?n[o][i]=r:n[o][i]=Math.min(n[o-1][i]+1,n[o][i-1]+1,n[o-1][i-1]+(a===t.charCodeAt(i-1)?0:1))}return n[e.length][t.length]}(a,e,u);t<u&&(c=e,u=t)}})),null!==c?Error("Invalid Chai property: "+a+'. Did you mean "'+c+'"?'):Error("Invalid Chai property: "+a)}return-1!==s.indexOf(a)||o(r,"lockSsfi")||o(r,"ssfi",e),Reflect.get(r,a)}}):e}},,,,,,,,,,,,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createSocket=t.InternalSocket=void 0;var p=r(11),l=r(46);function d(e,t){if(l.default.isIP(t))return t;switch(e){case"begingroup":return new l.default("openBracket",t);case"endgroup":return new l.default("closeBracket");case"data":return new l.default("data",t);default:return null}}function h(e){switch(e.type){case"openBracket":return{event:"begingroup",payload:e.data};case"data":return{event:"data",payload:e.data};case"closeBracket":return{event:"endgroup",payload:e.data};default:return null}}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,e);var t,r,n,c=s(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,u),(e=c.call(this)).metadata=t,e.brackets=[],e.connected=!1,e.dataDelegate=null,e.debug=!1,e.emitEvent=e.regularEmitEvent,e.from=null,e.to=null,e}return t=u,(r=[{key:"regularEmitEvent",value:function(e,t){this.emit(e,t)}},{key:"debugEmitEvent",value:function(e,t){try{this.emit(e,t)}catch(e){if(e.id&&e.metadata&&e.error){if(0===this.listeners("error").length)throw e.error;return void this.emit("error",e)}if(0===this.listeners("error").length)throw e;this.emit("error",{id:this.to.process.id,error:e,metadata:this.metadata})}}},{key:"connect",value:function(){this.connected||(this.connected=!0,this.emitEvent("connect",null))}},{key:"disconnect",value:function(){this.connected&&(this.connected=!1,this.emitEvent("disconnect",null))}},{key:"isConnected",value:function(){return this.connected}},{key:"send",value:function(e){void 0!==e||"function"!=typeof this.dataDelegate?this.handleSocketEvent("data",e):this.handleSocketEvent("data",this.dataDelegate())}},{key:"post",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e;void 0===r&&"function"==typeof this.dataDelegate&&(r=this.dataDelegate()),this.isConnected()||0!==this.brackets.length||this.connect(),this.handleSocketEvent("ip",r,!1),t&&this.isConnected()&&0===this.brackets.length&&this.disconnect()}},{key:"beginGroup",value:function(e){this.handleSocketEvent("begingroup",e)}},{key:"endGroup",value:function(){this.handleSocketEvent("endgroup")}},{key:"setDataDelegate",value:function(e){if("function"!=typeof e)throw Error("A data delegate must be a function.");this.dataDelegate=e}},{key:"setDebug",value:function(e){this.debug=e,this.emitEvent=this.debug?this.debugEmitEvent:this.regularEmitEvent}},{key:"getId",value:function(){var e=function(e){return"".concat(e.process.id,"() ").concat(e.port.toUpperCase())},t=function(e){return"".concat(e.port.toUpperCase()," ").concat(e.process.id,"()")};return this.from||this.to?this.from&&!this.to?"".concat(e(this.from)," -> ANON"):this.from?"".concat(e(this.from)," -> ").concat(t(this.to)):"DATA -> ".concat(t(this.to)):"UNDEFINED"}},{key:"handleSocketEvent",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="ip"===e&&l.default.isIP(t),o=n?t:d(e,t);if(o){if(!this.isConnected()&&r&&0===this.brackets.length&&this.connect(),"begingroup"===e&&this.brackets.push(t),n&&"openBracket"===o.type&&this.brackets.push(o.data),"endgroup"===e){if(0===this.brackets.length)return;o.data=this.brackets.pop(),t=o.data}if(n&&"closeBracket"===t.type){if(0===this.brackets.length)return;this.brackets.pop()}if(this.emitEvent("ip",o),o&&o.type){if(n){var i=h(o);e=i.event,t=i.payload}"connect"===e&&(this.connected=!0),"disconnect"===e&&(this.connected=!1),this.emitEvent(e,t)}}}}])&&i(t.prototype,r),n&&i(t,n),u}(p.EventEmitter);t.InternalSocket=f,t.createSocket=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new f(e)}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentLoader=void 0;var c=r(23),u=r(201),p=r(37),l=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this.baseDir=t,this.options=r,this.components=null,this.libraryIcons={},this.sourcesForComponents={},this.specsForComponents={},this.processing=null,this.ready=!1}var t,r,o;return t=e,(r=[{key:"getModulePrefix",value:function(e){if(!e)return"";var t=e;return"noflo"===t?"":("@"===t[0]&&(t=t.replace(/@[a-z-]+\//,"")),t.replace(/^noflo-/,""))}},{key:"listComponents",value:function(e){var t,r=this;return this.processing?t=this.processing:this.ready&&this.components?t=Promise.resolve(this.components):(this.components={},this.ready=!1,this.processing=new Promise((function(e,t){p.makeAsync((function(){u.register(r,(function(n){n?t(n):(r.ready=!0,r.processing=null,e(r.components))}))}))})),t=this.processing),e&&(p.deprecated("Providing a callback to ComponentLoader.listComponents is deprecated, use Promises"),t.then((function(t){e(null,t)}),e)),t}},{key:"load",value:function(e,t,r){var n=this,o=t,i=r;if("function"==typeof t&&(i=t,o=r),!this.ready)return this.listComponents().then((function(){return n.load(e,t,r)}));var a=new Promise((function(t,r){if(n.components){var o=n.components[e];if(!o){for(var i=Object.keys(n.components),a=0;a<i.length;a+=1){var s=i[a];if(s.split("/")[1]===e){o=n.components[s];break}}if(!o)return void r(new Error("Component ".concat(e," not available with base ").concat(n.baseDir)))}t(o)}else r(new Error("Component ".concat(e," not available with base ").concat(n.baseDir)))})).then((function(t){return n.isGraph(t)?n.loadGraph(e,t,o):n.createComponent(e,t,o).then((function(t){if(!t)return Promise.reject(new Error("Component ".concat(e," could not be loaded.")));var r=t;return"Graph"===e&&(r.baseDir=n.baseDir),"string"==typeof e&&(r.componentName=e),r.isLegacy()&&p.deprecated("Component ".concat(e," uses legacy NoFlo APIs. Please port to Process API")),n.setIcon(e,r),r}))}));return i&&(p.deprecated("Providing a callback to ComponentLoader.load is deprecated, use Promises"),a.then((function(e){i(null,e)}),i)),a}},{key:"createComponent",value:function(e,t,r){var n,o=t;if(!o)return Promise.reject(new Error("Component ".concat(e," not available")));if("string"==typeof o)return"function"==typeof u.dynamicLoad?new Promise((function(t,n){u.dynamicLoad(e,o,r,(function(e,r){e?n(e):t(r)}))})):Promise.reject(Error("Dynamic loading of ".concat(o," for component ").concat(e," not available on this platform.")));var a=o;if("function"==typeof a.getComponent)try{n=a.getComponent(r)}catch(e){return Promise.reject(e)}else{if("function"!=typeof o)return Promise.reject(new Error("Invalid type ".concat(i(o)," for component ").concat(e,".")));try{n=o(r)}catch(e){return Promise.reject(e)}}return Promise.resolve(n)}},{key:"isGraph",value:function(e){return!("object"!==i(e)||!(e instanceof c.Graph||Array.isArray(e.nodes)&&Array.isArray(e.edges)&&Array.isArray(e.initializers)))||!("object"!==i(e)||!e.processes||!e.connections)||"string"==typeof e&&(-1!==e.indexOf(".fbp")||-1!==e.indexOf(".json"))}},{key:"loadGraph",value:function(e,t,r){var n=this,o=this.components.Graph;return this.createComponent(e,o,r).then((function(r){var o=r;return o.loader=n,o.baseDir=n.baseDir,o.inPorts.remove("graph"),n.setIcon(e,o),o.setGraph(t).then((function(){return o}))}))}},{key:"setIcon",value:function(e,t){if(t.getIcon&&!t.getIcon()){var r=n(e.split("/"),2),o=r[0];r[1]&&this.getLibraryIcon(o)?t.setIcon(this.getLibraryIcon(o)):t.isSubgraph()?t.setIcon("sitemap"):t.setIcon("gear")}}},{key:"getLibraryIcon",value:function(e){return this.libraryIcons[e]?this.libraryIcons[e]:null}},{key:"setLibraryIcon",value:function(e,t){this.libraryIcons[e]=t}},{key:"normalizeName",value:function(e,t){var r=this.getModulePrefix(e),n="".concat(r,"/").concat(t);return e||(n=t),n}},{key:"registerComponent",value:function(e,t,r,n){var o=this.normalizeName(e,t);this.components[o]=r,n&&n(null)}},{key:"registerGraph",value:function(e,t,r,n){this.registerComponent(e,t,r,n)}},{key:"registerLoader",value:function(e,t){e(this,t)}},{key:"setSource",value:function(e,t,r,n,o){var i,a=this;return this.ready?(i=u.setSource?new Promise((function(o,i){u.setSource(a,e,t,r,n,(function(e){e?i(e):o()}))})):Promise.reject(new Error("setSource not allowed")),o&&(p.deprecated("Providing a callback to ComponentLoader.setSource is deprecated, use Promises"),i.then((function(){o(null)}),o)),i):this.listComponents().then((function(){return a.setSource(e,t,r,n,o)}))}},{key:"getSource",value:function(e,t){var r,n=this;return this.ready?(r=u.getSource?new Promise((function(t,r){u.getSource(n,e,(function(e,n){e?r(e):t(n)}))})):Promise.reject(new Error("getSource not allowed")),t&&(p.deprecated("Providing a callback to ComponentLoader.getSource is deprecated, use Promises"),r.then((function(e){t(null,e)}),t)),r):this.listComponents().then((function(){return n.getSource(e,t)}))}},{key:"getLanguages",value:function(){return u.getLanguages?u.getLanguages():["javascript","es2015"]}},{key:"clear",value:function(){this.components=null,this.sourcesForComponents={},this.specsForComponents={},this.ready=!1,this.processing=null}}])&&s(t.prototype,r),o&&s(t,o),e}();t.ComponentLoader=l},function(e,t,r){const n=r(239),o={host:"https://api.flowhub.io"};Object.defineProperty(t,"PING_INTERVAL",{value:6e5,enumerable:!0});e.exports.Runtime=class{constructor(e,t){if("object"!=typeof e)throw new Error("Runtime options expected");if(!e.id)throw new Error("Runtime requires an UUID");this.runtime=e,this.options={},Object.keys(o).forEach(e=>{this.options[e]=o[e]}),t&&Object.keys(t).forEach(e=>{this.options[e]=t[e]})}register(e,t){let r=e,o=t;"function"==typeof r&&(o=e,r=null),this.runtime.user?this.runtime.address?this.runtime.protocol?this.runtime.type?r?n.put(`${this.options.host}/runtimes/${this.runtime.id}`).set("Authorization","Bearer "+r).send(this.runtime).end(o):n.put(`${this.options.host}/runtimes/${this.runtime.id}`).send(this.runtime).end(o):o(new Error("Runtime registration requires a type")):o(new Error("Runtime registration requires a protocol")):o(new Error("Runtime registration requires an address URL")):o(new Error("Runtime registration requires a user UUID"))}ping(e){n.post(`${this.options.host}/runtimes/${this.runtime.id}`).send({}).end(t=>{e&&e(t)})}get(e,t){e?n.get(`${this.options.host}/runtimes/${this.runtime.id}`).set("Authorization","Bearer "+e).end((e,r)=>{e?t(e):200===r.status?(Object.keys(r.body).forEach(e=>{this.runtime[e]="seen"!==e&&"registered"!==e?r.body[e]:new Date(r.body[e])}),t(null,this.runtime)):t(new Error("Request returned "+r.status))}):t(new Error("API token required for fetching"))}del(e,t){e?n.del(`${this.options.host}/runtimes/${this.runtime.id}`).set("Authorization","Bearer "+e).end((e,r)=>{e&&404===e.status?t():t(e,r)}):t(new Error("API token required for deletion"))}},e.exports.list=function(e,r,i){let a=r,s=i;s||(s=a,a={}),e?(Object.keys(o).forEach(e=>{a[e]||(a[e]=o[e])}),n.get(a.host+"/runtimes/").set("Authorization","Bearer "+e).end((e,r)=>{if(e)return void s(e);if(200!==r.status)return void s(new Error("Request returned "+r.status));const n=[];r.body.forEach(e=>{n.push(new t.Runtime({...e,registered:new Date(e.registered),seen:new Date(e.seen)},a))}),s(null,n)})):s(new Error("API token required for fetching"))}},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,o=Array.isArray,i=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],a=i.obj[i.prop],s=Object.keys(a),c=0;c<s.length;++c){var u=s[c],p=a[u];"object"==typeof p&&null!==p&&-1===r.indexOf(p)&&(t.push({obj:a,prop:u}),r.push(p))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(o(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n=e;if("symbol"==typeof e?n=Symbol.prototype.toString.call(e):"string"!=typeof e&&(n=String(e)),"iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var o="",a=0;a<n.length;++a){var s=n.charCodeAt(a);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?o+=n.charAt(a):s<128?o+=i[s]:s<2048?o+=i[192|s>>6]+i[128|63&s]:s<55296||s>=57344?o+=i[224|s>>12]+i[128|s>>6&63]+i[128|63&s]:(a+=1,s=65536+((1023&s)<<10|1023&n.charCodeAt(a)),o+=i[240|s>>18]+i[128|s>>12&63]+i[128|s>>6&63]+i[128|63&s])}return o},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(o(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,i){if(!r)return t;if("object"!=typeof r){if(o(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(i&&(i.plainObjects||i.allowPrototypes)||!n.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var s=t;return o(t)&&!o(r)&&(s=a(t,i)),o(t)&&o(r)?(r.forEach((function(r,o){if(n.call(t,o)){var a=t[o];a&&"object"==typeof a&&r&&"object"==typeof r?t[o]=e(a,r,i):t.push(r)}else t[o]=r})),t):Object.keys(r).reduce((function(t,o){var a=r[o];return n.call(t,o)?t[o]=e(t[o],a,i):t[o]=a,t}),s)}}},function(e,t,r){"use strict";var n=r(48).codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}e.exports=function e(t,r,i){if("function"==typeof r)return e(t,null,r);r||(r={}),i=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];e.apply(this,n)}}}(i||o);var a=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||p()},u=t._writableState&&t._writableState.finished,p=function(){s=!1,u=!0,a||i.call(t)},l=t._readableState&&t._readableState.endEmitted,d=function(){a=!1,l=!0,s||i.call(t)},h=function(e){i.call(t,e)},f=function(){var e;return a&&!l?(t._readableState&&t._readableState.ended||(e=new n),i.call(t,e)):s&&!u?(t._writableState&&t._writableState.ended||(e=new n),i.call(t,e)):void 0},m=function(){t.req.on("finish",p)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",p),t.on("abort",f),t.req?m():t.on("request",m)),t.on("end",d),t.on("finish",p),!1!==r.error&&t.on("error",h),t.on("close",f),function(){t.removeListener("complete",p),t.removeListener("abort",f),t.removeListener("request",m),t.req&&t.req.removeListener("finish",p),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",p),t.removeListener("end",d),t.removeListener("error",h),t.removeListener("close",f)}}},function(e,t){e.exports={component:{title:"Component protocol",description:"Protocol for handling the component registry.",output:{error:{id:"output/error",description:"Error response to a command on component protocol",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["component"]},command:{enum:["error"]},payload:{required:["message"],properties:{message:{type:"string",description:"Error message describing what went wrong"}}}}}]},component:{id:"output/component",description:"Transmit the metadata about a component instance.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["component"]},command:{enum:["component"]},payload:{required:["name","subgraph","inPorts","outPorts"],additionalProperties:!1,properties:{name:{type:"string",description:"component name in format that can be used in graphs. Should contain the component library prefix.",example:"my-project/MyComponent"},description:{type:"string",description:"textual description on what the component does"},icon:{type:"string",description:'Visual icon for the component, matching icon names in <a href="http://fortawesome.github.io/Font-Awesome/icons/">Font Awesome</a>'},subgraph:{type:"boolean",description:"boolean telling whether the component is a subgraph"},inPorts:{description:"list of input ports of the component",id:"port_definition",type:"array",items:{type:"object",required:["id","type"],additionalProperties:!1,properties:{id:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},type:{description:"port datatype",type:"string",example:"boolean"},schema:{type:"string",format:"uri",description:"Link to JSON schema for data on this port",example:"https://example.net/schemas/person.json"},required:{description:"whether the port needs to be connected for the component to work",type:"boolean",example:!0},addressable:{type:"boolean",description:"whether the port is an ArrayPort",example:!1},description:{type:"string",description:"textual description of the port"},values:{type:"array",description:"list of values accepted for the port"},default:{description:"default value for the port"}}}},outPorts:{description:"list of output ports of the component",id:"port_definition",type:"array",items:{type:"object",required:["id","type"],additionalProperties:!1,properties:{id:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},type:{description:"port datatype",type:"string",example:"boolean"},schema:{type:"string",format:"uri",description:"Link to JSON schema for data on this port",example:"https://example.net/schemas/person.json"},required:{description:"whether the port needs to be connected for the component to work",type:"boolean",example:!0},addressable:{type:"boolean",description:"whether the port is an ArrayPort",example:!1},description:{type:"string",description:"textual description of the port"},values:{type:"array",description:"list of values accepted for the port"},default:{description:"default value for the port"}}}}}}}}]},componentsready:{id:"output/componentsready",description:"Indication that a component listing has finished",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{enum:["component"],type:"string",description:"type of protocol"},command:{enum:["componentsready"],description:"command to be executed",example:"addnode"},payload:{type:"integer",description:"number of components transmitted in this batch",example:42},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},source:{id:"output/source",description:"Source code for a component. In cases where a runtime receives a `source` message, it should do whatever operations are needed for making that component available for graphs, including possible compilation.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["component"]},command:{enum:["source"]},payload:{required:["name","language","code"],additionalProperties:!1,properties:{name:{type:"string",description:"Name of the component. Must not contain library prefix",example:"MyComponent"},language:{type:"string",description:"The programming language used for the component code",example:"c++"},library:{type:"string",description:"Component library identifier",example:"components-common"},code:{type:"string",description:"Component source code"},tests:{type:"string",description:"unit tests for the component"}}}}}]}},input:{list:{id:"input/list",description:"Request a list of currently available components. Will be responded with a set of `component` messages.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["component"]},command:{enum:["list"]},payload:{required:[]}}}]},getsource:{id:"input/getsource",description:"Request for the source code of a given component. Will be responded with a `source` message.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["component"]},command:{enum:["getsource"]},payload:{required:["name"],additionalProperties:!1,properties:{name:{type:"string",description:"Name of the component to for which to get source code. Should contain the library prefix",example:"my-project/SomeComponent"}}}}}]},source:{id:"input/source",description:"Source code for a component. In cases where a runtime receives a `source` message, it should do whatever operations are needed for making that component available for graphs, including possible compilation.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["component"]},command:{enum:["source"]},payload:{required:["name","language","code"],additionalProperties:!1,properties:{name:{type:"string",description:"Name of the component. Must not contain library prefix.",example:"SomeComponent"},language:{type:"string",description:"The programming language used for the component code",example:"c++"},library:{type:"string",description:"Component library identifier",example:"my-project"},code:{type:"string",description:"Component source code"},tests:{type:"string",description:"Unit tests for the component"}}}}}]}}},graph:{$schema:"http://json-schema.org/draft-04/schema#",title:"Graph protocol",description:"This protocol is utilized for communicating about graph changes in both directions.",messages:{error:{id:"messages/error",properties:{protocol:{enum:["graph"]},command:{enum:["error"]},payload:{required:["message"],properties:{message:{type:"string",description:"Error message describing what went wrong"}}}}},clear:{id:"messages/clear",properties:{protocol:{enum:["graph"]},command:{enum:["clear"]},payload:{required:["id"],additionalProperties:!1,properties:{id:{description:"identifier for the graph being created. Used for all subsequent messages related to the graph instance",id:"graph_id",type:"string"},name:{type:"string",description:"Human-readable label for the graph"},library:{type:"string",description:"Component library identifier"},main:{type:"boolean",description:"Identifies the graph as a main graph of a project that should not be registered as a component\nGraphs registered in this way should also be available for use as subgraphs in other graphs. Therefore a graph registration and later changes to it may cause component messages of the Component protocol to be sent back to the client informing of possible changes in the ports of the subgraph component."},icon:{type:"string",description:"Icon to use for the graph when used as a component"},description:{type:"string",description:"Description to use for the graph when used as a component"}}}}},addnode:{properties:{protocol:{enum:["graph"]},command:{enum:["addnode"]},payload:{required:["id","component","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},component:{type:"string",description:"component name used for the node"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},removenode:{properties:{protocol:{enum:["graph"]},command:{enum:["removenode"]},payload:{required:["id","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},renamenode:{properties:{protocol:{enum:["graph"]},command:{enum:["renamenode"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{type:"string",description:"original identifier for the node"},to:{type:"string",description:"new identifier for the node"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},changenode:{properties:{protocol:{enum:["graph"]},command:{enum:["changenode"]},payload:{required:["id","metadata","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},addedge:{properties:{protocol:{enum:["graph"]},command:{enum:["addedge"]},payload:{required:["src","tgt","graph"],additionalProperties:!1,properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},metadata:{description:"Structure of key-value pairs for edge metadata",id:"metadata_edge",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},removeedge:{properties:{protocol:{enum:["graph"]},command:{enum:["removeedge"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},changeedge:{properties:{protocol:{enum:["graph"]},command:{enum:["changeedge"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{metadata:{description:"struct of key-value pairs for edge metadata",id:"metadata_edge",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},addinitial:{properties:{protocol:{enum:["graph"]},command:{enum:["addinitial"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{metadata:{type:"object",description:"structure of key-value pairs for IIP metadata",id:"metadata_edge",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},src:{description:"source data for the edge",id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},tgt:{description:"target node/port for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},removeinitial:{properties:{protocol:{enum:["graph"]},command:{enum:["removeinitial"]},payload:{required:["tgt","graph"],additionalProperties:!1,properties:{src:{description:"IIP data",id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},tgt:{description:"target node/port for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},addinport:{properties:{protocol:{enum:["graph"]},command:{enum:["addinport"]},payload:{additionalProperties:!1,required:["public","port","node","graph"],properties:{public:{description:"the exported name of the port",id:"port_id",type:"string",example:"in"},node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{description:"internal port name in the graph",id:"port_id",type:"string",example:"in"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},removeinport:{properties:{protocol:{enum:["graph"]},command:{enum:["removeinport"]},payload:{required:["public","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port to remove",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},renameinport:{properties:{protocol:{enum:["graph"]},command:{enum:["renameinport"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{description:"original exported port name",id:"port_id",type:"string",example:"in"},to:{description:"new exported port name",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},addoutport:{properties:{protocol:{enum:["graph"]},command:{enum:["addoutport"]},payload:{required:["public","node","port","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port",example:"out",id:"port_id",type:"string"},node:{description:"node identifier",id:"node_id",type:"string",example:"Repeat"},port:{description:"internal port name",example:"out[2]",id:"port_id",type:"string"},metadata:{description:"structure of key-value pairs for port metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},removeoutport:{properties:{protocol:{enum:["graph"]},command:{enum:["removeoutport"]},payload:{required:["public","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port to remove",example:"out",id:"port_id",type:"string"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},renameoutport:{properties:{protocol:{enum:["graph"]},command:{enum:["renameoutport"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{description:"original exported port name",id:"port_id",type:"string",example:"in"},to:{description:"new exported port name",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},addgroup:{properties:{protocol:{enum:["graph"]},command:{enum:["addgroup"]},payload:{required:["name","nodes","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},nodes:{type:"array",description:"an array of node ids part of the group",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}},metadata:{description:"structure of key-value pairs for group metadata",id:"metadata_group",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},removegroup:{properties:{protocol:{enum:["graph"]},command:{enum:["removegroup"]},payload:{required:["name","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},renamegroup:{properties:{protocol:{enum:["graph"]},command:{enum:["renamegroup"]},payload:{required:["from","to","graph"],properties:{from:{type:"string",description:"original group name"},to:{type:"string",description:"new group name"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},changegroup:{properties:{protocol:{enum:["graph"]},command:{enum:["changegroup"]},payload:{required:["name","metadata","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},metadata:{description:"structure of key-value pairs for group metadata",id:"metadata_group",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}},output:{error:{id:"output/error",description:"Error response to a command on graph protocol",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{id:"messages/error",properties:{protocol:{enum:["graph"]},command:{enum:["error"]},payload:{required:["message"],properties:{message:{type:"string",description:"Error message describing what went wrong"}}}}}]},clear:{id:"output/clear",description:"An empty graph was initialized",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{id:"messages/clear",properties:{protocol:{enum:["graph"]},command:{enum:["clear"]},payload:{required:["id"],additionalProperties:!1,properties:{id:{description:"identifier for the graph being created. Used for all subsequent messages related to the graph instance",id:"graph_id",type:"string"},name:{type:"string",description:"Human-readable label for the graph"},library:{type:"string",description:"Component library identifier"},main:{type:"boolean",description:"Identifies the graph as a main graph of a project that should not be registered as a component\nGraphs registered in this way should also be available for use as subgraphs in other graphs. Therefore a graph registration and later changes to it may cause component messages of the Component protocol to be sent back to the client informing of possible changes in the ports of the subgraph component."},icon:{type:"string",description:"Icon to use for the graph when used as a component"},description:{type:"string",description:"Description to use for the graph when used as a component"}}}}}]},addnode:{id:"output/addnode",description:"A node was added to a graph.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addnode"]},payload:{required:["id","component","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},component:{type:"string",description:"component name used for the node"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removenode:{id:"output/removenode",description:"A node was removed from a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removenode"]},payload:{required:["id","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renamenode:{id:"output/renamenode",description:"A node was renamed in a graph.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renamenode"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{type:"string",description:"original identifier for the node"},to:{type:"string",description:"new identifier for the node"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},changenode:{id:"output/changenode",description:"Metadata of a node was changed in a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["changenode"]},payload:{required:["id","metadata","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addedge:{id:"output/addedge",description:"An edge was added to a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addedge"]},payload:{required:["src","tgt","graph"],additionalProperties:!1,properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},metadata:{description:"Structure of key-value pairs for edge metadata",id:"metadata_edge",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeedge:{id:"output/removeedge",description:"An edge was removed from a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeedge"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},changeedge:{id:"output/changeedge",description:"Metadata of an edge was changed in a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["changeedge"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{metadata:{description:"struct of key-value pairs for edge metadata",id:"metadata_edge",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addinitial:{id:"output/addinitial",description:"An IIP was added to a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addinitial"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{metadata:{type:"object",description:"structure of key-value pairs for IIP metadata",id:"metadata_edge",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},src:{description:"source data for the edge",id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},tgt:{description:"target node/port for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeinitial:{id:"output/removeinitial",description:"An IIP was removed from a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeinitial"]},payload:{required:["tgt","graph"],additionalProperties:!1,properties:{src:{description:"IIP data",id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},tgt:{description:"target node/port for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addinport:{id:"output/addinport",description:"An exported inport was added to a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addinport"]},payload:{additionalProperties:!1,required:["public","port","node","graph"],properties:{public:{description:"the exported name of the port",id:"port_id",type:"string",example:"in"},node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{description:"internal port name in the graph",id:"port_id",type:"string",example:"in"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeinport:{id:"output/removeinport",description:"An exported inport was removed from a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeinport"]},payload:{required:["public","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port to remove",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renameinport:{id:"output/renameinport",description:"An exported inport was renamed in a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renameinport"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{description:"original exported port name",id:"port_id",type:"string",example:"in"},to:{description:"new exported port name",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addoutport:{id:"output/addoutport",description:"An exported outport was added to a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addoutport"]},payload:{required:["public","node","port","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port",example:"out",id:"port_id",type:"string"},node:{description:"node identifier",id:"node_id",type:"string",example:"Repeat"},port:{description:"internal port name",example:"out[2]",id:"port_id",type:"string"},metadata:{description:"structure of key-value pairs for port metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeoutport:{id:"output/removeoutport",description:"An exported outport was removed from a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeoutport"]},payload:{required:["public","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port to remove",example:"out",id:"port_id",type:"string"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renameoutport:{id:"output/renameoutport",description:"An exported outport was renamed in a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renameoutport"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{description:"original exported port name",id:"port_id",type:"string",example:"in"},to:{description:"new exported port name",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addgroup:{id:"output/addgroup",description:"A group was added to a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addgroup"]},payload:{required:["name","nodes","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},nodes:{type:"array",description:"an array of node ids part of the group",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}},metadata:{description:"structure of key-value pairs for group metadata",id:"metadata_group",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removegroup:{id:"output/removegroup",description:"A group was removed from a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removegroup"]},payload:{required:["name","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renamegroup:{id:"output/renamegroup",description:"A group was renamed in a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renamegroup"]},payload:{required:["from","to","graph"],properties:{from:{type:"string",description:"original group name"},to:{type:"string",description:"new group name"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},changegroup:{id:"output/changegroup",description:"Metadata of a group was changed in a graph",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["changegroup"]},payload:{required:["name","metadata","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},metadata:{description:"structure of key-value pairs for group metadata",id:"metadata_group",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}},input:{clear:{id:"input/clear",description:"Initialize an empty graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{id:"messages/clear",properties:{protocol:{enum:["graph"]},command:{enum:["clear"]},payload:{required:["id"],additionalProperties:!1,properties:{id:{description:"identifier for the graph being created. Used for all subsequent messages related to the graph instance",id:"graph_id",type:"string"},name:{type:"string",description:"Human-readable label for the graph"},library:{type:"string",description:"Component library identifier"},main:{type:"boolean",description:"Identifies the graph as a main graph of a project that should not be registered as a component\nGraphs registered in this way should also be available for use as subgraphs in other graphs. Therefore a graph registration and later changes to it may cause component messages of the Component protocol to be sent back to the client informing of possible changes in the ports of the subgraph component."},icon:{type:"string",description:"Icon to use for the graph when used as a component"},description:{type:"string",description:"Description to use for the graph when used as a component"}}}}}]},addnode:{id:"input/addnode",description:"Add node to a graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addnode"]},payload:{required:["id","component","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},component:{type:"string",description:"component name used for the node"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removenode:{id:"input/removenode",description:"Remove a node from a graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removenode"]},payload:{required:["id","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renamenode:{id:"input/renamenode",description:"Change the ID of a node in the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renamenode"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{type:"string",description:"original identifier for the node"},to:{type:"string",description:"new identifier for the node"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},changenode:{id:"input/changenode",description:"Change the metadata associated to a node in the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["changenode"]},payload:{required:["id","metadata","graph"],additionalProperties:!1,properties:{id:{type:"string",description:"identifier for the node"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addedge:{id:"input/addedge",description:"Add an edge to the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addedge"]},payload:{required:["src","tgt","graph"],additionalProperties:!1,properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},metadata:{description:"Structure of key-value pairs for edge metadata",id:"metadata_edge",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeedge:{id:"input/removeedge",description:"Remove an edge from the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeedge"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},changeedge:{id:"input/changeedge",description:"Change an edge's metadata",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["changeedge"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{metadata:{description:"struct of key-value pairs for edge metadata",id:"metadata_edge",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addinitial:{id:"input/addinitial",description:"Add an IIP to the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addinitial"]},payload:{additionalProperties:!1,required:["graph","src","tgt"],properties:{metadata:{type:"object",description:"structure of key-value pairs for IIP metadata",id:"metadata_edge",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},src:{description:"source data for the edge",id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},tgt:{description:"target node/port for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeinitial:{id:"input/removeinitial",description:"Remove an IIP from the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeinitial"]},payload:{required:["tgt","graph"],additionalProperties:!1,properties:{src:{description:"IIP data",id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},tgt:{description:"target node/port for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addinport:{id:"input/addinport",description:"Add an exported inport to the graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addinport"]},payload:{additionalProperties:!1,required:["public","port","node","graph"],properties:{public:{description:"the exported name of the port",id:"port_id",type:"string",example:"in"},node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{description:"internal port name in the graph",id:"port_id",type:"string",example:"in"},metadata:{description:"structure of key-value pairs for node metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeinport:{id:"input/removeinport",description:"Remove an exported port from the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeinport"]},payload:{required:["public","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port to remove",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renameinport:{id:"input/renameinport",description:"Rename an exported port in the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renameinport"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{description:"original exported port name",id:"port_id",type:"string",example:"in"},to:{description:"new exported port name",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addoutport:{id:"input/addoutport",description:"Add an exported outport to the graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addoutport"]},payload:{required:["public","node","port","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port",example:"out",id:"port_id",type:"string"},node:{description:"node identifier",id:"node_id",type:"string",example:"Repeat"},port:{description:"internal port name",example:"out[2]",id:"port_id",type:"string"},metadata:{description:"structure of key-value pairs for port metadata",id:"metadata_node",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removeoutport:{id:"input/removeoutport",description:"Remove an exported port from the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removeoutport"]},payload:{required:["public","graph"],additionalProperties:!1,properties:{public:{description:"the exported name of the port to remove",example:"out",id:"port_id",type:"string"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renameoutport:{id:"input/renameoutport",description:"Rename an exported port in the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renameoutport"]},payload:{required:["from","to","graph"],additionalProperties:!1,properties:{from:{description:"original exported port name",id:"port_id",type:"string",example:"in"},to:{description:"new exported port name",id:"port_id",type:"string",example:"in"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},addgroup:{id:"input/addgroup",description:"Add a group to the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["addgroup"]},payload:{required:["name","nodes","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},nodes:{type:"array",description:"an array of node ids part of the group",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}},metadata:{description:"structure of key-value pairs for group metadata",id:"metadata_group",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},removegroup:{id:"input/removegroup",description:"Remove a group from the graph",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["removegroup"]},payload:{required:["name","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},renamegroup:{id:"input/renamegroup",description:"Rename a group in the graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["renamegroup"]},payload:{required:["from","to","graph"],properties:{from:{type:"string",description:"original group name"},to:{type:"string",description:"new group name"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},changegroup:{id:"input/changegroup",description:"Change a group's metadata",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["graph"]},command:{enum:["changegroup"]},payload:{required:["name","metadata","graph"],additionalProperties:!1,properties:{name:{type:"string",description:"the group name"},metadata:{description:"structure of key-value pairs for group metadata",id:"metadata_group",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}}},network:{$schema:"http://json-schema.org/draft-04/schema#",title:"Network protocol",description:"Protocol for starting and stopping FBP networks, and finding out about their state.",output:{stopped:{id:"output/stopped",description:"Inform that a given network has stopped.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["stopped"]},payload:{required:["graph"],additionalProperties:!1,properties:{time:{type:"string",format:"date-time",description:"time when the network was stopped"},uptime:{type:"number",description:"time the network was running, in seconds"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},running:{type:"boolean",description:"whether or not network is currently running"},started:{type:"boolean",description:"whether or not network has been started"},debug:{type:"boolean",description:"whether or not network is in debug mode"}}}}}]},started:{id:"output/started",description:"Inform that a given network has been started.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["started"]},payload:{required:["graph"],additionalProperties:!1,properties:{time:{type:"string",format:"date-time",description:"time when the network was started"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},started:{type:"boolean",description:"whether or not network has started running"},running:{type:"boolean",description:"whether or not network is currently running"},debug:{type:"boolean",description:"whether or not network is in debug mode"}}}}}]},status:{id:"output/status",description:"Response to a getstatus message.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["status"]},payload:{required:["running","graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},uptime:{type:"number",description:"time the network has been running, in seconds"},started:{type:"boolean",description:"whether or not network has started running"},running:{type:"boolean",description:"boolean tells whether the network is running or not"},debug:{type:"boolean",description:"whether or not network is in debug mode"}}}}}]},output:{id:"output/output",description:"An output message from a running network, roughly similar to STDOUT output of a Unix process, or a line of console.log in JavaScript. Output can also be used for passing images from the runtime to the UI.'",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["output"]},payload:{required:["message"],additionalProperties:!1,properties:{message:{type:"string",description:"contents of the output line"},type:{type:"string",enum:["message","previewurl"],description:"type of output, either message or previewurl"},url:{type:"string",format:"uri",description:"URL for an image generated by the runtime"}}}}}]},error:{id:"output/error",description:"An error from a running network, roughly similar to STDERR output of a Unix process, or a line of console.error in JavaScript.'",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["error"]},payload:{required:["message"],additionalProperties:!1,properties:{message:{description:"contents of the error message",type:"string"},stack:{description:"stack trace",type:"string"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},processerror:{id:"output/processerror",description:"When in debug mode, a network can signal an error happening inside a process.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["processerror"]},payload:{required:["id","error","graph"],additionalProperties:!1,properties:{id:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},error:{type:"string",description:"error from the component"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},icon:{id:"output/icon",description:"Icon of a component instance has changed.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["icon"]},payload:{required:["id","icon","graph"],additionalProperties:!1,properties:{id:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},icon:{type:"string",description:"new icon for the component instance"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},connect:{id:"output/connect",description:"Beginning of transmission on an edge.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["connect"]},payload:{additionalProperties:!1,id:"network_event",required:["id","tgt","graph"],properties:{id:{type:"string",description:"textual edge identifier, usually in form of a FBP language line"},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},subgraph:{type:"array",description:"Subgraph identifier for the event. An array of node IDs.",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}}}}}}]},begingroup:{id:"output/begingroup",description:"Beginning of a group (bracket IP) on an edge.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["begingroup"]},payload:{allOf:[{id:"network_event",required:["id","tgt","graph"],properties:{id:{type:"string",description:"textual edge identifier, usually in form of a FBP language line"},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},subgraph:{type:"array",description:"Subgraph identifier for the event. An array of node IDs.",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}}}},{required:["group"],properties:{group:{description:"group name",type:"string"}}},{additionalProperties:!1,properties:{group:!0,id:!0,tgt:!0,src:!0,graph:!0,subgraph:!0}}]}}}]},data:{id:"output/data",description:"Data transmission on an edge.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["data"]},payload:{allOf:[{id:"network_event",required:["id","tgt","graph"],properties:{id:{type:"string",description:"textual edge identifier, usually in form of a FBP language line"},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},subgraph:{type:"array",description:"Subgraph identifier for the event. An array of node IDs.",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}}}},{required:["data"],properties:{data:{description:"actual data being transmitted, encoded in a way that can be carried over the protocol transport"},type:{type:"string",description:"The basic datatype sent",example:"array"},schema:{type:"string",format:"uri",description:"Link to JSON schema describing the format of the data",example:"https://example.net/schemas/person.json"}}},{additionalProperties:!1,properties:{data:!0,id:!0,src:!0,tgt:!0,graph:!0,subgraph:!0}}]}}}]},endgroup:{id:"output/endgroup",description:"Ending of a group (bracket IP) on an edge.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["endgroup"]},payload:{allOf:[{id:"network_event",required:["id","tgt","graph"],properties:{id:{type:"string",description:"textual edge identifier, usually in form of a FBP language line"},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},subgraph:{type:"array",description:"Subgraph identifier for the event. An array of node IDs.",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}}}},{required:["group"],properties:{group:{description:"group name",type:"string"}}},{additionalProperties:!1,properties:{group:!0,id:!0,src:!0,tgt:!0,graph:!0,subgraph:!0}}]}}}]},disconnect:{id:"output/disconnect",description:"End of transmission on an edge.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["network"]},command:{enum:["disconnect"]},payload:{additionalProperties:!1,id:"network_event",required:["id","tgt","graph"],properties:{id:{type:"string",description:"textual edge identifier, usually in form of a FBP language line"},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},subgraph:{type:"array",description:"Subgraph identifier for the event. An array of node IDs.",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}}}}}}]},edges:{id:"output/edges",description:"List of edges user has selected for inspection in a user interface or debugger, sent from runtime to UI.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["edges"]},payload:{required:["graph","edges"],additionalProperties:!1,properties:{edges:{type:"array",description:"list of selected edges",items:{type:"object",required:["src","tgt"],additionalProperties:!1,properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}}}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}},input:{start:{id:"input/start",description:"Start execution of a FBP network based on a given graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["start"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},getstatus:{id:"input/getstatus",description:"Get the current status of the runtime. The runtime should respond with a status message.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["getstatus"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},stop:{id:"input/stop",description:"Stop execution of a FBP network based on a given graph.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["stop"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},persist:{id:"input/persist",description:"Tells the runtime to persist the current state of graphs and components so that they are available between restarts. Requires the network:persist capability.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["persist"]},payload:{required:[],additionalProperties:!1,properties:null}}}]},debug:{id:"input/debug",description:"Set a network into debug mode",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["debug"]},payload:{additionalProperties:!1,required:["enable","graph"],properties:{enable:{description:"tells whether to put the network in debug mode",type:"boolean"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},edges:{id:"input/edges",description:"List of edges user has selected for inspection in a user interface or debugger, sent from UI to a runtime.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["network"]},command:{enum:["edges"]},payload:{required:["graph","edges"],additionalProperties:!1,properties:{edges:{type:"array",description:"list of selected edges",items:{type:"object",required:["src","tgt"],additionalProperties:!1,properties:{src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}}}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}}},runtime:{title:"Runtime protocol",description:"When a client connects to a FBP procotol it may choose to discover the capabilities and other information about the runtime.",input:{getruntime:{id:"input/getruntime",description:"Request the information about the runtime. When receiving this message the runtime should response with a runtime message. If the runtime is currently running a graph and it is able to speak the full Runtime protocol, it should follow up with a ports message.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["getruntime"]},payload:{required:[],properties:{secret:{type:"string",description:"access token to authorize the client. Provided also in payload for compatibility with older runtimes"}}}}}]},packet:{id:"input/packet",description:"Runtimes that can be used as remote subgraphs (i.e. ones that have reported supporting the protocol:runtime capability) need to be able to receive and transmit information packets at their exposed ports.\nThese packets can be send from the client to the runtimes input ports, or from runtimes output ports to the client.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["packet"]},payload:{required:["port","event","graph"],additionalProperties:!1,properties:{port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},event:{type:"string",enum:["connect","begingroup","data","endgroup","disconnect"],description:"packet event"},type:{type:"string",description:"The basic datatype sent",example:"array"},schema:{type:"string",format:"uri",description:"Link to JSON schema describing the format of the data",example:"https://example.net/schemas/person.json"},payload:{description:"payload for the packet. Used only with begingroup (for group names) and data packets"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}},output:{error:{id:"output/error",description:"Error response to a command on runtime protocol",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["error"]},payload:{required:["message"],properties:{message:{type:"string",description:"Error message describing what went wrong"}}}}}]},ports:{id:"output/ports",description:"Message sent by the runtime to signal its available ports. The runtime is responsible for sending the up-to-date list of available ports back to client whenever it changes.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["ports"]},payload:{required:["graph","inPorts","outPorts"],additionalProperties:!1,properties:{inPorts:{description:"list of input ports of the runtime",id:"port_definition",type:"array",items:{type:"object",required:["id","type"],additionalProperties:!1,properties:{id:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},type:{description:"port datatype",type:"string",example:"boolean"},schema:{type:"string",format:"uri",description:"Link to JSON schema for data on this port",example:"https://example.net/schemas/person.json"},required:{description:"whether the port needs to be connected for the component to work",type:"boolean",example:!0},addressable:{type:"boolean",description:"whether the port is an ArrayPort",example:!1},description:{type:"string",description:"textual description of the port"},values:{type:"array",description:"list of values accepted for the port"},default:{description:"default value for the port"}}}},outPorts:{description:"list of output ports of the runtime",id:"port_definition",type:"array",items:{type:"object",required:["id","type"],additionalProperties:!1,properties:{id:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},type:{description:"port datatype",type:"string",example:"boolean"},schema:{type:"string",format:"uri",description:"Link to JSON schema for data on this port",example:"https://example.net/schemas/person.json"},required:{description:"whether the port needs to be connected for the component to work",type:"boolean",example:!0},addressable:{type:"boolean",description:"whether the port is an ArrayPort",example:!1},description:{type:"string",description:"textual description of the port"},values:{type:"array",description:"list of values accepted for the port"},default:{description:"default value for the port"}}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},runtime:{id:"output/runtime",description:"Response from the runtime to the getruntime request.",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["runtime"]},payload:{required:["version","capabilities","type"],additionalProperties:!1,properties:{id:{type:"string",description:"unique runtime ID. Must be a UUID, version 4",example:"f18a4924-9d4f-414d-a37c-cd24b39bba10"},label:{description:"Human-readable description of the runtime",type:"string"},version:{description:"version of the runtime protocol that the runtime supports",type:"string",example:"0.6"},allCapabilities:{description:"<a href='#capabilities'>capability strings</a> for things the runtime is able to do. May include things not permitted for this client.",id:"capabilities",type:"array",items:{type:"string",enums:["protocol:network","network:persist","network:status","network:data","network:control","protocol:component","component:getsource","component:setsource","protocol:runtime","protocol:graph","graph:readonly","protocol:trace"],_enumDescriptions:[{name:"protocol:network",description:"can control and introspect its running networks using the Network protocol. DEPRECATED. Instead the individual network:... capabilities should be used. Implies capabilities network:status, network:data, network:control. Does not imply capability network:persist.",inputs:["network:start","network:getstatus","network:stop","network:debug","network:edges"],outputs:["network:stopped","network:started","network:status","network:output","network:error","network:processerror","network:icon","network:connect","network:begingroup","network:data","network:endgroup","network:disconnect","network:edges"]},{name:"network:persist",description:"can *flash* a running graph setup to the runtime, making it persistent across restarts",inputs:["network:persist"],outputs:["network:persist","network:error"]},{name:"network:status",description:"can get and follow changes to network status",inputs:["network:getstatus"],outputs:["network:status","network:started","network:stopped","network:error"]},{name:"network:data",description:"can listen to data flowing through the network and processes",inputs:["network:edges"],outputs:["network:edges","network:output","network:error","network:data","network:begingroup","network:endgroup","network:connect","network:disconnect","network:icon","network:processerror","network:error"]},{name:"network:control",description:"can start and stop networks",inputs:["network:start","network:stop","network:getstatus","network:debug"],outputs:["network:started","network:stopped","network:status","network:error"]},{name:"protocol:component",description:"can list components of the runtime using the component:list message.",inputs:["component:list"],outputs:["component:component","component:componentsready","component:error"]},{name:"component:getsource",description:"read and send component source code back to client",inputs:["component:getsource"],outputs:["component:source","component:error"]},{name:"component:setsource",description:"runtime is able to compile and run custom components sent as source code strings",inputs:["component:source"],outputs:["component:component","component:error"]},{name:"protocol:runtime",description:"can expose ports of main graph and transmit packet information to/from them",inputs:["runtime:packet"],outputs:["runtime:ports","runtime:packetsent","runtime:packet","runtime:error"]},{name:"graph:readonly",description:"read and follow changes to runtime graphs (but not modify)",inputs:[],outputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup"]},{name:"protocol:graph",description:"read & modify runtime graphs using the Graph protocol.",inputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup"],outputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup","graph:error"]},{name:"protocol:trace",description:"runtime is able to record and send over flowtraces, used for retroactive debugging.",inputs:["trace:start","trace:stop","trace:clear","trace:dump"],outputs:["trace:start","trace:stop","trace:clear","trace:dump","trace:error"]}]}},capabilities:{description:"<a href='#capabilities'>capability strings</a> for things the runtime is able to do for this client.",id:"capabilities",type:"array",items:{type:"string",enums:["protocol:network","network:persist","network:status","network:data","network:control","protocol:component","component:getsource","component:setsource","protocol:runtime","protocol:graph","graph:readonly","protocol:trace"],_enumDescriptions:[{name:"protocol:network",description:"can control and introspect its running networks using the Network protocol. DEPRECATED. Instead the individual network:... capabilities should be used. Implies capabilities network:status, network:data, network:control. Does not imply capability network:persist.",inputs:["network:start","network:getstatus","network:stop","network:debug","network:edges"],outputs:["network:stopped","network:started","network:status","network:output","network:error","network:processerror","network:icon","network:connect","network:begingroup","network:data","network:endgroup","network:disconnect","network:edges"]},{name:"network:persist",description:"can *flash* a running graph setup to the runtime, making it persistent across restarts",inputs:["network:persist"],outputs:["network:persist","network:error"]},{name:"network:status",description:"can get and follow changes to network status",inputs:["network:getstatus"],outputs:["network:status","network:started","network:stopped","network:error"]},{name:"network:data",description:"can listen to data flowing through the network and processes",inputs:["network:edges"],outputs:["network:edges","network:output","network:error","network:data","network:begingroup","network:endgroup","network:connect","network:disconnect","network:icon","network:processerror","network:error"]},{name:"network:control",description:"can start and stop networks",inputs:["network:start","network:stop","network:getstatus","network:debug"],outputs:["network:started","network:stopped","network:status","network:error"]},{name:"protocol:component",description:"can list components of the runtime using the component:list message.",inputs:["component:list"],outputs:["component:component","component:componentsready","component:error"]},{name:"component:getsource",description:"read and send component source code back to client",inputs:["component:getsource"],outputs:["component:source","component:error"]},{name:"component:setsource",description:"runtime is able to compile and run custom components sent as source code strings",inputs:["component:source"],outputs:["component:component","component:error"]},{name:"protocol:runtime",description:"can expose ports of main graph and transmit packet information to/from them",inputs:["runtime:packet"],outputs:["runtime:ports","runtime:packetsent","runtime:packet","runtime:error"]},{name:"graph:readonly",description:"read and follow changes to runtime graphs (but not modify)",inputs:[],outputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup"]},{name:"protocol:graph",description:"read & modify runtime graphs using the Graph protocol.",inputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup"],outputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup","graph:error"]},{name:"protocol:trace",description:"runtime is able to record and send over flowtraces, used for retroactive debugging.",inputs:["trace:start","trace:stop","trace:clear","trace:dump"],outputs:["trace:start","trace:stop","trace:clear","trace:dump","trace:error"]}]}},graph:{description:"ID of the currently configured main graph running on the runtime, if any",type:"string",example:"service-main",id:"graph_id"},type:{description:"type of the runtime",type:"string",example:"microflo"},namespace:{description:"Library namespace of the project running on the runtime, if any. Must match that of components belonging to the (top-level) of project.",type:"string",example:"my-project-foo"},repository:{description:"Source-code repository URL of the project running on the runtime, if any",type:"string",example:"https://github.com/flowbased/fbp-protocol.git"},repositoryVersion:{description:"Unique version identifier of the source code of the project, if known. The version should be available in @repository.",type:"string",example:"0.6.3-8-g90edcfc"}}}}}]},packetsent:{id:"output/packetsent",description:"Confirmation that a packet has been sent",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["packetsent"]},payload:{required:["port","event","graph"],additionalProperties:!1,properties:{port:{description:"port name for the input port",id:"port_id",type:"string",example:"in"},event:{type:"string",enum:["connect","begingroup","data","endgroup","disconnect"],description:"packet event"},type:{type:"string",description:"The basic datatype sent",example:"array"},schema:{type:"string",format:"uri",description:"Link to JSON schema describing the format of the data",example:"https://example.net/schemas/person.json"},payload:{description:"payload for the packet. Used only with begingroup (for group names) and data packets"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},packet:{id:"output/packet",description:"Runtimes that can be used as remote subgraphs (i.e. ones that have reported supporting the protocol:runtime capability) need to be able to receive and transmit information packets at their exposed ports.\nThese packets can be send from the client to the runtimes input ports, or from runtimes output ports to the client.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["runtime"]},command:{enum:["packet"]},payload:{required:["port","event","graph"],additionalProperties:!1,properties:{port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},event:{type:"string",enum:["connect","begingroup","data","endgroup","disconnect"],description:"packet event"},type:{type:"string",description:"The basic datatype sent",example:"array"},schema:{type:"string",format:"uri",description:"Link to JSON schema describing the format of the data",example:"https://example.net/schemas/person.json"},payload:{description:"payload for the packet. Used only with begingroup (for group names) and data packets"},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}}},shared:{$schema:"http://json-schema.org/draft-04/schema#",title:"Shared",description:"Shared schema fragments",graph_id:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},node_id:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port_id:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},input_message:{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},output_message:{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},metadata_node:{id:"metadata_node",description:"structure of key-value pairs for graph node metadata",type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph entity"},y:{type:"integer",description:"Y coordinate of a graph entity"}}},metadata_edge:{id:"metadata_edge",description:"structure of key-value pairs for graph edge metadata",type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph entity"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph entity"},secure:{type:"boolean",description:"Whether graph entity data should be treated as secure"}}},metadata_group:{id:"metadata_group",description:"structure of key-value pairs for graph group metadata",type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string",description:"Longer textual description of the group"}}},port:{id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},port_definition:{id:"port_definition",type:"array",items:{type:"object",required:["id","type"],additionalProperties:!1,properties:{id:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},type:{description:"port datatype",type:"string",example:"boolean"},schema:{type:"string",format:"uri",description:"Link to JSON schema for data on this port",example:"https://example.net/schemas/person.json"},required:{description:"whether the port needs to be connected for the component to work",type:"boolean",example:!0},addressable:{type:"boolean",description:"whether the port is an ArrayPort",example:!1},description:{type:"string",description:"textual description of the port"},values:{type:"array",description:"list of values accepted for the port"},default:{description:"default value for the port"}}}},iip:{id:"iip",type:"object",required:["data"],additionalProperties:!1,properties:{data:{description:"IIP value in its actual data type",type:["object","array","string","number","integer","boolean","null"]}}},network_event:{id:"network_event",required:["id","tgt","graph"],properties:{id:{type:"string",description:"textual edge identifier, usually in form of a FBP language line"},src:{description:"source node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},tgt:{description:"target node for the edge",id:"port",type:"object",required:["node","port"],additionalProperties:!1,properties:{node:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"},port:{id:"port_id",description:"Port identifier in a component or process",type:"string",example:"in"},index:{type:["string","number"],description:"connection index, for addressable ports"}}},graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},subgraph:{type:"array",description:"Subgraph identifier for the event. An array of node IDs.",items:{id:"node_id",description:"Node identifier in a graph",type:"string",example:"Repeat"}}}},capabilities:{id:"capabilities",type:"array",items:{type:"string",enums:["protocol:network","network:persist","network:status","network:data","network:control","protocol:component","component:getsource","component:setsource","protocol:runtime","protocol:graph","graph:readonly","protocol:trace"],_enumDescriptions:[{name:"protocol:network",description:"can control and introspect its running networks using the Network protocol. DEPRECATED. Instead the individual network:... capabilities should be used. Implies capabilities network:status, network:data, network:control. Does not imply capability network:persist.",inputs:["network:start","network:getstatus","network:stop","network:debug","network:edges"],outputs:["network:stopped","network:started","network:status","network:output","network:error","network:processerror","network:icon","network:connect","network:begingroup","network:data","network:endgroup","network:disconnect","network:edges"]},{name:"network:persist",description:"can *flash* a running graph setup to the runtime, making it persistent across restarts",inputs:["network:persist"],outputs:["network:persist","network:error"]},{name:"network:status",description:"can get and follow changes to network status",inputs:["network:getstatus"],outputs:["network:status","network:started","network:stopped","network:error"]},{name:"network:data",description:"can listen to data flowing through the network and processes",inputs:["network:edges"],outputs:["network:edges","network:output","network:error","network:data","network:begingroup","network:endgroup","network:connect","network:disconnect","network:icon","network:processerror","network:error"]},{name:"network:control",description:"can start and stop networks",inputs:["network:start","network:stop","network:getstatus","network:debug"],outputs:["network:started","network:stopped","network:status","network:error"]},{name:"protocol:component",description:"can list components of the runtime using the component:list message.",inputs:["component:list"],outputs:["component:component","component:componentsready","component:error"]},{name:"component:getsource",description:"read and send component source code back to client",inputs:["component:getsource"],outputs:["component:source","component:error"]},{name:"component:setsource",description:"runtime is able to compile and run custom components sent as source code strings",inputs:["component:source"],outputs:["component:component","component:error"]},{name:"protocol:runtime",description:"can expose ports of main graph and transmit packet information to/from them",inputs:["runtime:packet"],outputs:["runtime:ports","runtime:packetsent","runtime:packet","runtime:error"]},{name:"graph:readonly",description:"read and follow changes to runtime graphs (but not modify)",inputs:[],outputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup"]},{name:"protocol:graph",description:"read & modify runtime graphs using the Graph protocol.",inputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup"],outputs:["graph:clear","graph:addnode","graph:removenode","graph:renamenode","graph:changenode","graph:addedge","graph:removeedge","graph:changeedge","graph:addinitial","graph:removeinitial","graph:addinport","graph:removeinport","graph:renameinport","graph:addoutport","graph:removeoutport","graph:renameoutport","graph:addgroup","graph:removegroup","graph:renamegroup","graph:changegroup","graph:error"]},{name:"protocol:trace",description:"runtime is able to record and send over flowtraces, used for retroactive debugging.",inputs:["trace:start","trace:stop","trace:clear","trace:dump"],outputs:["trace:start","trace:stop","trace:clear","trace:dump","trace:error"]}]}}},trace:{$schema:"http://json-schema.org/draft-04/schema#",title:"Trace protocol",description:"This protocol is utilized for triggering and transmitting [Flowtrace](https://github.com/flowbased/flowtrace)s",messages:{start:{properties:{protocol:{enum:["trace"]},command:{enum:["start"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},buffersize:{description:"Size of tracing buffer to keep. In bytes",type:"integer"}}}}},stop:{properties:{protocol:{enum:["trace"]},command:{enum:["stop"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}},clear:{properties:{protocol:{enum:["trace"]},command:{enum:["clear"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}},output:{start:{id:"output/start",description:"Tracing was started",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["start"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},buffersize:{description:"Size of tracing buffer to keep. In bytes",type:"integer"}}}}}]},stop:{id:"output/stop",description:"Tracing was stopped",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["stop"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},clear:{id:"output/clear",description:"Tracing buffer was cleared",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["clear"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},dump:{id:"output/dump",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["dump"]},payload:{required:["graph","type","flowtrace"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},type:{description:"String describing type of trace.",type:"string",enum:["flowtrace.json"]},flowtrace:{description:"A Flowtrace file of `type`",type:"string"}}}}}]},error:{id:"output/error",description:"Error response to a command on trace protocol",allOf:[{id:"message",description:"protocol message sent by a runtime",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message"},responseTo:{type:"string",description:"unique identifier of the request message is response to"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["error"]},payload:{required:["message"],properties:{message:{type:"string",description:"Error message describing what went wrong"}}}}}]}},input:{start:{id:"input/start",description:"Enable/start tracing of a network.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["start"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},buffersize:{description:"Size of tracing buffer to keep. In bytes",type:"integer"}}}}}]},stop:{description:"Stop/disable tracing of a network.",id:"input/stop",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["stop"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]},dump:{id:"input/dump",description:"Trigger dumping of the current tracing buffer, to return it back to server.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["dump"]},payload:{required:["graph","type"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"},type:{description:"Type/format of trace to output",type:"string",enum:["flowtrace.json"]}}}}}]},clear:{id:"input/clear",description:"Clear current tracing buffer.",allOf:[{id:"message",description:"protocol message sent by a client",additionalProperties:!1,required:["protocol","command","payload"],properties:{protocol:{type:"string",description:"type of protocol",example:"graph"},command:{type:"string",description:"command to be executed",example:"addnode"},payload:{type:"object",description:"content of message",properties:{secret:{type:"string",description:"access token to authorize the client. Legacy location, use toplevel secret instead"}}},secret:{type:"string",description:"access token to authorize the client"},requestId:{type:"string",description:"unique request identifier"}}},{properties:{protocol:{enum:["trace"]},command:{enum:["clear"]},payload:{required:["graph"],additionalProperties:!1,properties:{graph:{id:"graph_id",description:"Graph identifier the message targets",type:"string"}}}}}]}}}}},function(e,t,r){"use strict";var n=r(288),o=r(90),i=r(50),a=r(129),s=r(290);function c(e,t,r){var n=this._refs[r];if("string"==typeof n){if(!this._refs[n])return c.call(this,e,t,n);n=this._refs[n]}if((n=n||this._schemas[r])instanceof a)return f(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var o,i,s,p=u.call(this,t,r);return p&&(o=p.schema,t=p.root,s=p.baseId),o instanceof a?i=o.validate||e.call(this,o.schema,t,void 0,s):void 0!==o&&(i=f(o,this._opts.inlineRefs)?o:e.call(this,o,t,void 0,s)),i}function u(e,t){var r=n.parse(t),o=g(r),i=m(this._getId(e.schema));if(0===Object.keys(e.schema).length||o!==i){var s=v(o),c=this._refs[s];if("string"==typeof c)return p.call(this,e,c,r);if(c instanceof a)c.validate||this._compile(c),e=c;else{if(!((c=this._schemas[s])instanceof a))return;if(c.validate||this._compile(c),s==v(t))return{schema:c,root:e,baseId:i};e=c}if(!e.schema)return;i=m(this._getId(e.schema))}return d.call(this,r,i,e.schema,e)}function p(e,t,r){var n=u.call(this,e,t);if(n){var o=n.schema,i=n.baseId;e=n.root;var a=this._getId(o);return a&&(i=b(i,a)),d.call(this,r,i,o,e)}}e.exports=c,c.normalizeId=v,c.fullPath=m,c.url=b,c.ids=function(e){var t=v(this._getId(e)),r={"":t},a={"":m(t,!1)},c={},u=this;return s(e,{allKeys:!0},(function(e,t,s,p,l,d,h){if(""!==t){var f=u._getId(e),m=r[p],g=a[p]+"/"+l;if(void 0!==h&&(g+="/"+("number"==typeof h?h:i.escapeFragment(h))),"string"==typeof f){f=m=v(m?n.resolve(m,f):f);var y=u._refs[f];if("string"==typeof y&&(y=u._refs[y]),y&&y.schema){if(!o(e,y.schema))throw new Error('id "'+f+'" resolves to more than one schema')}else if(f!=v(g))if("#"==f[0]){if(c[f]&&!o(e,c[f]))throw new Error('id "'+f+'" resolves to more than one schema');c[f]=e}else u._refs[f]=g}r[t]=m,a[t]=g}})),c},c.inlineRef=f,c.schema=u;var l=i.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function d(e,t,r,n){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var o=e.fragment.split("/"),a=1;a<o.length;a++){var s=o[a];if(s){if(void 0===(r=r[s=i.unescapeFragment(s)]))break;var c;if(!l[s]&&((c=this._getId(r))&&(t=b(t,c)),r.$ref)){var p=b(t,r.$ref),d=u.call(this,n,p);d&&(r=d.schema,n=d.root,t=d.baseId)}}}return void 0!==r&&r!==n.schema?{schema:r,root:n,baseId:t}:void 0}}var h=i.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function f(e,t){return!1!==t&&(void 0===t||!0===t?function e(t){var r;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if("object"==typeof(r=t[n])&&!e(r))return!1}else for(var o in t){if("$ref"==o)return!1;if("object"==typeof(r=t[o])&&!e(r))return!1}return!0}(e):t?function e(t){var r,n=0;if(Array.isArray(t)){for(var o=0;o<t.length;o++)if("object"==typeof(r=t[o])&&(n+=e(r)),n==1/0)return 1/0}else for(var i in t){if("$ref"==i)return 1/0;if(h[i])n++;else if("object"==typeof(r=t[i])&&(n+=e(r)+1),n==1/0)return 1/0}return n}(e)<=t:void 0)}function m(e,t){return!1!==t&&(e=v(e)),g(n.parse(e))}function g(e){return n.serialize(e).split("#")[0]+"#"}var y=/#\/?$/;function v(e){return e?e.replace(y,""):""}function b(e,t){return t=v(t),n.resolve(e,t)}},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var a=i[o];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";var n=r(89);function o(e,t,r){this.message=r||o.message(e,t),this.missingRef=n.url(e,t),this.missingSchema=n.normalizeId(n.fullPath(this.missingRef))}function i(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:i((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:i(o)},o.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,r){(function(t,r,n){var o;o=function(){var e,o,i;return function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var c="function"==typeof _dereq_&&_dereq_;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=r[a]={exports:{}};t[a][0].call(p.exports,(function(e){var r=t[a][1][e];return o(r||e)}),p,p.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof _dereq_&&_dereq_,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){"use strict";t.exports=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}e.any=function(e){return r(e)},e.prototype.any=function(){return r(this)}}},{}],2:[function(e,r,n){"use strict";var o;try{throw new Error}catch(e){o=e}var i=e("./schedule"),a=e("./queue");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new a(16),this._normalQueue=new a(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=i}function c(e){for(;e.length()>0;)u(e)}function u(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var r=e.shift(),n=e.shift();t.call(r,n)}}s.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(e,r){r?(t.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),t.exit(2)):this.throwLater(e)},s.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.prototype.invokeLater=function(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()},s.prototype.invoke=function(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()},s.prototype.settlePromises=function(e){this._normalQueue._pushOne(e),this._queueTick()},s.prototype._drainQueues=function(){c(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,c(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},r.exports=s,r.exports.firstLineError=o},{"./queue":26,"./schedule":29}],3:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){var o=!1,i=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},s=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},c=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var u=r(i),p=new e(t);p._propagateFrom(this,1);var l=this._target();if(p._setBoundTo(u),u instanceof e){var d={promiseRejectionQueued:!1,promise:p,target:l,bindingPromise:u};l._then(t,a,void 0,p,d),u._then(s,c,void 0,p,d),p._setOnCancel(u)}else p._resolveCallback(l);return p},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,r){return e.resolve(r).bind(t)}}},{}],4:[function(e,t,r){"use strict";var n;"undefined"!=typeof Promise&&(n=Promise);var o=e("./promise")();o.noConflict=function(){try{Promise===o&&(Promise=n)}catch(e){}return o},t.exports=o},{"./promise":22}],5:[function(e,t,r){"use strict";var n=Object.create;if(n){var o=n(null),i=n(null);o[" size"]=i[" size"]=0}t.exports=function(t){var r=e("./util"),n=r.canEvaluate;function o(e){return function(e,n){var o;if(null!=e&&(o=e[n]),"function"!=typeof o){var i="Object "+r.classString(e)+" has no method '"+r.toString(n)+"'";throw new t.TypeError(i)}return o}(e,this.pop()).apply(e,this)}function i(e){return e[this]}function a(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}r.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(o,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=a;else if(n){var r=(void 0)(e);t=null!==r?r:i}else t=i;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,r){"use strict";t.exports=function(t,r,n,o){var i=e("./util"),a=i.tryCatch,s=i.errorObj,c=t._async;t.prototype.break=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null==r||!r._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=a(e).call(this._boundValue());n===s&&(this._attachExtraTrace(n.e),c.throwLater(n.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util"),n=e("./es5").keys,o=r.tryCatch,i=r.errorObj;return function(e,a,s){return function(c){var u=s._boundValue();e:for(var p=0;p<e.length;++p){var l=e[p];if(l===Error||null!=l&&l.prototype instanceof Error){if(c instanceof l)return o(a).call(u,c)}else if("function"==typeof l){var d=o(l).call(u,c);if(d===i)return d;if(d)return o(a).call(u,c)}else if(r.isObject(c)){for(var h=n(l),f=0;f<h.length;++f){var m=h[f];if(l[m]!=c[m])continue e}return o(a).call(u,c)}}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t,r){"use strict";t.exports=function(e){var t=!1,r=[];function n(){this._trace=new n.CapturedTrace(o())}function o(){var e=r.length-1;if(e>=0)return r[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},n.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},n.CapturedTrace=null,n.create=function(){if(t)return new n},n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var r=e.prototype._pushContext,i=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,c=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=r,e.prototype._popContext=i,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=c,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=o,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},n}},{}],9:[function(e,r,n){"use strict";r.exports=function(r,n,o,i){var a,s,c,u,p=r._async,l=e("./errors").Warning,d=e("./util"),h=e("./es5"),f=d.canAttachTrace,m=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,g=/\((?:timers\.js):\d+:\d+\)/,y=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,v=null,b=null,w=!1,x=!(0==d.env("BLUEBIRD_DEBUG")),E=!(0==d.env("BLUEBIRD_WARNINGS")||!x&&!d.env("BLUEBIRD_WARNINGS")),k=!(0==d.env("BLUEBIRD_LONG_STACK_TRACES")||!x&&!d.env("BLUEBIRD_LONG_STACK_TRACES")),_=0!=d.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(E||!!d.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var e=[];function t(){for(var t=0;t<e.length;++t)e[t]._notifyUnhandledRejection();n()}function n(){e.length=0}u=function(r){e.push(r),setTimeout(t,1)},h.defineProperty(r,"_unhandledRejectionCheck",{value:t}),h.defineProperty(r,"_unhandledRejectionClear",{value:n})}(),r.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},r.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),u(this))},r.prototype._notifyUnhandledRejectionIsHandled=function(){V("rejectionHandled",a,void 0,this)},r.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},r.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},r.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),V("unhandledRejection",s,e,this)}},r.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},r.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},r.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},r.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},r.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},r.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},r.prototype._warn=function(e,t,r){return G(e,t,r||this)},r.onPossiblyUnhandledRejection=function(e){var t=r._getContext();s=d.contextBind(t,e)},r.onUnhandledRejectionHandled=function(e){var t=r._getContext();a=d.contextBind(t,e)};var S=function(){};r.longStackTraces=function(){if(p.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!re.longStackTraces&&W()){var e=r.prototype._captureStackTrace,t=r.prototype._attachExtraTrace,o=r.prototype._dereferenceTrace;re.longStackTraces=!0,S=function(){if(p.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");r.prototype._captureStackTrace=e,r.prototype._attachExtraTrace=t,r.prototype._dereferenceTrace=o,n.deactivateLongStackTraces(),re.longStackTraces=!1},r.prototype._captureStackTrace=U,r.prototype._attachExtraTrace=$,r.prototype._dereferenceTrace=z,n.activateLongStackTraces()}},r.hasLongStackTraces=function(){return re.longStackTraces&&W()};var C={unhandledrejection:{before:function(){var e=d.global.onunhandledrejection;return d.global.onunhandledrejection=null,e},after:function(e){d.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=d.global.onrejectionhandled;return d.global.onrejectionhandled=null,e},after:function(e){d.global.onrejectionhandled=e}}},P=function(){var e=function(e,t){if(!e)return!d.global.dispatchEvent(t);var r;try{return r=e.before(),!d.global.dispatchEvent(t)}finally{e.after(r)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new CustomEvent(t,{detail:r,cancelable:!0});return h.defineProperty(n,"promise",{value:r.promise}),h.defineProperty(n,"reason",{value:r.reason}),e(C[t],n)}}return"function"==typeof Event?(t=new Event("CustomEvent"),d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new Event(t,{cancelable:!0});return n.detail=r,h.defineProperty(n,"promise",{value:r.promise}),h.defineProperty(n,"reason",{value:r.reason}),e(C[t],n)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!0,r),e(C[t],n)})}catch(e){}return function(){return!1}}(),D=d.isNode?function(){return t.emit.apply(t,arguments)}:d.global?function(e){var t="on"+e.toLowerCase(),r=d.global[t];return!!r&&(r.apply(d.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function A(e,t){return{promise:t}}var O={promiseCreated:A,promiseFulfilled:A,promiseRejected:A,promiseResolved:A,promiseCancelled:A,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:A},j=function(e){var t=!1;try{t=D.apply(null,arguments)}catch(e){p.throwLater(e),t=!0}var r=!1;try{r=P(e,O[e].apply(null,arguments))}catch(e){p.throwLater(e),r=!0}return r||t};function T(){return!1}function F(e,t,r){var n=this;try{e(t,r,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+d.toString(e));n._attachCancellationCallback(e)}))}catch(e){return e}}function I(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?d.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function N(){return this._onCancelField}function R(e){this._onCancelField=e}function B(){this._cancellationParent=void 0,this._onCancelField=void 0}function L(e,t){if(0!=(1&t)){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}r.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?r.longStackTraces():!e.longStackTraces&&r.hasLongStackTraces()&&S()),"warnings"in e){var t=e.warnings;re.warnings=!!t,_=re.warnings,d.isObject(t)&&"wForgottenReturn"in t&&(_=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!re.cancellation){if(p.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");r.prototype._clearCancellationData=B,r.prototype._propagateFrom=L,r.prototype._onCancel=N,r.prototype._setOnCancel=R,r.prototype._attachCancellationCallback=I,r.prototype._execute=F,M=L,re.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!re.monitoring?(re.monitoring=!0,r.prototype._fireEvent=j):!e.monitoring&&re.monitoring&&(re.monitoring=!1,r.prototype._fireEvent=T)),"asyncHooks"in e&&d.nodeSupportsAsyncResource){var n=re.asyncHooks,a=!!e.asyncHooks;n!==a&&(re.asyncHooks=a,a?o():i())}return r},r.prototype._fireEvent=T,r.prototype._execute=function(e,t,r){try{e(t,r)}catch(e){return e}},r.prototype._onCancel=function(){},r.prototype._setOnCancel=function(e){},r.prototype._attachCancellationCallback=function(e){},r.prototype._captureStackTrace=function(){},r.prototype._attachExtraTrace=function(){},r.prototype._dereferenceTrace=function(){},r.prototype._clearCancellationData=function(){},r.prototype._propagateFrom=function(e,t){};var M=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function q(){var e=this._boundTo;return void 0!==e&&e instanceof r?e.isFulfilled()?e.value():void 0:e}function U(){this._trace=new ee(this._peekContext())}function $(e,t){if(f(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=J(e);d.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),d.notEnumerableProp(e,"__stackCleaned__",!0)}}}function z(){this._trace=void 0}function G(e,t,n){if(re.warnings){var o,i=new l(e);if(t)n._attachExtraTrace(i);else if(re.longStackTraces&&(o=r._peekContext()))o.attachExtraTrace(i);else{var a=J(i);i.stack=a.message+"\n"+a.stack.join("\n")}j("warning",i)||X(i,"",!0)}}function H(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],o="    (No stack trace)"===n||v.test(n),i=o&&Q(n);o&&!i&&(w&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function J(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var n=t[r];if("    (No stack trace)"===n||v.test(n))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:H(t)}}function X(e,t,r){if("undefined"!=typeof console){var n;if(d.isObject(e)){var o=e.stack;n=t+b(o,e)}else n=t+String(e);"function"==typeof c?c(n,r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}}function V(e,t,r,n){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(n):t(r,n))}catch(e){p.throwLater(e)}"unhandledRejection"===e?j(e,r,n)||o||X(r,"Unhandled rejection "):j(e,n)}function K(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():d.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+function(e){return e.length<41?e:e.substr(0,38)+"..."}(t)+">, no stack trace)"}function W(){return"function"==typeof te}var Q=function(){return!1},Y=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function Z(e){var t=e.match(Y);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function ee(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);te(this,ee),t>32&&this.uncycle()}d.inherits(ee,Error),n.CapturedTrace=ee,ee.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],r={},n=0,o=this;void 0!==o;++n)t.push(o),o=o._parent;for(n=(e=this._length=n)-1;n>=0;--n){var i=t[n].stack;void 0===r[i]&&(r[i]=n)}for(n=0;n<e;++n){var a=r[t[n].stack];if(void 0!==a&&a!==n){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var s=n>0?t[n-1]:this;a<e-1?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var c=s._length+1,u=n-2;u>=0;--u)t[u]._length=c,c++;return}}}},ee.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=J(e),r=t.message,n=[t.stack],o=this;void 0!==o;)n.push(H(o.stack.split("\n"))),o=o._parent;!function(e){for(var t=e[0],r=1;r<e.length;++r){for(var n=e[r],o=t.length-1,i=t[o],a=-1,s=n.length-1;s>=0;--s)if(n[s]===i){a=s;break}for(s=a;s>=0;--s){var c=n[s];if(t[o]!==c)break;t.pop(),o--}t=n}}(n),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(n),d.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,n)),d.notEnumerableProp(e,"__stackCleaned__",!0)}};var te=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():K(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,v=e,b=t;var r=Error.captureStackTrace;return Q=function(e){return m.test(e)},function(e,t){Error.stackTraceLimit+=6,r(e,t),Error.stackTraceLimit-=6}}var n,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return v=/@/,b=t,w=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){n="stack"in e}return!("stack"in o)&&n&&"number"==typeof Error.stackTraceLimit?(v=e,b=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6}):(b=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?K(t):t.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(c=function(e){console.warn(e)},d.isNode&&t.stderr.isTTY?c=function(e,t){var r=t?"[33m":"[31m";console.warn(r+e+"[0m\n")}:d.isNode||"string"!=typeof(new Error).stack||(c=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var re={warnings:E,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return k&&r.longStackTraces(),{asyncHooks:function(){return re.asyncHooks},longStackTraces:function(){return re.longStackTraces},warnings:function(){return re.warnings},cancellation:function(){return re.cancellation},monitoring:function(){return re.monitoring},propagateFromFunction:function(){return M},boundValueFunction:function(){return q},checkForgottenReturns:function(e,t,r,n,o){if(void 0===e&&null!==t&&_){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&n._bitField))return;r&&(r+=" ");var i="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),c=H(s),u=c.length-1;u>=0;--u){var p=c[u];if(!g.test(p)){var l=p.match(y);l&&(i="at "+l[1]+":"+l[2]+":"+l[3]+" ");break}}if(c.length>0){var d=c[0];for(u=0;u<s.length;++u)if(s[u]===d){u>0&&(a="\n"+s[u-1]);break}}}var h="a promise was created in a "+r+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+a;n._warn(h,!0,t)}},setBounds:function(e,t){if(W()){for(var r,n,o=(e.stack||"").split("\n"),i=(t.stack||"").split("\n"),a=-1,s=-1,c=0;c<o.length;++c)if(u=Z(o[c])){r=u.fileName,a=u.line;break}for(c=0;c<i.length;++c){var u;if(u=Z(i[c])){n=u.fileName,s=u.line;break}}a<0||s<0||!r||!n||r!==n||a>=s||(Q=function(e){if(m.test(e))return!0;var t=Z(e);return!!(t&&t.fileName===r&&a<=t.line&&t.line<=s)})}},warn:G,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),G(r)},CapturedTrace:ee,fireDomEvent:P,fireGlobalEvent:D}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,t,r){"use strict";t.exports=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1],n=function(){throw t};return this.caught(e,n)},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var n=arguments[1];n instanceof e&&n.suppressUnhandledRejections();var o=function(){return n};return this.caught(r,o)}}},{}],11:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.reduce,n=e.all;function o(){return n(this)}e.prototype.each=function(e){return r(this,e,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,n){return r(e,n,t,0)._then(o,void 0,void 0,e,void 0)},e.mapSeries=function(e,n){return r(e,n,t,t)}}},{}],12:[function(e,t,r){"use strict";var n,o,i=e("./es5"),a=i.freeze,s=e("./util"),c=s.inherits,u=s.notEnumerableProp;function p(e,t){function r(n){if(!(this instanceof r))return new r(n);u(this,"message","string"==typeof n?n:t),u(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return c(r,Error),r}var l=p("Warning","warning"),d=p("CancellationError","cancellation error"),h=p("TimeoutError","timeout error"),f=p("AggregateError","aggregate error");try{n=TypeError,o=RangeError}catch(e){n=p("TypeError","type error"),o=p("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(f.prototype[m[g]]=Array.prototype[m[g]]);i.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var y=0;function v(e){if(!(this instanceof v))return new v(e);u(this,"name","OperationalError"),u(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(u(this,"message",e.message),u(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}f.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",o=n.split("\n"),i=0;i<o.length;++i)o[i]=e+o[i];t+=(n=o.join("\n"))+"\n"}return y--,t},c(v,Error);var b=Error.__BluebirdErrorTypes__;b||(b=a({CancellationError:d,TimeoutError:h,OperationalError:v,RejectionError:v,AggregateError:f}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:n,RangeError:o,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:l}},{"./es5":13,"./util":36}],13:[function(e,t,r){var n=function(){"use strict";return void 0===this}();if(n)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!(r&&!r.writable&&!r.set)}};else{var o={}.hasOwnProperty,i={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var r in e)o.call(e,r)&&t.push(r);return t};t.exports={isArray:function(e){try{return"[object Array]"===i.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return a}},isES5:n,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.map;e.prototype.filter=function(e,n){return r(this,e,n,t)},e.filter=function(e,n,o){return r(e,n,o,t)}}},{}],15:[function(e,t,r){"use strict";t.exports=function(t,r,n){var o=e("./util"),i=t.CancellationError,a=o.errorObj,s=e("./catch_filter")(n);function c(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function u(e){this.finallyHandler=e}function p(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function l(){return h.call(this,this.promise._target()._settledValue())}function d(e){if(!p(this,e))return a.e=e,a}function h(e){var o=this.promise,s=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?s.call(o._boundValue()):s.call(o._boundValue(),e);if(c===n)return c;if(void 0!==c){o._setReturnedNonUndefined();var h=r(c,o);if(h instanceof t){if(null!=this.cancelPromise){if(h._isCancelled()){var f=new i("late cancellation observer");return o._attachExtraTrace(f),a.e=f,a}h.isPending()&&h._attachCancellationCallback(new u(this))}return h._then(l,d,void 0,this,void 0)}}}return o.isRejected()?(p(this),a.e=e,a):(p(this),e)}return c.prototype.isFinallyHandler=function(){return 0===this.type},u.prototype._resultCancelled=function(){p(this.finallyHandler)},t.prototype._passThrough=function(e,t,r,n){return"function"!=typeof e?this.then():this._then(r,n,void 0,new c(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,h,h)},t.prototype.tap=function(e){return this._passThrough(e,1,h)},t.prototype.tapCatch=function(e){var r=arguments.length;if(1===r)return this._passThrough(e,1,void 0,h);var n,i=new Array(r-1),a=0;for(n=0;n<r-1;++n){var c=arguments[n];if(!o.isObject(c))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(c)));i[a++]=c}i.length=a;var u=arguments[n];return this._passThrough(s(i,u,this),1,void 0,h)},c}},{"./catch_filter":7,"./util":36}],16:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i,a){var s=e("./errors").TypeError,c=e("./util"),u=c.errorObj,p=c.tryCatch,l=[];function d(e,r,o,i){if(a.cancellation()){var s=new t(n),c=this._finallyPromise=new t(n);this._promise=s.lastly((function(){return c})),s._captureStackTrace(),s._setOnCancel(this)}else(this._promise=new t(n))._captureStackTrace();this._stack=i,this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(l):l,this._yieldedPromise=null,this._cancellationPhase=!1}c.inherits(d,i),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=p(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),e=p(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},d.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=p(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=p(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(e){var r=this._promise;if(e===u)return this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(e.e,!1);var n=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(n);var i=o(n,this._promise);if(i instanceof t||null!==(i=function(e,r,n){for(var i=0;i<r.length;++i){n._pushContext();var a=p(r[i])(e);if(n._popContext(),a===u){n._pushContext();var s=t.reject(u.e);return n._popContext(),s}var c=o(a,n);if(c instanceof t)return c}return null}(i,this._yieldHandlers,this._promise))){var a=(i=i._target())._bitField;0==(50397184&a)?(this._yieldedPromise=i,i._proxy(this,null)):0!=(33554432&a)?t._async.invoke(this._promiseFulfilled,this,i._value()):0!=(16777216&a)?t._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled()}else this._promiseRejected(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,n=d,o=(new Error).stack;return function(){var t=e.apply(this,arguments),i=new n(void 0,void 0,r,o),a=i.promise();return i._generator=t,i._promiseFulfilled(void 0),a}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new s("expecting a function but got "+c.classString(e));l.push(e)},t.spawn=function(e){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return r("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new d(e,this),o=n.promise();return n._run(t.spawn),o}}},{"./errors":12,"./util":36}],17:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i){var a=e("./util");a.canEvaluate,a.tryCatch,a.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var n=[].slice.call(arguments);e&&n.pop();var o=new r(n).promise();return void 0!==e?o.spread(e):o}}},{"./util":36}],18:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i,a){var s=e("./util"),c=s.tryCatch,u=s.errorObj,p=t._async;function l(e,r,n,o){this.constructor$(e),this._promise._captureStackTrace();var a=t._getContext();if(this._callback=s.contextBind(a,r),this._preservedValues=o===i?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0),s.isArray(e))for(var c=0;c<e.length;++c){var u=e[c];u instanceof t&&u.suppressUnhandledRejections()}}function d(e,r,o,i){if("function"!=typeof r)return n("expecting a function but got "+s.classString(r));var a=0;if(void 0!==o){if("object"!=typeof o||null===o)return t.reject(new TypeError("options argument must be an object but it is "+s.classString(o)));if("number"!=typeof o.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+s.classString(o.concurrency)));a=o.concurrency}return new l(e,r,a="number"==typeof a&&isFinite(a)&&a>=1?a:0,i).promise()}s.inherits(l,r),l.prototype._asyncInit=function(){this._init$(void 0,-2)},l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,r){var n=this._values,i=this.length(),s=this._preservedValues,p=this._limit;if(r<0){if(n[r=-1*r-1]=e,p>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(p>=1&&this._inFlight>=p)return n[r]=e,this._queue.push(r),!1;null!==s&&(s[r]=e);var l=this._promise,d=this._callback,h=l._boundValue();l._pushContext();var f=c(d).call(h,e,r,i),m=l._popContext();if(a.checkForgottenReturns(f,m,null!==s?"Promise.filter":"Promise.map",l),f===u)return this._reject(f.e),!0;var g=o(f,this._promise);if(g instanceof t){var y=(g=g._target())._bitField;if(0==(50397184&y))return p>=1&&this._inFlight++,n[r]=g,g._proxy(this,-1*(r+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(g._reason()),!0):(this._cancel(),!0);f=g._value()}n[r]=f}return++this._totalResolved>=i&&(null!==s?this._filter(n,s):this._resolve(n),!0)},l.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(r[n],n)}},l.prototype._filter=function(e,t){for(var r=t.length,n=new Array(r),o=0,i=0;i<r;++i)e[i]&&(n[o++]=t[i]);n.length=o,this._resolve(n)},l.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return d(this,e,t,null)},t.map=function(e,t,r,n){return d(e,t,r,n)}}},{"./util":36}],19:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var n=new t(r);n._captureStackTrace(),n._pushContext();var o=s(e).apply(this,arguments),a=n._popContext();return i.checkForgottenReturns(o,a,"Promise.method",n),n._resolveFromSyncValue(o),n}},t.attempt=t.try=function(e){if("function"!=typeof e)return o("expecting a function but got "+a.classString(e));var n,c=new t(r);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],p=arguments[2];n=a.isArray(u)?s(e).apply(p,u):s(e).call(p,u)}else n=s(e)();var l=c._popContext();return i.checkForgottenReturns(n,l,"Promise.try",c),c._resolveFromSyncValue(n),c},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,r){"use strict";var n=e("./util"),o=n.maybeWrapAsError,i=e("./errors").OperationalError,a=e("./es5"),s=/^(?:name|message|stack|cause)$/;function c(e){var t;if(function(e){return e instanceof Error&&a.getPrototypeOf(e)===Error.prototype}(e)){(t=new i(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var r=a.keys(e),o=0;o<r.length;++o){var c=r[o];s.test(c)||(t[c]=e[c])}return t}return n.markAsOriginatingFromRejection(e),e}t.exports=function(e,t){return function(r,n){if(null!==e){if(r){var i=c(o(r));e._attachExtraTrace(i),e._reject(i)}else if(t){var a=[].slice.call(arguments,1);e._fulfill(a)}else e._fulfill(n);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util"),n=t._async,o=r.tryCatch,i=r.errorObj;function a(e,t){if(!r.isArray(e))return s.call(this,e,t);var a=o(t).apply(this._boundValue(),[null].concat(e));a===i&&n.throwLater(a.e)}function s(e,t){var r=this._boundValue(),a=void 0===e?o(t).call(r,null):o(t).call(r,null,e);a===i&&n.throwLater(a.e)}function c(e,t){if(!e){var r=new Error(e+"");r.cause=e,e=r}var a=o(t).call(this._boundValue(),e);a===i&&n.throwLater(a.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var r=s;void 0!==t&&Object(t).spread&&(r=a),this._then(r,c,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,r,n){"use strict";r.exports=function(){var n=function(){return new v("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},o=function(){return new F.PromiseInspection(this._target())},i=function(e){return F.reject(new v(e))};function a(){}var s={},c=e("./util");c.setReflectHandler(o);var u=function(){var e=t.domain;return void 0===e?null:e},p=function(){return{domain:u(),async:null}},l=c.isNode&&c.nodeSupportsAsyncResource?e("async_hooks").AsyncResource:null,d=function(){return{domain:u(),async:new l("Bluebird::Promise")}},h=c.isNode?p:function(){return null};c.notEnumerableProp(F,"_getContext",h);var f=e("./es5"),m=e("./async"),g=new m;f.defineProperty(F,"_async",{value:g});var y=e("./errors"),v=F.TypeError=y.TypeError;F.RangeError=y.RangeError;var b=F.CancellationError=y.CancellationError;F.TimeoutError=y.TimeoutError,F.OperationalError=y.OperationalError,F.RejectionError=y.OperationalError,F.AggregateError=y.AggregateError;var w=function(){},x={},E={},k=e("./thenables")(F,w),_=e("./promise_array")(F,w,k,i,a),S=e("./context")(F),C=S.create,P=e("./debuggability")(F,S,(function(){h=d,c.notEnumerableProp(F,"_getContext",d)}),(function(){h=p,c.notEnumerableProp(F,"_getContext",p)})),D=(P.CapturedTrace,e("./finally")(F,k,E)),A=e("./catch_filter")(E),O=e("./nodeback"),j=c.errorObj,T=c.tryCatch;function F(e){e!==w&&function(e,t){if(null==e||e.constructor!==F)throw new v("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new v("expecting a function but got "+c.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function I(e){this.promise._resolveCallback(e)}function N(e){this.promise._rejectCallback(e,!1)}function R(e){var t=new F(w);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return F.prototype.toString=function(){return"[object Promise]"},F.prototype.caught=F.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,n=new Array(t-1),o=0;for(r=0;r<t-1;++r){var a=arguments[r];if(!c.isObject(a))return i("Catch statement predicate: expecting an object but got "+c.classString(a));n[o++]=a}if(n.length=o,"function"!=typeof(e=arguments[r]))throw new v("The last argument to .catch() must be a function, got "+c.toString(e));return this.then(void 0,A(n,e,this))}return this.then(void 0,e)},F.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},F.prototype.then=function(e,t){if(P.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+c.classString(e);arguments.length>1&&(r+=", "+c.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},F.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},F.prototype.spread=function(e){return"function"!=typeof e?i("expecting a function but got "+c.classString(e)):this.all()._then(e,void 0,void 0,x,void 0)},F.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},F.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new _(this).promise()},F.prototype.error=function(e){return this.caught(c.originatesFromRejection,e)},F.getNewLibraryCopy=r.exports,F.is=function(e){return e instanceof F},F.fromNode=F.fromCallback=function(e){var t=new F(w);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=T(e)(O(t,r));return n===j&&t._rejectCallback(n.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},F.all=function(e){return new _(e).promise()},F.cast=function(e){var t=k(e);return t instanceof F||((t=new F(w))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},F.resolve=F.fulfilled=F.cast,F.reject=F.rejected=function(e){var t=new F(w);return t._captureStackTrace(),t._rejectCallback(e,!0),t},F.setScheduler=function(e){if("function"!=typeof e)throw new v("expecting a function but got "+c.classString(e));return g.setScheduler(e)},F.prototype._then=function(e,t,r,n,o){var i=void 0!==o,a=i?o:new F(w),s=this._target(),u=s._bitField;i||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&u)?this._boundValue():s===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var p=h();if(0!=(50397184&u)){var l,d,f=s._settlePromiseCtx;0!=(33554432&u)?(d=s._rejectionHandler0,l=e):0!=(16777216&u)?(d=s._fulfillmentHandler0,l=t,s._unsetRejectionIsUnhandled()):(f=s._settlePromiseLateCancellationObserver,d=new b("late cancellation observer"),s._attachExtraTrace(d),l=t),g.invoke(f,s,{handler:c.contextBind(p,l),promise:a,receiver:n,value:d})}else s._addCallbacks(e,t,a,n,p);return a},F.prototype._length=function(){return 65535&this._bitField},F.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},F.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},F.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},F.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},F.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},F.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},F.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},F.prototype._isFinal=function(){return(4194304&this._bitField)>0},F.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},F.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},F.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},F.prototype._setAsyncGuaranteed=function(){if(!g.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},F.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},F.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==s)return void 0===t&&this._isBound()?this._boundValue():t},F.prototype._promiseAt=function(e){return this[4*e-4+2]},F.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},F.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},F.prototype._boundValue=function(){},F.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,r=e._rejectionHandler0,n=e._promise0,o=e._receiverAt(0);void 0===o&&(o=s),this._addCallbacks(t,r,n,o,null)},F.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=s),this._addCallbacks(r,n,o,i,null)},F.prototype._addCallbacks=function(e,t,r,n,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=r,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=c.contextBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=c.contextBind(o,t));else{var a=4*i-4;this[a+2]=r,this[a+3]=n,"function"==typeof e&&(this[a+0]=c.contextBind(o,e)),"function"==typeof t&&(this[a+1]=c.contextBind(o,t))}return this._setLength(i+1),i},F.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},F.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(n(),!1);var r=k(e,this);if(!(r instanceof F))return this._fulfill(e);t&&this._propagateFrom(r,2);var o=r._target();if(o!==this){var i=o._bitField;if(0==(50397184&i)){var a=this._length();a>0&&o._migrateCallback0(this);for(var s=1;s<a;++s)o._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&i))this._fulfill(o._value());else if(0!=(16777216&i))this._reject(o._reason());else{var c=new b("late cancellation observer");o._attachExtraTrace(c),this._reject(c)}}else this._reject(n())}},F.prototype._rejectCallback=function(e,t,r){var n=c.ensureErrorObject(e),o=n===e;if(!o&&!r&&P.warnings()){var i="a promise was rejected with a non-error: "+c.classString(e);this._warn(i,!0)}this._attachExtraTrace(n,!!t&&o),this._reject(e)},F.prototype._resolveFromExecutor=function(e){if(e!==w){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,n=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,r)}));r=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)}},F.prototype._settlePromiseFromHandler=function(e,t,r,n){var o=n._bitField;if(0==(65536&o)){var i;n._pushContext(),t===x?r&&"number"==typeof r.length?i=T(e).apply(this._boundValue(),r):(i=j).e=new v("cannot .spread() a non-array: "+c.classString(r)):i=T(e).call(t,r);var a=n._popContext();0==(65536&(o=n._bitField))&&(i===E?n._reject(r):i===j?n._rejectCallback(i.e,!1):(P.checkForgottenReturns(i,a,"",n,this),n._resolveCallback(i)))}},F.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},F.prototype._followee=function(){return this._rejectionHandler0},F.prototype._setFollowee=function(e){this._rejectionHandler0=e},F.prototype._settlePromise=function(e,t,r,n){var i=e instanceof F,s=this._bitField,c=0!=(134217728&s);0!=(65536&s)?(i&&e._invokeInternalOnCancel(),r instanceof D&&r.isFinallyHandler()?(r.cancelPromise=e,T(t).call(r,n)===j&&e._reject(j.e)):t===o?e._fulfill(o.call(r)):r instanceof a?r._promiseCancelled(e):i||e instanceof _?e._cancel():r.cancel()):"function"==typeof t?i?(c&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,n,e)):t.call(r,n,e):r instanceof a?r._isResolved()||(0!=(33554432&s)?r._promiseFulfilled(n,e):r._promiseRejected(n,e)):i&&(c&&e._setAsyncGuaranteed(),0!=(33554432&s)?e._fulfill(n):e._reject(n))},F.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,n=e.receiver,o=e.value;"function"==typeof t?r instanceof F?this._settlePromiseFromHandler(t,n,o,r):t.call(n,o,r):r instanceof F&&r._reject(o)},F.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},F.prototype._settlePromise0=function(e,t,r){var n=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,o,t)},F.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},F.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!=(134217728&t)?this._settlePromises():g.settlePromises(this),this._dereferenceTrace())}},F.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return g.fatalError(e,c.isNode);(65535&t)>0?g.settlePromises(this):this._ensurePossibleRejectionHandled()}},F.prototype._fulfillPromises=function(e,t){for(var r=1;r<e;r++){var n=this._fulfillmentHandlerAt(r),o=this._promiseAt(r),i=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(o,n,i,t)}},F.prototype._rejectPromises=function(e,t){for(var r=1;r<e;r++){var n=this._rejectionHandlerAt(r),o=this._promiseAt(r),i=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(o,n,i,t)}},F.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},F.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&f.defineProperty(F.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),F.defer=F.pending=function(){return P.deprecated("Promise.defer","new Promise"),{promise:new F(w),resolve:I,reject:N}},c.notEnumerableProp(F,"_makeSelfResolutionError",n),e("./method")(F,w,k,i,P),e("./bind")(F,w,k,P),e("./cancel")(F,_,i,P),e("./direct_resolve")(F),e("./synchronous_inspection")(F),e("./join")(F,_,k,w,g),F.Promise=F,F.version="3.7.2",e("./call_get.js")(F),e("./generators.js")(F,i,w,k,a,P),e("./map.js")(F,_,i,k,w,P),e("./nodeify.js")(F),e("./promisify.js")(F,w),e("./props.js")(F,_,k,i),e("./race.js")(F,w,k,i),e("./reduce.js")(F,_,i,k,w,P),e("./settle.js")(F,_,P),e("./some.js")(F,_,i),e("./timers.js")(F,w,P),e("./using.js")(F,i,k,C,w,P),e("./any.js")(F),e("./each.js")(F,w),e("./filter.js")(F,w),c.toFastProperties(F),c.toFastProperties(F.prototype),R({a:1}),R({b:2}),R({c:3}),R(1),R((function(){})),R(void 0),R(!1),R(new F(w)),P.setBounds(m.firstLineError,c.lastLineError),F}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i){var a=e("./util");function s(e){var n=this._promise=new t(r);e instanceof t&&(n._propagateFrom(e,3),e.suppressUnhandledRejections()),n._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return a.isArray,a.inherits(s,i),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function e(r,i){var s=n(this._values,this._promise);if(s instanceof t){var c=(s=s._target())._bitField;if(this._values=s,0==(50397184&c))return this._promise._setAsyncGuaranteed(),s._then(e,this._reject,void 0,this,i);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(s._reason()):this._cancel();s=s._value()}if(null!==(s=a.asArray(s)))0!==s.length?this._iterate(s):-5===i?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(i));else{var u=o("expecting an array or an iterable object but got "+a.classString(s)).reason();this._promise._rejectCallback(u,!1)}},s.prototype._iterate=function(e){var r=this.getActualLength(e.length);this._length=r,this._values=this.shouldCopyValues()?new Array(r):this._values;for(var o=this._promise,i=!1,a=null,s=0;s<r;++s){var c=n(e[s],o);a=c instanceof t?(c=c._target())._bitField:null,i?null!==a&&c.suppressUnhandledRejections():null!==a?0==(50397184&a)?(c._proxy(this,s),this._values[s]=c):i=0!=(33554432&a)?this._promiseFulfilled(c._value(),s):0!=(16777216&a)?this._promiseRejected(c._reason(),s):this._promiseCancelled(s):i=this._promiseFulfilled(c,s)}i||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var r=0;r<e.length;++r)e[r]instanceof t&&e[r].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},{"./util":36}],24:[function(e,t,r){"use strict";t.exports=function(t,r){var n={},o=e("./util"),i=e("./nodeback"),a=o.withAppended,s=o.maybeWrapAsError,c=o.canEvaluate,u=e("./errors").TypeError,p={__isPromisified__:!0},l=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),d=function(e){return o.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function h(e){return!l.test(e)}function f(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function m(e,t,r){var n=o.getDataPropertyOrDefault(e,t+r,p);return!!n&&f(n)}function g(e,t,r,n){for(var i=o.inheritedDataKeys(e),a=[],s=0;s<i.length;++s){var c=i[s],p=e[c],l=n===d||d(c);"function"!=typeof p||f(p)||m(e,c,t)||!n(c,p,e,l)||a.push(c,p)}return function(e,t,r){for(var n=0;n<e.length;n+=2){var o=e[n];if(r.test(o))for(var i=o.replace(r,""),a=0;a<e.length;a+=2)if(e[a]===i)throw new u("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(a,t,r),a}var y=c?void 0:function(e,c,u,p,l,d){var h=function(){return this}(),f=e;function m(){var o=c;c===n&&(o=this);var u=new t(r);u._captureStackTrace();var p="string"==typeof f&&this!==h?this[f]:e,l=i(u,d);try{p.apply(o,a(arguments,l))}catch(e){u._rejectCallback(s(e),!0,!0)}return u._isFateSealed()||u._setAsyncGuaranteed(),u}return"string"==typeof f&&(e=p),o.notEnumerableProp(m,"__isPromisified__",!0),m};function v(e,t,r,i,a){for(var s=new RegExp(t.replace(/([$])/,"\\$")+"$"),c=g(e,t,s,r),u=0,p=c.length;u<p;u+=2){var l=c[u],d=c[u+1],h=l+t;if(i===y)e[h]=y(l,n,l,d,t,a);else{var f=i(d,(function(){return y(l,n,l,d,t,a)}));o.notEnumerableProp(f,"__isPromisified__",!0),e[h]=f}}return o.toFastProperties(e),e}t.promisify=function(e,t){if("function"!=typeof e)throw new u("expecting a function but got "+o.classString(e));if(f(e))return e;var r=function(e,t,r){return y(e,t,void 0,e,null,r)}(e,void 0===(t=Object(t)).context?n:t.context,!!t.multiArgs);return o.copyDescriptors(e,r,h),r},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new u("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,n=t.suffix;"string"!=typeof n&&(n="Async");var i=t.filter;"function"!=typeof i&&(i=d);var a=t.promisifier;if("function"!=typeof a&&(a=y),!o.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=o.inheritedDataKeys(e),c=0;c<s.length;++c){var p=e[s[c]];"constructor"!==s[c]&&o.isClass(p)&&(v(p.prototype,n,i,a,r),v(p,n,i,a,r))}return v(e,n,i,a,r)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,r){"use strict";t.exports=function(t,r,n,o){var i,a=e("./util"),s=a.isObject,c=e("./es5");"function"==typeof Map&&(i=Map);var u=function(){var e=0,t=0;function r(r,n){this[e]=r,this[e+t]=n,e++}return function(n){t=n.size,e=0;var o=new Array(2*n.size);return n.forEach(r,o),o}}();function p(e){var t,r=!1;if(void 0!==i&&e instanceof i)t=u(e),r=!0;else{var n=c.keys(e),o=n.length;t=new Array(2*o);for(var a=0;a<o;++a){var s=n[a];t[a]=e[s],t[a+o]=s}}this.constructor$(t),this._isMap=r,this._init$(void 0,r?-6:-3)}function l(e){var r,i=n(e);return s(i)?(r=i instanceof t?i._then(t.props,void 0,void 0,void 0,void 0):new p(i).promise(),i instanceof t&&r._propagateFrom(i,2),r):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}a.inherits(p,r),p.prototype._init=function(){},p.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var r;if(this._isMap)r=function(e){for(var t=new i,r=e.length/2|0,n=0;n<r;++n){var o=e[r+n],a=e[n];t.set(o,a)}return t}(this._values);else{r={};for(var n=this.length(),o=0,a=this.length();o<a;++o)r[this._values[o+n]]=this._values[o]}return this._resolve(r),!0}return!1},p.prototype.shouldCopyValues=function(){return!1},p.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return l(this)},t.props=function(e){return l(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,r){"use strict";function n(e){this._capacity=e,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(e){return this._capacity<e},n.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},n.prototype.push=function(e,t,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(r);var o=this._front+n-3;this._checkCapacity(n);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=r,this._length=n},n.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,n,o){for(var i=0;i<o;++i)r[i+n]=e[i+t],e[i+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=n},{}],27:[function(e,t,r){"use strict";t.exports=function(t,r,n,o){var i=e("./util");function a(e,s){var c,u=n(e);if(u instanceof t)return(c=u).then((function(e){return a(e,c)}));if(null===(e=i.asArray(e)))return o("expecting an array or an iterable object but got "+i.classString(e));var p=new t(r);void 0!==s&&p._propagateFrom(s,3);for(var l=p._fulfill,d=p._reject,h=0,f=e.length;h<f;++h){var m=e[h];(void 0!==m||h in e)&&t.cast(m)._then(l,d,void 0,p,null)}return p}t.race=function(e){return a(e,void 0)},t.prototype.race=function(){return a(this,void 0)}}},{"./util":36}],28:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i,a){var s=e("./util"),c=s.tryCatch;function u(e,r,n,o){this.constructor$(e);var a=t._getContext();this._fn=s.contextBind(a,r),void 0!==n&&(n=t.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function p(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function l(e,t,r,o){return"function"!=typeof t?n("expecting a function but got "+s.classString(t)):new u(e,t,r,o).promise()}function d(e){this.accum=e,this.array._gotAccum(e);var r=o(this.value,this.array._promise);return r instanceof t?(this.array._currentCancellable=r,r._then(h,void 0,void 0,this,void 0)):h.call(this,r)}function h(e){var r,n=this.array,o=n._promise,i=c(n._fn);o._pushContext(),(r=void 0!==n._eachValues?i.call(o._boundValue(),e,this.index,this.length):i.call(o._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(n._currentCancellable=r);var s=o._popContext();return a.checkForgottenReturns(r,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",o),r}s.inherits(u,r),u.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},u.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},u.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},u.prototype._iterate=function(e){var r,n;this._values=e;var o=e.length;void 0!==this._initialValue?(r=this._initialValue,n=0):(r=t.resolve(e[0]),n=1),this._currentCancellable=r;for(var i=n;i<o;++i){var a=e[i];a instanceof t&&a.suppressUnhandledRejections()}if(!r.isRejected())for(;n<o;++n){var s={accum:null,value:e[n],index:n,length:o,array:this};r=r._then(d,void 0,void 0,s,void 0),0==(127&n)&&r._setNoAsyncGuarantee()}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(p,p,void 0,r,this)},t.prototype.reduce=function(e,t){return l(this,e,t,null)},t.reduce=function(e,t,r,n){return l(e,t,r,n)}}},{"./util":36}],29:[function(e,o,i){"use strict";var a,s,c,u,p,l=e("./util"),d=l.getNativePromise();if(l.isNode&&"undefined"==typeof MutationObserver){var h=r.setImmediate,f=t.nextTick;a=l.isRecentNode?function(e){h.call(r,e)}:function(e){f.call(t,e)}}else if("function"==typeof d&&"function"==typeof d.resolve){var m=d.resolve();a=function(e){m.then(e)}}else a="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?void 0!==n?function(e){n(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(s=document.createElement("div"),c={attributes:!0},u=!1,p=document.createElement("div"),new MutationObserver((function(){s.classList.toggle("foo"),u=!1})).observe(p,c),function(e){var t=new MutationObserver((function(){t.disconnect(),e()}));t.observe(s,c),u||(u=!0,p.classList.toggle("foo"))});o.exports=a},{"./util":36}],30:[function(e,t,r){"use strict";t.exports=function(t,r,n){var o=t.PromiseInspection;function i(e){this.constructor$(e)}e("./util").inherits(i,r),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var r=new o;return r._bitField=33554432,r._settledValueField=e,this._promiseResolved(t,r)},i.prototype._promiseRejected=function(e,t){var r=new o;return r._bitField=16777216,r._settledValueField=e,this._promiseResolved(t,r)},t.settle=function(e){return n.deprecated(".settle()",".reflect()"),new i(e).promise()},t.allSettled=function(e){return new i(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,r){"use strict";t.exports=function(t,r,n){var o=e("./util"),i=e("./errors").RangeError,a=e("./errors").AggregateError,s=o.isArray,c={};function u(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function p(e,t){if((0|t)!==t||t<0)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var r=new u(e),o=r.promise();return r.setHowMany(t),r.init(),o}o.inherits(u,r),u.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=s(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(e){this._howMany=e},u.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},u.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},u.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},u.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new a,t=this.length();t<this._values.length;++t)this._values[t]!==c&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(e){this._values.push(e)},u.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new i(t)},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return p(e,t)},t.prototype.some=function(e){return p(this,e)},t._SomePromiseArray=u}},{"./errors":12,"./util":36}],32:[function(e,t,r){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},i=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,r){"use strict";t.exports=function(t,r){var n=e("./util"),o=n.errorObj,i=n.isObject,a={}.hasOwnProperty;return function(e,s){if(i(e)){if(e instanceof t)return e;var c=function(e){try{return function(e){return e.then}(e)}catch(e){return o.e=e,o}}(e);if(c===o){s&&s._pushContext();var u=t.reject(c.e);return s&&s._popContext(),u}if("function"==typeof c)return function(e){try{return a.call(e,"_promise0")}catch(e){return!1}}(e)?(u=new t(r),e._then(u._fulfill,u._reject,void 0,u,null),u):function(e,i,a){var s=new t(r),c=s;a&&a._pushContext(),s._captureStackTrace(),a&&a._popContext();var u=n.tryCatch(i).call(e,(function(e){s&&(s._resolveCallback(e),s=null)}),(function(e){s&&(s._rejectCallback(e,!1,!0),s=null)}));return s&&u===o&&(s._rejectCallback(u.e,!0,!0),s=null),c}(e,c,s)}return e}}},{"./util":36}],34:[function(e,t,r){"use strict";t.exports=function(t,r,n){var o=e("./util"),i=t.TimeoutError;function a(e){this.handle=e}a.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(e){return c(+this).thenReturn(e)},c=t.delay=function(e,o){var i,c;return void 0!==o?(i=t.resolve(o)._then(s,null,null,e,void 0),n.cancellation()&&o instanceof t&&i._setOnCancel(o)):(i=new t(r),c=setTimeout((function(){i._fulfill()}),+e),n.cancellation()&&i._setOnCancel(new a(c)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};function u(e){return clearTimeout(this.handle),e}function p(e){throw clearTimeout(this.handle),e}t.prototype.delay=function(e){return c(e,this)},t.prototype.timeout=function(e,t){var r,s;e=+e;var c=new a(setTimeout((function(){r.isPending()&&function(e,t,r){var n;n="string"!=typeof t?t instanceof Error?t:new i("operation timed out"):new i(t),o.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._reject(n),null!=r&&r.cancel()}(r,t,s)}),e));return n.cancellation()?(s=this.then(),(r=s._then(u,p,void 0,c,void 0))._setOnCancel(c)):r=this._then(u,p,void 0,c,void 0),r}}},{"./util":36}],35:[function(e,t,r){"use strict";t.exports=function(t,r,n,o,i,a){var s=e("./util"),c=e("./errors").TypeError,u=e("./util").inherits,p=s.errorObj,l=s.tryCatch,d={};function h(e){setTimeout((function(){throw e}),0)}function f(e,r){var o=0,a=e.length,s=new t(i);return function i(){if(o>=a)return s._fulfill();var c=function(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(e[o++]);if(c instanceof t&&c._isDisposable()){try{c=n(c._getDisposer().tryDispose(r),e.promise)}catch(e){return h(e)}if(c instanceof t)return c._then(i,h,null,null,null)}i()}(),s}function m(e,t,r){this._data=e,this._promise=t,this._context=r}function g(e,t,r){this.constructor$(e,t,r)}function y(e){return m.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function v(e){this.length=e,this.promise=null,this[e-1]=null}m.prototype.data=function(){return this._data},m.prototype.promise=function(){return this._promise},m.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},m.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=t!==d?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},m.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},u(g,m),g.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},v.prototype._resultCancelled=function(){for(var e=this.length,r=0;r<e;++r){var n=this[r];n instanceof t&&n.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return r("you must pass at least 2 arguments to Promise.using");var o,i=arguments[e-1];if("function"!=typeof i)return r("expecting a function but got "+s.classString(i));var c=!0;2===e&&Array.isArray(arguments[0])?(e=(o=arguments[0]).length,c=!1):(o=arguments,e--);for(var u=new v(e),d=0;d<e;++d){var h=o[d];if(m.isDisposer(h)){var g=h;(h=h.promise())._setDisposable(g)}else{var b=n(h);b instanceof t&&(h=b._then(y,null,null,{resources:u,index:d},void 0))}u[d]=h}var w=new Array(u.length);for(d=0;d<w.length;++d)w[d]=t.resolve(u[d]).reflect();var x=t.all(w).then((function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return p.e=r.error(),p;if(!r.isFulfilled())return void x.cancel();e[t]=r.value()}E._pushContext(),i=l(i);var n=c?i.apply(void 0,e):i(e),o=E._popContext();return a.checkForgottenReturns(n,o,"Promise.using",E),n})),E=x.lastly((function(){var e=new t.PromiseInspection(x);return f(u,e)}));return u.promise=E,E._setOnCancel(u),E},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new g(e,this,o());throw new c}}},{"./errors":12,"./util":36}],36:[function(e,n,o){"use strict";var i=e("./es5"),a="undefined"==typeof navigator,s={e:{}},c,u="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0!==this?this:null;function p(){try{var e=c;return c=null,e.apply(this,arguments)}catch(e){return s.e=e,s}}function l(e){return c=e,p}var d=function(e,t){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}return n.prototype=t.prototype,e.prototype=new n,e.prototype};function h(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function f(e){return"function"==typeof e||"object"==typeof e&&null!==e}function m(e){return h(e)?new Error(P(e)):e}function g(e,t){var r,n=e.length,o=new Array(n+1);for(r=0;r<n;++r)o[r]=e[r];return o[r]=t,o}function y(e,t,r){if(!i.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var n=Object.getOwnPropertyDescriptor(e,t);return null!=n?null==n.get&&null==n.set?n.value:r:void 0}function v(e,t,r){if(h(e))return e;var n={value:r,configurable:!0,enumerable:!1,writable:!0};return i.defineProperty(e,t,n),e}function b(e){throw e}var w=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(i.isES5){var r=Object.getOwnPropertyNames;return function(e){for(var n=[],o=Object.create(null);null!=e&&!t(e);){var a;try{a=r(e)}catch(e){return n}for(var s=0;s<a.length;++s){var c=a[s];if(!o[c]){o[c]=!0;var u=Object.getOwnPropertyDescriptor(e,c);null!=u&&null==u.get&&null==u.set&&n.push(c)}}e=i.getPrototypeOf(e)}return n}}var n={}.hasOwnProperty;return function(r){if(t(r))return[];var o=[];e:for(var i in r)if(n.call(r,i))o.push(i);else{for(var a=0;a<e.length;++a)if(n.call(e[a],i))continue e;o.push(i)}return o}}(),x=/this\s*\.\s*\S+\s*=/;function E(e){try{if("function"==typeof e){var t=i.names(e.prototype),r=i.isES5&&t.length>1,n=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=x.test(e+"")&&i.names(e).length>0;if(r||n||o)return!0}return!1}catch(e){return!1}}function k(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.foo}return n(),n(),e}var _=/^[a-z$_][a-z$_0-9]*$/i;function S(e){return _.test(e)}function C(e,t,r){for(var n=new Array(e),o=0;o<e;++o)n[o]=t+o+r;return n}function P(e){try{return e+""}catch(e){return"[no string representation]"}}function D(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function A(e){try{v(e,"isOperational",!0)}catch(e){}}function O(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function j(e){return D(e)&&i.propertyIsWritable(e,"stack")}var T="stack"in new Error?function(e){return j(e)?e:new Error(P(e))}:function(e){if(j(e))return e;try{throw new Error(P(e))}catch(e){return e}};function F(e){return{}.toString.call(e)}function I(e,t,r){for(var n=i.names(e),o=0;o<n.length;++o){var a=n[o];if(r(a))try{i.defineProperty(t,a,i.getDescriptor(e,a))}catch(e){}}}var N=function(e){return i.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var R="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],n=e[Symbol.iterator]();!(t=n.next()).done;)r.push(t.value);return r};N=function(e){return i.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?R(e):null}}var B=void 0!==t&&"[object process]"===F(t).toLowerCase(),L=void 0!==t&&void 0!==t.env,M;function q(e){return L?t.env[e]:void 0}function U(){if("function"==typeof Promise)try{if("[object Promise]"===F(new Promise((function(){}))))return Promise}catch(e){}}function $(e,t){if(null===e||"function"!=typeof t||t===M)return t;null!==e.domain&&(t=e.domain.bind(t));var r=e.async;if(null!==r){var n=t;t=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=n,e[1]=this,r.runInAsyncScope.apply(r,e)}}return t}var z={setReflectHandler:function(e){M=e},isClass:E,isIdentifier:S,inheritedDataKeys:w,getDataPropertyOrDefault:y,thrower:b,isArray:i.isArray,asArray:N,notEnumerableProp:v,isPrimitive:h,isObject:f,isError:D,canEvaluate:a,errorObj:s,tryCatch:l,inherits:d,withAppended:g,maybeWrapAsError:m,toFastProperties:k,filledRange:C,toString:P,canAttachTrace:j,ensureErrorObject:T,originatesFromRejection:O,markAsOriginatingFromRejection:A,classString:F,copyDescriptors:I,isNode:B,hasEnvVariables:L,env:q,global:u,getNativePromise:U,contextBind:$},G;z.isRecentNode=z.isNode&&(t.versions&&t.versions.node?G=t.versions.node.split(".").map(Number):t.version&&(G=t.version.split(".").map(Number)),0===G[0]&&G[1]>10||G[0]>0),z.nodeSupportsAsyncResource=z.isNode&&function(){var t=!1;try{t="function"==typeof e("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(e){t=!1}return t}(),z.isNode&&z.toFastProperties(t);try{throw new Error}catch(e){z.lastLineError=e}n.exports=z},{"./es5":13,async_hooks:void 0}]},{},[4])(4)},e.exports=o(),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,r(13),r(26),r(137).setImmediate)},function(e,t,r){const n=r(139),o=r(47),i=r(67),a=r(145);function s(e){const t=e;return e.name||(t.name=e.topic),e.cases||(t.cases=[]),e}t.validate=function(e){const t="undefined"!=typeof window&&window.tv4?window.tv4:r(110);if(!t)throw new Error("TV4 not available, unable to validate");t.reset(),Object.keys(a).forEach(e=>{const r=a[e];t.addSchema(r.id,r)});const n=t.validateMultiple(e,"testsfile.json");return n.missing.length&&(n.passed=!1),n},t.create=e=>s(e),t.loadYAML=function(e,t){const n=[];try{("undefined"!=typeof window&&window.jsyaml?window.jsyaml:r(146)).safeLoadAll(e,e=>n.push(s(e)))}catch(e){return void t(e)}t(null,n)},t.loadYAMLSync=function(e){const t="undefined"!=typeof window&&window.jsyaml?window.jsyaml:r(146),n=[];return t.safeLoadAll(e,e=>n.push(s(e))),n},t.getSuitesSync=function(e){if(!i.isArray(e))return t.getSuitesSync([e]);let n=[];return e.forEach(e=>{n=n.concat(function(e){const n=r(27);if(n.statSync(e).isDirectory()){const r=n.readdirSync(e).filter(e=>".yaml"===o.extname(e)).map(t=>o.join(e,t));return t.getSuitesSync(r)}const i=n.readFileSync(e,"utf-8");return t.loadYAMLSync(i)}(e))}),n},t.getSuites=function(e,a){if(!i.isArray(e))return void t.getSuites([e],a);i.asyncSeries(e,(e,a)=>{i.startsWith(e,"http://")?function(e,r){n(e).then(e=>e.text()).then(e=>new Promise((r,n)=>{t.loadYAML(e,(e,t)=>{e?n(e):r(t)})})).then(e=>{r(null,e)},r)}(e,a):function(e,n){const i=r(27);i.stat(e,(r,a)=>{r?n(r):a.isDirectory()?i.readdir(e,(r,i)=>{if(r)return void n(r);const a=i.filter(e=>".yaml"===o.extname(e)).map(t=>o.join(e,t));t.getSuites(a,n)}):i.readFile(e,"utf-8",(e,r)=>{e?n(e):t.loadYAML(r,n)})})}(e,a)},(e,t)=>{if(e)return void a(e);const r=t.reduce((e,t)=>e.concat(t),[]);a(null,r)})}},function(e,t,r){"use strict";var n=r(53);e.exports=new n({explicit:[r(342),r(343),r(344)]})},function(e,t,r){(function(t){var r;r=function(){"use strict";var e="function"==typeof Promise,r="object"==typeof self?self:t,n="undefined"!=typeof Symbol,o="undefined"!=typeof Map,i="undefined"!=typeof Set,a="undefined"!=typeof WeakMap,s="undefined"!=typeof WeakSet,c="undefined"!=typeof DataView,u=n&&void 0!==Symbol.iterator,p=n&&void 0!==Symbol.toStringTag,l=i&&"function"==typeof Set.prototype.entries,d=o&&"function"==typeof Map.prototype.entries,h=l&&Object.getPrototypeOf((new Set).entries()),f=d&&Object.getPrototypeOf((new Map).entries()),m=u&&"function"==typeof Array.prototype[Symbol.iterator],g=m&&Object.getPrototypeOf([][Symbol.iterator]()),y=u&&"function"==typeof String.prototype[Symbol.iterator],v=y&&Object.getPrototypeOf(""[Symbol.iterator]());return function(t){var n=typeof t;if("object"!==n)return n;if(null===t)return"null";if(t===r)return"global";if(Array.isArray(t)&&(!1===p||!(Symbol.toStringTag in t)))return"Array";if("object"==typeof window&&null!==window){if("object"==typeof window.location&&t===window.location)return"Location";if("object"==typeof window.document&&t===window.document)return"Document";if("object"==typeof window.navigator){if("object"==typeof window.navigator.mimeTypes&&t===window.navigator.mimeTypes)return"MimeTypeArray";if("object"==typeof window.navigator.plugins&&t===window.navigator.plugins)return"PluginArray"}if(("function"==typeof window.HTMLElement||"object"==typeof window.HTMLElement)&&t instanceof window.HTMLElement){if("BLOCKQUOTE"===t.tagName)return"HTMLQuoteElement";if("TD"===t.tagName)return"HTMLTableDataCellElement";if("TH"===t.tagName)return"HTMLTableHeaderCellElement"}}var u=p&&t[Symbol.toStringTag];if("string"==typeof u)return u;var l=Object.getPrototypeOf(t);return l===RegExp.prototype?"RegExp":l===Date.prototype?"Date":e&&l===Promise.prototype?"Promise":i&&l===Set.prototype?"Set":o&&l===Map.prototype?"Map":s&&l===WeakSet.prototype?"WeakSet":a&&l===WeakMap.prototype?"WeakMap":c&&l===DataView.prototype?"DataView":o&&l===f?"Map Iterator":i&&l===h?"Set Iterator":m&&l===g?"Array Iterator":y&&l===v?"String Iterator":null===l?"Object":Object.prototype.toString.call(t).slice(8,-1)}},e.exports=r()}).call(this,r(26))},function(e,t,r){var n=r(153),o=r(154),i=r(366),a=r(54);e.exports=function(e,t,r,n){return s({showHidden:t,seen:[],stylize:function(e){return e}},e,void 0===r?2:r)};function s(e,r,f){if(r&&"function"==typeof r.inspect&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var m=r.inspect(f,e);return"string"!=typeof m&&(m=s(e,m,f)),m}var g,y=function(e,t){switch(typeof t){case"undefined":return e.stylize("undefined","undefined");case"string":var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string");case"number":return 0===t&&1/t==-1/0?e.stylize("-0","number"):e.stylize(""+t,"number");case"boolean":return e.stylize(""+t,"boolean");case"symbol":return e.stylize(t.toString(),"symbol")}if(null===t)return e.stylize("null","null")}(e,r);if(y)return y;if(g=r,"object"==typeof HTMLElement?g instanceof HTMLElement:g&&"object"==typeof g&&"nodeType"in g&&1===g.nodeType&&"string"==typeof g.nodeName){if("outerHTML"in r)return r.outerHTML;try{if(document.xmlVersion)return(new XMLSerializer).serializeToString(r);var v=document.createElementNS("http://www.w3.org/1999/xhtml","_");v.appendChild(r.cloneNode(!1));var b=v.innerHTML.replace("><",">"+r.innerHTML+"<");return v.innerHTML="",b}catch(e){}}var w,x,E=i(r),k=e.showHidden?o(r):E;if(0===k.length||d(r)&&(1===k.length&&"stack"===k[0]||2===k.length&&"description"===k[0]&&"stack"===k[1])){if("function"==typeof r)return x=(w=n(r))?": "+w:"",e.stylize("[Function"+x+"]","special");if(p(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(l(r))return e.stylize(Date.prototype.toUTCString.call(r),"date");if(d(r))return c(r)}var _,S,C="",P=!1,D=!1,A=["{","}"];if("object"==typeof(_=r)&&/\w+Array]$/.test(h(_))&&(D=!0,A=["[","]"]),function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===h(e)}(r)&&(P=!0,A=["[","]"]),"function"==typeof r&&(C=" [Function"+(x=(w=n(r))?": "+w:"")+"]"),p(r)&&(C=" "+RegExp.prototype.toString.call(r)),l(r)&&(C=" "+Date.prototype.toUTCString.call(r)),d(r))return c(r);if(0===k.length&&(!P||0==r.length))return A[0]+C+A[1];if(f<0)return p(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");if(e.seen.push(r),P)S=function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)Object.prototype.hasOwnProperty.call(t,String(a))?i.push(u(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(u(e,t,r,n,o,!0))})),i}(e,r,f,E,k);else{if(D)return function(e){for(var t="[ ",r=0;r<e.length;++r){if(t.length>=a.truncateThreshold-7){t+="...";break}t+=e[r]+", "}-1!==(t+=" ]").indexOf(",  ]")&&(t=t.replace(",  ]"," ]"));return t}(r);S=k.map((function(t){return u(e,r,f,E,t,P)}))}return e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return e+t.length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(S,C,A)}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function u(e,t,r,n,o,i){var a,c,u=Object.getOwnPropertyDescriptor(t,o);if(u&&(u.get?c=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(c=e.stylize("[Setter]","special"))),n.indexOf(o)<0&&(a="["+o+"]"),c||(e.seen.indexOf(t[o])<0?(c=s(e,t[o],null===r?null:r-1)).indexOf("\n")>-1&&(c=i?c.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+c.split("\n").map((function(e){return"   "+e})).join("\n")):c=e.stylize("[Circular]","special")),void 0===a){if(i&&o.match(/^\d+$/))return c;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+c}function p(e){return"object"==typeof e&&"[object RegExp]"===h(e)}function l(e){return"object"==typeof e&&"[object Date]"===h(e)}function d(e){return"object"==typeof e&&"[object Error]"===h(e)}function h(e){return Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e){return[":~:",e,":~:"].join("")}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(d,e);var t,r,n,u=c(d);function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,d);var r=t;return e=u.call(this,r),r.catchExceptions&&(window.onerror=function(e){return this.client&&this.send("network","error",e,{href:this.context?this.context.href:this.client.location.href}),console.error(e),!0}.bind(p(e))),r.defaultPermissions.length||(r.defaultPermissions=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource","network:data","network:control","network:status"]),e.client=null,e}return t=d,(r=[{key:"setClient",value:function(e){this.client=e}},{key:"send",value:function(e,t,r,n){if(this.client){var o=r;r instanceof Error&&(o={message:r.message,stack:r.stack});var i=this.context;i||(i=n),this.client.postMessage(JSON.stringify({protocol:e,command:t,payload:o}),i.href),a(l(d.prototype),"send",this).call(this,e,t,r,i)}}},{key:"sendAll",value:function(e,t,r){this.send(e,t,r,this.context)}}])&&i(t.prototype,r),n&&i(t,n),d}(r(164));e.exports=d},function(e,t){t.parseName=function(e){if(-1===e.indexOf("/"))return{library:null,name:e};var t=e.split("/");return{library:t[0],name:t[1]}},t.withNamespace=function(e,t){return t&&-1===e.indexOf("/")?"".concat(t,"/").concat(e):e},t.withoutNamespace=function(e){return-1===e.indexOf("/")?e:e.split("/")[1]}},,,,,,,,,,,,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Network=void 0;var l=r(112),d=r(37),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,u=c(l);function l(){return o(this,l),u.apply(this,arguments)}return t=l,(r=[{key:"addNode",value:function(e,t,r){var n=this;"function"==typeof t&&(r=t,t={}),t=t||{};var o=a(p(l.prototype),"addNode",this).call(this,e,t).then((function(r){return t.initial||n.graph.addNode(e.id,e.component,e.metadata),r}));return r&&(d.deprecated("Providing a callback to Network.addNode is deprecated, use Promises"),o.then((function(e){r(null,e)}),r)),o}},{key:"removeNode",value:function(e,t){var r=this,n=a(p(l.prototype),"removeNode",this).call(this,e).then((function(){return r.graph.removeNode(e.id),null}));return t&&(d.deprecated("Providing a callback to Network.removeNode is deprecated, use Promises"),n.then((function(){t(null)}),t)),n}},{key:"renameNode",value:function(e,t,r){var n=this,o=a(p(l.prototype),"renameNode",this).call(this,e,t).then((function(){n.graph.renameNode(e,t)}));return r&&(d.deprecated("Providing a callback to Network.renameNode is deprecated, use Promises"),o.then((function(){r(null)}),r)),o}},{key:"addEdge",value:function(e,t,r){var n=this;"function"==typeof t&&(r=t,t={}),t=t||{};var o=a(p(l.prototype),"addEdge",this).call(this,e,t).then((function(r){return t.initial||n.graph.addEdgeIndex(e.from.node,e.from.port,e.from.index,e.to.node,e.to.port,e.to.index,e.metadata),r}));return r&&(d.deprecated("Providing a callback to Network.addEdge is deprecated, use Promises"),o.then((function(e){r(null,e)}),r)),o}},{key:"removeEdge",value:function(e,t){var r=this,n=a(p(l.prototype),"removeEdge",this).call(this,e).then((function(){return r.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port),null}));return t&&(d.deprecated("Providing a callback to Network.removeEdge is deprecated, use Promises"),n.then((function(){t(null)}),t)),n}},{key:"addInitial",value:function(e,t,r){var n=this;"function"==typeof t&&(r=t,t={}),t=t||{};var o=a(p(l.prototype),"addInitial",this).call(this,e,t).then((function(r){return t.initial||n.graph.addInitialIndex(e.from.data,e.to.node,e.to.port,e.to.index,e.metadata),r}));return r&&(d.deprecated("Providing a callback to Network.addInitial is deprecated, use Promises"),o.then((function(){r(null)}),r)),o}},{key:"removeInitial",value:function(e,t){var r=this,n=a(p(l.prototype),"removeInitial",this).call(this,e).then((function(){r.graph.removeInitial(e.to.node,e.to.port)}));return t&&(d.deprecated("Providing a callback to Network.removeInitial is deprecated, use Promises"),n.then((function(){t(null)}),t)),n}}])&&i(t.prototype,r),n&&i(t,n),l}(l.BaseNetwork);t.Network=h},function(e,t,r){"use strict";(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseNetwork=void 0;var p=r(11),l=r(83),d=r(84),h=r(478),f=r(46),m=r(37);function g(e,t,r,n,o){return o?(e.to={process:t,port:r,index:n},t.component&&t.component.inPorts&&t.component.inPorts.ports[r]?t.component.inPorts.ports[r].isAddressable()?(t.component.inPorts.ports[r].attach(e,n),Promise.resolve(e)):(t.component.inPorts.ports[r].attach(e),Promise.resolve(e)):Promise.reject(new Error("No inport '".concat(r,"' defined in process ").concat(t.id," (").concat(e.getId(),")")))):(e.from={process:t,port:r,index:n},t.component&&t.component.outPorts&&t.component.outPorts.ports[r]?t.component.outPorts.ports[r].isAddressable()?(t.component.outPorts.ports[r].attach(e,n),Promise.resolve(e)):(t.component.outPorts.ports[r].attach(e),Promise.resolve(e)):Promise.reject(new Error("No outport '".concat(r,"' defined in process ").concat(t.id," (").concat(e.getId(),")"))))}var y=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(p,t);var r,n,c,u=s(p);function p(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,p),(r=u.call(this)).options=n,r.processes={},r.connections=[],r.initials=[],r.nextInitials=[],r.defaults=[],r.graph=t,r.started=!1,r.stopped=!0,r.debug=!0,r.eventBuffer=[],t.properties.baseDir&&!n.baseDir&&m.deprecated("Passing baseDir via Graph properties is deprecated, pass via Network options instead"),r.baseDir=null,m.isBrowser()?r.baseDir=n.baseDir||t.properties.baseDir||"/":r.baseDir=n.baseDir||t.properties.baseDir||e.cwd(),r.startupDate=null,n.componentLoader?r.loader=n.componentLoader:t.properties.componentLoader?(m.deprecated("Passing componentLoader via Graph properties is deprecated, pass via Network options instead"),r.loader=t.properties.componentLoader):r.loader=new d.ComponentLoader(r.baseDir,r.options),r.flowtraceName=null,r.setFlowtrace(n.flowtrace||!1,null),r}return r=p,(n=[{key:"uptime",value:function(){return this.startupDate?Date.now()-this.startupDate.getTime():0}},{key:"getActiveProcesses",value:function(){var e=this,t=[];return this.started?(Object.keys(this.processes).forEach((function(r){var n=e.processes[r];n&&n.component&&(n.component.load>0&&t.push(r),n.component.__openConnections>0&&t.push(r))})),t):t}},{key:"traceEvent",value:function(e,t){if(this.flowtrace&&(!this.flowtraceName||this.flowtraceName===this.flowtrace.mainGraph))switch(e){case"ip":var r="data";"openBracket"===t.type?r="begingroup":"closeBracket"===t.type&&(r="endgroup");var n=t.socket.from?{node:t.socket.from.process.id,port:t.socket.from.port}:null,o=t.socket.to?{node:t.socket.to.process.id,port:t.socket.to.port}:null;this.flowtrace.addNetworkPacket("network:".concat(r),n,o,this.flowtraceName,{subgraph:t.subgraph,group:t.group,datatype:t.datatype,schema:t.schema,data:t.data});break;case"start":this.flowtrace.addNetworkStarted(this.flowtraceName);break;case"end":this.flowtrace.addNetworkStopped(this.flowtraceName);break;case"error":this.flowtrace.addNetworkError(this.flowtraceName,t)}}},{key:"bufferedEmit",value:function(e,t){var r=this;if(this.traceEvent(e,t),["icon","error","process-error","end"].includes(e))this.emit(e,t);else if(this.isStarted()||"end"===e){if(this.emit(e,t),"start"===e&&(this.eventBuffer.forEach((function(e){r.emit(e.type,e.payload)})),this.eventBuffer=[]),"ip"===e)switch(t.type){case"openBracket":return void this.bufferedEmit("begingroup",t);case"closeBracket":return void this.bufferedEmit("endgroup",t);case"data":this.bufferedEmit("data",t)}}else this.eventBuffer.push({type:e,payload:t})}},{key:"load",value:function(e,t,r){var n=this.loader.load(e,t);return r&&(m.deprecated("Providing a callback to Network.load is deprecated, use Promises"),n.then((function(e){r(null,e)}),r)),n}},{key:"addNode",value:function(e,t,r){var n,o=this;if("function"==typeof t&&(r=t,t={}),this.processes[e.id])n=Promise.resolve(this.processes[e.id]);else{var i={id:e.id};e.component?n=this.load(e.component,e.metadata).then((function(t){t.nodeId=e.id,i.component=t,i.componentName=e.component;var r=i.component.inPorts.ports,n=i.component.outPorts.ports;return Object.keys(r).forEach((function(n){var o=r[n];o.node=e.id,o.nodeInstance=t,o.name=n})),Object.keys(n).forEach((function(r){var o=n[r];o.node=e.id,o.nodeInstance=t,o.name=r})),t.isSubgraph()&&o.subscribeSubgraph(i),o.subscribeNode(i),o.processes[i.id]=i,i})):(this.processes[i.id]=i,n=Promise.resolve(i))}return r&&(m.deprecated("Providing a callback to Network.addNode is deprecated, use Promises"),n.then((function(e){r(null,e)}),r)),n}},{key:"removeNode",value:function(e,t){var r,n=this,o=this.getNode(e.id);if(o){if(!o.component)return delete this.processes[e.id],Promise.resolve();r=o.component.shutdown().then((function(){return delete n.processes[e.id],Promise.resolve()}))}else r=Promise.reject(new Error("Node ".concat(e.id," not found")));return t&&(m.deprecated("Providing a callback to Network.removeNode is deprecated, use Promises"),r.then((function(){t(null)}),t)),r}},{key:"renameNode",value:function(e,t,r){var n,o=this.getNode(e);if(o){if(o.id=t,o.component){var i=o.component.inPorts.ports,a=o.component.outPorts.ports;Object.keys(i).forEach((function(e){var r=i[e];r&&(r.node=t)})),Object.keys(a).forEach((function(e){var r=a[e];r&&(r.node=t)}))}this.processes[t]=o,delete this.processes[e],n=Promise.resolve()}else n=Promise.reject(new Error("Process ".concat(e," not found")));return r&&(m.deprecated("Providing a callback to Network.renameNode is deprecated, use Promises"),n.then((function(){r(null)}),r)),n}},{key:"getNode",value:function(e){return this.processes[e]}},{key:"connect",value:function(e){var t=this,r=function(e,r){return t.graph[e].reduce((function(e,n){return e.then((function(){return t[r](n,{initial:!0})}))}),Promise.resolve())},n=Promise.resolve().then((function(){return r("nodes","addNode")})).then((function(){return r("edges","addEdge")})).then((function(){return r("initializers","addInitial")})).then((function(){return r("nodes","addDefaults")})).then((function(){return t}));return e&&(m.deprecated("Providing a callback to Network.connect is deprecated, use Promises"),n.then((function(){e(null)}),e)),n}},{key:"subscribeSubgraph",value:function(e){var t=this;if(e.component)if(e.component.isReady()){var r=e.component;if(r.network){r.network.setDebug(this.debug),this.flowtrace&&r.network.setFlowtrace(this.flowtrace,e.componentName,!1);var n=function(r,n){if("process-error"===r&&0===t.listeners("process-error").length){if(n.id&&n.metadata&&n.error)throw n.error;throw n}n||(n={}),n.subgraph?(n.subgraph.unshift||(n.subgraph=[n.subgraph]),n.subgraph.unshift(e.id)):n.subgraph=[e.id],t.bufferedEmit(r,n)};r.network.on("ip",(function(e){n("ip",e)})),r.network.on("process-error",(function(e){n("process-error",e)}))}}else e.component.once("ready",(function(){t.subscribeSubgraph(e)}))}},{key:"subscribeSocket",value:function(e,t){var r=this;if(e.on("ip",(function(t){r.bufferedEmit("ip",{id:e.getId(),type:t.type,socket:e,data:t.data,metadata:e.metadata})})),e.on("error",(function(e){if(0===r.listeners("process-error").length){if(e.id&&e.metadata&&e.error)throw e.error;throw e}r.bufferedEmit("process-error",e)})),t&&t.component&&t.component.isLegacy()){var n=t.component;e.on("connect",(function(){n.__openConnections||(n.__openConnections=0),n.__openConnections+=1})),e.on("disconnect",(function(){n.__openConnections-=1,n.__openConnections<0&&(n.__openConnections=0),0===n.__openConnections&&r.checkIfFinished()}))}}},{key:"subscribeNode",value:function(e){var t=this;if(e.component){var r=e.component;r.on("activate",(function(){t.debouncedEnd&&(t.abortDebounce=!0)})),r.on("deactivate",(function(e){e>0||t.checkIfFinished()})),r.getIcon&&r.on("icon",(function(){t.bufferedEmit("icon",{id:e.id,icon:r.getIcon()})}))}}},{key:"ensureNode",value:function(e,t){var r=this.getNode(e);if(!r)return Promise.reject(new Error("No process defined for ".concat(t," node ").concat(e)));if(!r.component)return Promise.reject(new Error("No component defined for ".concat(t," node ").concat(e)));var n=r.component;return n.isReady()?Promise.resolve(r):new Promise((function(e){n.once("ready",(function(){e(r)}))}))}},{key:"addEdge",value:function(e,t,r){var n=this;"function"==typeof t&&(r=t,t={});var o=this.ensureNode(e.from.node,"outbound").then((function(t){var r=l.createSocket(e.metadata);return r.setDebug(n.debug),n.ensureNode(e.to.node,"inbound").then((function(o){return n.subscribeSocket(r,t),g(r,o,e.to.port,e.to.index,!0)})).then((function(){return g(r,t,e.from.port,e.from.index,!1)})).then((function(){return n.connections.push(r),r}))}));return r&&(m.deprecated("Providing a callback to Network.addEdge is deprecated, use Promises"),o.then((function(e){r(null,e)}),r)),o}},{key:"removeEdge",value:function(e,t){var r=this;return this.connections.forEach((function(t){t&&e.to.node===t.to.process.id&&e.to.port===t.to.port&&(t.to.process.component.inPorts[t.to.port].detach(t),e.from.node&&t.from&&e.from.node===t.from.process.id&&e.from.port===t.from.port&&t.from.process.component.outPorts[t.from.port].detach(t),r.connections.splice(r.connections.indexOf(t),1))})),t&&(m.deprecated("Providing a callback to Network.removeEdge is deprecated, use Promises"),t(null)),Promise.resolve()}},{key:"addDefaults",value:function(e){var t=this;return this.ensureNode(e.id,"inbound").then((function(e){return Promise.all(Object.keys(e.component.inPorts.ports).map((function(r){var n=e.component.inPorts.ports[r];if(!n.hasDefault()||n.isAttached())return Promise.resolve();var o=l.createSocket();return o.setDebug(t.debug),t.subscribeSocket(o),g(o,e,r,void 0,!0).then((function(){t.connections.push(o),t.defaults.push(o)}))})))})).then((function(){}))}},{key:"addInitial",value:function(e,t,r){var n=this;"function"==typeof t&&(r=t,t={});var o=this.ensureNode(e.to.node,"inbound").then((function(t){var r=l.createSocket(e.metadata);return r.setDebug(n.debug),n.subscribeSocket(r),g(r,t,e.to.port,e.to.index,!0)})).then((function(t){n.connections.push(t);var r={socket:t,data:e.from.data};return n.initials.push(r),n.nextInitials.push(r),n.isRunning()?n.sendInitials():n.isStopped()||(n.setStarted(!0),n.sendInitials()),t}));return r&&(m.deprecated("Providing a callback to Network.addInitial is deprecated, use Promises"),o.then((function(e){r(null,e)}),r)),o}},{key:"removeInitial",value:function(e,t){var r=this;return this.connections.forEach((function(t){if(t&&e.to.node===t.to.process.id&&e.to.port===t.to.port){t.to.process.component.inPorts[t.to.port].detach(t),r.connections.splice(r.connections.indexOf(t),1);for(var n=0;n<r.initials.length;n+=1){var o=r.initials[n];if(!o)return;if(o.socket!==t)return;r.initials.splice(r.initials.indexOf(o),1)}for(var i=0;i<r.nextInitials.length;i+=1){var a=r.nextInitials[i];if(!a)return;if(a.socket!==t)return;r.nextInitials.splice(r.nextInitials.indexOf(a),1)}}})),t&&(m.deprecated("Providing a callback to Network.removeInitial is deprecated, use Promises"),t(null)),Promise.resolve()}},{key:"sendInitials",value:function(){var e=this;return new Promise((function(e){m.makeAsync(e)})).then((function(){return e.initials.reduce((function(e,t){return e.then((function(){return t.socket.post(new f.default("data",t.data,{initial:!0})),Promise.resolve()}))}),Promise.resolve())})).then((function(){return e.initials=[],Promise.resolve()}))}},{key:"isStarted",value:function(){return this.started}},{key:"isStopped",value:function(){return this.stopped}},{key:"isRunning",value:function(){return this.getActiveProcesses().length>0}},{key:"startComponents",value:function(){var e=this;return this.processes&&Object.keys(this.processes).length?Promise.all(Object.keys(this.processes).map((function(t){var r=e.processes[t];return r.component?r.component.start():Promise.resolve()}))).then((function(){})):Promise.resolve()}},{key:"sendDefaults",value:function(){return Promise.all(this.defaults.map((function(e){return 1!==e.to.process.component.inPorts[e.to.port].sockets.length||(e.connect(),e.send(),e.disconnect()),Promise.resolve()}))).then((function(){}))}},{key:"start",value:function(e){var t,r=this;return this.debouncedEnd&&(this.abortDebounce=!0),this.started?t=this.stop().then((function(){return r.start()})):(this.initials=this.nextInitials.slice(0),this.eventBuffer=[],t=this.startComponents().then((function(){return r.sendInitials()})).then((function(){return r.sendDefaults()})).then((function(){return r.setStarted(!0),Promise.resolve(r)}))),e&&(m.deprecated("Providing a callback to Network.start is deprecated, use Promises"),t.then((function(){e(null)}),e)),t}},{key:"stop",value:function(e){var t,r=this;return this.debouncedEnd&&(this.abortDebounce=!0),this.started?(this.connections.forEach((function(e){e.isConnected()&&e.disconnect()})),this.processes&&Object.keys(this.processes).length?t=Promise.all(Object.keys(this.processes).map((function(e){return r.processes[e].component?r.processes[e].component.shutdown():Promise.resolve()}))).then((function(){return r.setStarted(!1),r.stopped=!0,Promise.resolve(r)})):(this.setStarted(!1),this.stopped=!0,t=Promise.resolve(this))):(this.stopped=!0,t=Promise.resolve(this)),e&&(m.deprecated("Providing a callback to Network.stop is deprecated, use Promises"),t.then((function(){e(null)}),e)),t}},{key:"setStarted",value:function(e){if(this.started!==e){if(!e)return this.started=!1,void this.bufferedEmit("end",{start:this.startupDate,end:new Date,uptime:this.uptime()});this.startupDate||(this.startupDate=new Date),this.started=!0,this.stopped=!1,this.bufferedEmit("start",{start:this.startupDate})}}},{key:"checkIfFinished",value:function(){var e=this;this.isRunning()||(delete this.abortDebounce,this.debouncedEnd||(this.debouncedEnd=h.debounce((function(){e.abortDebounce||e.isRunning()||e.setStarted(!1)}),50)),this.debouncedEnd())}},{key:"getDebug",value:function(){return this.debug}},{key:"setDebug",value:function(e){var t=this;e!==this.debug&&(this.debug=e,this.connections.forEach((function(t){t.setDebug(e)})),Object.keys(this.processes).forEach((function(r){var n=t.processes[r];if(n.component){var o=n.component;o.isSubgraph()&&o.network.setDebug(e)}})))}},{key:"setFlowtrace",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return this.flowtraceName=null,void(this.flowtrace=null);this.flowtrace||(this.flowtrace=e,this.flowtraceName=r||this.graph.name,this.flowtrace.addGraph(this.flowtraceName,this.graph,n),Object.keys(this.processes).forEach((function(e){var r=t.processes[e],n=r.component;n.isSubgraph()&&n.network&&n.network.setFlowtrace(t.flowtrace,r.componentName,!1)})))}}])&&i(r.prototype,n),c&&i(r,c),p}(p.EventEmitter);t.BaseNetwork=y}).call(this,r(13))},,function(e,t,r){"use strict";var n=String.prototype.replace,o=/%20/g,i=r(86),a={RFC1738:"RFC1738",RFC3986:"RFC3986"};e.exports=i.assign({default:a.RFC3986,formatters:{RFC1738:function(e){return n.call(e,o,"+")},RFC3986:function(e){return String(e)}}},a)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return null!==e&&"object"===n(e)}},function(e,t,r){e.exports=r(256)},function(e,t,r){const n=r(64),o=r(118),i=r(51)("fbp-spec:runner"),a=r(51)("fbp-spec:runner:received"),s=r(92),{FlowtraceRecorder:c}=r(138),u=r(67),p=r(329),l=r(93),d=r(149);function h(e,t,r){var o,a;o=o=>{if(o)r(o);else if(t.fixture)if("json"!==t.fixture.type){if("fbp"===t.fixture.type){let e;try{e=n.parse(t.fixture.data)}catch(e){return void r(e)}return e.properties||(e.properties={}),void r(null,e)}r(new Error("Unknown fixture type "+t.fixture.type))}else{let e;try{e=JSON.parse(t.fixture.data)}catch(e){return void r(e)}r(null,e)}else!function(e,t,r){i("synthesizing fixture",e);const n=t[e];if(!n)return void r(new Error("Could not find component for topic: "+e));const o={properties:{},inports:{},outports:{},processes:{},connections:[]};o.processes.testee={component:e},n.inPorts.forEach(e=>{const t=e.id;o.inports[t]={process:"testee",port:t}}),n.outPorts.forEach(e=>{const t=e.id;o.outports[t]={process:"testee",port:t}}),Object.keys(o.outports).length<1?r(new Error(`Component '${e}' used as fixture has no outports`)):Object.keys(o.inports).length<1?r(new Error(`Component '${e}' used as fixture has no inports`)):r(null,o)}(t.topic,e.components,r)},null!=(a=e).components&&"object"==typeof a.components&&Object.keys(a.components).length?o(null):p.getComponents(e.client,(t,r)=>{t?o(t):(e.components=r,o(null))})}function f(e){return e.cases.filter(e=>!e.skip).length>0}function m(e,t,r){if(t.skip)return void r(null,{passed:!0});const n=u.isArray(t.inputs)?t.inputs:[t.inputs],o=u.isArray(t.expect)?t.expect:[t.expect];n.length===o.length?e.runTest(t,(e,t)=>{let n;if(e)return n={passed:!1,error:e},void r(null,n);n=function(e){let t;const r=e.filter(e=>null!=e.actual),n=e.filter(e=>null!=e.expect);if(r.length<n.length)return t={passed:!1,error:new Error(`Only got ${r.length} output messages out of ${n.length}`)},t;const o=e.map(e=>{e.error=null;try{d.expect(e.expect,e.actual)}catch(t){e.error=t}return e}),i=o.filter(e=>e.error);if(0===i.length)t={passed:!0};else if(1===n.length)t={error:i[0].error};else if(n.length>1&&1===i.length){const e=o.findIndex(e=>e.error),r=o[e];t={error:new Error(`Expectation ${e} of sequence failed: ${r.error.message}`)}}else{const e=o.map(e=>(null!=e.error?e.error.message:void 0)||"");t={error:new Error("Multiple failures in sequence: "+e)}}return t}(t),n.error&&(n.passed=!1),r(null,n)}):r(null,{passed:!1,error:new Error(`Test sequence length mismatch. Got ${n.length} inputs and ${o.length} expectations`)})}t.getComponentSuites=function(e,t){p.getCapabilities(e.client,(r,n)=>{r?t(r):-1!==n.indexOf("component:getsource")?p.getComponentTests(e.client,(e,r)=>{e?t(e):function(e,t){const r=Object.keys(e).map(t=>e[t]);u.asyncSeries(r,(function(e,t){l.loadYAML(e,(e,r)=>{t(null,e?null:r)})}),(e,r)=>{e?t(e):t(null,r.filter(e=>null!==e).reduce((e,t)=>e.concat(t),[]))})}(r,(e,n)=>{e?t(e):(i("get component suites",r.length,n.length),t(null,n))})}):t(null,[])})},t.Runner=class{constructor(e,t={}){this.client=e,this.currentGraphId=null,this.components={},this.parentElement=null,this.options=t,this.recorder=null,null==this.options.connectTimeout&&(this.options.connectTimeout=5e3),null==this.options.commandTimeout&&(this.options.commandTimeout=3e3)}prepareClient(e){null==this.client.protocol||null==this.client.address?e(null,this.client):s.resolve().then(()=>o(this.client,{commandTimeout:this.options.commandTimeout})).then(e=>(this.client=e,this.parentElement&&"iframe"===e.definition.protocol&&e.transport.setParentElement(this.parentElement),e)).nodeify(e)}connect(e){i("connect"),this.prepareClient(t=>{if(t)return void e(t);this.client.on("signal",({proto:e,command:t,payload:r})=>a(e,t,r)),this.client.on("network",({command:e,payload:t})=>{"output"===e&&t.message&&console.log(t.message)});const r=Math.floor(this.options.connectTimeout/500);u.retryUntil(()=>(i("trying to connect"),this.client.connect()),()=>this.client.isConnected()?s.resolve():s.reject(new Error("Not connected to runtime")),500,r).then(()=>this.checkCapabilities(["protocol:graph","protocol:network","protocol:runtime"])).nodeify(e)})}disconnect(e){i("disconnect"),(null!=this.client?this.client.isConnected():void 0)?s.resolve().then(()=>this.client.disconnect()).nodeify(e):e()}checkCapabilities(e){if(!this.client.isConnected())return s.reject(new Error("Not connected to runtime"));if(!this.client.definition||!this.client.definition.capabilities||!this.client.definition.capabilities.length)return s.reject(new Error("Runtime provides no capabilities"));for(let t=0;t<e.length;t+=1){const r=e[t];if(-1===this.client.definition.capabilities.indexOf(r))return s.reject(new Error("Runtime doesn't provide "+r))}return s.resolve()}setupSuite(e,t){i(`setup suite "${e.name}"`),this.options.traceCallback&&!this.recorder&&(this.recorder=new c(this.client)),f(e)?this.client.isConnected()?h(this,e,(e,r)=>{e?t(e):p.sendGraph(this.client,r,(e,r)=>{e?t(e):(this.currentGraphId=r,this.recorder?this.recorder.start(r).then(()=>{p.startNetwork(this.client,r,t)},t):p.startNetwork(this.client,r,t))})}):t(new Error("Disconnected from runtime")):t(null)}teardownSuite(e,t){i(`teardown suite "${e.name}"`),this.recorder&&this.currentGraphId&&this.recorder.stop(this.currentGraphId),f(e)?this.client.isConnected()?this.currentGraphId?p.stopNetwork(this.client,this.currentGraphId,t):t():t(new Error("Disconnected from runtime")):t(null)}runTest(e,t){if(i(`runtest "${e.name}"`),!this.client.isConnected())return void t(new Error("Disconnected from runtime"));const r=u.isArray(e.inputs)?e.inputs:[e.inputs],n=u.isArray(e.expect)?e.expect:[e.expect],o=[];for(let e=0,t=r.length,i=t>=0;i?e<t:e>t;i?e+=1:e-=1)o.push({inputs:r[e],expect:n[e]});u.asyncSeries(o,(e,t)=>function(e,t,r,n,o){const i=e.observe(e=>"runtime"===e.protocol&&"packet"===e.command&&e.payload.graph===t);function a(e){const t={};return e.forEach(e=>{t[e.payload.port]=e.payload.payload}),t}function c(e){if("runtime"!==e.protocol||"packet"!==e.command)return!1;if(e.payload.graph!==t)return!1;if("data"!==e.payload.event)return!1;const r=a(i.signals.slice(0,i.signals.indexOf(e)+1));return Object.keys(r).length===Object.keys(n).length}function u(e){return"network"===e.protocol&&"error"===e.command||"network"===e.protocol&&"processerror"===e.command?!e.payload.graph||e.payload.graph===t:"runtime"===e.protocol&&"packet"===e.command&&(e.payload.graph===t&&("data"===e.payload.event&&("error"===e.payload.port&&void 0===n.error)))}const l=s.promisify(p.sendPackets);s.resolve().then(()=>l(e,t,r)).then(()=>i.until(c,u)).then(e=>a(e)).nodeify(o)}(this.client,this.currentGraphId,e.inputs,e.expect,t),(r,n)=>{this.options.traceCallback&&this.currentGraphId&&this.recorder&&this.options.traceCallback(this.currentGraphId,e.name,this.recorder.dump(this.currentGraphId)),r?t(r):(n.forEach((e,t)=>{o[t].actual=e}),t(null,o))})}},t.runAll=function(e,t,r,n){function o(n,o){m(e,n,(e,a)=>{const s=n;var c;Object.keys(a).forEach(e=>{const t=a[e];s[e]=t}),n.error&&(s.error=n.error.message),i(`ran test "${n.name}"`,n.passed,e),c=null,r(t),o(c)})}i("running suites",t.map(e=>e.name)),u.asyncSeries(t,(t,r)=>function(e,t,r,n){t.skip?n(null,t):e.setupSuite(t,o=>{i("setup suite",o),o?n(o,t):u.asyncSeries(t.cases,r,r=>{i("testrun complete",r),r?e.teardownSuite(t,e=>{i("teardown suite",e),n(r,t)}):e.teardownSuite(t,e=>{i("teardown suite",e),n(e,t)})})})}(e,t,o,r),e=>n(e))},t.runTestAndCheck=m},function(e,t,r){const n=r(257),{EventEmitter:o}=r(11),i=r(88),{timedPromise:a,addressToProtocol:s}=r(283),{canSend:c,canReceive:u}=r(284),p=r(285)(),l=r(322),d=r(323);class h extends o{constructor(e,t){super(),this.definition=e;const r=n.getTransport(e.protocol);this.transport=new r(this.definition),this.options=t,this.options.connectionTimeout||(this.options.connectionTimeout=1e3),this.options.commandTimeout||(this.options.commandTimeout=1e3),this.options.skipPermissions||(this.options.skipPermissions=!1),this.options.skipValidation||(this.options.skipValidation=!1),this.prepareCommands()}validate(e,t){return p(e,t).catch(e=>this.options.skipValidation?(this.protocolError(e),Promise.resolve(t)):Promise.reject(e))}isConnected(){return this.transport.isConnected()}connect(){return a((e,t)=>{if(this.isConnected())return void e(this.definition);let r=null;const n=o=>{"runtime"===o.command?(this.transport.removeListener("error",r),this.validate("/runtime/output/runtime",o).then(()=>{this.prepareAdapter(o.payload.version),e(this.definition),this.emit("connected",this.definition),this.transport.once("disconnected",()=>{this.emit("disconnected",this.definition)})},e=>{this.transport.disconnect(),t(e)})):this.transport.once("runtime",n)};r=e=>{let r=e;e instanceof Error||(r=new Error(`Connection to ${this.definition.address} failed`)),this.transport.removeListener("runtime",n),this.transport.disconnect(),t(r)},this.transport.once("runtime",n),this.transport.once("error",r),this.transport.connect()},this.options.connectionTimeout,`Connection to ${this.definition.address} timed out`)}disconnect(){return new Promise(e=>{this.isConnected()?(this.transport.once("disconnected",()=>{e(null)}),this.transport.disconnect()):e(null)})}observe(e){return l(this,e)}signal(e){this.emit("signal",e),this.emit(e.protocol,{command:e.command,payload:e.payload})}protocolError(e){this.emit("protocolError",e)}canSend(e,t){return new Promise((r,n)=>{this.options.skipPermissions||c(e,t,this.definition.capabilities)?r(null):n(new Error(`Not permitted to send ${e}:${t} messages`))})}canReceive(e,t){return new Promise((r,n)=>{this.options.skipPermissions||u(e,t,this.definition.capabilities)?r(null):n(new Error(`Not permitted to receive ${e}:${t} messages`))})}prepareCommands(){this.protocol={},Object.keys(i).forEach(e=>{if(!i[e].input)return;const t={};Object.keys(i[e].input).forEach(r=>{t[r]=(t={})=>{const n={...t,secret:this.definition.secret};return this.validate(`/${e}/${i[e].input[r].id}`,{protocol:e,command:r,payload:t}).then(()=>new Promise((e,t)=>{this.adapter||t(new Error("FBP client must be connected to the runtime before sending commands")),e(null)})).then(()=>this.canSend(e,r)).then(()=>this.adapter.send(e,r,n))}}),this.protocol[e]=t}),this.protocol.graph.send=(e,t=!1)=>{const r=e.name||e.properties.id,{properties:n,nodes:o,edges:i,initializers:a,inports:s,outports:c}=e;return this.protocol.graph.clear({id:r,name:e.name,main:t,library:n.library||this.definition.namespace,icon:n.icon||"",description:n.description||""}).then(()=>Promise.all(o.map(e=>this.protocol.graph.addnode({id:e.id,component:e.component,metadata:e.metadata,graph:r})))).then(()=>Promise.all(i.map(e=>this.protocol.graph.addedge({src:e.from,tgt:e.to,metadata:e.metadata,graph:r})))).then(()=>Promise.all(a.map(e=>this.protocol.graph.addinitial({src:e.from,tgt:e.to,metadata:e.metadata,graph:r})))).then(()=>Promise.all(Object.keys(s).map(e=>this.protocol.graph.addinport({public:e,node:s[e].process,port:s[e].port,graph:r})))).then(()=>Promise.all(Object.keys(c).map(e=>this.protocol.graph.addoutport({public:e,node:c[e].process,port:c[e].port,graph:r})))).then(()=>e)}}prepareAdapter(e){if(this.adapter)return;const t=Number.parseFloat(e);if(!(t<=.9))throw new Error("Unsupported FBP protocol version "+e);this.adapter=d(this,t)}}e.exports=(e,t={})=>new Promise((r,o)=>{p("/definition/",e).then(()=>{const i=e;i.protocol=i.protocol||s(i.address),i.protocol?n.transports[i.protocol]?r(new h(i,t)):o(new Error("Unsupported FBP transport "+i.protocol)):o(new Error("Runtime connection protocol is required"))},o)})},function(e,t){var r=1e3,n=6e4,o=60*n,i=24*o;function a(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===s&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return a(e,t,i,"day");if(t>=o)return a(e,t,o,"hour");if(t>=n)return a(e,t,n,"minute");if(t>=r)return a(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var n=r(34),o=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return o(e,t,r)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=a),a.prototype=Object.create(o.prototype),i(o,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=o(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,r){"use strict";(function(t,n){var o;e.exports=S,S.ReadableState=_;r(11).EventEmitter;var i=function(e,t){return e.listeners(t).length},a=r(122),s=r(34).Buffer,c=t.Uint8Array||function(){};var u,p=r(271);u=p&&p.debuglog?p.debuglog("stream"):function(){};var l,d,h,f=r(272),m=r(123),g=r(124).getHighWaterMark,y=r(48).codes,v=y.ERR_INVALID_ARG_TYPE,b=y.ERR_STREAM_PUSH_AFTER_EOF,w=y.ERR_METHOD_NOT_IMPLEMENTED,x=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(58)(S,a);var E=m.errorOrDestroy,k=["error","close","destroy","pause","resume"];function _(e,t,n){o=o||r(49),e=e||{},"boolean"!=typeof n&&(n=t instanceof o),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",n),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(l||(l=r(126).StringDecoder),this.decoder=new l(e.encoding),this.encoding=e.encoding)}function S(e){if(o=o||r(49),!(this instanceof S))return new S(e);var t=this instanceof o;this._readableState=new _(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function C(e,t,r,n,o){u("readableAddChunk",t);var i,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?A(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,O(e)))}(e,a);else if(o||(i=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new v("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(a,t)),i)E(e,i);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)a.endEmitted?E(e,new x):P(e,a,t,!0);else if(a.ended)E(e,new b);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?P(e,a,t,!1):j(e,a)):P(e,a,t,!1)}else n||(a.reading=!1,j(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function P(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&A(e)),j(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=m.destroy,S.prototype._undestroy=m.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),C(this,e,t,!1,r)},S.prototype.unshift=function(e){return C(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){l||(l=r(126).StringDecoder);var t=new l(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,o="";null!==n;)o+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==o&&this._readableState.buffer.push(o),this._readableState.length=o.length,this};function D(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=1073741824?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function A(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(O,e))}function O(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,R(e)}function j(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(T,e,t))}function T(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(u("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function F(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function I(e){u("readable nexttick read 0"),e.read(0)}function N(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function L(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(M,t,e))}function M(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function q(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):A(this),null;if(0===(e=D(e,t))&&t.ended)return 0===t.length&&L(this),null;var n,o=t.needReadable;return u("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",o=!0),t.ended||t.reading?u("reading or ended",o=!1):o&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=D(r,t))),null===(n=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&L(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){E(this,new w("_read()"))},S.prototype.pipe=function(e,t){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,u("pipe count=%d opts=%j",o.pipesCount,t);var a=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?c:g;function s(t,n){u("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,u("cleanup"),e.removeListener("close",f),e.removeListener("finish",m),e.removeListener("drain",p),e.removeListener("error",h),e.removeListener("unpipe",s),r.removeListener("end",c),r.removeListener("end",g),r.removeListener("data",d),l=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||p())}function c(){u("onend"),e.end()}o.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",s);var p=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,R(e))}}(r);e.on("drain",p);var l=!1;function d(t){u("ondata");var n=e.write(t);u("dest.write",n),!1===n&&((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==q(o.pipes,e))&&!l&&(u("false write response, pause",o.awaitDrain),o.awaitDrain++),r.pause())}function h(t){u("onerror",t),g(),e.removeListener("error",h),0===i(e,"error")&&E(e,t)}function f(){e.removeListener("finish",m),g()}function m(){u("onfinish"),e.removeListener("close",f),g()}function g(){u("unpipe"),r.unpipe(e)}return r.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",h),e.once("close",f),e.once("finish",m),e.emit("pipe",r),o.flowing||(u("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<o;i++)n[i].emit("unpipe",this,{hasUnpiped:!1});return this}var a=q(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t),o=this._readableState;return"data"===e?(o.readableListening=this.listenerCount("readable")>0,!1!==o.flowing&&this.resume()):"readable"===e&&(o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.flowing=!1,o.emittedReadable=!1,u("on readable",o.length,o.reading),o.length?A(this):o.reading||n.nextTick(I,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(F,this),r},S.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(F,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(N,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var o in e.on("end",(function(){if(u("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(o){(u("wrapped data"),r.decoder&&(o=r.decoder.write(o)),r.objectMode&&null==o)||(r.objectMode||o&&o.length)&&(t.push(o)||(n=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));for(var i=0;i<k.length;i++)e.on(k[i],this.emit.bind(this,k[i]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=r(275)),d(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=B,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(e,t){return void 0===h&&(h=r(276)),h(S,e,t)})}).call(this,r(26),r(13))},function(e,t,r){e.exports=r(11).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){o(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,i){var a=this,s=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return s||c?(i?i(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(o,this,e)):t.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!i&&e?a._writableState?a._writableState.errorEmitted?t.nextTick(n,a):(a._writableState.errorEmitted=!0,t.nextTick(r,a,e)):t.nextTick(r,a,e):i?(t.nextTick(n,a),i(e)):t.nextTick(n,a)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(13))},function(e,t,r){"use strict";var n=r(48).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,o){var i=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,o,r);if(null!=i){if(!isFinite(i)||Math.floor(i)!==i||i<0)throw new n(o?r:"highWaterMark",i);return Math.floor(i)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var o=n.callback;t.pendingcb--,o(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var i;e.exports=S,S.WritableState=_;var a={deprecate:r(274)},s=r(122),c=r(34).Buffer,u=t.Uint8Array||function(){};var p,l=r(123),d=r(124).getHighWaterMark,h=r(48).codes,f=h.ERR_INVALID_ARG_TYPE,m=h.ERR_METHOD_NOT_IMPLEMENTED,g=h.ERR_MULTIPLE_CALLBACK,y=h.ERR_STREAM_CANNOT_PIPE,v=h.ERR_STREAM_DESTROYED,b=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,x=h.ERR_UNKNOWN_ENCODING,E=l.errorOrDestroy;function k(){}function _(e,t,a){i=i||r(49),e=e||{},"boolean"!=typeof a&&(a=t instanceof i),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,o=r.sync,i=r.writecb;if("function"!=typeof i)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,o,i){--t.pendingcb,r?(n.nextTick(i,o),n.nextTick(j,e,t),e._writableState.errorEmitted=!0,E(e,o)):(i(o),e._writableState.errorEmitted=!0,E(e,o),j(e,t))}(e,r,o,t,i);else{var a=A(r)||e.destroyed;a||r.corked||r.bufferProcessing||!r.bufferedRequest||D(e,r),o?n.nextTick(P,e,r,a,i):P(e,r,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function S(e){var t=this instanceof(i=i||r(49));if(!t&&!p.call(S,this))return new S(e);this._writableState=new _(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function C(e,t,r,n,o,i,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):r?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function P(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),j(e,t)}function D(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),a=t.corkedRequestsFree;a.entry=r;for(var s=0,c=!0;r;)i[s]=r,r.isBuf||(c=!1),r=r.next,s+=1;i.allBuffers=c,C(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,p=r.encoding,l=r.callback;if(C(e,t,!1,t.objectMode?1:u.length,u,p,l),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function A(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),j(e,t)}))}function j(e,t){var r=A(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var o=e._readableState;(!o||o.autoDestroy&&o.endEmitted)&&e.destroy()}return r}r(58)(S,s),_.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(_.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===S&&(e&&e._writableState instanceof _)}})):p=function(e){return e instanceof this},S.prototype.pipe=function(){E(this,new y)},S.prototype.write=function(e,t,r){var o,i=this._writableState,a=!1,s=!i.objectMode&&(o=e,c.isBuffer(o)||o instanceof u);return s&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=k),i.ending?function(e,t){var r=new w;E(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,o){var i;return null===r?i=new b:"string"==typeof r||t.objectMode||(i=new f("chunk",["string","Buffer"],r)),!i||(E(e,i),n.nextTick(o,i),!1)}(this,i,e,r))&&(i.pendingcb++,a=function(e,t,r,n,o,i){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r));return t}(t,n,o);n!==a&&(r=!0,o="buffer",n=a)}var s=t.objectMode?1:n.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var p=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:o,isBuf:r,callback:i,next:null},p?p.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,s,n,o,i);return u}(this,i,s,e,t,r)),a},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||D(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new x(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new m("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var o=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),o.corked&&(o.corked=1,this.uncork()),o.ending||function(e,t,r){t.ending=!0,j(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,o,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=l.destroy,S.prototype._undestroy=l.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(26),r(13))},function(e,t,r){"use strict";var n=r(120).Buffer,o=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===o||!o(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=p,this.end=l,t=3;break;default:return this.write=d,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function p(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.StringDecoder=i,i.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},i.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},i.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var o=a(t[n]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--n<r||-2===o)return 0;if((o=a(t[n]))>=0)return o>0&&(e.lastNeed=o-2),o;if(--n<r||-2===o)return 0;if((o=a(t[n]))>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";e.exports=p;var n=r(48).codes,o=n.ERR_METHOD_NOT_IMPLEMENTED,i=n.ERR_MULTIPLE_CALLBACK,a=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,c=r(49);function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new i);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function p(e){if(!(this instanceof p))return new p(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function l(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}r(58)(p,c),p.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},p.prototype._transform=function(e,t,r){r(new o("_transform()"))},p.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var o=this._readableState;(n.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},p.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},p.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,r){const n=r(14)("fbp-protocol-client:signaller"),{WebSocket:o,EventEmitter:i}=r(66);e.exports=class extends i{constructor(e,t="client",r="wss://api.flowhub.io"){super(),this.signaller=r,this.role=t,this.id=e,this.connection=null,this.connecting=!1,this.buffer=[]}isConnected(){return!(!this.connection||this.connection.readyState!==this.connection.OPEN)}connect(){if(this.isConnected()||this.connecting)return;n(`${this.id} ${this.role} connecting`);const e=new o(this.signaller);this.connecting=!0,e.addEventListener("open",()=>{n(`${this.id} ${this.role} connected to ${this.signaller}`),this.connection=e,this.connecting=!1,this.emit("connected"),this.flush()}),e.addEventListener("message",e=>{this.handleMessage(e)}),e.addEventListener("close",()=>{this.connection=null,this.connecting=!1,this.emit("disconnected"),n(`${this.id} ${this.role} disconnected`)}),e.addEventListener("error",e=>{this.connection=null,this.connecting=!1,this.emit("error",e),n(`${this.id} ${this.role} error`,e)})}signal(e,t={}){const r={id:this.id};this.send(`/to|${e}|/signal|${JSON.stringify(r)}|${JSON.stringify(t)}`)}join(e){const t={id:this.id},r={room:e,id:this.id};this.send(`/announce|${JSON.stringify(t)}|${JSON.stringify(r)}`)}joinReply(e,t){const r={id:this.id},n={room:t,id:this.id};this.send(`/to|${e}|/announce|${JSON.stringify(r)}|${JSON.stringify(n)}`)}send(e){if(!this.isConnected())return n(`${this.id} ${this.role} push buffer`),void this.buffer.push(e);const[t]=e.split("|");n(`${this.id} ${this.role} send ${t}`),this.connection.send(e)}disconnect(){this.isConnected()&&(n(`${this.id} ${this.role} disconnecting`),this.connection.close())}handleMessage(e){const[t,r,o,...i]=e.data.split("|");if("/to"===t){if(r!==this.id)return void n(`${this.id} ${this.role} wrongly-addressed DM, was sent to ${r}`);const t=`${o}|${i.join("|")}`;return void this.handleMessage({...e,data:t})}n(`${this.id} ${this.role} recv ${t}`);let a=null;switch(a=o?JSON.parse(o):JSON.parse(r),t){case"/announce":this.emit("join",a,JSON.parse(r));break;case"/signal":this.emit("signal",a,JSON.parse(r));break;case"/roominfo":break;default:n(`${this.id} ${this.role} unhandled command ${t}`,a)}}flush(){this.buffer.length&&(n(`${this.id} ${this.role} flush buffer`,this.buffer.length),this.buffer.forEach(e=>{this.send(e)}),this.buffer=[])}}},function(e,t,r){"use strict";var n=r(50);e.exports=function(e){n.copy(e,this)}},function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,n="boolean"==typeof t.cycles&&t.cycles,o=t.cmp&&(r=t.cmp,function(e){return function(t,n){var o={key:t,value:e[t]},i={key:n,value:e[n]};return r(o,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,a;if(Array.isArray(t)){for(a="[",r=0;r<t.length;r++)r&&(a+=","),a+=e(t[r])||"null";return a+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=i.push(t)-1,c=Object.keys(t).sort(o&&o(t));for(a="",r=0;r<c.length;r++){var u=c[r],p=e(t[u]);p&&(a&&(a+=","),a+=JSON.stringify(u)+":"+p)}return i.splice(s,1),"{"+a+"}"}}(e)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n="",o=!0===e.schema.$async,i=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),a=e.self._getId(e.schema);if(e.opts.strictKeywords){var s=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(s){var c="unknown keyword: "+s;if("log"!==e.opts.strictKeywords)throw new Error(c);e.logger.warn(c)}}if(e.isTop&&(n+=" var validate = ",o&&(e.async=!0,n+="async "),n+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",a&&(e.opts.sourceCode||e.opts.processCode)&&(n+=" /*# sourceURL="+a+" */ ")),"boolean"==typeof e.schema||!i&&!e.schema.$ref){var u=e.level,p=e.dataLevel,l=e.schema["false schema"],d=e.schemaPath+e.util.getProperty("false schema"),h=e.errSchemaPath+"/false schema",f=!e.opts.allErrors,m="data"+(p||""),g="valid"+u;if(!1===e.schema){e.isTop?f=!0:n+=" var "+g+" = false; ",(W=W||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'boolean schema is false' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";var y=n;n=W.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n+=o?" return data; ":" validate.errors = null; return true; ":n+=" var "+g+" = true; ";return e.isTop&&(n+=" }; return validate; "),n}if(e.isTop){var v=e.isTop;u=e.level=0,p=e.dataLevel=0,m="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}n+=" var vErrors = null; ",n+=" var errors = 0;     ",n+=" if (rootData === undefined) rootData = data; "}else{u=e.level,m="data"+((p=e.dataLevel)||"");if(a&&(e.baseId=e.resolve.url(e.baseId,a)),o&&!e.async)throw new Error("async schema in sync schema");n+=" var errs_"+u+" = errors;"}g="valid"+u,f=!e.opts.allErrors;var w="",x="",E=e.schema.type,k=Array.isArray(E);if(E&&e.opts.nullable&&!0===e.schema.nullable&&(k?-1==E.indexOf("null")&&(E=E.concat("null")):"null"!=E&&(E=[E,"null"],k=!0)),k&&1==E.length&&(E=E[0],k=!1),e.schema.$ref&&i){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(i=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(n+=" "+e.RULES.all.$comment.code(e,"$comment")),E){if(e.opts.coerceTypes)var _=e.util.coerceToTypes(e.opts.coerceTypes,E);var S=e.RULES.types[E];if(_||k||!0===S||S&&!Q(S)){d=e.schemaPath+".type",h=e.errSchemaPath+"/type",d=e.schemaPath+".type",h=e.errSchemaPath+"/type";var C=k?"checkDataTypes":"checkDataType";if(n+=" if ("+e.util[C](E,m,e.opts.strictNumbers,!0)+") { ",_){var P="dataType"+u,D="coerced"+u;n+=" var "+P+" = typeof "+m+"; var "+D+" = undefined; ","array"==e.opts.coerceTypes&&(n+=" if ("+P+" == 'object' && Array.isArray("+m+") && "+m+".length == 1) { "+m+" = "+m+"[0]; "+P+" = typeof "+m+"; if ("+e.util.checkDataType(e.schema.type,m,e.opts.strictNumbers)+") "+D+" = "+m+"; } "),n+=" if ("+D+" !== undefined) ; ";var A=_;if(A)for(var O,j=-1,T=A.length-1;j<T;)"string"==(O=A[j+=1])?n+=" else if ("+P+" == 'number' || "+P+" == 'boolean') "+D+" = '' + "+m+"; else if ("+m+" === null) "+D+" = ''; ":"number"==O||"integer"==O?(n+=" else if ("+P+" == 'boolean' || "+m+" === null || ("+P+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==O&&(n+=" && !("+m+" % 1)"),n+=")) "+D+" = +"+m+"; "):"boolean"==O?n+=" else if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+D+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+D+" = true; ":"null"==O?n+=" else if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+D+" = null; ":"array"==e.opts.coerceTypes&&"array"==O&&(n+=" else if ("+P+" == 'string' || "+P+" == 'number' || "+P+" == 'boolean' || "+m+" == null) "+D+" = ["+m+"]; ");n+=" else {   ",(W=W||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",n+=k?""+E.join(","):""+E,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=k?""+E.join(","):""+E,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";y=n;n=W.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } if ("+D+" !== undefined) {  ";var F=p?"data"+(p-1||""):"parentData";n+=" "+m+" = "+D+"; ",p||(n+="if ("+F+" !== undefined)"),n+=" "+F+"["+(p?e.dataPathArr[p]:"parentDataProperty")+"] = "+D+"; } "}else{(W=W||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",n+=k?""+E.join(","):""+E,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=k?""+E.join(","):""+E,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";y=n;n=W.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}n+=" } "}}if(e.schema.$ref&&!i)n+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",f&&(n+=" } if (errors === ",n+=v?"0":"errs_"+u,n+=") { ",x+="}");else{var I=e.RULES;if(I)for(var N=-1,R=I.length-1;N<R;)if(Q(S=I[N+=1])){if(S.type&&(n+=" if ("+e.util.checkDataType(S.type,m,e.opts.strictNumbers)+") { "),e.opts.useDefaults)if("object"==S.type&&e.schema.properties){l=e.schema.properties;var B=Object.keys(l);if(B)for(var L,M=-1,q=B.length-1;M<q;){if(void 0!==(z=l[L=B[M+=1]]).default){var U=m+e.util.getProperty(L);if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+U;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else n+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(n+=" || "+U+" === null || "+U+" === '' "),n+=" ) "+U+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(z.default)+" ":n+=" "+JSON.stringify(z.default)+" ",n+="; "}}}else if("array"==S.type&&Array.isArray(e.schema.items)){var $=e.schema.items;if($){j=-1;for(var z,G=$.length-1;j<G;)if(void 0!==(z=$[j+=1]).default){U=m+"["+j+"]";if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+U;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else n+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(n+=" || "+U+" === null || "+U+" === '' "),n+=" ) "+U+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(z.default)+" ":n+=" "+JSON.stringify(z.default)+" ",n+="; "}}}var H=S.rules;if(H)for(var J,X=-1,V=H.length-1;X<V;)if(Y(J=H[X+=1])){var K=J.code(e,J.keyword,S.type);K&&(n+=" "+K+" ",f&&(w+="}"))}if(f&&(n+=" "+w+" ",w=""),S.type&&(n+=" } ",E&&E===S.type&&!_)){n+=" else { ";var W;d=e.schemaPath+".type",h=e.errSchemaPath+"/type";(W=W||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",n+=k?""+E.join(","):""+E,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=k?""+E.join(","):""+E,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";y=n;n=W.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } "}f&&(n+=" if (errors === ",n+=v?"0":"errs_"+u,n+=") { ",x+="}")}}function Q(e){for(var t=e.rules,r=0;r<t.length;r++)if(Y(t[r]))return!0}function Y(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,n=0;n<r.length;n++)if(void 0!==e.schema[r[n]])return!0}(t)}return f&&(n+=" "+x+" "),v?(o?(n+=" if (errors === 0) return data;           ",n+=" else throw new ValidationError(vErrors); "):(n+=" validate.errors = vErrors; ",n+=" return errors === 0;       "),n+=" }; return validate;"):n+=" var "+g+" = errors === errs_"+u+";",n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d=e.opts.$data&&s&&s.$data;d?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s;var h="maximum"==t,f=h?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[f],g=e.opts.$data&&m&&m.$data,y=h?"<":">",v=h?">":"<",b=void 0;if(!d&&"number"!=typeof s&&void 0!==s)throw new Error(t+" must be number");if(!g&&void 0!==m&&"number"!=typeof m&&"boolean"!=typeof m)throw new Error(f+" must be number or boolean");if(g){var w=e.util.getData(m.$data,a,e.dataPathArr),x="exclusive"+i,E="exclType"+i,k="exclIsNumber"+i,_="' + "+(P="op"+i)+" + '";o+=" var schemaExcl"+i+" = "+w+"; ",o+=" var "+x+"; var "+E+" = typeof "+(w="schemaExcl"+i)+"; if ("+E+" != 'boolean' && "+E+" != 'undefined' && "+E+" != 'number') { ";var S;b=f;(S=S||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(o+=" , message: '"+f+" should be boolean' "),e.opts.verbose&&(o+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var C=o;o=S.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+C+"]); ":o+=" validate.errors = ["+C+"]; return false; ":o+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } else if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" "+E+" == 'number' ? ( ("+x+" = "+n+" === undefined || "+w+" "+y+"= "+n+") ? "+l+" "+v+"= "+w+" : "+l+" "+v+" "+n+" ) : ( ("+x+" = "+w+" === true) ? "+l+" "+v+"= "+n+" : "+l+" "+v+" "+n+" ) || "+l+" !== "+l+") { var op"+i+" = "+x+" ? '"+y+"' : '"+y+"='; ",void 0===s&&(b=f,u=e.errSchemaPath+"/"+f,n=w,d=g)}else{_=y;if((k="number"==typeof m)&&d){var P="'"+_+"'";o+=" if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" ( "+n+" === undefined || "+m+" "+y+"= "+n+" ? "+l+" "+v+"= "+m+" : "+l+" "+v+" "+n+" ) || "+l+" !== "+l+") { "}else{k&&void 0===s?(x=!0,b=f,u=e.errSchemaPath+"/"+f,n=m,v+="="):(k&&(n=Math[h?"min":"max"](m,s)),m===(!k||n)?(x=!0,b=f,u=e.errSchemaPath+"/"+f,v+="="):(x=!1,_+="="));P="'"+_+"'";o+=" if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" "+l+" "+v+" "+n+" || "+l+" !== "+l+") { "}}b=b||t,(S=S||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+P+", limit: "+n+", exclusive: "+x+" } ",!1!==e.opts.messages&&(o+=" , message: 'should be "+_+" ",o+=d?"' + "+n:n+"'"),e.opts.verbose&&(o+=" , schema:  ",o+=d?"validate.schema"+c:""+s,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";C=o;return o=S.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+C+"]); ":o+=" validate.errors = ["+C+"]; return false; ":o+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } ",p&&(o+=" else { "),o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d=e.opts.$data&&s&&s.$data;if(d?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s,!d&&"number"!=typeof s)throw new Error(t+" must be number");o+="if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" "+l+".length "+("maxItems"==t?">":"<")+" "+n+") { ";var h=t,f=f||[];f.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(h||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT have ",o+="maxItems"==t?"more":"fewer",o+=" than ",o+=d?"' + "+n+" + '":""+s,o+=" items' "),e.opts.verbose&&(o+=" , schema:  ",o+=d?"validate.schema"+c:""+s,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var m=o;return o=f.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+m+"]); ":o+=" validate.errors = ["+m+"]; return false; ":o+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",p&&(o+=" else { "),o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d=e.opts.$data&&s&&s.$data;if(d?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s,!d&&"number"!=typeof s)throw new Error(t+" must be number");var h="maxLength"==t?">":"<";o+="if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===e.opts.unicode?o+=" "+l+".length ":o+=" ucs2length("+l+") ",o+=" "+h+" "+n+") { ";var f=t,m=m||[];m.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(f||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT be ",o+="maxLength"==t?"longer":"shorter",o+=" than ",o+=d?"' + "+n+" + '":""+s,o+=" characters' "),e.opts.verbose&&(o+=" , schema:  ",o+=d?"validate.schema"+c:""+s,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var g=o;return o=m.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+g+"]); ":o+=" validate.errors = ["+g+"]; return false; ":o+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",p&&(o+=" else { "),o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d=e.opts.$data&&s&&s.$data;if(d?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s,!d&&"number"!=typeof s)throw new Error(t+" must be number");o+="if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" Object.keys("+l+").length "+("maxProperties"==t?">":"<")+" "+n+") { ";var h=t,f=f||[];f.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(h||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT have ",o+="maxProperties"==t?"more":"fewer",o+=" than ",o+=d?"' + "+n+" + '":""+s,o+=" properties' "),e.opts.verbose&&(o+=" , schema:  ",o+=d?"validate.schema"+c:""+s,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var m=o;return o=f.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+m+"]); ":o+=" validate.errors = ["+m+"]; return false; ":o+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",p&&(o+=" else { "),o}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(325),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(26))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowtraceRecorder=t.trace=t.Flowtrace=void 0;const n=r(326);t.trace=n;var o=r(140);Object.defineProperty(t,"Flowtrace",{enumerable:!0,get:function(){return o.default}});var i=r(328);Object.defineProperty(t,"FlowtraceRecorder",{enumerable:!0,get:function(){return i.default}})},function(e,t,r){r(327),e.exports=self.fetch.bind(self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(141),o=r(41),i=r(11);class a extends i.EventEmitter{constructor(e,t=400){super(),this.bufferSize=t,this.graphs={},this.metadata={...e,start:new Date},this.mainGraph=null,this.clear(),this.subscribe()}clear(){this.events=new n(this.bufferSize)}subscribe(){this.on("event",(e,t,r)=>{let n;try{n=o(t)}catch(e){n="DATA"}this.events.enq({event:e,payload:n,graph:r,time:new Date})})}addGraph(e,t,r=!1){this.graphs[e]=t,r&&(this.mainGraph=e)}addNetworkPacket(e,t,r,n,o){this.emit("event",e,{...o,src:t,tgt:r},n)}addNetworkStarted(e){this.emit("event","network:started",{},e)}addNetworkStopped(e){this.emit("event","network:stopped",{},e)}addNetworkError(e,t){this.emit("event","network:error",t,e)}addNetworkProcessError(e,t){this.emit("event","network:processerror",t,e)}addNetworkIcon(e,t,r){this.emit("event","network:icon",{node:t,icon:r},e)}addNetworkOutput(e,t){this.emit("event","network:output",t,e)}toJSON(){const e=this.events.toarray().map(e=>{const[t,r]=e.event.split(":");return{protocol:t,command:r,payload:e.payload,graph:e.graph,time:e.time}});return e.reverse(),{header:{metadata:{...this.metadata,end:this.metadata.end||new Date},graphs:this.graphs,main:this.mainGraph},events:e}}}t.default=a},function(e,t){function r(e){if(!(this instanceof r))return new r(e);if("object"==typeof e&&Array.isArray(e._buffer)&&"number"==typeof e._capacity&&"number"==typeof e._first&&"number"==typeof e._size)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);else{if("number"!=typeof e||e%1!=0||e<1)throw new TypeError("Invalid capacity");this._buffer=new Array(e),this._capacity=e,this._first=0,this._size=0}}r.prototype={size:function(){return this._size},capacity:function(){return this._capacity},enq:function(e){this._first>0?this._first--:this._first=this._capacity-1,this._buffer[this._first]=e,this._size<this._capacity&&this._size++},push:function(e){this._size==this._capacity?(this._buffer[this._first]=e,this._first=(this._first+1)%this._capacity):(this._buffer[(this._first+this._size)%this._capacity]=e,this._size++)},deq:function(){if(0==this._size)throw new RangeError("dequeue on empty buffer");var e=this._buffer[(this._first+this._size-1)%this._capacity];return this._size--,e},pop:function(){return this.deq()},shift:function(){if(0==this._size)throw new RangeError("shift on empty buffer");var e=this._buffer[this._first];return this._first==this._capacity-1?this._first=0:this._first++,this._size--,e},get:function(e,t){if(0==this._size&&0==e&&(null==t||0==t))return[];if("number"!=typeof e||e%1!=0||e<0)throw new TypeError("Invalid start");if(e>=this._size)throw new RangeError("Index past end of buffer: "+e);if(null==t)return this._buffer[(this._first+e)%this._capacity];if("number"!=typeof t||t%1!=0||t<0)throw new TypeError("Invalid end");if(t>=this._size)throw new RangeError("Index past end of buffer: "+t);return this._first+e>=this._capacity&&(e-=this._capacity,t-=this._capacity),this._first+t<this._capacity?this._buffer.slice(this._first+e,this._first+t+1):this._buffer.slice(this._first+e,this._capacity).concat(this._buffer.slice(0,this._first+t+1-this._capacity))},toarray:function(){return 0==this._size?[]:this.get(0,this._size-1)}},e.exports=r},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryJournalStore=t.JournalStore=t.Journal=void 0;var u=r(11),p=r(41),l=r(143);t.JournalStore=l.default;var d=r(331);function h(e){var t=e.args;switch(e.cmd){case"addNode":return"".concat(t.id,"(").concat(t.component,")");case"removeNode":return"DEL ".concat(t.id,"(").concat(t.component,")");case"renameNode":return"RENAME ".concat(t.oldId," ").concat(t.newId);case"changeNode":return"META ".concat(t.id);case"addEdge":return"".concat(t.from.node," ").concat(t.from.port," -> ").concat(t.to.port," ").concat(t.to.node);case"removeEdge":return"".concat(t.from.node," ").concat(t.from.port," -X> ").concat(t.to.port," ").concat(t.to.node);case"changeEdge":return"META ".concat(t.from.node," ").concat(t.from.port," -> ").concat(t.to.port," ").concat(t.to.node);case"addInitial":return"'".concat(t.from.data,"' -> ").concat(t.to.port," ").concat(t.to.node);case"removeInitial":return"'".concat(t.from.data,"' -X> ").concat(t.to.port," ").concat(t.to.node);case"startTransaction":return">>> ".concat(e.rev,": ").concat(t.id);case"endTransaction":return"<<< ".concat(e.rev,": ").concat(t.id);case"changeProperties":return"PROPERTIES";case"addGroup":return"GROUP ".concat(t.name);case"renameGroup":return"RENAME GROUP ".concat(t.oldName," ").concat(t.newName);case"removeGroup":return"DEL GROUP ".concat(t.name);case"changeGroup":return"META GROUP ".concat(t.name);case"addInport":return"INPORT ".concat(t.name);case"removeInport":return"DEL INPORT ".concat(t.name);case"renameInport":return"RENAME INPORT ".concat(t.oldId," ").concat(t.newId);case"changeInport":return"META INPORT ".concat(t.name);case"addOutport":return"OUTPORT ".concat(t.name);case"removeOutport":return"DEL OUTPORT ".concat(t.name);case"renameOutport":return"RENAME OUTPORT ".concat(t.oldId," ").concat(t.newId);case"changeOutport":return"META OUTPORT ".concat(t.name);default:throw new Error("Unknown journal entry: ".concat(e.cmd))}}function f(e,t){var r={};return Object.keys(e).forEach((function(e){r[e]=null})),Object.keys(t).forEach((function(e){var n=t[e];r[e]=n})),r}t.MemoryJournalStore=d.default;var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,s,c=a(u);function u(e,t,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=c.call(this)).graph=e,n.entries=[],n.subscribed=!0,n.store=r||new d.default(n.graph),0===n.store.countTransactions()?(n.currentRevision=-1,n.startTransaction("initial",t||{}),n.graph.nodes.forEach((function(e){n.appendCommand("addNode",e)})),n.graph.edges.forEach((function(e){n.appendCommand("addEdge",e)})),n.graph.initializers.forEach((function(e){n.appendCommand("addInitial",e)})),Object.keys(n.graph.properties).length>0&&n.appendCommand("changeProperties",n.graph.properties),Object.keys(n.graph.inports).forEach((function(e){var t=n.graph.inports[e];n.appendCommand("addInport",{name:e,port:t})})),Object.keys(n.graph.outports).forEach((function(e){var t=n.graph.outports[e];n.appendCommand("addOutport",{name:e,port:t})})),n.graph.groups.forEach((function(e){n.appendCommand("addGroup",e)})),n.endTransaction("initial",t||{})):n.currentRevision=n.store.lastRevision,n.graph.on("addNode",(function(e){n.appendCommand("addNode",e)})),n.graph.on("removeNode",(function(e){n.appendCommand("removeNode",e)})),n.graph.on("renameNode",(function(e,t){var r={oldId:e,newId:t};n.appendCommand("renameNode",r)})),n.graph.on("changeNode",(function(e,t){n.appendCommand("changeNode",{id:e.id,new:e.metadata,old:t})})),n.graph.on("addEdge",(function(e){n.appendCommand("addEdge",e)})),n.graph.on("removeEdge",(function(e){n.appendCommand("removeEdge",e)})),n.graph.on("changeEdge",(function(e,t){n.appendCommand("changeEdge",{from:e.from,to:e.to,new:e.metadata,old:t})})),n.graph.on("addInitial",(function(e){n.appendCommand("addInitial",e)})),n.graph.on("removeInitial",(function(e){n.appendCommand("removeInitial",e)})),n.graph.on("changeProperties",(function(e,t){return n.appendCommand("changeProperties",{new:e,old:t})})),n.graph.on("addGroup",(function(e){return n.appendCommand("addGroup",e)})),n.graph.on("renameGroup",(function(e,t){return n.appendCommand("renameGroup",{oldName:e,newName:t})})),n.graph.on("removeGroup",(function(e){return n.appendCommand("removeGroup",e)})),n.graph.on("changeGroup",(function(e,t){return n.appendCommand("changeGroup",{name:e.name,new:e.metadata,old:t})})),n.graph.on("addExport",(function(e){return n.appendCommand("addExport",e)})),n.graph.on("removeExport",(function(e){return n.appendCommand("removeExport",e)})),n.graph.on("addInport",(function(e,t){return n.appendCommand("addInport",{name:e,port:t})})),n.graph.on("removeInport",(function(e,t){return n.appendCommand("removeInport",{name:e,port:t})})),n.graph.on("renameInport",(function(e,t){return n.appendCommand("renameInport",{oldId:e,newId:t})})),n.graph.on("changeInport",(function(e,t,r){return n.appendCommand("changeInport",{name:e,new:t.metadata,old:r})})),n.graph.on("addOutport",(function(e,t){return n.appendCommand("addOutport",{name:e,port:t})})),n.graph.on("removeOutport",(function(e,t){return n.appendCommand("removeOutport",{name:e,port:t})})),n.graph.on("renameOutport",(function(e,t){return n.appendCommand("renameOutport",{oldId:e,newId:t})})),n.graph.on("changeOutport",(function(e,t,r){return n.appendCommand("changeOutport",{name:e,new:t.metadata,old:r})})),n.graph.on("startTransaction",(function(e,t){n.startTransaction(e,t)})),n.graph.on("endTransaction",(function(e,t){n.endTransaction(e,t)})),n}return t=u,(n=[{key:"startTransaction",value:function(e,t){if(this.subscribed){if(this.entries.length>0)throw Error("Inconsistent @entries");this.currentRevision+=1,this.appendCommand("startTransaction",{id:e,metadata:t},this.currentRevision)}}},{key:"endTransaction",value:function(e,t){this.subscribed&&(this.appendCommand("endTransaction",{id:e,metadata:t},this.currentRevision),this.store.putTransaction(this.currentRevision,this.entries),this.entries=[])}},{key:"appendCommand",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.subscribed){var n={cmd:e,args:p(t),rev:r};this.entries.push(n)}}},{key:"executeEntry",value:function(e){var t=e.args;switch(e.cmd){case"addNode":this.graph.addNode(t.id,t.component);break;case"removeNode":this.graph.removeNode(t.id);break;case"renameNode":this.graph.renameNode(t.oldId,t.newId);break;case"changeNode":this.graph.setNodeMetadata(t.id,f(t.old,t.new));break;case"addEdge":this.graph.addEdge(t.from.node,t.from.port,t.to.node,t.to.port);break;case"removeEdge":this.graph.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port);break;case"changeEdge":this.graph.setEdgeMetadata(t.from.node,t.from.port,t.to.node,t.to.port,f(t.old,t.new));break;case"addInitial":"number"==typeof t.to.index?this.graph.addInitialIndex(t.from.data,t.to.node,t.to.port,t.to.index,t.metadata):this.graph.addInitial(t.from.data,t.to.node,t.to.port,t.metadata);break;case"removeInitial":this.graph.removeInitial(t.to.node,t.to.port);break;case"startTransaction":case"endTransaction":break;case"changeProperties":this.graph.setProperties(t.new);break;case"addGroup":this.graph.addGroup(t.name,t.nodes,t.metadata);break;case"renameGroup":this.graph.renameGroup(t.oldName,t.newName);break;case"removeGroup":this.graph.removeGroup(t.name);break;case"changeGroup":this.graph.setGroupMetadata(t.name,f(t.old,t.new));break;case"addInport":this.graph.addInport(t.name,t.port.process,t.port.port,t.port.metadata);break;case"removeInport":this.graph.removeInport(t.name);break;case"renameInport":this.graph.renameInport(t.oldId,t.newId);break;case"changeInport":this.graph.setInportMetadata(t.name,f(t.old,t.new));break;case"addOutport":this.graph.addOutport(t.name,t.port.process,t.port.port,t.port.metadata(t.name));break;case"removeOutport":this.graph.removeOutport(t.name);break;case"renameOutport":this.graph.renameOutport(t.oldId,t.newId);break;case"changeOutport":this.graph.setOutportMetadata(t.name,f(t.old,t.new));break;default:throw new Error("Unknown journal entry: ".concat(e.cmd))}}},{key:"executeEntryInversed",value:function(e){var t=e.args;switch(e.cmd){case"addNode":this.graph.removeNode(t.id);break;case"removeNode":this.graph.addNode(t.id,t.component);break;case"renameNode":this.graph.renameNode(t.newId,t.oldId);break;case"changeNode":this.graph.setNodeMetadata(t.id,f(t.new,t.old));break;case"addEdge":this.graph.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port);break;case"removeEdge":this.graph.addEdge(t.from.node,t.from.port,t.to.node,t.to.port);break;case"changeEdge":this.graph.setEdgeMetadata(t.from.node,t.from.port,t.to.node,t.to.port,f(t.new,t.old));break;case"addInitial":this.graph.removeInitial(t.to.node,t.to.port);break;case"removeInitial":"number"==typeof t.to.index?this.graph.addInitialIndex(t.from.data,t.to.node,t.to.port,t.to.index,t.metadata):this.graph.addInitial(t.from.data,t.to.node,t.to.port,t.metadata);break;case"startTransaction":case"endTransaction":break;case"changeProperties":this.graph.setProperties(t.old);break;case"addGroup":this.graph.removeGroup(t.name);break;case"renameGroup":this.graph.renameGroup(t.newName,t.oldName);break;case"removeGroup":this.graph.addGroup(t.name,t.nodes,t.metadata);break;case"changeGroup":this.graph.setGroupMetadata(t.name,f(t.new,t.old));break;case"addInport":this.graph.removeInport(t.name);break;case"removeInport":this.graph.addInport(t.name,t.port.process,t.port.port,t.port.metadata);break;case"renameInport":this.graph.renameInport(t.newId,t.oldId);break;case"changeInport":this.graph.setInportMetadata(t.name,f(t.new,t.old));break;case"addOutport":this.graph.removeOutport(t.name);break;case"removeOutport":this.graph.addOutport(t.name,t.port.process,t.port.port,t.port.metadata);break;case"renameOutport":this.graph.renameOutport(t.newId,t.oldId);break;case"changeOutport":this.graph.setOutportMetadata(t.name,f(t.new,t.old));break;default:throw new Error("Unknown journal entry: ".concat(e.cmd))}}},{key:"moveToRevision",value:function(e){var t=this;if(e!==this.currentRevision){if(this.subscribed=!1,e>this.currentRevision)for(var r=this.currentRevision+1,n=r,o=e,i=r<=o;i?n<=o:n>=o;i?n+=1:n-=1)this.store.fetchTransaction(n).forEach((function(e){t.executeEntry(e)}));else for(var a=this.currentRevision,s=e+1;a>=s;a-=1){var c=this.store.fetchTransaction(a).slice(0);c.reverse(),c.forEach((function(e){t.executeEntryInversed(e)}))}this.currentRevision=e,this.subscribed=!0}}},{key:"undo",value:function(){this.canUndo()&&this.moveToRevision(this.currentRevision-1)}},{key:"canUndo",value:function(){return this.currentRevision>0}},{key:"redo",value:function(){this.canRedo()&&this.moveToRevision(this.currentRevision+1)}},{key:"canRedo",value:function(){return this.currentRevision<this.store.lastRevision}},{key:"toPrettyString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=t||this.store.lastRevision,n=[],o=e,i=r,a=e<=i;a?o<i:o>i;a?o+=1:o-=1){var s=this.store.fetchTransaction(o);s.forEach((function(e){n.push(h(e))}))}return n.join("\n")}},{key:"toJSON",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t||this.store.lastRevision,n=[],o=e,i=r;o<i;o+=1){var a=this.store.fetchTransaction(o);a.forEach((function(e){n.push(h(e))}))}return n}},{key:"save",value:function(e,t){var n=JSON.stringify(this.toJSON(),null,4);(0,r(27).writeFile)("".concat(e,".json"),n,"utf-8",t)}}])&&o(t.prototype,n),s&&o(t,s),u}(u.EventEmitter);t.Journal=m},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).graph=e,t.lastRevision=0,t}return t=c,(r=[{key:"countTransactions",value:function(){return 0}},{key:"putTransaction",value:function(e,t){e>this.lastRevision&&(this.lastRevision=e),this.emit("transaction",e,t)}},{key:"fetchTransaction",value:function(e){return[]}}])&&o(t.prototype,r),n&&o(t,n),c}(r(11).EventEmitter);t.default=u},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeResolveTheirs=t.equivalent=t.loadFile=t.loadFBP=t.loadJSON=t.createGraph=t.Graph=void 0;var h=r(11),f=r(41),m=r(332),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var t,n,o,a=p(l);function l(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(this,l),(e=a.call(this)).setMaxListeners(0),e.name=t,e.properties={},e.nodes=[],e.edges=[],e.initializers=[],e.inports={},e.outports={},e.groups=[],e.transaction={id:null,depth:0},e.caseSensitive=r.caseSensitive||!1,e}return t=l,(n=[{key:"getPortName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.caseSensitive?e:e.toLowerCase()}},{key:"startTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.transaction.id)throw Error("Nested transactions not supported");this.transaction.id=e,this.transaction.depth=1,this.emit("startTransaction",e,t)}},{key:"endTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",e,t)}},{key:"checkTransactionStart",value:function(){this.transaction.id?"implicit"===this.transaction.id&&(this.transaction.depth+=1):this.startTransaction("implicit")}},{key:"checkTransactionEnd",value:function(){"implicit"===this.transaction.id&&(this.transaction.depth-=1),0===this.transaction.depth&&this.endTransaction("implicit")}},{key:"setProperties",value:function(e){var t=this;this.checkTransactionStart();var r=f(this.properties);Object.keys(e).forEach((function(r){var n=e[r];t.properties[r]=n})),this.emit("changeProperties",this.properties,r),this.checkTransactionEnd()}},{key:"addInport",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.getNode(t)){var o=this.getPortName(e);this.checkTransactionStart(),this.inports[o]={process:t,port:this.getPortName(r),metadata:n},this.emit("addInport",o,this.inports[o]),this.checkTransactionEnd()}}},{key:"removeInport",value:function(e){var t=this.getPortName(e);if(this.inports[t]){this.checkTransactionStart();var r=this.inports[t];this.setInportMetadata(t,{}),delete this.inports[t],this.emit("removeInport",t,r),this.checkTransactionEnd()}}},{key:"renameInport",value:function(e,t){var r=this.getPortName(e),n=this.getPortName(t);this.inports[r]&&n!==r&&(this.checkTransactionStart(),this.inports[n]=this.inports[r],delete this.inports[r],this.emit("renameInport",r,n),this.checkTransactionEnd())}},{key:"setInportMetadata",value:function(e,t){var r=this,n=this.getPortName(e);if(this.inports[n]){this.checkTransactionStart(),this.inports[n].metadata||(this.inports[n].metadata={});var o=f(this.inports[n].metadata);Object.keys(t).forEach((function(e){var o=t[e],i=r.inports[n].metadata;i&&(null!=o?i[e]=o:delete i[e])})),this.emit("changeInport",n,this.inports[n],o,t),this.checkTransactionEnd()}}},{key:"addOutport",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.getNode(t)){var o=this.getPortName(e);this.checkTransactionStart(),this.outports[o]={process:t,port:this.getPortName(r),metadata:n},this.emit("addOutport",o,this.outports[o]),this.checkTransactionEnd()}}},{key:"removeOutport",value:function(e){var t=this.getPortName(e);if(this.outports[t]){this.checkTransactionStart();var r=this.outports[t];this.setOutportMetadata(t,{}),delete this.outports[t],this.emit("removeOutport",t,r),this.checkTransactionEnd()}}},{key:"renameOutport",value:function(e,t){var r=this.getPortName(e),n=this.getPortName(t);this.outports[r]&&(this.checkTransactionStart(),this.outports[n]=this.outports[r],delete this.outports[r],this.emit("renameOutport",r,n),this.checkTransactionEnd())}},{key:"setOutportMetadata",value:function(e,t){var r=this,n=this.getPortName(e);if(this.outports[n]){this.checkTransactionStart();var o=f(this.outports[n].metadata);this.outports[n].metadata||(this.outports[n].metadata={}),Object.keys(t).forEach((function(e){var o=t[e],i=r.outports[n].metadata;i&&(null!=o?i[e]=o:delete i[e])})),this.emit("changeOutport",n,this.outports[n],o,t),this.checkTransactionEnd()}}},{key:"addGroup",value:function(e,t,r){this.checkTransactionStart();var n={name:e,nodes:t,metadata:r};return this.groups.push(n),this.emit("addGroup",n),this.checkTransactionEnd(),n}},{key:"renameGroup",value:function(e,t){var r=this;this.checkTransactionStart(),this.groups.forEach((function(n){n&&n.name===e&&(n.name=t,r.emit("renameGroup",e,t))})),this.checkTransactionEnd()}},{key:"removeGroup",value:function(e){var t=this;this.checkTransactionStart(),this.groups=this.groups.filter((function(r){return!(!r||r.name===e&&(t.setGroupMetadata(r.name,{}),t.emit("removeGroup",r),1))})),this.checkTransactionEnd()}},{key:"setGroupMetadata",value:function(e,t){var r=this;this.checkTransactionStart(),this.groups.forEach((function(n){if(n&&n.name===e){var o=f(n.metadata);Object.keys(t).forEach((function(e){var r=t[e],o=n;o.metadata&&(null!=r?o.metadata[e]=r:delete o.metadata[e])})),r.emit("changeGroup",n,o,t)}})),this.checkTransactionEnd()}},{key:"addNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.checkTransactionStart();var n={id:e,component:t,metadata:r};return this.nodes.push(n),this.emit("addNode",n),this.checkTransactionEnd(),n}},{key:"removeNode",value:function(e){var t=this,r=this.getNode(e);r&&(this.checkTransactionStart(),this.edges.forEach((function(e){e.from.node!==r.id&&e.to.node!==r.id||t.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port)})),this.initializers.forEach((function(e){e.to.node===r.id&&t.removeInitial(e.to.node,e.to.port)})),Object.keys(this.inports).forEach((function(r){t.inports[r].process===e&&t.removeInport(r)})),Object.keys(this.outports).forEach((function(r){t.outports[r].process===e&&t.removeOutport(r)})),this.groups.forEach((function(r){if(r){var n=r.nodes.indexOf(e);-1!==n&&(r.nodes.splice(n,1),0===r.nodes.length&&t.removeGroup(r.name))}})),this.setNodeMetadata(e,{}),this.nodes=this.nodes.filter((function(e){return e!==r})),this.emit("removeNode",r),this.checkTransactionEnd())}},{key:"getNode",value:function(e){var t=this.nodes.find((function(t){return t&&t.id===e}));return t||null}},{key:"renameNode",value:function(e,t){var r=this;this.checkTransactionStart();var n=this.getNode(e);n&&(n.id=t,this.edges.forEach((function(r){var n=r;n&&(n.from.node===e&&(n.from.node=t),n.to.node===e&&(n.to.node=t))})),this.initializers.forEach((function(r){var n=r;n&&n.to.node===e&&(n.to.node=t)})),Object.keys(this.inports).forEach((function(n){var o=r.inports[n];o.process===e&&(o.process=t)})),Object.keys(this.outports).forEach((function(n){var o=r.outports[n];o.process===e&&(o.process=t)})),this.groups.forEach((function(r){if(r){var n=r.nodes.indexOf(e);-1!==n&&(r.nodes[n]=t)}})),this.emit("renameNode",e,t),this.checkTransactionEnd())}},{key:"setNodeMetadata",value:function(e,t){var r=this.getNode(e);if(r){this.checkTransactionStart(),r.metadata||(r.metadata={});var n=f(r.metadata);Object.keys(t).forEach((function(e){if(r.metadata){var n=t[e];null!=n?r.metadata[e]=n:delete r.metadata[e]}})),this.emit("changeNode",r,n,t),this.checkTransactionEnd()}}},{key:"addEdge",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=this.getPortName(t),a=this.getPortName(n);if(this.edges.some((function(t){return t.from.node===e&&t.from.port===i&&t.to.node===r&&t.to.port===a})))return null;if(!this.getNode(e))return null;if(!this.getNode(r))return null;this.checkTransactionStart();var s={from:{node:e,port:i},to:{node:r,port:a},metadata:o};return this.edges.push(s),this.emit("addEdge",s),this.checkTransactionEnd(),s}},{key:"addEdgeIndex",value:function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=this.getPortName(t),c=this.getPortName(o),u=null===i?void 0:i,p=null===r?void 0:r;if(this.edges.some((function(t){return t.from.node===e&&t.from.port===s&&t.from.index===p&&t.to.node===n&&t.to.port===c&&t.to.index===u})))return null;if(!this.getNode(e))return null;if(!this.getNode(n))return null;this.checkTransactionStart();var l={from:{node:e,port:s,index:p},to:{node:n,port:c,index:u},metadata:a};return this.edges.push(l),this.emit("addEdge",l),this.checkTransactionEnd(),l}},{key:"removeEdge",value:function(e,t,r,n){var o=this;if(this.getEdge(e,t,r,n)){this.checkTransactionStart();var i=this.getPortName(t),a=this.getPortName(n);this.edges=this.edges.filter((function(t){if(r&&a){if(t.from.node===e&&t.from.port===i&&t.to.node===r&&t.to.port===a)return o.setEdgeMetadata(t.from.node,t.from.port,t.to.node,t.to.port,{}),o.emit("removeEdge",t),!1}else if(t.from.node===e&&t.from.port===i||t.to.node===e&&t.to.port===i)return o.setEdgeMetadata(t.from.node,t.from.port,t.to.node,t.to.port,{}),o.emit("removeEdge",t),!1;return!0})),this.checkTransactionEnd()}}},{key:"getEdge",value:function(e,t,r,n){var o=this.getPortName(t),i=this.getPortName(n),a=this.edges.find((function(t){return!!t&&t.from.node===e&&t.from.port===o&&t.to.node===r&&t.to.port===i}));return a||null}},{key:"setEdgeMetadata",value:function(e,t,r,n,o){var i=this.getEdge(e,t,r,n);if(i){this.checkTransactionStart(),i.metadata||(i.metadata={});var a=f(i.metadata);Object.keys(o).forEach((function(e){var t=o[e];i.metadata||(i.metadata={}),null!==t?i.metadata[e]=t:delete i.metadata[e]})),this.emit("changeEdge",i,a,o),this.checkTransactionEnd()}}},{key:"addInitial",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.getNode(t))return null;var o=this.getPortName(r);this.checkTransactionStart();var i={from:{data:e},to:{node:t,port:o},metadata:n};return this.initializers.push(i),this.emit("addInitial",i),this.checkTransactionEnd(),i}},{key:"addInitialIndex",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!this.getNode(t))return null;var i=null===n?void 0:n,a=this.getPortName(r);this.checkTransactionStart();var s={from:{data:e},to:{node:t,port:a,index:i},metadata:o};return this.initializers.push(s),this.emit("addInitial",s),this.checkTransactionEnd(),s}},{key:"addGraphInitial",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.inports[t];return n?this.addInitial(e,n.process,n.port,r):null}},{key:"addGraphInitialIndex",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=this.inports[t];return o?this.addInitialIndex(e,o.process,o.port,r,n):null}},{key:"removeInitial",value:function(e,t){var r=this,n=this.getPortName(t);this.checkTransactionStart(),this.initializers=this.initializers.filter((function(t){return t.to.node!==e||t.to.port!==n||(r.emit("removeInitial",t),!1)})),this.checkTransactionEnd()}},{key:"removeGraphInitial",value:function(e){var t=this.inports[e];t&&this.removeInitial(t.process,t.port)}},{key:"toDOT",value:function(){var e=function(e){return e.replace(/\./g,"")},t=function(e){return'"'.concat(function(e){return e.replace(/"/g,'\\"')}(e),'"')},r="digraph {\n";return this.nodes.forEach((function(e){r+="    ".concat(t(e.id)," [label=").concat(t(e.id)," shape=box]\n")})),this.initializers.forEach((function(n,o){var i;i="function"==typeof n.from.data?"Function":JSON.stringify(n.from.data),r+="    data".concat(o," [label=").concat(t(i)," shape=plaintext]\n"),r+="    data".concat(o," -> ").concat(t(n.to.node),"[headlabel=").concat(e(n.to.port)," labelfontcolor=blue labelfontsize=8.0]\n")})),this.edges.forEach((function(n){r+="    ".concat(t(n.from.node)," -> ").concat(t(n.to.node),"[taillabel=").concat(e(n.from.port)," headlabel=").concat(e(n.to.port)," labelfontcolor=blue labelfontsize=8.0]\n")})),r+="}"}},{key:"toYUML",value:function(){var e=[];return this.initializers.forEach((function(t){e.push("(start)[".concat(t.to.port,"]->(").concat(t.to.node,")"))})),this.edges.forEach((function(t){e.push("(".concat(t.from.node,")[").concat(t.from.port,"]->(").concat(t.to.node,")"))})),e.join(",")}},{key:"toJSON",value:function(){var e={caseSensitive:this.caseSensitive,properties:i({name:this.name},this.properties),inports:i({},this.inports),outports:i({},this.outports),groups:this.groups.map((function(e){var t={name:e.name,nodes:e.nodes};return e.metadata&&Object.keys(e.metadata).length&&(t.metadata=i({},e.metadata)),t})),processes:{},connections:[]};return e&&e.properties&&(delete e.properties.baseDir,delete e.properties.componentLoader),this.nodes.forEach((function(t){e.processes||(e.processes={}),e.processes[t.id]={component:t.component},t.metadata&&(e.processes[t.id].metadata=i({},t.metadata))})),this.edges.forEach((function(t){var r={src:{process:t.from.node,port:t.from.port,index:t.from.index},tgt:{process:t.to.node,port:t.to.port,index:t.to.index}};t.metadata&&Object.keys(t.metadata).length&&(r.metadata=i({},t.metadata)),e.connections||(e.connections=[]),e.connections.push(r)})),this.initializers.forEach((function(t){var r={data:t.from.data,tgt:{process:t.to.node,port:t.to.port,index:t.to.index}};t.metadata&&Object.keys(t.metadata).length&&(r.metadata=i({},t.metadata)),e.connections||(e.connections=[]),e.connections.push(r)})),e}},{key:"save",value:function(e,t){if(m.isBrowser())t(new Error("Saving graphs not supported on browser"));else{var n=JSON.stringify(this.toJSON(),null,4),o=e;o.match(/\.json$/)||(o="".concat(e,".json")),r(27).writeFile(o,n,"utf-8",(function(e){e?t(e):t(null,o)}))}}}])&&c(t.prototype,n),o&&c(t,o),l}(h.EventEmitter);function y(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(r="string"==typeof e?JSON.parse(e):f(e)).properties||(r.properties={}),r.processes||(r.processes={}),r.connections||(r.connections=[]);var o=new g(r.properties.name,{caseSensitive:r.caseSensitive||!1});o.startTransaction("loadJSON",n);var i={};return Object.keys(r.properties).forEach((function(e){if("name"!==e&&r.properties){var t=r.properties[e];i[e]=t}})),o.setProperties(i),Object.keys(r.processes).forEach((function(e){if(r.processes){var t=r.processes[e];t.metadata||(t.metadata={}),o.addNode(e,t.component,t.metadata)}})),r.connections.forEach((function(e){var t=e.metadata?e.metadata:{};void 0===e.data?void 0!==e.src&&("number"!=typeof e.src.index&&"number"!=typeof e.tgt.index?o.addEdge(e.src.process,o.getPortName(e.src.port),e.tgt.process,o.getPortName(e.tgt.port),t):o.addEdgeIndex(e.src.process,o.getPortName(e.src.port),e.src.index,e.tgt.process,o.getPortName(e.tgt.port),e.tgt.index,t)):"number"==typeof e.tgt.index?o.addInitialIndex(e.data,e.tgt.process,o.getPortName(e.tgt.port),e.tgt.index,t):o.addInitial(e.data,e.tgt.process,o.getPortName(e.tgt.port),t)})),r.inports&&Object.keys(r.inports).forEach((function(e){if(r.inports&&r.inports[e]){var t=r.inports[e];o.addInport(e,t.process,o.getPortName(t.port),t.metadata||{})}})),r.outports&&Object.keys(r.outports).forEach((function(e){if(r.outports&&r.outports[e]){var t=r.outports[e];o.addOutport(e,t.process,o.getPortName(t.port),t.metadata||{})}})),r.groups&&r.groups.forEach((function(e){o.addGroup(e.name,e.nodes,e.metadata||{})})),o.endTransaction("loadJSON"),t(null,o)}function v(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{n=r(64).parse(e,{caseSensitive:i})}catch(e){return t(e)}return y(n,t,o)}function b(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(200!==r.status&&t(new Error("Failed to load ".concat(e,": HTTP ").concat(r.status))),t(null,r.responseText))},r.open("GET",e,!0),r.send()}t.Graph=g,t.createGraph=function(e,t){return new g(e,t)},t.loadJSON=y,t.loadFBP=v,t.loadFile=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];m.isBrowser()?b(e,(function(r,o){r?t(r):o?"fbp"!==e.split(".").pop()?y(o,t,n):v(o,t,n):t(new Error("No data received"))})):r(27).readFile(e,"utf-8",(function(r,n){r?t(r):"fbp"!==e.split(".").pop()?y(n,t,{}):v(n,t,{},o)}))},t.mergeResolveTheirs=function(e,t){var r;(r=e).groups.reverse(),r.groups.forEach((function(e){null!=e&&r.removeGroup(e.name)})),Object.keys(r.outports).forEach((function(e){r.removeOutport(e)})),Object.keys(r.inports).forEach((function(e){r.removeInport(e)})),r.setProperties({}),r.initializers.reverse(),r.initializers.forEach((function(e){r.removeInitial(e.to.node,e.to.port)})),r.edges.reverse(),r.edges.forEach((function(e){r.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port)})),r.nodes.reverse(),r.nodes.forEach((function(e){r.removeNode(e.id)})),t.nodes.forEach((function(t){e.addNode(t.id,t.component,t.metadata)})),t.edges.forEach((function(t){e.addEdge(t.from.node,t.from.port,t.to.node,t.to.port,t.metadata)})),t.initializers.forEach((function(t){"number"!=typeof t.to.index?e.addInitial(t.from.data,t.to.node,t.to.port,t.metadata||{}):e.addInitialIndex(t.from.data,t.to.node,t.to.port,t.to.index,t.metadata||{})})),e.setProperties(t.properties),Object.keys(t.inports).forEach((function(r){var n=t.inports[r];e.addInport(r,n.process,n.port,n.metadata||{})})),Object.keys(t.outports).forEach((function(r){var n=t.outports[r];e.addOutport(r,n.process,n.port,n.metadata||{})})),t.groups.forEach((function(t){e.addGroup(t.name,t.nodes,t.metadata||{})}))},t.equivalent=function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},function(e,t,r){try{e.exports={base:r(333),testcase:r(334),testsuite:r(335),testsuites:r(336),expectations:r(337),testsfile:r(338)}}catch(e){console.log("fbp-spec: Failed to load schemas",e)}},function(e,t,r){"use strict";var n=r(339);e.exports=n},function(e,t,r){"use strict";var n=r(53);e.exports=new n({include:[r(148)]})},function(e,t,r){"use strict";var n=r(53);e.exports=new n({include:[r(94)],implicit:[r(345),r(346),r(347),r(348)]})},function(e,t,r){const n=r(51)("fbp-spec:expectation"),o=r(360),i=r(383),a=r(67),s={type:(e,t)=>o.expect(e).to.be.a(t),equals:(e,t)=>o.expect(e).to.eql(t),above:(e,t)=>o.expect(e).to.be.above(t),below:(e,t)=>o.expect(e).to.be.below(t),haveKeys:(e,t)=>o.expect(e).to.have.keys(t),includeKeys:(e,t)=>o.expect(e).to.include.keys(t),contains:(e,t)=>o.expect(e).to.contain(t),noterror(e){if(null!=e?e.message:void 0)throw e}};t.expect=function e(t,r){a.isArray(t)?t.forEach(e=>{Object.keys(e).forEach(t=>{(a.isArray(e[t])?e[t]:[e[t]]).forEach(e=>{n("checking port for expectation",t,e);const o=r[t];if(void 0===o)throw new Error("No data received on port "+t);const a=function(e){const t=Object.keys(e);for(let r=0;r<t.length;r+=1){const n=t[r],o=e[n];if("path"!==n){const e=s[n];if(e){const t=t=>e(t,o);return t.toString=()=>`${n} ${o}`,t}}}throw new Error(`fbp-spec: No operator matching ${Object.keys(e)}. Available: ${Object.keys(s)}`)}(e);(function(e,t){let r;if(e.path){if(n("extracting JSONPath from",e.path,t),r=i.query(t,e.path),!r.length)throw new Error(`expected JSONPath '${e.path}' to match data in ${JSON.stringify(t)}`)}else r=[t];return n("matching against",r),r})(e,o).forEach(e=>{n("checking against predicate",e,a.toString()),a(e)})})})}):e([t],r)},t.noError=e=>o.expect(e).to.not.exist},function(e,t){
/*!
 * assertion-error
 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
 * MIT Licensed
 */
/*!
 * Return a function that will copy properties from
 * one object to another excluding any originally
 * listed. Returned function will create a new `{}`.
 *
 * @param {String} excluded properties ...
 * @return {Function}
 */
function r(){var e=[].slice.call(arguments);function t(t,r){Object.keys(r).forEach((function(n){~e.indexOf(n)||(t[n]=r[n])}))}return function(){for(var e=[].slice.call(arguments),r=0,n={};r<e.length;r++)t(n,e[r]);return n}}function n(e,t,o){var i=r("name","message","stack","constructor","toJSON")(t||{});for(var a in this.message=e||"Unspecified AssertionError",this.showDiff=!1,i)this[a]=i[a];if(o=o||n,Error.captureStackTrace)Error.captureStackTrace(this,o);else try{throw new Error}catch(e){this.stack=e.stack}}
/*!
 * Inherit from Error.prototype
 */
/*!
 * Primary Exports
 */
e.exports=n,n.prototype=Object.create(Error.prototype),
/*!
 * Statically set name
 */
n.prototype.name="AssertionError",
/*!
 * Ensure correct constructor
 */
n.prototype.constructor=n,n.prototype.toJSON=function(e){var t=r("constructor","toJSON","stack")({name:this.name},this);return!1!==e&&this.stack&&(t.stack=this.stack),t}},function(e,t){
/*!
 * Chai - getActual utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){return t.length>4?t[4]:e._obj}},function(e,t,r){
/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var n=r(96),o=r(54);e.exports=function(e){var t=n(e),r=Object.prototype.toString.call(e);if(o.truncateThreshold&&t.length>=o.truncateThreshold){if("[object Function]"===r)return e.name&&""!==e.name?"[Function: "+e.name+"]":"[Function]";if("[object Array]"===r)return"[ Array("+e.length+") ]";if("[object Object]"===r){var i=Object.keys(e);return"{ Object ("+(i.length>2?i.splice(0,2).join(", ")+", ...":i.join(", "))+") }"}return t}return t}},function(e,t,r){"use strict";var n=Function.prototype.toString,o=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\s\(\/]+)/;e.exports=function(e){if("function"!=typeof e)return null;var t="";if(void 0===Function.prototype.name&&void 0===e.name){var r=n.call(e).match(o);r&&(t=r[1])}else t=e.name;return t}},function(e,t){
/*!
 * Chai - getProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=Object.getOwnPropertyNames(e);function r(e){-1===t.indexOf(e)&&t.push(e)}for(var n=Object.getPrototypeOf(e);null!==n;)Object.getOwnPropertyNames(n).forEach(r),n=Object.getPrototypeOf(n);return t}},function(e,t){
/*!
 * Chai - getOwnEnumerablePropertySymbols utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){return"function"!=typeof Object.getOwnPropertySymbols?[]:Object.getOwnPropertySymbols(e).filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))}},function(e,t,r){const n=r(51)("fbp-spec:subprocess");t.start=function(e,t,o){let i;try{i=r(27)}catch(e){return o(e),null}if(null==t.timeout){t.timeout=300}let a=!1,s="";const c=["-c",e],u=i.spawn("sh",c);return n("spawned",`'sh ${c.join(" ")}'`),n("waiting for output"),u.on("error",e=>o(e)),u.stdout.on("data",e=>{const t=e.toString();n("sub stdout",t),a||(n("got output, transitioning to started"),a=!0,setTimeout(o,100))}),u.stderr.on("data",e=>{const t=e.toString();s+=t,n("sub stderr",t),a||(n("got stderr, failing"),a=!0,o(new Error(`Subprocess wrote on stderr: '${s}'`)))}),setTimeout(()=>{a||(n("timeout waiting for output, assuming started"),a=!0,o(null))},t.timeout),u}},,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var p=r(11),l=r(14),d=r(159),h=r(37),f=r(480),m=r(481),g=r(482),y=l.default("noflo:component"),v=l.default("noflo:component:brackets"),b=l.default("noflo:component:send"),w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,e);var t,r,n,c=s(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,u),e=c.call(this);var r=t;return r.inPorts||(r.inPorts={}),r.inPorts instanceof d.InPorts?e.inPorts=r.inPorts:e.inPorts=new d.InPorts(r.inPorts),r.outPorts||(r.outPorts={}),r.outPorts instanceof d.OutPorts?e.outPorts=r.outPorts:e.outPorts=new d.OutPorts(r.outPorts),e.icon=r.icon?r.icon:"",e.description=r.description?r.description:"",e.componentName=null,e.baseDir=null,e.started=!1,e.load=0,e.ordered=null!=r.ordered&&r.ordered,e.autoOrdering=null!=r.autoOrdering?r.autoOrdering:null,e.outputQ=[],e.bracketContext={in:{},out:{}},e.activateOnInput=null==r.activateOnInput||r.activateOnInput,r.forwardBrackets||(r.forwardBrackets={in:["out","error"]}),e.forwardBrackets=r.forwardBrackets,"function"==typeof r.process&&e.process(r.process),e.nodeId=null,e.__openConnections=0,e}return t=u,(r=[{key:"getDescription",value:function(){return this.description}},{key:"isReady",value:function(){return!0}},{key:"isSubgraph",value:function(){return!1}},{key:"setIcon",value:function(e){this.icon=e,this.emit("icon",this.icon)}},{key:"getIcon",value:function(){return this.icon}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=this.outPorts.ports[r];if(o&&(o.isAttached()||!o.isRequired()))return t.forEach((function(e){o.openBracket(e,{scope:n})})),o.data(e,{scope:n}),void t.forEach((function(e){o.closeBracket(e,{scope:n})}));throw e}},{key:"setUp",value:function(e){e(null)}},{key:"tearDown",value:function(e){e(null)}},{key:"start",value:function(e){var t,r=this;return t=this.isStarted()?Promise.resolve():new Promise((function(e,t){var n=r.setUp((function(r){r?t(r):e()}));n&&n.then&&n.then(e,t)})).then((function(){return r.started=!0,r.emit("start"),Promise.resolve()})),e&&(h.deprecated("Providing a callback to Component.start is deprecated, use Promises"),t.then((function(){e(null)}),e)),t}},{key:"shutdown",value:function(e){var t=this,r=new Promise((function(e,r){var n=t.tearDown((function(t){t?r(t):e()}));n&&n.then&&n.then(e,r)})).then((function(){return new Promise((function(e){t.load>0?t.on("deactivate",(function r(n){n>0||(t.removeListener("deactivate",r),e())})):e()}))})).then((function(){var e=t.inPorts.ports||t.inPorts;return Object.keys(e).forEach((function(t){var r=e[t];"function"==typeof r.clear&&r.clear()})),t.bracketContext={in:{},out:{}},t.isStarted()?(t.started=!1,t.emit("end"),Promise.resolve()):Promise.resolve()}));return e&&(h.deprecated("Providing a callback to Component.shutdown is deprecated, use Promises"),r.then((function(){e(null)}),e)),r}},{key:"isStarted",value:function(){return this.started}},{key:"prepareForwarding",value:function(){var e=this;Object.keys(this.forwardBrackets).forEach((function(t){var r=e.forwardBrackets[t];if(t in e.inPorts.ports){var n=[];r.forEach((function(t){t in e.outPorts.ports&&n.push(t)})),0===n.length?delete e.forwardBrackets[t]:e.forwardBrackets[t]=n}else delete e.forwardBrackets[t]}))}},{key:"isLegacy",value:function(){return!this.handle}},{key:"process",value:function(e){var t=this;if("function"!=typeof e)throw new Error("Process handler must be a function");if(!this.inPorts)throw new Error("Component ports must be defined before process function");return this.prepareForwarding(),this.handle=e,Object.keys(this.inPorts.ports).forEach((function(e){var r=t.inPorts.ports[e];r.name||(r.name=e),r.on("ip",(function(e){return t.handleIP(e,r)}))})),this}},{key:"isForwardingInport",value:function(e){var t;return!(!(t="string"==typeof e?e:e.name)||!(t in this.forwardBrackets))}},{key:"isForwardingOutport",value:function(e,t){var r,n;return r="string"==typeof e?e:e.name,n="string"==typeof t?t:t.name,!(!r||!n||!this.forwardBrackets[r]||-1===this.forwardBrackets[r].indexOf(n))}},{key:"isOrdered",value:function(){return!!this.ordered||!!this.autoOrdering}},{key:"handleIP",value:function(e,t){if(t.options.triggering){"openBracket"!==e.type||null!==this.autoOrdering||this.ordered||(y("".concat(this.nodeId," port '").concat(t.name,"' entered auto-ordering mode")),this.autoOrdering=!0);var r={};if(this.isForwardingInport(t)){if("openBracket"===e.type)return;if("closeBracket"===e.type){var n=t.getBuffer(e.scope,e.index),o=n.filter((function(e){return"data"===e.type}));if(this.outputQ.length>=this.load&&0===o.length){if(n[0]!==e)return;if(!t.name)return;t.get(e.scope,e.index);var i=this.getBracketContext("in",t.name,e.scope,e.index).pop();i.closeIp=e,v("".concat(this.nodeId," closeBracket-C from '").concat(i.source,"' to ").concat(i.ports,": '").concat(e.data,"'")),r={__resolved:!0,__bracketClosingAfter:[i]},this.outputQ.push(r),this.processOutputQueue()}if(!o.length)return}}var a=new f.default(e,this,t,r),s=new m.default(this.inPorts,a),c=new g.default(this.outPorts,a);try{if(!this.handle)throw new Error("Processing function not defined");var u=this.handle(s,c,a);u&&u.then&&u.then((function(e){return c.sendDone(e)}),(function(e){return c.done(e)}))}catch(e){this.deactivate(a),c.sendDone(e)}a.activated||(t.isAddressable()?y("".concat(this.nodeId," packet on '").concat(t.name,"[").concat(e.index,"]' didn't match preconditions: ").concat(e.type)):y("".concat(this.nodeId," packet on '").concat(t.name,"' didn't match preconditions: ").concat(e.type)))}}},{key:"getBracketContext",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=d.normalizePortName(t),i=o.name,a=o.index;null!=n&&(a="".concat(n));var s="in"===e?this.inPorts:this.outPorts;return i=s.ports[i].isAddressable()?"".concat(i,"[").concat(a,"]"):t,this.bracketContext[e][i]||(this.bracketContext[e][i]={}),this.bracketContext[e][i][r]||(this.bracketContext[e][i][r]=[]),this.bracketContext[e][i][r]}},{key:"addToResult",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e,i=r,a=d.normalizePortName(t),s=a.name,c=a.index,u=n?"unshift":"push";if(this.outPorts.ports[s].isAddressable()){var p=c?parseInt(c,10):i.index;return o[s]||(o[s]={}),o[s][p]||(o[s][p]=[]),i.index=p,void o[s][p][u](i)}o[s]||(o[s]=[]),o[s][u](i)}},{key:"getForwardableContexts",value:function(e,t,r){var n=this,o=d.normalizePortName(t),i=o.name,a=o.index,s=[];return r.forEach((function(r,o){if(n.isForwardingOutport(e,i)&&-1===r.ports.indexOf(t)){var c=n.getBracketContext("out",i,r.ip.scope,parseInt(a,10))[o];c&&c.ip.data===r.ip.data&&-1!==c.ports.indexOf(t)||s.push(r)}})),s}},{key:"addBracketForwards",value:function(e){var t=this,r=e;(null!=r.__bracketClosingBefore?r.__bracketClosingBefore.length:void 0)&&r.__bracketClosingBefore.forEach((function(e){v("".concat(t.nodeId," closeBracket-A from '").concat(e.source,"' to ").concat(e.ports,": '").concat(e.closeIp.data,"'")),e.ports.length&&e.ports.forEach((function(n){var o=e.closeIp.clone();t.addToResult(r,n,o,!0),t.getBracketContext("out",n,o.scope).pop()}))})),r.__bracketContext&&Object.keys(r.__bracketContext).reverse().forEach((function(e){var n=r.__bracketContext[e];n.length&&Object.keys(r).forEach((function(o){var i,a,s=r[o];0!==o.indexOf("__")&&(t.outPorts[o].isAddressable()?Object.keys(s).forEach((function(c){var u=s[c];if(u.filter((function(e){return"data"===e.type})).length){var p="".concat(o,"[").concat(c,"]");(a=t.getForwardableContexts(e,p,n)).length&&(i=[],a.forEach((function(r){v("".concat(t.nodeId," openBracket from '").concat(e,"' to '").concat(p,"': '").concat(r.ip.data,"'"));var n=r.ip.clone();n.index=parseInt(c,10),i.push(n),r.ports.push(p),t.getBracketContext("out",o,r.ip.scope,n.index).push(r)})),i.reverse(),i.forEach((function(e){t.addToResult(r,o,e,!0)})))}})):s.filter((function(e){return"data"===e.type})).length&&(a=t.getForwardableContexts(e,o,n)).length&&(i=[],a.forEach((function(r){v("".concat(t.nodeId," openBracket from '").concat(e,"' to '").concat(o,"': '").concat(r.ip.data,"'")),i.push(r.ip.clone()),r.ports.push(o),t.getBracketContext("out",o,r.ip.scope).push(r)})),i.reverse(),i.forEach((function(e){t.addToResult(r,o,e,!0)}))))}))})),(null!=r.__bracketClosingAfter?r.__bracketClosingAfter.length:void 0)&&r.__bracketClosingAfter.forEach((function(e){v("".concat(t.nodeId," closeBracket-B from '").concat(e.source,"' to ").concat(e.ports,": '").concat(e.closeIp.data,"'")),e.ports.length&&e.ports.forEach((function(n){var o=e.closeIp.clone();t.addToResult(r,n,o,!1),t.getBracketContext("out",n,o.scope).pop()}))})),delete r.__bracketClosingBefore,delete r.__bracketContext,delete r.__bracketClosingAfter}},{key:"processOutputQueue",value:function(){for(var e=this,t=function(){if(!e.outputQ[0].__resolved)return"break";var t=e.outputQ.shift();e.addBracketForwards(t),Object.keys(t).forEach((function(r){var n,o=t[r];0!==r.indexOf("__")&&(e.outPorts.ports[r].isAddressable()?Object.keys(o).forEach((function(t){var i=o[t],a=parseInt(t,10);e.outPorts.ports[r].isAttached(a)&&i.forEach((function(t){var o=t;n="".concat(r,"[").concat(o.index,"]"),"openBracket"===o.type?b("".concat(e.nodeId," sending ").concat(n," < '").concat(o.data,"'")):"closeBracket"===o.type?b("".concat(e.nodeId," sending ").concat(n," > '").concat(o.data,"'")):b("".concat(e.nodeId," sending ").concat(n," DATA")),e.outPorts[r].options.scoped||(o.scope=null),e.outPorts[r].sendIP(o)}))})):e.outPorts.ports[r].isAttached()&&o.forEach((function(t){var o=t;n=r,"openBracket"===o.type?b("".concat(e.nodeId," sending ").concat(n," < '").concat(o.data,"'")):"closeBracket"===o.type?b("".concat(e.nodeId," sending ").concat(n," > '").concat(o.data,"'")):b("".concat(e.nodeId," sending ").concat(n," DATA")),e.outPorts[r].options.scoped||(o.scope=null),e.outPorts[r].sendIP(o)})))}))};this.outputQ.length>0&&"break"!==t(););}},{key:"activate",value:function(e){e.activated||(e.activated=!0,e.deactivated=!1,this.load+=1,this.emit("activate",this.load),(this.ordered||this.autoOrdering)&&this.outputQ.push(e.result))}},{key:"deactivate",value:function(e){e.deactivated||(e.deactivated=!0,e.activated=!1,this.isOrdered()&&this.processOutputQueue(),this.load-=1,this.emit("deactivate",this.load))}}])&&i(t.prototype,r),n&&i(t,n),u}(p.EventEmitter);t.Component=w,w.description="",w.icon=null},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.normalizePortName=t.OutPorts=t.InPorts=void 0;var d=r(11),h=r(160),f=r(162),m=function(e){s(r,e);var t=u(r);function r(e,n){var i;return o(this,r),(i=t.call(this)).model=n,i.ports={},e?(Object.keys(e).forEach((function(t){var r=e[t];i.add(t,r)})),i):p(i)}return a(r,[{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("add"===e||"remove"===e)throw new Error("Add and remove are restricted port names");if(!e.match(/^[a-z0-9_\.\/]+$/))throw new Error("Port names can only contain lowercase alphanumeric characters and underscores. '".concat(e,"' not allowed"));this.ports[e]&&this.remove(e);var r=t;if("object"===n(r)&&r.canAttach)this.ports[e]=r;else{var o=this.model;this.ports[e]=new o(t)}return this[e]=this.ports[e],this.emit("add",e),this}},{key:"remove",value:function(e){if(!this.ports[e])throw new Error("Port ".concat(e," not defined"));return delete this.ports[e],delete this[e],this.emit("remove",e),this}}]),r}(d.EventEmitter),g=function(e){s(r,e);var t=u(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,r),t.call(this,e,h.default)}return r}(m);t.InPorts=g;var y=function(e){s(r,e);var t=u(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,r),t.call(this,e,f.default)}return a(r,[{key:"connect",value:function(e,t){var r=this.ports[e];if(!r)throw new Error("Port ".concat(e," not available"));r.connect(t)}},{key:"beginGroup",value:function(e,t,r){var n=this.ports[e];if(!n)throw new Error("Port ".concat(e," not available"));n.beginGroup(t,r)}},{key:"send",value:function(e,t,r){var n=this.ports[e];if(!n)throw new Error("Port ".concat(e," not available"));n.send(t,r)}},{key:"endGroup",value:function(e,t){var r=this.ports[e];if(!r)throw new Error("Port ".concat(e," not available"));r.endGroup(t)}},{key:"disconnect",value:function(e,t){var r=this.ports[e];if(!r)throw new Error("Port ".concat(e," not available"));r.disconnect(t)}}]),r}(m);t.OutPorts=y,t.normalizePortName=function(e){var t={name:e};if(-1===e.indexOf("["))return t;var r=e.match(/(.*)\[([0-9]+)\]/);return!r||r.length<3?t:{name:r[1],index:r[2]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,e);var t,r,n,c=s(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,u);var r=t;return null==r.control&&(r.control=!1),null==r.scoped&&(r.scoped=!0),null==r.triggering&&(r.triggering=!0),(e=c.call(this,r)).nodeInstance=null,e.prepareBuffer(),e}return t=u,(r=[{key:"attachSocket",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.hasDefault()&&e.setDataDelegate((function(){return t.options.default})),e.on("connect",(function(){return t.handleSocketEvent("connect",e,r)})),e.on("begingroup",(function(e){return t.handleSocketEvent("begingroup",e,r)})),e.on("data",(function(e){return t.validateData(e),t.handleSocketEvent("data",e,r)})),e.on("endgroup",(function(e){return t.handleSocketEvent("endgroup",e,r)})),e.on("disconnect",(function(){return t.handleSocketEvent("disconnect",e,r)})),e.on("ip",(function(e){return t.handleIP(e,r)}))}},{key:"handleIP",value:function(e,t){if(!this.options.control||"data"===e.type){var r=e;r.owner=this.nodeInstance,this.isAddressable()&&(r.index=t),"all"===r.datatype&&(r.datatype=this.getDataType()),this.getSchema()&&!r.schema&&(r.schema=this.getSchema());var n=this.prepareBufferForIP(r);n.push(r),this.options.control&&n.length>1&&n.shift(),this.emit("ip",r,t)}}},{key:"handleSocketEvent",value:function(e,t,r){return this.isAddressable()?this.emit(e,t,r):this.emit(e,t)}},{key:"hasDefault",value:function(){return void 0!==this.options.default}},{key:"prepareBuffer",value:function(){if(this.isAddressable())return this.options.scoped&&(this.indexedScopedBuffer={}),this.indexedIipBuffer={},void(this.indexedBuffer={});this.options.scoped&&(this.scopedBuffer={}),this.iipBuffer=[],this.buffer=[]}},{key:"prepareBufferForIP",value:function(e){return this.isAddressable()?null!=e.scope&&this.options.scoped?(e.scope in this.indexedScopedBuffer||(this.indexedScopedBuffer[e.scope]=[]),e.index in this.indexedScopedBuffer[e.scope]||(this.indexedScopedBuffer[e.scope][e.index]=[]),this.indexedScopedBuffer[e.scope][e.index]):e.initial?(e.index in this.indexedIipBuffer||(this.indexedIipBuffer[e.index]=[]),this.indexedIipBuffer[e.index]):(e.index in this.indexedBuffer||(this.indexedBuffer[e.index]=[]),this.indexedBuffer[e.index]):null!=e.scope&&this.options.scoped?(e.scope in this.scopedBuffer||(this.scopedBuffer[e.scope]=[]),this.scopedBuffer[e.scope]):e.initial?this.iipBuffer:this.buffer}},{key:"validateData",value:function(e){if(this.options.values&&-1===this.options.values.indexOf(e))throw new Error("Invalid data='".concat(e,"' received, not in [").concat(this.options.values,"]"))}},{key:"getBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isAddressable()){if(null!=e&&this.options.scoped){if(!(e in this.indexedScopedBuffer))return;if(!(t in this.indexedScopedBuffer[e]))return;return this.indexedScopedBuffer[e][t]}if(r){if(!(t in this.indexedIipBuffer))return;return this.indexedIipBuffer[t]}if(!(t in this.indexedBuffer))return;return this.indexedBuffer[t]}if(null!=e&&this.options.scoped){if(!(e in this.scopedBuffer))return;return this.scopedBuffer[e]}return r?this.iipBuffer:this.buffer}},{key:"getFromBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.getBuffer(e,t,r);if(null!=n?n.length:void 0)return this.options.control?n[n.length-1]:n.shift()}},{key:"get",value:function(e,t){var r=this.getFromBuffer(e,t);return void 0!==r?r:this.getFromBuffer(null,t,!0)}},{key:"hasIPinBuffer",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.getBuffer(e,t,n);if(!(null!=o?o.length:void 0))return!1;for(var i=0;i<o.length;i+=1)if(r(o[i]))return!0;return!1}},{key:"hasIIP",value:function(e,t){return this.hasIPinBuffer(null,e,t,!0)}},{key:"has",value:function(e,t,r){var n=r,o=t;return this.isAddressable()||(n=o,o=null),!!this.hasIPinBuffer(e,o,n)||!!this.hasIIP(o,n)}},{key:"length",value:function(e,t){var r=this.getBuffer(e,t);return r?r.length:0}},{key:"ready",value:function(e){return this.length(e)>0}},{key:"clear",value:function(){return this.prepareBuffer()}}])&&i(t.prototype,r),n&&i(t,n),u}(r(161).default);t.default=p},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var u=r(11),p=["all","string","number","int","object","array","boolean","color","date","bang","function","buffer","stream"];var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).options=function(e){var t=e.datatype||"all";"integer"===t&&(t="int");var r=e.required||!1;if(-1===p.indexOf(t))throw new Error("Invalid port datatype '".concat(t,"' specified, valid are ").concat(p.join(", ")));var n=e.schema||e.type;if(n&&-1===n.indexOf("/"))throw new Error("Invalid port schema '".concat(n,"' specified. Should be URL or MIME type"));var o="boolean"!=typeof e.scoped||e.scoped,i=e.description||"";return Object.assign({},e,{description:i,datatype:t,required:r,schema:n,scoped:o})}(e),t.sockets=[],t.node=null,t.nodeInstance=null,t.name=null,t}return t=c,(r=[{key:"getId",value:function(){return this.node&&this.name?"".concat(this.node," ").concat(this.name.toUpperCase()):"Port"}},{key:"getDataType",value:function(){return this.options.datatype}},{key:"getSchema",value:function(){return this.options.schema||null}},{key:"getDescription",value:function(){return this.options.description}},{key:"attach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t;this.isAddressable()&&null!==t||(r=this.sockets.length),this.sockets[r]=e,this.attachSocket(e,r),this.isAddressable()?this.emit("attach",e,r):this.emit("attach",e)}},{key:"attachSocket",value:function(e){}},{key:"detach",value:function(e){var t=this.sockets.indexOf(e);-1!==t&&(this.sockets[t]=void 0,this.isAddressable()?this.emit("detach",e,t):this.emit("detach",e))}},{key:"isAddressable",value:function(){return!!this.options.addressable}},{key:"isBuffered",value:function(){return!!this.options.buffered}},{key:"isRequired",value:function(){return!!this.options.required}},{key:"isAttached",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.isAddressable()&&null!==e?!!this.sockets[e]:!!this.sockets.length}},{key:"listAttached",value:function(){for(var e=[],t=0;t<this.sockets.length;t+=1)this.sockets[t]&&e.push(t);return e}},{key:"isConnected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.isAddressable()){if(null===e)throw new Error("".concat(this.getId(),": Socket ID required"));if(!this.sockets[e])throw new Error("".concat(this.getId(),": Socket ").concat(e," not available"));return this.sockets[e].isConnected()}var t=!1;return this.sockets.forEach((function(e){e&&e.isConnected()&&(t=!0)})),t}},{key:"canAttach",value:function(){return!0}}])&&o(t.prototype,r),n&&o(t,n),c}(u.EventEmitter);t.default=l},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var l=r(161),d=r(46),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,u=c(l);function l(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,l);var r=t;return null==r.scoped&&(r.scoped=!0),"boolean"!=typeof r.caching&&(r.caching=!1),(e=u.call(this,r)).cache={},e}return t=l,(r=[{key:"attach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(p(l.prototype),"attach",this).call(this,e,t),this.isCaching()&&null!=this.cache[t]&&this.send(this.cache[t],t)}},{key:"connect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getSockets(e);this.checkRequired(t),t.forEach((function(e){e&&e.connect()}))}},{key:"beginGroup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getSockets(t);this.checkRequired(r),r.forEach((function(t){t&&t.beginGroup(e)}))}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getSockets(t);this.checkRequired(r),this.isCaching()&&e!==this.cache[t]&&(this.cache[t]=e),r.forEach((function(t){t&&t.send(e)}))}},{key:"endGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getSockets(e);this.checkRequired(t),t.forEach((function(e){e&&e.endGroup()}))}},{key:"disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getSockets(e);this.checkRequired(t),t.forEach((function(e){e&&e.disconnect()}))}},{key:"sendIP",value:function(e,t,r,n){var o,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=n;d.default.isIP(e)?a=(o=e).index:o=new d.default(e,t,r);var s=this.getSockets(a);this.checkRequired(s),"all"===o.datatype&&(o.datatype=this.getDataType()),this.getSchema()&&!o.schema&&(o.schema=this.getSchema());var c=null!=this.cache[a]?this.cache[a].data:void 0;this.isCaching()&&t!==c&&(this.cache[a]=o);var u=!0;return s.forEach((function(e){e&&(u?(e.post(o,i),u=!1):(o.clonable&&(o=o.clone()),e.post(o,i)))})),this}},{key:"openBracket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sendIP("openBracket",e,t,r)}},{key:"data",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sendIP("data",e,t,r)}},{key:"closeBracket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sendIP("closeBracket",e,t,r)}},{key:"checkRequired",value:function(e){if(0===e.length&&this.isRequired())throw new Error("".concat(this.getId(),": No connections available"))}},{key:"getSockets",value:function(e){if(this.isAddressable()){if(null===e)throw new Error("".concat(this.getId()," Socket ID required"));return this.sockets[e]?[this.sockets[e]]:[]}return this.sockets}},{key:"isCaching",value:function(){return!!this.options.caching}}])&&i(t.prototype,r),n&&i(t,n),l}(l.default);t.default=h},function(e,t){e.exports={stringPatterns:[/'[^]*?'/g,/"[^]*?"/g,/`[^]*?`/g],prePatterns:[/\[[^]*?\]/,/{[^]*?}/,/=>\s*?\([^]*?\)/,/=\s*?function\s*?\([^]*(?=[^]*\))/,/=\s*?\([^]*(?=[^]*\))/,/\s*?=[^>][^,\)]*/],postPatterns:[/\([^]*?\)/]}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?c(e):t}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=r(11).EventEmitter,l={Runtime:r(490),Graph:r(491),Network:r(492),Component:r(493),Trace:r(495)},d=r(14)("noflo-runtime-base:messaging:receive"),h=r(14)("noflo-runtime-base:messaging:receive:payload"),f=r(14)("noflo-runtime-base:messaging:send"),m=r(14)("noflo-runtime-base:messaging:send:payload"),g=r(99).withNamespace,y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,r,n,s=a(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this)).options=e,t.options||(t.options={}),t.version="0.7",t.component=new l.Component(c(t)),t.graph=new l.Graph(c(t)),t.network=new l.Network(c(t)),t.runtime=new l.Runtime(c(t)),t.trace=new l.Trace(c(t)),t.context=null,null!=t.options.captureOutput&&t.options.captureOutput&&t.startCapture(),t.options.capabilities||(t.options.capabilities=["protocol:graph","protocol:component","protocol:network","protocol:runtime","protocol:trace","component:setsource","component:getsource","graph:readonly","network:data","network:control","network:status"]),t.options.defaultPermissions||(t.options.defaultPermissions=[]),t.options.permissions||(t.options.permissions={}),setTimeout((function(){t._startDefaultGraph()}),0),t}return t=u,(r=[{key:"getGraphName",value:function(e){var t=this.options.namespace||"default",r=e.name||"main";return g(r,t)}},{key:"_startDefaultGraph",value:function(){var e=this;if(this.options.defaultGraph){var t=this.getGraphName(this.options.defaultGraph);this.context="none",this.graph.registerGraph(t,this.options.defaultGraph,!1).then((function(){return e.network._startNetwork(e.options.defaultGraph,t,e.context)})).then((function(r){e.runtime.setMainGraph(t,e.options.defaultGraph),e.emit("ready",r)})).catch((function(t){e.emit("error",t)}))}else this.emit("ready",null)}},{key:"canDo",value:function(e,t){var r;r="string"==typeof e?[e]:e;var n=this.getPermitted(t);return r.filter((function(e){return n.includes(e)})).length>0}},{key:"canInput",value:function(e,t,r){if("graph"===e)return this.canDo(["protocol:graph"],r);if("trace"===e)return this.canDo(["protocol:trace"],r);switch("".concat(e,":").concat(t)){case"component:list":return this.canDo(["protocol:component"],r);case"component:getsource":return this.canDo(["component:getsource"],r);case"component:source":return this.canDo(["component:setsource"],r);case"network:edges":return this.canDo(["network:data","protocol:network"],r);case"network:start":case"network:stop":case"network:debug":return this.canDo(["network:control","protocol:network"],r);case"network:getstatus":return this.canDo(["network:status","network:control","protocol:network"],r);case"runtime:getruntime":return!0;case"runtime:packet":return this.canDo(["protocol:runtime"],r);default:return!1}}},{key:"getPermitted",value:function(e){return e?this.options.permissions[e]?this.options.permissions[e]:[]:this.options.defaultPermissions}},{key:"send",value:function(e,t,r){f("".concat(e," ").concat(t)),m(r)}},{key:"sendAll",value:function(){}},{key:"receive",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;d("".concat(e," ").concat(t)),h(r);var o=r?r.secret:null;if(this.canInput(e,t,o))switch(this.context=n,e){case"runtime":return void this.runtime.receive(t,r,n);case"graph":return void this.graph.receive(t,r,n);case"network":return void this.network.receive(t,r,n);case"component":return void this.component.receive(t,r,n);case"trace":return void this.trace.receive(t,r,n);default:this.send(e,"error",new Error("Protocol ".concat(e," is not supported")),n)}else this.send(e,"error",new Error("".concat(e,":").concat(t," is not permitted")),n)}}])&&o(t.prototype,r),n&&o(t,n),u}(p);e.exports=y,e.exports.direct=r(496)},function(e,t){t.normalizeOptions=function(e){var t=e;return void 0===e.catchExceptions&&(t.catchExceptions=!0,window.location.search&&"debug"===window.location.search.substring(1)&&(t.catchExceptions=!1)),t},t.subscribe=function(e,t){e.addEventListener("message",(function(e){var r=e.data;"string"==typeof e.data&&(r=JSON.parse(e.data)),r.protocol&&r.command&&t(r,e)}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){const n=r(202),o={};t.setSource=function(e,t,r,i,a,s){n.setSource(o,e,t,r,i,a,s)},t.getSource=function(e,t,r){n.getSource(o,e,t,r)},t.getLanguages=n.getLanguages,t.register=function(e,t){e.setLibraryIcon("flow","random"),e.setLibraryIcon("indexeddb","database"),e.setLibraryIcon("objects","list"),e.setLibraryIcon("strings","font"),e.registerComponent("ui","BlobToEntry",r(203)),e.registerComponent("ui","CheckGistExists",r(204)),e.registerComponent("ui","CheckRepoExists",r(205)),e.registerComponent("ui","CheckSyncState",r(206)),e.registerComponent("ui","CheckTokenGrant",r(212)),e.registerComponent("ui","CleanAction",r(218)),e.registerComponent("ui","CleanProject",r(219)),e.registerComponent("ui","ClearUserData",r(220)),e.registerComponent("ui","CollectInitialData",r(221)),e.registerComponent("ui","CreateCommit",r(222)),e.registerComponent("ui","CreateContext",r(223)),e.registerComponent("ui","CreateEmptyContext",r(224)),e.registerComponent("ui","CreateLoadingContext",r(225)),e.registerComponent("ui","CreateTree",r(226)),e.registerComponent("ui","DatabaseReady",r(227)),e.registerComponent("ui","DispatchAction",r(228)),e.registerComponent("ui","EnsureId",r(229)),e.registerComponent("ui","EnsureLocalRuntimes",r(230)),e.registerComponent("ui","ErrorToContext",r(231)),e.registerComponent("ui","ExchangeGrantToken",r(232)),e.registerComponent("ui","FindNodesInGraph",r(233)),e.registerComponent("ui","GetActionValues",r(234)),e.registerComponent("ui","GetBlob",r(235)),e.registerComponent("ui","GetReference",r(236)),e.registerComponent("ui","GetRemoteProjects",r(237)),e.registerComponent("ui","GetRemoteRuntimes",r(238)),e.registerComponent("ui","GetRemoteUser",r(249)),e.registerComponent("ui","GetUrl",r(250)),e.registerComponent("ui","GetUserToken",r(251)),e.registerComponent("ui","GistToProject",r(252)),e.registerComponent("ui","HasActionRuntime",r(253)),e.registerComponent("ui","ListenRuntime",r(254)),e.registerComponent("ui","LoadTests",r(255)),e.registerComponent("ui","LoadUserData",r(385)),e.registerComponent("ui","LoggingMiddleware",r(386)),e.registerComponent("ui","LoginOAuth",r(387)),e.registerComponent("ui","MapStateToProps",r(388)),e.registerComponent("ui","OpenLiveMode",r(389)),e.registerComponent("ui","OpenNewProject",r(390)),e.registerComponent("ui","OpenProject",r(391)),e.registerComponent("ui","OpenProjectMode",r(392)),e.registerComponent("ui","PopulateProjectRuntime",r(393)),e.registerComponent("ui","PopulateRuntimeData",r(394)),e.registerComponent("ui","PreparePulls",r(395)),e.registerComponent("ui","PreparePush",r(396)),e.registerComponent("ui","ReconnectRuntime",r(397)),e.registerComponent("ui","RefreshRemoteUser",r(398)),e.registerComponent("ui","RemoveRemoteProject",r(399)),e.registerComponent("ui","RemoveRemoteRuntime",r(400)),e.registerComponent("ui","Router",r(401)),e.registerComponent("ui","RunTests",r(402)),e.registerComponent("ui","RuntimeReducer",r(403)),e.registerComponent("ui","RuntimeToProject",r(404)),e.registerComponent("ui","SearchGraphNodeToContext",r(405)),e.registerComponent("ui","SendComponentChanges",r(406)),e.registerComponent("ui","SendCurrentHash",r(407)),e.registerComponent("ui","SendEdges",r(408)),e.registerComponent("ui","SendGraphChanges",r(409)),e.registerComponent("ui","SendNewGraph",r(410)),e.registerComponent("ui","SendSubgraph",r(411)),e.registerComponent("ui","SetAction",r(412)),e.registerComponent("ui","SetToContext",r(413)),e.registerComponent("ui","SetUrl",r(414)),e.registerComponent("ui","SetUrlHash",r(415)),e.registerComponent("ui","StartNetwork",r(416)),e.registerComponent("ui","State",r(417)),e.registerComponent("ui","StopNetwork",r(418)),e.registerComponent("ui","StorageReducer",r(419)),e.registerComponent("ui","Store",r(420)),e.registerComponent("ui","StoreRemoteProject",r(421)),e.registerComponent("ui","StoreRemoteRuntime",r(422)),e.registerComponent("ui","StoreUser",r(423)),e.registerComponent("ui","StoreUserPreferences",r(424)),e.registerComponent("ui","UpdateFromTree",r(425)),e.registerComponent("ui","UpdateReference",r(426)),e.registerComponent("ui","Save",r(427)),e.registerComponent("ui","SaveData",r(428)),e.registerComponent("ui","GetRuntimeClient",r(429)),e.registerComponent("ui","MigrateLocalStorage",r(430)),e.registerComponent("ui","ContextReducer",r(431)),e.registerComponent("ui","Delete",r(432)),e.registerComponent("ui","DeleteData",r(433)),e.registerComponent("ui","GithubMiddleware",r(434)),e.registerComponent("ui","GithubReducer",r(435)),e.registerComponent("ui","GithubSynchronization",r(436)),e.registerComponent("ui","Load",r(437)),e.registerComponent("ui","LoadData",r(438)),e.registerComponent("ui","PrepareStorage",r(439)),e.registerComponent("ui","RegistryMiddleware",r(440)),e.registerComponent("ui","RegistryReducer",r(441)),e.registerComponent("ui","RuntimeMiddleware",r(442)),e.registerComponent("ui","StorageMiddleware",r(443)),e.registerComponent("ui","UrlMiddleware",r(444)),e.registerComponent("ui","UserMiddleware",r(445)),e.registerComponent("ui","UserReducer",r(446)),e.registerComponent("ui","main",r(157)),e.registerComponent("core","Kick",r(447)),e.registerComponent("core","Merge",r(448)),e.registerComponent("core","Output",r(449)),e.registerComponent("core","Repeat",r(453)),e.registerComponent("core","RepeatAsync",r(454)),e.registerComponent("core","SendNext",r(455)),e.registerComponent("core","Split",r(456)),e.registerComponent("flow","Race",r(457)),e.registerComponent("graph","LoadJson",r(458)),e.registerComponent("indexeddb","BeginTransaction",r(459)),e.registerComponent("indexeddb","CreateIndex",r(460)),e.registerComponent("indexeddb","CreateStore",r(461)),e.registerComponent("indexeddb","Delete",r(462)),e.registerComponent("indexeddb","GetStore",r(463)),e.registerComponent("indexeddb","Open",r(464)),e.registerComponent("indexeddb","Put",r(466)),e.registerComponent("indexeddb","Query",r(467)),e.registerComponent("indexeddb","UpgradeRouter",r(468)),e.registerComponent("interaction","ListenHash",r(469)),e.registerComponent("interaction","ListenResize",r(470)),e.registerComponent("objects","CallMethod",r(471)),e.registerComponent("objects","CreateObject",r(472)),e.registerComponent("objects","GetObjectKey",r(473)),e.registerComponent("strings","SendString",r(474)),e.registerComponent(null,"Graph",r(475));const o=[];o.push(r(476)),n.registerCustomLoaders(e,o,t)}},function(module,exports){function registerCustomLoaders(e,t,r){if(!t.length)return void r();const n=t.shift();e.registerLoader(n,n=>{n?r(n):registerCustomLoaders(e,t,r)})}function setSource(sources,loader,packageId,name,originalSource,language,callback){let implementation,source=originalSource;if("coffeescript"===language){if("undefined"!=typeof window&&!window.CoffeeScript)return void callback(new Error(`CoffeeScript compiler needed for ${packageId}/${name} not available`));try{source=window.CoffeeScript.compile(source,{bare:!0})}catch(e){return void callback(e)}}if(("es6"===language||"es2015"===language)&&"undefined"!=typeof window&&window.babel)try{source=window.babel.transform(source).code}catch(e){return void callback(e)}try{const withExports=`(function () { var exports = {}; ${source}; return exports; })();`;implementation=eval(withExports)}catch(e){return void callback(e)}if("function"!=typeof implementation&&(!implementation.getComponent||"function"!=typeof implementation.getComponent))return void callback(new Error(`Provided source for ${packageId}/${name} failed to create a runnable component`));const fullName=`${packageId}/${name}`;sources[fullName]={language:language,source:originalSource},loader.registerComponent(packageId,name,implementation,callback)}function getSource(e,t,r,n){if(!t.components[r])return void n(new Error(`Component ${r} not available`));const o=t.components[r];let i;if(-1!==r.indexOf("/")){const e=r.split("/");i={name:e[1],library:e[0]}}else i={name:r,library:""};return t.isGraph(o)?(i.code=JSON.stringify(o,null,2),i.language="json",void n(null,i)):e[r]?(i.code=e[r].source,i.language=e[r].language,i.tests=e[r].tests,void n(null,i)):"function"==typeof o?(i.code=o.toString(),i.language="javascript",void n(null,i)):"function"==typeof o.getComponent?(i.code=o.getComponent.toString(),i.language="javascript",void n(null,i)):void n(new Error("Unable to get sources for "+r))}function getLanguages(){const e=["javascript","es2015"];return"undefined"!=typeof window&&window.CoffeeScript&&e.push("coffeescript"),e}module.exports={registerCustomLoaders:registerCustomLoaders,setSource:setSource,getSource:getSource,getLanguages:getLanguages}},,,,,function(e,t,r){(function(t){
/*!
 * octo.js
 * Copyright (c) 2012 Justin Palmer <justin@labratrevenge.com>
 * MIT Licensed
 */
!function(){"undefined"==typeof superagent&&(superagent=r(208),void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")&&(btoa=r(211)));var n={api:function(){var e,r,n,o,i,a="https://api.github.com";superagent;function s(){}function c(a,c,u){var p=1,l=30,d={},h=!1,f=!1,m={};void 0!==t&&t.execPath&&t.execPath.match(/node/)&&(d["User-Agent"]="Octo.js");var g=function(){var t=superagent[a](s.host()+c);t.on("error",(function(e){y._handledError=e,y.trigger("error",e)})),i&&t.set("Authorization","token "+i),!i&&n&&o&&t.set("Authorization","Basic "+btoa(n+":"+o)),t.set(d).query({page:p,per_page:l}).timeout(3e3).send(u).end((function(t){if(!y._handledError){if(t.error)return y._handledError=t,void y.trigger("error",t);e=~~t.header["x-ratelimit-limit"],r=~~t.header["x-ratelimit-remaining"];var n=t.header.link;h=/rel=\"next\"/i.test(n),f=/rel=\"next\"/.test(n),y.trigger("end",t),t.ok&&y.trigger("success",t)}}))};function y(){g()}return y.page=function(e){return arguments.length?(p=e,y):p},y.perpage=function(e){return arguments.length?(l=e,y):l},y.next=function(){return p+=1,g(),y},y.prev=function(){return p-=1,g(),y},y.hasnext=function(){return h},y.hasprev=function(){return f},y.on=function(e,t){return void 0===m[e]&&(m[e]=[]),m[e].push(t),y},y.off=function(e,t){if(m[e]instanceof Array)for(var r=m[e],n=0;n<r.length;n++)if(r[n]===t){r.splice(n,1);break}return y},y.trigger=function(e,t){return m[e]instanceof Array&&m[e].forEach((function(e){e.call(y,t)})),y},y.set=function(e,t){return d[e]=t,y},y}return s.host=function(e){return arguments.length?(a=e,s):a},s.get=function(e,t){return new c("get",e)},s.post=function(e,t){return new c("post",e,t)},s.patch=function(e,t){return new c("patch",e,t)},s.put=function(e,t){return new c("put",e,t)},s.del=function(e,t){return new c("del",e,t)},s.limit=function(){return e},s.remaining=function(){return r},s.username=function(e){return arguments.length?(n=e,s):n},s.password=function(e){return arguments.length?(o=e,s):o},s.token=function(e){return arguments.length?(i=e,s):i},s}};e.exports=n}()}).call(this,r(13))},function(e,t,r){var n=r(209),o=r(210),i="undefined"==typeof window?this:window;function a(){}var s="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function c(e){return e===Object(e)}function u(e){if(!c(e))return e;var t=[];for(var r in e)null!=e[r]&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}function p(e){for(var t,r={},n=e.split("&"),o=0,i=n.length;o<i;++o)t=n[o].split("="),r[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return r}function l(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text=this.xhr.responseText,this.setStatusProperties(this.xhr.status),this.header=this.headers=function(e){var t,r,n,o,i=e.split(/\r?\n/),a={};i.pop();for(var c=0,u=i.length;c<u;++c)t=(r=i[c]).indexOf(":"),n=r.slice(0,t).toLowerCase(),o=s(r.slice(t+1)),a[n]=o;return a}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function d(e,t){var r=this;n.call(this),this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",(function(){var t=new l(r);"HEAD"==e&&(t.text=null),r.callback(null,t)}))}function h(e,t){return"function"==typeof t?new d("GET",e).end(t):1==arguments.length?new d("GET",e):new d(e,t)}h.serializeObject=u,h.parseString=p,h.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},h.serialize={"application/x-www-form-urlencoded":u,"application/json":JSON.stringify},h.parse={"application/x-www-form-urlencoded":p,"application/json":JSON.parse},l.prototype.get=function(e){return this.header[e.toLowerCase()]},l.prototype.setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=t.split(/ *; */).shift();var r=function(e){return o(e.split(/ *; */),(function(e,t){var r=t.split(/ *= */),n=r.shift(),o=r.shift();return n&&o&&(e[n]=o),e}),{})}(t);for(var n in r)this[n]=r[n]},l.prototype.parseBody=function(e){var t=h.parse[this.type];return t?t(e):null},l.prototype.setStatusProperties=function(e){var t=e/100|0;this.status=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e||1223==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},l.prototype.toError=function(){var e=this.req,t=e.method,r=e.url,n="cannot "+t+" "+r+" ("+this.status+")",o=new Error(n);return o.status=this.status,o.method=t,o.url=r,o},h.Response=l,n(d.prototype),d.prototype.use=function(e){return e(this),this},d.prototype.timeout=function(e){return this._timeout=e,this},d.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},d.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},d.prototype.set=function(e,t){if(c(e)){for(var r in e)this.set(r,e[r]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},d.prototype.getHeader=function(e){return this._header[e.toLowerCase()]},d.prototype.type=function(e){return this.set("Content-Type",h.types[e]||e),this},d.prototype.accept=function(e){return this.set("Accept",h.types[e]||e),this},d.prototype.auth=function(e,t){var r=btoa(e+":"+t);return this.set("Authorization","Basic "+r),this},d.prototype.query=function(e){return"string"!=typeof e&&(e=u(e)),e&&this._query.push(e),this},d.prototype.field=function(e,t){return this._formData||(this._formData=new FormData),this._formData.append(e,t),this},d.prototype.attach=function(e,t,r){return this._formData||(this._formData=new FormData),this._formData.append(e,t,r),this},d.prototype.send=function(e){var t=c(e),r=this.getHeader("Content-Type");if(t&&c(this._data))for(var n in e)this._data[n]=e[n];else"string"==typeof e?(r||this.type("form"),r=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return t?(r||this.type("json"),this):this},d.prototype.callback=function(e,t){var r=this._callback;return 2==r.length?r(e,t):e?this.emit("error",e):void r(t)},d.prototype.crossDomainError=function(){var e=new Error("Origin is not allowed by Access-Control-Allow-Origin");e.crossDomain=!0,this.callback(e)},d.prototype.timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},d.prototype.withCredentials=function(){return this._withCredentials=!0,this},d.prototype.end=function(e){var t=this,r=this.xhr=function(){if(i.XMLHttpRequest&&("file:"!=i.location.protocol||!i.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}(),n=this._query.join("&"),o=this._timeout,s=this._formData||this._data;if(this._callback=e||a,r.onreadystatechange=function(){if(4==r.readyState)return 0==r.status?t.aborted?t.timeoutError():t.crossDomainError():void t.emit("end")},r.upload&&(r.upload.onprogress=function(e){e.percent=e.loaded/e.total*100,t.emit("progress",e)}),o&&!this._timer&&(this._timer=setTimeout((function(){t.abort()}),o)),n&&(n=h.serializeObject(n),this.url+=~this.url.indexOf("?")?"&"+n:"?"+n),r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof s&&!function(e){switch({}.toString.call(e)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}(s)){var c=h.serialize[this.getHeader("Content-Type")];c&&(s=c(s))}for(var u in this.header)null!=this.header[u]&&r.setRequestHeader(u,this.header[u]);return this.emit("request",this),r.send(s),this},h.Request=d,h.get=function(e,t,r){var n=h("GET",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},h.head=function(e,t,r){var n=h("HEAD",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},h.del=function(e,t){var r=h("DELETE",e);return t&&r.end(t),r},h.patch=function(e,t,r){var n=h("PATCH",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},h.post=function(e,t,r){var n=h("POST",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},h.put=function(e,t,r){var n=h("PUT",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},e.exports=h},function(e,t){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){var r=this;function n(){r.off(e,n),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks[e];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){e.exports=function(e,t,r){for(var n=0,o=e.length,i=3==arguments.length?r:e[n++];n<o;)i=t.call(null,i,e[n],++n,e);return i}},function(e,t,r){(function(t){!function(){"use strict";e.exports=function(e){return(e instanceof t?e:t.from(e.toString(),"binary")).toString("base64")}}()}).call(this,r(34).Buffer)},,function(e,t,r){(function(e,n){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof n&&n;a.global!==a&&a.window!==a&&a.self;var s,c=2147483647,u=/^xn--/,p=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,f=String.fromCharCode;function m(e){throw new RangeError(d[e])}function g(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function y(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+g((e=e.replace(l,".")).split("."),t).join(".")}function v(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=f(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function x(e,t,r){var n=0;for(e=r?h(e/700):e>>1,e+=h(e/t);e>455;n+=36)e=h(e/35);return h(n+36*e/(e+38))}function E(e){var t,r,n,o,i,a,s,u,p,l,d,f=[],g=e.length,y=0,v=128,w=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&m("not-basic"),f.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<g;){for(i=y,a=1,s=36;o>=g&&m("invalid-input"),((u=(d=e.charCodeAt(o++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:36)>=36||u>h((c-y)/a))&&m("overflow"),y+=u*a,!(u<(p=s<=w?1:s>=w+26?26:s-w));s+=36)a>h(c/(l=36-p))&&m("overflow"),a*=l;w=x(y-i,t=f.length+1,0==i),h(y/t)>c-v&&m("overflow"),v+=h(y/t),y%=t,f.splice(y++,0,v)}return b(f)}function k(e){var t,r,n,o,i,a,s,u,p,l,d,g,y,b,E,k=[];for(g=(e=v(e)).length,t=128,r=0,i=72,a=0;a<g;++a)(d=e[a])<128&&k.push(f(d));for(n=o=k.length,o&&k.push("-");n<g;){for(s=c,a=0;a<g;++a)(d=e[a])>=t&&d<s&&(s=d);for(s-t>h((c-r)/(y=n+1))&&m("overflow"),r+=(s-t)*y,t=s,a=0;a<g;++a)if((d=e[a])<t&&++r>c&&m("overflow"),d==t){for(u=r,p=36;!(u<(l=p<=i?1:p>=i+26?26:p-i));p+=36)E=u-l,b=36-l,k.push(f(w(l+E%b,0))),u=h(E/b);k.push(f(w(u,0))),i=x(r,y,n==o),r=0,++n}++r,++t}return k.join("")}s={version:"1.4.1",ucs2:{decode:v,encode:b},decode:E,encode:k,toASCII:function(e){return y(e,(function(e){return p.test(e)?"xn--"+k(e):e}))},toUnicode:function(e){return y(e,(function(e){return u.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return s}.call(t,r,t,e))||(e.exports=o)}()}).call(this,r(214)(e),r(26))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var p=0;p<u;++p){var l,d,h,f,m=e[p].replace(s,"%20"),g=m.indexOf(r);g>=0?(l=m.substr(0,g),d=m.substr(g+1)):(l=m,d=""),h=decodeURIComponent(l),f=decodeURIComponent(d),n(a,h)?o(a[h])?a[h].push(f):a[h]=[a[h],f]:a[h]=f}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var s=encodeURIComponent(n(a))+r;return o(e[a])?i(e[a],(function(e){return s+encodeURIComponent(n(e))})).join(t):s+encodeURIComponent(n(e[a]))})).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var a=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o;"undefined"!=typeof window?o=window:"undefined"==typeof self?(console.warn("Using browser-only version of superagent in non-browser environment"),o=void 0):o=self;var i=r(240),a=r(241),s=r(242),c=r(245),u=r(115),p=r(246),l=r(248);function d(){}e.exports=function(e,r){return"function"==typeof r?new t.Request("GET",e).end(r):1===arguments.length?new t.Request("GET",e):new t.Request(e,r)};var h=t=e.exports;t.Request=w,h.getXHR=function(){if(o.XMLHttpRequest&&(!o.location||"file:"!==o.location.protocol||!o.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw new Error("Browser-only version of superagent could not find XHR")};var f="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function m(e){if(!u(e))return e;var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&g(t,r,e[r]);return t.join("&")}function g(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r))r.forEach((function(r){g(e,t,r)}));else if(u(r))for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&g(e,"".concat(t,"[").concat(n,"]"),r[n]);else e.push(encodeURI(t)+"="+encodeURIComponent(r));else e.push(encodeURI(t))}function y(e){for(var t,r,n={},o=e.split("&"),i=0,a=o.length;i<a;++i)-1===(r=(t=o[i]).indexOf("="))?n[decodeURIComponent(t)]="":n[decodeURIComponent(t.slice(0,r))]=decodeURIComponent(t.slice(r+1));return n}function v(e){return/[/+]json($|[^-\w])/i.test(e)}function b(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){for(var t,r,n,o,i=e.split(/\r?\n/),a={},s=0,c=i.length;s<c;++s)-1!==(t=(r=i[s]).indexOf(":"))&&(n=r.slice(0,t).toLowerCase(),o=f(r.slice(t+1)),a[n]=o);return a}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function w(e,t){var r=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",(function(){var e,t=null,n=null;try{n=new b(r)}catch(e){return(t=new Error("Parser is unable to parse the response")).parse=!0,t.original=e,r.xhr?(t.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,t.status=r.xhr.status?r.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),r.callback(t)}r.emit("response",n);try{r._isResponseOK(n)||(e=new Error(n.statusText||n.text||"Unsuccessful HTTP response"))}catch(t){e=t}e?(e.original=t,e.response=n,e.status=n.status,r.callback(e,n)):r.callback(null,n)}))}function x(e,t,r){var n=h("DELETE",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n}h.serializeObject=m,h.parseString=y,h.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},h.serialize={"application/x-www-form-urlencoded":s.stringify,"application/json":a},h.parse={"application/x-www-form-urlencoded":y,"application/json":JSON.parse},p(b.prototype),b.prototype._parseBody=function(e){var t=h.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&v(this.type)&&(t=h.parse["application/json"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},b.prototype.toError=function(){var e=this.req,t=e.method,r=e.url,n="cannot ".concat(t," ").concat(r," (").concat(this.status,")"),o=new Error(n);return o.status=this.status,o.method=t,o.url=r,o},h.Response=b,i(w.prototype),c(w.prototype),w.prototype.type=function(e){return this.set("Content-Type",h.types[e]||e),this},w.prototype.accept=function(e){return this.set("Accept",h.types[e]||e),this},w.prototype.auth=function(e,t,r){1===arguments.length&&(t=""),"object"===n(t)&&null!==t&&(r=t,t=""),r||(r={type:"function"==typeof btoa?"basic":"auto"});var o=function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,r,o)},w.prototype.query=function(e){return"string"!=typeof e&&(e=m(e)),e&&this._query.push(e),this},w.prototype.attach=function(e,t,r){if(t){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,r||t.name)}return this},w.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},w.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var r=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),r(e,t)},w.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},w.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},w.prototype.ca=w.prototype.agent,w.prototype.buffer=w.prototype.ca,w.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},w.prototype.pipe=w.prototype.write,w.prototype._isHost=function(e){return e&&"object"===n(e)&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},w.prototype.end=function(e){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},w.prototype._setUploadTimeout=function(){var e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((function(){e._timeoutError("Upload timeout of ",e._uploadTimeout,"ETIMEDOUT")}),this._uploadTimeout))},w.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var e=this;this.xhr=h.getXHR();var t=this.xhr,r=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var r=t.readyState;if(r>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4===r){var n;try{n=t.status}catch(e){n=0}if(!n){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var n=function(t,r){r.total>0&&(r.percent=r.loaded/r.total*100,100===r.percent&&clearTimeout(e._uploadTimeoutTimer)),r.direction=t,e.emit("progress",r)};if(this.hasListeners("progress"))try{t.addEventListener("progress",n.bind(null,"download")),t.upload&&t.upload.addEventListener("progress",n.bind(null,"upload"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!==this.method&&"HEAD"!==this.method&&"string"!=typeof r&&!this._isHost(r)){var o=this._header["content-type"],i=this._serializer||h.serialize[o?o.split(";")[0]:""];!i&&v(o)&&(i=h.serialize["application/json"]),i&&(r=i(r))}for(var a in this.header)null!==this.header[a]&&Object.prototype.hasOwnProperty.call(this.header,a)&&t.setRequestHeader(a,this.header[a]);this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send(void 0===r?null:r)},h.agent=function(){return new l},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((function(e){l.prototype[e.toLowerCase()]=function(t,r){var n=new h.Request(e,t);return this._setDefaults(n),r&&n.end(r),n}})),l.prototype.del=l.prototype.delete,h.get=function(e,t,r){var n=h("GET",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},h.head=function(e,t,r){var n=h("HEAD",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},h.options=function(e,t,r){var n=h("OPTIONS",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},h.del=x,h.delete=x,h.patch=function(e,t,r){var n=h("PATCH",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},h.post=function(e,t,r){var n=h("POST",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},h.put=function(e,t,r){var n=h("PUT",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n}},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){e.exports=o,o.default=o,o.stable=a,o.stableStringify=a;var r=[],n=[];function o(e,t,o){var i;for(!function e(t,o,i,a){var s;if("object"==typeof t&&null!==t){for(s=0;s<i.length;s++)if(i[s]===t){var c=Object.getOwnPropertyDescriptor(a,o);return void(void 0!==c.get?c.configurable?(Object.defineProperty(a,o,{value:"[Circular]"}),r.push([a,o,t,c])):n.push([t,o]):(a[o]="[Circular]",r.push([a,o,t])))}if(i.push(t),Array.isArray(t))for(s=0;s<t.length;s++)e(t[s],s,i,t);else{var u=Object.keys(t);for(s=0;s<u.length;s++){var p=u[s];e(t[p],p,i,t)}}i.pop()}}(e,"",[],void 0),i=0===n.length?JSON.stringify(e,t,o):JSON.stringify(e,s(t),o);0!==r.length;){var a=r.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}return i}function i(e,t){return e<t?-1:e>t?1:0}function a(e,t,o){var a,c=function e(t,o,a,s){var c;if("object"==typeof t&&null!==t){for(c=0;c<a.length;c++)if(a[c]===t){var u=Object.getOwnPropertyDescriptor(s,o);return void(void 0!==u.get?u.configurable?(Object.defineProperty(s,o,{value:"[Circular]"}),r.push([s,o,t,u])):n.push([t,o]):(s[o]="[Circular]",r.push([s,o,t])))}if("function"==typeof t.toJSON)return;if(a.push(t),Array.isArray(t))for(c=0;c<t.length;c++)e(t[c],c,a,t);else{var p={},l=Object.keys(t).sort(i);for(c=0;c<l.length;c++){var d=l[c];e(t[d],d,a,t),p[d]=t[d]}if(void 0===s)return p;r.push([s,o,t]),s[o]=p}a.pop()}}(e,"",[],void 0)||e;for(a=0===n.length?JSON.stringify(c,t,o):JSON.stringify(c,s(t),o);0!==r.length;){var u=r.pop();4===u.length?Object.defineProperty(u[0],u[1],u[3]):u[0][u[1]]=u[2]}return a}function s(e){return e=void 0!==e?e:function(e,t){return t},function(t,r){if(n.length>0)for(var o=0;o<n.length;o++){var i=n[o];if(i[1]===t&&i[0]===r){r="[Circular]",n.splice(o,1);break}}return e.call(this,t,r)}}},function(e,t,r){"use strict";var n=r(243),o=r(244),i=r(114);e.exports={formats:i,parse:o,stringify:n}},function(e,t,r){"use strict";var n=r(86),o=r(114),i=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},s=Array.isArray,c=Array.prototype.push,u=function(e,t){c.apply(e,s(t)?t:[t])},p=Date.prototype.toISOString,l=o.default,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,format:l,formatter:o.formatters[l],indices:!1,serializeDate:function(e){return p.call(e)},skipNulls:!1,strictNullHandling:!1},h=function e(t,r,o,i,a,c,p,l,h,f,m,g,y){var v,b=t;if("function"==typeof p?b=p(r,b):b instanceof Date?b=f(b):"comma"===o&&s(b)&&(b=n.maybeMap(b,(function(e){return e instanceof Date?f(e):e})).join(",")),null===b){if(i)return c&&!g?c(r,d.encoder,y,"key"):r;b=""}if("string"==typeof(v=b)||"number"==typeof v||"boolean"==typeof v||"symbol"==typeof v||"bigint"==typeof v||n.isBuffer(b))return c?[m(g?r:c(r,d.encoder,y,"key"))+"="+m(c(b,d.encoder,y,"value"))]:[m(r)+"="+m(String(b))];var w,x=[];if(void 0===b)return x;if(s(p))w=p;else{var E=Object.keys(b);w=l?E.sort(l):E}for(var k=0;k<w.length;++k){var _=w[k],S=b[_];if(!a||null!==S){var C=s(b)?"function"==typeof o?o(r,_):r:r+(h?"."+_:"["+_+"]");u(x,e(S,C,o,i,a,c,p,l,h,f,m,g,y))}}return x};e.exports=function(e,t){var r,n=e,c=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=o.default;if(void 0!==e.format){if(!i.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=o.formatters[r],a=d.filter;return("function"==typeof e.filter||s(e.filter))&&(a=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:a,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"==typeof c.filter?n=(0,c.filter)("",n):s(c.filter)&&(r=c.filter);var p,l=[];if("object"!=typeof n||null===n)return"";p=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var f=a[p];r||(r=Object.keys(n)),c.sort&&r.sort(c.sort);for(var m=0;m<r.length;++m){var g=r[m];c.skipNulls&&null===n[g]||u(l,h(n[g],g,f,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.formatter,c.encodeValuesOnly,c.charset))}var y=l.join(c.delimiter),v=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),y.length>0?v+y:""}},function(e,t,r){"use strict";var n=r(86),o=Object.prototype.hasOwnProperty,i=Array.isArray,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},u=function(e,t,r,n){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(i),u=s?i.slice(0,s.index):i,p=[];if(u){if(!r.plainObjects&&o.call(Object.prototype,u)&&!r.allowPrototypes)return;p.push(u)}for(var l=0;r.depth>0&&null!==(s=a.exec(i))&&l<r.depth;){if(l+=1,!r.plainObjects&&o.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;p.push(s[1])}return s&&p.push("["+i.slice(s.index)+"]"),function(e,t,r,n){for(var o=n?t:c(t,r),i=e.length-1;i>=0;--i){var a,s=e[i];if("[]"===s&&r.parseArrays)a=[].concat(o);else{a=r.plainObjects?Object.create(null):{};var u="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,p=parseInt(u,10);r.parseArrays||""!==u?!isNaN(p)&&s!==u&&String(p)===u&&p>=0&&r.parseArrays&&p<=r.arrayLimit?(a=[])[p]=o:a[u]=o:a={0:o}}o=a}return o}(p,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var p="string"==typeof e?function(e,t){var r,u={},p=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,d=p.split(t.delimiter,l),h=-1,f=t.charset;if(t.charsetSentinel)for(r=0;r<d.length;++r)0===d[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===d[r]?f="utf-8":"utf8=%26%2310003%3B"===d[r]&&(f="iso-8859-1"),h=r,r=d.length);for(r=0;r<d.length;++r)if(r!==h){var m,g,y=d[r],v=y.indexOf("]="),b=-1===v?y.indexOf("="):v+1;-1===b?(m=t.decoder(y,a.decoder,f,"key"),g=t.strictNullHandling?null:""):(m=t.decoder(y.slice(0,b),a.decoder,f,"key"),g=n.maybeMap(c(y.slice(b+1),t),(function(e){return t.decoder(e,a.decoder,f,"value")}))),g&&t.interpretNumericEntities&&"iso-8859-1"===f&&(g=s(g)),y.indexOf("[]=")>-1&&(g=i(g)?[g]:g),o.call(u,m)?u[m]=n.combine(u[m],g):u[m]=g}return u}(e,r):e,l=r.plainObjects?Object.create(null):{},d=Object.keys(p),h=0;h<d.length;++h){var f=d[h],m=u(f,p[f],r,"string"==typeof e);l=n.merge(l,m,r)}return n.compact(l)}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r(115);function i(e){if(e)return function(e){for(var t in i.prototype)Object.prototype.hasOwnProperty.call(i.prototype,t)&&(e[t]=i.prototype[t]);return e}(e)}e.exports=i,i.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},i.prototype.parse=function(e){return this._parser=e,this},i.prototype.responseType=function(e){return this._responseType=e,this},i.prototype.serialize=function(e){return this._serializer=e,this},i.prototype.timeout=function(e){if(!e||"object"!==n(e))return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;case"upload":this._uploadTimeout=e.upload;break;default:console.warn("Unknown timeout option",t)}return this},i.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var a=new Set(["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]),s=new Set([408,413,429,500,502,503,504,521,522,524]);i.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(e,t);if(!0===r)return!0;if(!1===r)return!1}catch(e){console.error(e)}if(t&&t.status&&s.has(t.status))return!0;if(e){if(e.code&&a.has(e.code))return!0;if(e.timeout&&"ECONNABORTED"===e.code)return!0;if(e.crossDomain)return!0}return!1},i.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},i.prototype.then=function(e,t){var r=this;if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((function(e,t){n.on("abort",(function(){if(!(r._maxRetries&&r._maxRetries>r._retries))if(r.timedout&&r.timedoutError)t(r.timedoutError);else{var e=new Error("Aborted");e.code="ABORTED",e.status=r.status,e.method=r.method,e.url=r.url,t(e)}})),n.end((function(r,n){r?t(r):e(n)}))}))}return this._fullfilledPromise.then(e,t)},i.prototype.catch=function(e){return this.then(void 0,e)},i.prototype.use=function(e){return e(this),this},i.prototype.ok=function(e){if("function"!=typeof e)throw new Error("Callback required");return this._okCallback=e,this},i.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},i.prototype.get=function(e){return this._header[e.toLowerCase()]},i.prototype.getHeader=i.prototype.get,i.prototype.set=function(e,t){if(o(e)){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&this.set(r,e[r]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},i.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},i.prototype.field=function(e,t){if(null==e)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(o(e)){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&this.field(r,e[r]);return this}if(Array.isArray(t)){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=String(t)),this._getFormData().append(e,t),this},i.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},i.prototype._auth=function(e,t,r,n){switch(r.type){case"basic":this.set("Authorization","Basic ".concat(n("".concat(e,":").concat(t))));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer ".concat(e))}return this},i.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},i.prototype.redirects=function(e){return this._maxRedirects=e,this},i.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw new TypeError("Invalid argument");return this._maxResponseSize=e,this},i.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},i.prototype.send=function(e){var t=o(e),r=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(t&&o(this._data))for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this._data[n]=e[n]);else"string"==typeof e?(r||this.type("form"),(r=this._header["content-type"])&&(r=r.toLowerCase().trim()),this._data="application/x-www-form-urlencoded"===r?this._data?"".concat(this._data,"&").concat(e):e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)||r||this.type("json"),this},i.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},i.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.includes("?")?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(t>=0){var r=this.url.slice(t+1).split("&");"function"==typeof this._sort?r.sort(this._sort):r.sort(),this.url=this.url.slice(0,t)+"?"+r.join("&")}}},i.prototype._appendQueryString=function(){console.warn("Unsupported")},i.prototype._timeoutError=function(e,t,r){if(!this._aborted){var n=new Error("".concat(e+t,"ms exceeded"));n.timeout=t,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.timedoutError=n,this.abort(),this.callback(n)}},i.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")}),this._responseTimeout))}},function(e,t,r){"use strict";var n=r(247);function o(e){if(e)return function(e){for(var t in o.prototype)Object.prototype.hasOwnProperty.call(o.prototype,t)&&(e[t]=o.prototype[t]);return e}(e)}e.exports=o,o.prototype.get=function(e){return this.header[e.toLowerCase()]},o.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=n.type(t);var r=n.params(t);for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(this[o]=r[o]);this.links={};try{e.link&&(this.links=n.parseLinks(e.link))}catch(e){}},o.prototype._setStatusProperties=function(e){var t=e/100|0;this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e}},function(e,t,r){"use strict";function n(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){var t,r={},o=n(e.split(/ *; */));try{for(o.s();!(t=o.n()).done;){var i=t.value.split(/ *= */),a=i.shift(),s=i.shift();a&&s&&(r[a]=s)}}catch(e){o.e(e)}finally{o.f()}return r},t.parseLinks=function(e){var t,r={},o=n(e.split(/ *, */));try{for(o.s();!(t=o.n()).done;){var i=t.value.split(/ *; */),a=i[0].slice(1,-1);r[i[1].split(/ *= */)[1].slice(1,-1)]=a}}catch(e){o.e(e)}finally{o.f()}return r},t.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"].forEach((function(e){i.prototype[e]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this._defaults.push({fn:e,args:r}),this}})),i.prototype._setDefaults=function(e){this._defaults.forEach((function(t){e[t.fn].apply(e,n(t.args))}))},e.exports=i},,,,,,,,function(e,t,r){e.exports={runner:r(117),subprocess:r(156),mocha:r(384),testsuite:r(93),schema:r(145),getSchema:function(t){const r=t.replace(".json","");return e.exports.schema[r]},ui:{}}},function(e,t,r){t.transports={websocket:r(258),iframe:r(263),opener:r(264),webrtc:r(265),base:r(57)},t.connection=r(282),t.Signaller=r(128),t.getTransport=function(e){return t.transports[e]}},function(e,t,r){const n=r(57),o=r(66);e.exports=class extends n{constructor(e){super(e),this.handleError=this.handleError.bind(this),this.handleMessage=this.handleMessage.bind(this),this.connecting=!1,this.connection=null,this.protocol="noflo",this.buffer=[],this.container=null}getElement(){if(this.container)return this.container;this.container=document.createElement("div"),this.container.classList.add("preview-container");const e=document.createElement("pre"),t=document.createElement("img");return this.container.appendChild(t),this.container.appendChild(e),this.on("network",r=>{if("output"!==r.command)return;const n=r.payload;if(null!=n.type&&"previewurl"===n.type){const e=n.url.indexOf(!0)?"&":"?";t.src=`${n.url+e}timestamp=${(new Date).getTime()}`}if(null!=n.message){const t=n.message.replace(/[\u00A0-\u99999<>&]/gim,e=>`&#${e.charCodeAt(0)};`);e.innerHTML+=t+"\n",e.scrollTop=e.scrollHeight}}),this.on("disconnected",()=>{e.innerHTML=""}),this.container}isConnected(){return this.connection&&!1===this.connecting}connect(){this.connection||this.connecting||(this.protocol?this.connection=new o.WebSocket(this.getAddress(),this.protocol):this.connection=new o.WebSocket(this.getAddress()),this.connection.addEventListener("open",()=>(this.connecting=!1,this.sendRuntime("getruntime",{}),this.emit("status",{online:!0,label:"connected"}),this.emit("connected"),this.flush()),!1),this.connection.addEventListener("message",this.handleMessage,!1),this.connection.addEventListener("error",this.handleError,!1),this.connection.addEventListener("close",()=>{this.connection=null,this.emit("status",{online:!1,label:"disconnected"}),this.emit("disconnected")},!1),this.connecting=!0)}disconnect(){this.connection&&(this.connecting=!1,this.connection.close())}send(e,t,r){this.connecting?this.buffer.push({protocol:e,command:t,payload:r}):this.connection&&this.connection.send(JSON.stringify({protocol:e,command:t,payload:r}))}handleError(e){if("noflo"===this.protocol)return delete this.protocol,this.connecting=!1,this.connection=null,void setTimeout(()=>{this.connect()},1);this.connection=null,this.connecting=!1;const t=new Error("Connection failed");t.event=e,this.emit("error",t)}handleMessage(e){const t=JSON.parse(e.data);return this.recvMessage(t)}flush(){this.buffer.forEach(e=>{this.send(e.protocol,e.command,e.payload)}),this.buffer=[]}}},function(e,t,r){var n;try{n=r(260)}catch(e){}finally{if(n||"undefined"==typeof window||(n=window),!n)throw new Error("Could not determine global this")}var o=n.WebSocket||n.MozWebSocket,i=r(261);function a(e,t){return t?new o(e,t):new o(e)}o&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(a,e,{get:function(){return o[e]}})})),e.exports={w3cwebsocket:o?a:null,version:i}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){e.exports=r(262).version},function(e){e.exports=JSON.parse('{"name":"websocket","description":"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.","keywords":["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],"author":"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)","contributors":["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],"version":"1.0.33","repository":{"type":"git","url":"https://github.com/theturtle32/WebSocket-Node.git"},"homepage":"https://github.com/theturtle32/WebSocket-Node","engines":{"node":">=4.0.0"},"dependencies":{"bufferutil":"^4.0.1","debug":"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2","yaeti":"^0.0.6"},"devDependencies":{"buffer-equal":"^1.0.0","gulp":"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1","jshint":"^2.0.0","tape":"^4.9.1"},"config":{"verbose":false},"scripts":{"test":"tape test/unit/*.js","gulp":"gulp"},"main":"index","directories":{"lib":"./lib"},"browser":"lib/browser.js","license":"Apache-2.0","_resolved":"https://registry.npmjs.org/websocket/-/websocket-1.0.33.tgz","_integrity":"sha512-XwNqM2rN5eh3G2CUQE3OHZj+0xfdH42+OFK6LdC2yqiC0YU8e5UK0nYre220T0IyyN031V/XOvtHvXozvJYFWA==","_from":"websocket@1.0.33"}')},function(e,t,r){const n=r(57);e.exports=class extends n{constructor(e){super(e),this.updateIframe=this.updateIframe.bind(this),this.onLoaded=this.onLoaded.bind(this),this.onMessage=this.onMessage.bind(this),this.origin=window.location.origin,this.connecting=!1,this.connected=!1,this.buffer=[],this.iframe=null}getElement(){return this.iframe}isConnected(){return this.connected}setMain(e){this.graph&&this.graph.removeListener("changeProperties",this.updateIframe),e?(e.on("changeProperties",this.updateIframe),super.setMain(e),this.updateIframe()):super.setMain(e)}setParentElement(e){return this.iframe=document.createElement("iframe"),this.iframe.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),e.appendChild(this.iframe)}connect(){if(!this.iframe)throw new Error("Unable to connect without a parent element");return this.iframe.addEventListener("load",this.onLoaded,!1),this.connecting=!0,this.emit("status",{online:!1,label:"connecting"}),this.iframe.setAttribute("src",this.getAddress()),this.iframe.id="preview-iframe",window.addEventListener("message",this.onMessage,!1)}updateIframe(){if(!this.iframe||!this.graph)return;const e=this.graph.properties.environment;e&&e.content&&this.send("iframe","setcontent",e.content)}disconnect(){return this.iframe&&this.iframe.removeEventListener("load",this.onLoaded,!1),this.connected=!1,window.removeEventListener("message",this.onMessage,!1),this.emit("status",{online:!1,label:"disconnected"}),this.emit("disconnected")}onLoaded(){let e;this.once("capabilities",()=>(e&&clearTimeout(e),this.connecting=!1,this.connected=!0,this.emit("status",{online:!0,label:"connected"}),this.emit("connected"),this.updateIframe(),this.flush())),this.postMessage("runtime","getruntime",{}),e=setTimeout(()=>{this.postMessage("runtime","getruntime",{})},500)}send(e,t,r){this.connecting?this.buffer.push({protocol:e,command:t,payload:r}):this.postMessage(e,t,r)}postMessage(e,t,r){const n=this.iframe.contentWindow;if(n){try{if("about:blank"===n.location.href)return;if(-1!==n.location.href.indexOf("chrome-extension://"))throw new Error("Use * for IFRAME communications in a Chrome app")}catch(o){return void n.postMessage(JSON.stringify({protocol:e,command:t,payload:r}),"*")}n.postMessage(JSON.stringify({protocol:e,command:t,payload:r}),n.location.href)}}onMessage(e){let t;e.source&&e.source!==this.iframe.contentWindow||("string"==typeof e.data?t=JSON.parse(e.data):({data:t}=e),this.recvMessage(t))}flush(){this.buffer.forEach(e=>{this.postMessage(e.protocol,e.command,e.payload)}),this.buffer=[]}}},function(e,t,r){const n=r(57);e.exports=class extends n{constructor(e){super(e),this.onMessage=this.onMessage.bind(this),this.connecting=!1,this.connected=!1,this.buffer=[]}getElement(){return null}isConnected(){return this.connected}setParentElement(){}connect(){let e;this.connecting=!0,this.emit("status",{online:!1,label:"connecting"}),window.addEventListener("message",this.onMessage,!1),this.once("capabilities",()=>{e&&clearTimeout(e),this.connecting=!1,this.connected=!0,this.emit("status",{online:!0,label:"connected"}),this.emit("connected"),this.flush()}),this.postMessage("runtime","getruntime",{}),e=setTimeout(()=>{this.postMessage("runtime","getruntime",{})},500)}updateIframe(){}disconnect(){this.connected=!1,window.removeEventListener("message",this.onMessage,!1),this.emit("status",{online:!1,label:"disconnected"}),this.emit("disconnected")}send(e,t,r){this.connecting?this.buffer.push({protocol:e,command:t,payload:r}):this.postMessage(e,t,r)}postMessage(e,t,r){window.opener&&window.opener.postMessage(JSON.stringify({protocol:e,command:t,payload:r}),"*")}onMessage(e){let t;e.source&&e.source!==window.opener||("string"==typeof e.data?t=JSON.parse(e.data):({data:t}=e),this.recvMessage(t))}flush(){this.buffer.forEach(e=>{this.postMessage(e.protocol,e.command,e.payload)}),this.buffer=[]}}},function(e,t,r){const n=r(14)("fbp-protocol-client:webrtc"),o=r(267),{v4:i}=r(32),a=r(57),{isBrowser:s}=r(66),c=r(128);e.exports=class extends a{constructor(e){super(e),this.id=i(),this.handleMessage=this.handleMessage.bind(this),this.signaller=null,this.connecting=!1,this.protocol="webrtc",this.buffer=[],this.peers={}}getElement(){return null}isConnected(){return!!Object.keys(this.peers).filter(e=>this.peers[e].connected).length}maybeDisconnected(){this.signaller&&!this.signaller.isConnected()&&(this.signaller=null,this.connecting=!1),this.isConnected()||(this.emit("status",{online:!1,label:"disconnected"}),this.emit("disconnected"))}connect(){let e,t;if(this.isConnected()||this.connecting)return;if(this.signaller&&this.signaller.isConnected())return;const o=this.getAddress();-1!==o.indexOf("#")?([t,e]=o.split("#"),"webrtc://"===t&&(t=null)):e=o,t||(t="wss://api.flowhub.io/"),this.signaller=new c(this.id,"client",t);const i={channelName:e,initiator:!0};s()||(i.wrtc=r(281)),this.signaller.connect(),this.signaller.once("connected",()=>{this.signaller.join(e)}),this.signaller.on("join",e=>{this.peers[e.id]||(this.signaller.joinReply(e.id,this.id),this.connectPeer(e,i))}),this.signaller.on("signal",(e,t)=>{const r=this.peers[t.id];r||r.destroyed?(n(`${this.id} received signalling data for peer ${t.id}`),r.signal(e)):n(`${this.id} received signalling data for unknown/destroyed peer ${t.id}`)}),this.signaller.on("error",e=>{n(this.id+" signaller errored",e),this.connecting=!1,this.signaller=null,this.maybeDisconnected(),this.emit("error",e)}),this.signaller.on("disconnected",()=>{this.signaller=null,this.connecting=!1,this.maybeDisconnected()}),this.connecting=!0}connectPeer(e,t){n(`${this.id} connecting to peer ${e.id}`);const r=new o(t);this.peers[e.id]=r,r.on("signal",t=>{n(`${this.id} sending signalling data to peer ${e.id}`),this.signaller.signal(e.id,t)}),r.on("connect",()=>{n(`${this.id} connected to peer ${e.id}`),this.connecting=!1,this.emit("status",{online:!0,label:"connected"}),this.emit("connected"),this.sendRuntime("getruntime",{}),this.flush()}),r.on("data",this.handleMessage),r.on("close",()=>{n(`${this.id} disconnected from peer ${e.id}`),delete this.peers[e.id],this.maybeDisconnected()}),r.on("error",t=>{n(`${this.id} peer ${e.id} errored`,t),delete this.peers[e.id],this.maybeDisconnected(),this.emit("error",t)})}disconnect(){this.connecting=!1,Object.keys(this.peers).forEach(e=>{this.peers[e].destroy(),delete this.peers[e]}),this.signaller&&(this.signaller.disconnect(),this.signaller=null)}send(e,t,r){const n={protocol:e,command:t,payload:r};this.isConnected()?Object.keys(this.peers).forEach(e=>{const t=this.peers[e];t.connected&&t.send(JSON.stringify(n))}):this.buffer.push(n)}handleMessage(e){const t=JSON.parse(e);return this.recvMessage(t)}flush(){this.buffer.forEach(e=>{this.send(e.protocol,e.command,e.payload)}),this.buffer=[]}}},function(e,t,r){e.exports=function(e){function t(e){let r,o=null;function i(...e){if(!i.enabled)return;const n=i,o=Number(new Date),a=o-(r||o);n.diff=a,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r}),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return i.namespace=e,i.useColors=t.useColors(),i.color=t.selectColor(e),i.extend=n,i.destroy=t.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?t.enabled(e):o,set:e=>{o=e}}),"function"==typeof t.init&&t.init(i),i}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(119),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},function(e,t,r){
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
const n=r(14)("simple-peer"),o=r(268),i=r(269),a=r(270),s=r(279),c=r(280),{Buffer:u}=r(34);function p(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}class l extends a.Duplex{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=i(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||i(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||l.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},l.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:o(),!this._wrtc)throw"undefined"==typeof window?c(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):c(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(e){return void s(()=>this.destroy(c(e,"ERR_PC_CONSTRUCTOR")))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach(e=>{this.addStream(e)}),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw c(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(e=>{this._addIceCandidate(e)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(e=>{this.destroy(c(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(c(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(e=>{var r;!t.address||t.address.endsWith(".local")?(r="Ignoring unsupported ICE candidate.",console.warn(r)):this.destroy(c(e,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(e){this.destroy(c(e,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");const r=this._senderMap.get(e)||new Map;let n=r.get(t);if(n)throw n.removed?c(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):c(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");n=this._pc.addTrack(e,t),r.set(t,n),this._senderMap.set(e,r),this._needsNegotiation()}replaceTrack(e,t,r){this._debug("replaceTrack()");const n=this._senderMap.get(e),o=n?n.get(r):null;if(!o)throw c(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),null!=o.replaceTrack?o.replaceTrack(t):this.destroy(c(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");const r=this._senderMap.get(e),n=r?r.get(t):null;if(!n)throw c(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(n):this.destroy(c(e,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,s(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}destroy(e){this._destroy(e,()=>{})}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),s(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}))}_setupData(e){if(!e.channel)return this.destroy(c(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=65536),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{this.destroy(c(e,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1},5e3)}_read(){}_write(e,t,r){if(this.destroyed)return r(c(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(e){return this.destroy(c(e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=r):r(null)}else this._debug("write before connect"),this._chunk=e,this._cb=r}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=p(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})};this._pc.setLocalDescription(e).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(c(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=p(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()};this._pc.setLocalDescription(e).then(()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(c(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(c(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(c(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(c(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach(t=>{Object.assign(e,t)}),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(r=>{const n=[];r.forEach(e=>{n.push(t(e))}),e(null,n)},t=>e(t)):this._pc.getStats.length>0?this._pc.getStats(r=>{if(this.destroyed)return;const n=[];r.result().forEach(e=>{const r={};e.names().forEach(t=>{r[t]=e.stat(t)}),r.id=e.id,r.type=e.type,r.timestamp=e.timestamp,n.push(t(r))}),e(null,n)},t=>e(t)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((t,r)=>{if(this.destroyed)return;t&&(r=[]);const n={},o={},i={};let a=!1;r.forEach(e=>{"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(n[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(o[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(i[e.id]=e)});const s=e=>{a=!0;let t=o[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=Number(t.port)):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=Number(t[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let r=n[e.remoteCandidateId];r&&(r.ip||r.address)?(this.remoteAddress=r.ip||r.address,this.remotePort=Number(r.port)):r&&r.ipAddress?(this.remoteAddress=r.ipAddress,this.remotePort=Number(r.portNumber)):"string"==typeof e.googRemoteAddress&&(r=e.googRemoteAddress.split(":"),this.remoteAddress=r[0],this.remotePort=Number(r[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(r.forEach(e=>{"transport"===e.type&&e.selectedCandidatePairId&&s(i[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&s(e)}),a||Object.keys(i).length&&!Object.keys(o).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(c(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>65536||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=u.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some(e=>e.id===t.id)||(this._remoteStreams.push(t),s(()=>{this._debug("on stream"),this.emit("stream",t)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],n.apply(null,e)}}l.WEBRTC_SUPPORT=!!o(),l.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},l.channelConfig={},e.exports=l},function(e,t){e.exports=function(){if("undefined"==typeof globalThis)return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},function(e,t,r){"use strict";(function(t,n){var o=r(120).Buffer,i=t.crypto||t.msCrypto;i&&i.getRandomValues?e.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var r=o.allocUnsafe(e);if(e>0)if(e>65536)for(var a=0;a<e;a+=65536)i.getRandomValues(r.slice(a,a+65536));else i.getRandomValues(r);if("function"==typeof t)return n.nextTick((function(){t(null,r)}));return r}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,r(26),r(13))},function(e,t,r){(t=e.exports=r(121)).Stream=t,t.Readable=t,t.Writable=r(125),t.Duplex=r(49),t.Transform=r(127),t.PassThrough=r(277),t.finished=r(87),t.pipeline=r(278)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=r(34).Buffer,s=r(273).inspect,c=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,u;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,r,n,o=a.allocUnsafe(e>>>0),i=this.head,s=0;i;)t=i.data,r=o,n=s,a.prototype.copy.call(t,r,n),s+=i.data.length,i=i.next;return o}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var o=t.data,i=e>o.length?o.length:e;if(i===o.length?n+=o:n+=o.slice(0,e),0==(e-=i)){i===o.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=o.slice(i));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var o=r.data,i=e>o.length?o.length:e;if(o.copy(t,t.length-e,0,i),0==(e-=i)){i===o.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=o.slice(i));break}++n}return this.length-=n,t}},{key:c,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&i(t.prototype,r),u&&i(t,u),e}()},,function(e,t,r){(function(t){function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,r(26))},function(e,t,r){"use strict";(function(t){var n;function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(87),a=Symbol("lastResolve"),s=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),p=Symbol("lastPromise"),l=Symbol("handlePromise"),d=Symbol("stream");function h(e,t){return{value:e,done:t}}function f(e){var t=e[a];if(null!==t){var r=e[d].read();null!==r&&(e[p]=null,e[a]=null,e[s]=null,t(h(r,!1)))}}function m(e){t.nextTick(f,e)}var g=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((o(n={get stream(){return this[d]},next:function(){var e=this,r=this[c];if(null!==r)return Promise.reject(r);if(this[u])return Promise.resolve(h(void 0,!0));if(this[d].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[c]?n(e[c]):r(h(void 0,!0))}))}));var n,o=this[p];if(o)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(h(void 0,!0)):t[l](r,n)}),n)}}(o,this));else{var i=this[d].read();if(null!==i)return Promise.resolve(h(i,!1));n=new Promise(this[l])}return this[p]=n,n}},Symbol.asyncIterator,(function(){return this})),o(n,"return",(function(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){e?r(e):t(h(void 0,!0))}))}))})),n),g);e.exports=function(e){var t,r=Object.create(y,(o(t={},d,{value:e,writable:!0}),o(t,a,{value:null,writable:!0}),o(t,s,{value:null,writable:!0}),o(t,c,{value:null,writable:!0}),o(t,u,{value:e._readableState.endEmitted,writable:!0}),o(t,l,{value:function(e,t){var n=r[d].read();n?(r[p]=null,r[a]=null,r[s]=null,e(h(n,!1))):(r[a]=e,r[s]=t)},writable:!0}),t));return r[p]=null,i(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[p]=null,r[a]=null,r[s]=null,t(e)),void(r[c]=e)}var n=r[a];null!==n&&(r[p]=null,r[a]=null,r[s]=null,n(h(void 0,!0))),r[u]=!0})),e.on("readable",m.bind(null,r)),r}}).call(this,r(13))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=o;var n=r(127);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}r(58)(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var o=r(48).codes,i=o.ERR_MISSING_ARGS,a=o.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function c(e,t,o,i){i=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(i);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(87)),n(e,{readable:t,writable:o},(function(e){if(e)return i(e);s=!0,i()}));var c=!1;return function(t){if(!s&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void i(t||new a("pipe"))}}function u(e){e()}function p(e,t){return e.pipe(t)}function l(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,o=l(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new i("streams");var a=t.map((function(e,r){var i=r<t.length-1;return c(e,i,r>0,(function(e){n||(n=e),e&&a.forEach(u),i||(a.forEach(u),o(n))}))}));return t.reduce(p)}},function(e,t){
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
let r;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind(globalThis):e=>(r||(r=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0))},function(e,t,r){"use strict";function n(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,t,r){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof t&&(r=t,t=void 0),null!=t&&(r.code=t);try{return n(e,r)}catch(t){r.message=e.message,r.stack=e.stack;const o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(e)),n(new o,r)}}},function(e,t,r){"use strict";t.MediaStream=window.MediaStream,t.MediaStreamTrack=window.MediaStreamTrack,t.RTCDataChannel=window.RTCDataChannel,t.RTCDataChannelEvent=window.RTCDataChannelEvent,t.RTCDtlsTransport=window.RTCDtlsTransport,t.RTCIceCandidate=window.RTCIceCandidate,t.RTCIceTransport=window.RTCIceTransport,t.RTCPeerConnection=window.RTCPeerConnection,t.RTCPeerConnectionIceEvent=window.RTCPeerConnectionIceEvent,t.RTCRtpReceiver=window.RTCRtpReceiver,t.RTCRtpSender=window.RTCRtpSender,t.RTCRtpTransceiver=window.RTCRtpTransceiver,t.RTCSctpTransport=window.RTCSctpTransport,t.RTCSessionDescription=window.RTCSessionDescription,t.getUserMedia=window.getUserMedia,t.mediaDevices=navigator.mediaDevices},function(e,t){t.sendGraph=function(e,t,r,n){if((null!=e.properties.environment?e.properties.environment.type:void 0)&&!["all",t.definition.type].includes(e.properties.environment.type))return void r(new Error(`Graph type ${e.properties.environment.type} doesn't match runtime type ${t.definition.type}`));if(!t.canDo("protocol:graph"))return void r(new Error("Runtime doesn't support graph protocol"));const o=e.name||e.properties.id;t.sendGraph("clear",{id:o,name:e.name,main:n,library:e.properties.project,icon:e.properties.icon||"",description:e.properties.description||""}),e.nodes.forEach(e=>{t.sendGraph("addnode",{id:e.id,component:e.component,metadata:e.metadata,graph:o})}),e.edges.forEach(e=>{t.sendGraph("addedge",{src:{node:e.from.node,port:e.from.port},tgt:{node:e.to.node,port:e.to.port},metadata:e.metadata,graph:o})}),e.initializers.forEach(e=>{t.sendGraph("addinitial",{src:{data:e.from.data},tgt:{node:e.to.node,port:e.to.port},metadata:e.metadata,graph:o})}),e.inports&&Object.keys(e.inports).forEach(r=>{const n=e.inports[r];t.sendGraph("addinport",{public:r,node:n.process,port:n.port,graph:o})}),e.outports&&Object.keys(e.outports).forEach(r=>{const n=e.outports[r];t.sendGraph("addoutport",{public:r,node:n.process,port:n.port,graph:o})}),r()}},function(e,t,r){const{parse:n}=r(56);t.addressToProtocol=e=>{const t=n(e);switch(t.protocol){case"ws:":case"wss:":return"websocket";case"http:":case"https:":return t.query&&-1!==t.query.indexOf("fbp_protocol=webrtc")?"webrtc":"iframe";default:return null}},t.timedPromise=(e,t,r="Request timed out")=>Promise.race([new Promise(e),new Promise((e,n)=>{setTimeout(()=>{n(new Error(r))},t)})])},function(e,t,r){const n=r(88);function o(e,t,r=!0){return n.shared.capabilities.items._enumDescriptions.filter(n=>r?!(!n.inputs||!n.inputs.length)&&-1!==n.inputs.indexOf(`${e}:${t}`):!(!n.outputs||!n.outputs.length)&&-1!==n.outputs.indexOf(`${e}:${t}`)).map(e=>e.name)}t.canSend=(e,t,r)=>{if("runtime"===e&&"getruntime"===t)return!0;const n=o(e,t,!0);return r.filter(e=>-1!==n.indexOf(e)).length>0},t.canReceive=(e,t,r)=>{if("runtime"===e&&"runtime"===t)return!0;const n=o(e,t,!1);return r.filter(e=>-1!==n.indexOf(e)).length>0}},function(e,t,r){const n=r(286),o=r(320),i=r(88),a=r(321);function s(){}e.exports=()=>{const e=new n({extendRefs:!0,schemaId:"id",logger:{log:s,warn:s,error:console.log}});return e.addMetaSchema(o),e._opts.defaultMeta="http://json-schema.org/draft-04/schema#",Object.keys(i).forEach(t=>{i[t].id=`/${t}/`,e.addSchema(i[t])}),e.addSchema(a),(t,r)=>new Promise((n,o)=>{const[i,a,s]=t.slice(1).split("/");if(!a)return e.validate(t,r)?void n(r):void o(new Error("Runtime definition "+e.errorsText()));const c=r;c.protocol=i,e.validate(t,c)?n(r):o("input"!==a?new Error(`Runtime sent invalid payload for ${i}:${s}: ${e.errorsText()}`):new Error(`Client sent invalid payload for ${i}:${s}: ${e.errorsText()}`))})}},function(e,t,r){"use strict";var n=r(287),o=r(89),i=r(291),a=r(129),s=r(130),c=r(292),u=r(293),p=r(314),l=r(50);e.exports=y,y.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var n=this._addSchema(e);r=n.validate||this._compile(n)}var o=r(t);!0!==r.$async&&(this.errors=r.errors);return o},y.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},y.prototype.addSchema=function(e,t,r,n){if(Array.isArray(e)){for(var i=0;i<e.length;i++)this.addSchema(e[i],void 0,r,n);return this}var a=this._getId(e);if(void 0!==a&&"string"!=typeof a)throw new Error("schema id must be string");return k(this,t=o.normalizeId(t||a)),this._schemas[t]=this._addSchema(e,r,n,!0),this},y.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},y.prototype.validateSchema=function(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(f)?f:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,e);if(!n&&t){var o="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(o);this.logger.error(o)}return n},y.prototype.getSchema=function(e){var t=v(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=o.schema.call(e,{schema:{}},t);if(r){var i=r.schema,s=r.root,c=r.baseId,u=n.call(e,i,s,void 0,c);return e._fragments[t]=new a({ref:t,fragment:!0,schema:i,root:s,baseId:c,validate:u}),u}}(this,e)}},y.prototype.removeSchema=function(e){if(e instanceof RegExp)return b(this,this._schemas,e),b(this,this._refs,e),this;switch(typeof e){case"undefined":return b(this,this._schemas),b(this,this._refs),this._cache.clear(),this;case"string":var t=v(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,n=r?r(e):e;this._cache.del(n);var i=this._getId(e);i&&(i=o.normalizeId(i),delete this._schemas[i],delete this._refs[i])}return this},y.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},y.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,n=void 0===t.dataVar?"data":t.dataVar,o="",i=0;i<e.length;i++){var a=e[i];a&&(o+=n+a.dataPath+" "+a.message+r)}return o.slice(0,-r.length)},y.prototype._addSchema=function(e,t,r,n){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var i=this._opts.serialize,s=i?i(e):e,c=this._cache.get(s);if(c)return c;n=n||!1!==this._opts.addUsedSchema;var u=o.normalizeId(this._getId(e));u&&n&&k(this,u);var p,l=!1!==this._opts.validateSchema&&!t;l&&!(p=u&&u==o.normalizeId(e.$schema))&&this.validateSchema(e,!0);var d=o.ids.call(this,e),h=new a({id:u,schema:e,localRefs:d,cacheKey:s,meta:r});"#"!=u[0]&&n&&(this._refs[u]=h);this._cache.put(s,h),l&&p&&this.validateSchema(e,!0);return h},y.prototype._compile=function(e,t){if(e.compiling)return e.validate=i,i.schema=e.schema,i.errors=null,i.root=t||i,!0===e.schema.$async&&(i.$async=!0),i;var r,o;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{o=n.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=o,e.refs=o.refs,e.refVal=o.refVal,e.root=o.root,o;function i(){var t=e.validate,r=t.apply(this,arguments);return i.errors=t.errors,r}},y.prototype.compileAsync=r(315);var d=r(316);y.prototype.addKeyword=d.add,y.prototype.getKeyword=d.get,y.prototype.removeKeyword=d.remove,y.prototype.validateKeyword=d.validate;var h=r(91);y.ValidationError=h.Validation,y.MissingRefError=h.MissingRef,y.$dataMetaSchema=p;var f="http://json-schema.org/draft-07/schema",m=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],g=["/properties"];function y(e){if(!(this instanceof y))return new y(e);e=this._opts=l.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:_,warn:_,error:_};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=c(e.format),this._cache=e.cache||new i,this._loadingSchemas={},this._compilations=[],this.RULES=u(),this._getId=function(e){switch(e.schemaId){case"auto":return E;case"id":return w;default:return x}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=s),this._metaOpts=function(e){for(var t=l.copy(e._opts),r=0;r<m.length;r++)delete t[m[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(e){var t;e._opts.$data&&(t=r(319),e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var n=r(136);e._opts.$data&&(n=p(n,g));e.addMetaSchema(n,f,!0),e._refs["http://json-schema.org/schema"]=f}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function v(e,t){return t=o.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function b(e,t,r){for(var n in t){var o=t[n];o.meta||r&&!r.test(n)||(e._cache.del(o.cacheKey),delete t[n])}}function w(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function x(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function E(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function k(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function _(){}},function(e,t,r){"use strict";var n=r(89),o=r(50),i=r(91),a=r(130),s=r(131),c=o.ucs2length,u=r(90),p=i.Validation;function l(e,t,r){var n=h.call(this,e,t,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:e,root:t,baseId:r},{index:n,compiling:!1})}function d(e,t,r){var n=h.call(this,e,t,r);n>=0&&this._compilations.splice(n,1)}function h(e,t,r){for(var n=0;n<this._compilations.length;n++){var o=this._compilations[n];if(o.schema==e&&o.root==t&&o.baseId==r)return n}return-1}function f(e,t){return"var pattern"+e+" = new RegExp("+o.toQuotedString(t[e])+");"}function m(e){return"var default"+e+" = defaults["+e+"];"}function g(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function y(e){return"var customRule"+e+" = customRules["+e+"];"}function v(e,t){if(!e.length)return"";for(var r="",n=0;n<e.length;n++)r+=t(n,e);return r}e.exports=function e(t,r,h,b){var w=this,x=this._opts,E=[void 0],k={},_=[],S={},C=[],P={},D=[];r=r||{schema:t,refVal:E,refs:k};var A=l.call(this,t,r,b),O=this._compilations[A.index];if(A.compiling)return O.callValidate=function e(){var t=O.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var j=this._formats,T=this.RULES;try{var F=N(t,r,h,b);O.validate=F;var I=O.callValidate;return I&&(I.schema=F.schema,I.errors=null,I.refs=F.refs,I.refVal=F.refVal,I.root=F.root,I.$async=F.$async,x.sourceCode&&(I.source=F.source)),F}finally{d.call(this,t,r,b)}function N(t,a,l,d){var h=!a||a&&a.schema==t;if(a.schema!=r.schema)return e.call(w,t,a,l,d);var b,S=!0===t.$async,P=s({isTop:!0,schema:t,isRoot:h,baseId:d,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:i.MissingRef,RULES:T,validate:s,util:o,resolve:n,resolveRef:R,usePattern:M,useDefault:q,useCustomRule:U,opts:x,formats:j,logger:w.logger,self:w});P=v(E,g)+v(_,f)+v(C,m)+v(D,y)+P,x.processCode&&(P=x.processCode(P,t));try{b=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",P)(w,T,j,r,E,C,D,u,c,p),E[0]=b}catch(e){throw w.logger.error("Error compiling schema, function code:",P),e}return b.schema=t,b.errors=null,b.refs=k,b.refVal=E,b.root=h?b:a,S&&(b.$async=!0),!0===x.sourceCode&&(b.source={code:P,patterns:_,defaults:C}),b}function R(t,o,i){o=n.url(t,o);var a,s,c=k[o];if(void 0!==c)return L(a=E[c],s="refVal["+c+"]");if(!i&&r.refs){var u=r.refs[o];if(void 0!==u)return L(a=r.refVal[u],s=B(o,a))}s=B(o);var p=n.call(w,N,r,o);if(void 0===p){var l=h&&h[o];l&&(p=n.inlineRef(l,x.inlineRefs)?l:e.call(w,l,r,h,t))}if(void 0!==p)return function(e,t){var r=k[e];E[r]=t}(o,p),L(p,s);!function(e){delete k[e]}(o)}function B(e,t){var r=E.length;return E[r]=t,k[e]=r,"refVal"+r}function L(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function M(e){var t=S[e];return void 0===t&&(t=S[e]=_.length,_[t]=e),"pattern"+t}function q(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return o.toQuotedString(e);case"object":if(null===e)return"null";var t=a(e),r=P[t];return void 0===r&&(r=P[t]=C.length,C[r]=e),"default"+r}}function U(e,t,r,n){if(!1!==w._opts.validateSchema){var o=e.definition.dependencies;if(o&&!o.every((function(e){return Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have all required keywords: "+o.join(","));var i=e.definition.validateSchema;if(i)if(!i(t)){var a="keyword schema is invalid: "+w.errorsText(i.errors);if("log"!=w._opts.validateSchema)throw new Error(a);w.logger.error(a)}}var s,c=e.definition.compile,u=e.definition.inline,p=e.definition.macro;if(c)s=c.call(w,t,r,n);else if(p)s=p.call(w,t,r,n),!1!==x.validateSchema&&w.validateSchema(s,!0);else if(u)s=u.call(w,n,e.keyword,t,r);else if(!(s=e.definition.validate))return;if(void 0===s)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var l=D.length;return D[l]=s,{code:"customRule"+l,validate:s}}}},function(e,t,r){
/** @license URI.js v4.4.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,o=1;o<n;++o)t[o]=t[o].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function o(e){return e.toUpperCase()}function i(e){var n=t("[0-9]","[A-Fa-f]"),o=r(r("%[EFef]"+n+"%"+n+n+"%"+n+n)+"|"+r("%[89A-Fa-f]"+n+"%"+n+n)+"|"+r("%"+n+n)),i="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",a=t("[\\:\\/\\?\\#\\[\\]\\@]",i),s=e?"[\\uE000-\\uF8FF]":"[]",c=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),u=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),p=r(r(o+"|"+t(c,i,"[\\:]"))+"*"),l=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),d=r(l+"\\."+l+"\\."+l+"\\."+l),h=r(n+"{1,4}"),f=r(r(h+"\\:"+h)+"|"+d),m=r(r(h+"\\:")+"{6}"+f),g=r("\\:\\:"+r(h+"\\:")+"{5}"+f),y=r(r(h)+"?\\:\\:"+r(h+"\\:")+"{4}"+f),v=r(r(r(h+"\\:")+"{0,1}"+h)+"?\\:\\:"+r(h+"\\:")+"{3}"+f),b=r(r(r(h+"\\:")+"{0,2}"+h)+"?\\:\\:"+r(h+"\\:")+"{2}"+f),w=r(r(r(h+"\\:")+"{0,3}"+h)+"?\\:\\:"+h+"\\:"+f),x=r(r(r(h+"\\:")+"{0,4}"+h)+"?\\:\\:"+f),E=r(r(r(h+"\\:")+"{0,5}"+h)+"?\\:\\:"+h),k=r(r(r(h+"\\:")+"{0,6}"+h)+"?\\:\\:"),_=r([m,g,y,v,b,w,x,E,k].join("|")),S=r(r(c+"|"+o)+"+"),C=(r(_+"\\%25"+S),r(_+r("\\%25|\\%(?!"+n+"{2})")+S)),P=r("[vV]"+n+"+\\."+t(c,i,"[\\:]")+"+"),D=r("\\["+r(C+"|"+_+"|"+P)+"\\]"),A=r(r(o+"|"+t(c,i))+"*"),O=r(D+"|"+d+"(?!"+A+")|"+A),j=r("[0-9]*"),T=r(r(p+"@")+"?"+O+r("\\:"+j)+"?"),F=r(o+"|"+t(c,i,"[\\:\\@]")),I=r(F+"*"),N=r(F+"+"),R=r(r(o+"|"+t(c,i,"[\\@]"))+"+"),B=r(r("\\/"+I)+"*"),L=r("\\/"+r(N+B)+"?"),M=r(R+B),q=r(N+B),U="(?!"+F+")",$=(r(B+"|"+L+"|"+M+"|"+q+"|"+U),r(r(F+"|"+t("[\\/\\?]",s))+"*")),z=r(r(F+"|[\\/\\?]")+"*"),G=r(r("\\/\\/"+T+B)+"|"+L+"|"+q+"|"+U),H=r(u+"\\:"+G+r("\\?"+$)+"?"+r("\\#"+z)+"?"),J=r(r("\\/\\/"+T+B)+"|"+L+"|"+M+"|"+U),X=r(J+r("\\?"+$)+"?"+r("\\#"+z)+"?");return r(H+"|"+X),r(u+"\\:"+G+r("\\?"+$)+"?"),r(r("\\/\\/("+r("("+p+")@")+"?("+O+")"+r("\\:("+j+")")+"?)")+"?("+B+"|"+L+"|"+q+"|"+U+")"),r("\\?("+$+")"),r("\\#("+z+")"),r(r("\\/\\/("+r("("+p+")@")+"?("+O+")"+r("\\:("+j+")")+"?)")+"?("+B+"|"+L+"|"+M+"|"+U+")"),r("\\?("+$+")"),r("\\#("+z+")"),r(r("\\/\\/("+r("("+p+")@")+"?("+O+")"+r("\\:("+j+")")+"?)")+"?("+B+"|"+L+"|"+q+"|"+U+")"),r("\\?("+$+")"),r("\\#("+z+")"),r("("+p+")@"),r("\\:("+j+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",c,i),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",c,i),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",c,i),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",c,i),"g"),NOT_QUERY:new RegExp(t("[^\\%]",c,i,"[\\:\\@\\/\\?]",s),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",c,i,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",c,i),"g"),UNRESERVED:new RegExp(c,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",c,a),"g"),PCT_ENCODED:new RegExp(o,"g"),IPV4ADDRESS:new RegExp("^("+d+")$"),IPV6ADDRESS:new RegExp("^\\[?("+_+")"+r(r("\\%25|\\%(?!"+n+"{2})")+"("+S+")")+"?\\]?$")}}var a=i(!1),s=i(!0),c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=2147483647,p=/^xn--/,l=/[^\0-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function g(e){throw new RangeError(h[e])}function y(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var o=function(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}((e=e.replace(d,".")).split("."),t).join(".");return n+o}function v(e){for(var t=[],r=0,n=e.length;r<n;){var o=e.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){var i=e.charCodeAt(r++);56320==(64512&i)?t.push(((1023&o)<<10)+(1023&i)+65536):(t.push(o),r--)}else t.push(o)}return t}var b=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},w=function(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=36)e=f(e/35);return f(n+36*e/(e+38))},x=function(e){var t,r=[],n=e.length,o=0,i=128,a=72,s=e.lastIndexOf("-");s<0&&(s=0);for(var c=0;c<s;++c)e.charCodeAt(c)>=128&&g("not-basic"),r.push(e.charCodeAt(c));for(var p=s>0?s+1:0;p<n;){for(var l=o,d=1,h=36;;h+=36){p>=n&&g("invalid-input");var m=(t=e.charCodeAt(p++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>f((u-o)/d))&&g("overflow"),o+=m*d;var y=h<=a?1:h>=a+26?26:h-a;if(m<y)break;var v=36-y;d>f(u/v)&&g("overflow"),d*=v}var b=r.length+1;a=w(o-l,b,0==l),f(o/b)>u-i&&g("overflow"),i+=f(o/b),o%=b,r.splice(o++,0,i)}return String.fromCodePoint.apply(String,r)},E=function(e){var t=[],r=(e=v(e)).length,n=128,o=0,i=72,a=!0,s=!1,c=void 0;try{for(var p,l=e[Symbol.iterator]();!(a=(p=l.next()).done);a=!0){var d=p.value;d<128&&t.push(m(d))}}catch(e){s=!0,c=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw c}}var h=t.length,y=h;for(h&&t.push("-");y<r;){var x=u,E=!0,k=!1,_=void 0;try{for(var S,C=e[Symbol.iterator]();!(E=(S=C.next()).done);E=!0){var P=S.value;P>=n&&P<x&&(x=P)}}catch(e){k=!0,_=e}finally{try{!E&&C.return&&C.return()}finally{if(k)throw _}}var D=y+1;x-n>f((u-o)/D)&&g("overflow"),o+=(x-n)*D,n=x;var A=!0,O=!1,j=void 0;try{for(var T,F=e[Symbol.iterator]();!(A=(T=F.next()).done);A=!0){var I=T.value;if(I<n&&++o>u&&g("overflow"),I==n){for(var N=o,R=36;;R+=36){var B=R<=i?1:R>=i+26?26:R-i;if(N<B)break;var L=N-B,M=36-B;t.push(m(b(B+L%M,0))),N=f(L/M)}t.push(m(b(N,0))),i=w(o,D,y==h),o=0,++y}}}catch(e){O=!0,j=e}finally{try{!A&&F.return&&F.return()}finally{if(O)throw j}}++o,++n}return t.join("")},k=function(e){return y(e,(function(e){return l.test(e)?"xn--"+E(e):e}))},_=function(e){return y(e,(function(e){return p.test(e)?x(e.slice(4).toLowerCase()):e}))},S={};function C(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function P(e){for(var t="",r=0,n=e.length;r<n;){var o=parseInt(e.substr(r+1,2),16);if(o<128)t+=String.fromCharCode(o),r+=3;else if(o>=194&&o<224){if(n-r>=6){var i=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&o)<<6|63&i)}else t+=e.substr(r,6);r+=6}else if(o>=224){if(n-r>=9){var a=parseInt(e.substr(r+4,2),16),s=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&s)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function D(e,t){function r(e){var r=P(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,C).replace(t.PCT_ENCODED,o)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,C).replace(t.PCT_ENCODED,o)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,C).replace(t.PCT_ENCODED,o)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,C).replace(t.PCT_ENCODED,o)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,C).replace(t.PCT_ENCODED,o)),e}function A(e){return e.replace(/^0*(.*)/,"$1")||"0"}function O(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=c(r,2)[1];return n?n.split(".").map(A).join("."):e}function j(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=c(r,3),o=n[1],i=n[2];if(o){for(var a=o.toLowerCase().split("::").reverse(),s=c(a,2),u=s[0],p=s[1],l=p?p.split(":").map(A):[],d=u.split(":").map(A),h=t.IPV4ADDRESS.test(d[d.length-1]),f=h?7:8,m=d.length-f,g=Array(f),y=0;y<f;++y)g[y]=l[y]||d[m+y]||"";h&&(g[f-1]=O(g[f-1],t));var v=g.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(v&&v.length>1){var w=g.slice(0,v.index),x=g.slice(v.index+v.length);b=w.join(":")+"::"+x.join(":")}else b=g.join(":");return i&&(b+="%"+i),b}return e}var T=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,F=void 0==="".match(/(){0}/)[1];function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?s:a;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var o=e.match(T);if(o){F?(r.scheme=o[1],r.userinfo=o[3],r.host=o[4],r.port=parseInt(o[5],10),r.path=o[6]||"",r.query=o[7],r.fragment=o[8],isNaN(r.port)&&(r.port=o[5])):(r.scheme=o[1]||void 0,r.userinfo=-1!==e.indexOf("@")?o[3]:void 0,r.host=-1!==e.indexOf("//")?o[4]:void 0,r.port=parseInt(o[5],10),r.path=o[6]||"",r.query=-1!==e.indexOf("?")?o[7]:void 0,r.fragment=-1!==e.indexOf("#")?o[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?o[4]:void 0)),r.host&&(r.host=j(O(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var i=S[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||i&&i.unicodeSupport)D(r,n);else{if(r.host&&(t.domainHost||i&&i.domainHost))try{r.host=k(r.host.replace(n.PCT_ENCODED,P).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}D(r,a)}i&&i.parse&&i.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function N(e,t){var r=!1!==t.iri?s:a,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(j(O(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var R=/^\.\.?\//,B=/^\/\.(\/|$)/,L=/^\/\.\.(\/|$)/,M=/^\/?(?:.|\n)*?(?=\/|$)/;function q(e){for(var t=[];e.length;)if(e.match(R))e=e.replace(R,"");else if(e.match(B))e=e.replace(B,"/");else if(e.match(L))e=e.replace(L,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(M);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?s:a,n=[],o=S[(t.scheme||e.scheme||"").toLowerCase()];if(o&&o.serialize&&o.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||o&&o.domainHost)try{e.host=t.iri?_(e.host):k(e.host.replace(r.PCT_ENCODED,P).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}D(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var i=N(e,t);if(void 0!==i&&("suffix"!==t.reference&&n.push("//"),n.push(i),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var c=e.path;t.absolutePath||o&&o.absolutePath||(c=q(c)),void 0===i&&(c=c.replace(/^\/\//,"/%2F")),n.push(c)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function $(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],o={};return n||(e=I(U(e,r),r),t=I(U(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(o.scheme=t.scheme,o.userinfo=t.userinfo,o.host=t.host,o.port=t.port,o.path=q(t.path||""),o.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(o.userinfo=t.userinfo,o.host=t.host,o.port=t.port,o.path=q(t.path||""),o.query=t.query):(t.path?("/"===t.path.charAt(0)?o.path=q(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?o.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:o.path=t.path:o.path="/"+t.path,o.path=q(o.path)),o.query=t.query):(o.path=e.path,void 0!==t.query?o.query=t.query:o.query=e.query),o.userinfo=e.userinfo,o.host=e.host,o.port=e.port),o.scheme=e.scheme),o.fragment=t.fragment,o}function z(e,t){return e&&e.toString().replace(t&&t.iri?s.PCT_ENCODED:a.PCT_ENCODED,P)}var G={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},H={scheme:"https",domainHost:G.domainHost,parse:G.parse,serialize:G.serialize};function J(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var X={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=J(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(J(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=c(r,2),o=n[0],i=n[1];e.path=o&&"/"!==o?o:void 0,e.query=i,e.resourceName=void 0}return e.fragment=void 0,e}},V={scheme:"wss",domainHost:X.domainHost,parse:X.parse,serialize:X.serialize},K={},W="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Q="[0-9A-Fa-f]",Y=r(r("%[EFef]"+Q+"%"+Q+Q+"%"+Q+Q)+"|"+r("%[89A-Fa-f]"+Q+"%"+Q+Q)+"|"+r("%"+Q+Q)),Z=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),ee=new RegExp(W,"g"),te=new RegExp(Y,"g"),re=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Z),"g"),ne=new RegExp(t("[^]",W,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),oe=ne;function ie(e){var t=P(e);return t.match(ee)?t:e}var ae={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var o=!1,i={},a=r.query.split("&"),s=0,c=a.length;s<c;++s){var u=a[s].split("=");switch(u[0]){case"to":for(var p=u[1].split(","),l=0,d=p.length;l<d;++l)n.push(p[l]);break;case"subject":r.subject=z(u[1],t);break;case"body":r.body=z(u[1],t);break;default:o=!0,i[z(u[0],t)]=z(u[1],t)}}o&&(r.headers=i)}r.query=void 0;for(var h=0,f=n.length;h<f;++h){var m=n[h].split("@");if(m[0]=z(m[0]),t.unicodeSupport)m[1]=z(m[1],t).toLowerCase();else try{m[1]=k(z(m[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}n[h]=m.join("@")}return r},serialize:function(e,t){var r,n=e,i=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(i){for(var a=0,s=i.length;a<s;++a){var c=String(i[a]),u=c.lastIndexOf("@"),p=c.slice(0,u).replace(te,ie).replace(te,o).replace(re,C),l=c.slice(u+1);try{l=t.iri?_(l):k(z(l,t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}i[a]=p+"@"+l}n.path=i.join(",")}var d=e.headers=e.headers||{};e.subject&&(d.subject=e.subject),e.body&&(d.body=e.body);var h=[];for(var f in d)d[f]!==K[f]&&h.push(f.replace(te,ie).replace(te,o).replace(ne,C)+"="+d[f].replace(te,ie).replace(te,o).replace(oe,C));return h.length&&(n.query=h.join("&")),n}},se=/^([^\:]+)\:(.*)/,ce={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(se),n=e;if(r){var o=t.scheme||n.scheme||"urn",i=r[1].toLowerCase(),a=r[2],s=o+":"+(t.nid||i),c=S[s];n.nid=i,n.nss=a,n.path=void 0,c&&(n=c.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,o=r+":"+(t.nid||n),i=S[o];i&&(e=i.serialize(e,t));var a=e,s=e.nss;return a.path=(n||t.nid)+":"+s,a}},ue=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,pe={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ue)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};S[G.scheme]=G,S[H.scheme]=H,S[X.scheme]=X,S[V.scheme]=V,S[ae.scheme]=ae,S[ce.scheme]=ce,S[pe.scheme]=pe,e.SCHEMES=S,e.pctEncChar=C,e.pctDecChars=P,e.parse=I,e.removeDotSegments=q,e.serialize=U,e.resolveComponents=$,e.resolve=function(e,t,r){var n=function(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}({scheme:"null"},r);return U($(I(e,n),I(t,n),n,!0),n)},e.normalize=function(e,t){return"string"==typeof e?e=U(I(e,t),t):"object"===n(e)&&(e=I(U(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=U(I(e,r),r):"object"===n(e)&&(e=U(e,r)),"string"==typeof t?t=U(I(t,r),r):"object"===n(t)&&(t=U(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?s.ESCAPE:a.ESCAPE,C)},e.unescapeComponent=z,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=0,n=e.length,o=0;o<n;)r++,(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<n&&56320==(64512&(t=e.charCodeAt(o)))&&o++;return r}},function(e,t,r){"use strict";var n=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,o,i,a,s,c,u,p,l){if(i&&"object"==typeof i&&!Array.isArray(i)){for(var d in r(i,a,s,c,u,p,l),i){var h=i[d];if(Array.isArray(h)){if(d in n.arrayKeywords)for(var f=0;f<h.length;f++)e(t,r,o,h[f],a+"/"+d+"/"+f,s,a,d,i,f)}else if(d in n.propsKeywords){if(h&&"object"==typeof h)for(var m in h)e(t,r,o,h[m],a+"/"+d+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),s,a,d,i,m)}else(d in n.keywords||t.allKeys&&!(d in n.skipKeywords))&&e(t,r,o,h,a+"/"+d,s,a,d,i)}o(i,a,s,c,u,p,l)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};n.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},n.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},n.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},n.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,r){"use strict";var n=e.exports=function(){this._cache={}};n.prototype.put=function(e,t){this._cache[e]=t},n.prototype.get=function(e){return this._cache[e]},n.prototype.del=function(e){delete this._cache[e]},n.prototype.clear=function(){this._cache={}}},function(e,t,r){"use strict";var n=r(50),o=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,s=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,c=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,u=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,p=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,l=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,d=/^(?:\/(?:[^~/]|~0|~1)*)*$/,h=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,f=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function m(e){return e="full"==e?"full":"fast",n.copy(m[e])}function g(e){var t=e.match(o);if(!t)return!1;var r=+t[1],n=+t[2],a=+t[3];return n>=1&&n<=12&&a>=1&&a<=(2==n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:i[n])}function y(e,t){var r=e.match(a);if(!r)return!1;var n=r[1],o=r[2],i=r[3],s=r[5];return(n<=23&&o<=59&&i<=59||23==n&&59==o&&60==i)&&(!t||s)}e.exports=m,m.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":u,url:p,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:s,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:x,uuid:l,"json-pointer":d,"json-pointer-uri-fragment":h,"relative-json-pointer":f},m.full={date:g,time:y,"date-time":function(e){var t=e.split(v);return 2==t.length&&g(t[0])&&y(t[1],!0)},uri:function(e){return b.test(e)&&c.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":u,url:p,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:s,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:x,uuid:l,"json-pointer":d,"json-pointer-uri-fragment":h,"relative-json-pointer":f};var v=/t|\s/i;var b=/\/|:/;var w=/[^\\]\\Z/;function x(e){if(w.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},function(e,t,r){"use strict";var n=r(294),o=r(50).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=o(t),e.types=o(["number","integer","string","array","object","boolean","null"]),e.forEach((function(r){r.rules=r.rules.map((function(r){var o;if("object"==typeof r){var i=Object.keys(r)[0];o=r[i],r=i,o.forEach((function(r){t.push(r),e.all[r]=!0}))}return t.push(r),e.all[r]={keyword:r,code:n[r],implements:o}})),e.all.$comment={keyword:"$comment",code:n.$comment},r.type&&(e.types[r.type]=r)})),e.keywords=o(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},function(e,t,r){"use strict";e.exports={$ref:r(295),allOf:r(296),anyOf:r(297),$comment:r(298),const:r(299),contains:r(300),dependencies:r(301),enum:r(302),format:r(303),if:r(304),items:r(305),maximum:r(132),minimum:r(132),maxItems:r(133),minItems:r(133),maxLength:r(134),minLength:r(134),maxProperties:r(135),minProperties:r(135),multipleOf:r(306),not:r(307),oneOf:r(308),pattern:r(309),properties:r(310),propertyNames:r(311),required:r(312),uniqueItems:r(313),validate:r(131)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o,i=" ",a=e.level,s=e.dataLevel,c=e.schema[t],u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(s||""),d="valid"+a;if("#"==c||"#/"==c)e.isRoot?(n=e.async,o="validate"):(n=!0===e.root.schema.$async,o="root.refVal[0]");else{var h=e.resolveRef(e.baseId,c,e.isRoot);if(void 0===h){var f=e.MissingRefError.message(e.baseId,c);if("fail"==e.opts.missingRefs){e.logger.error(f),(v=v||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { ref: '"+e.util.escapeQuotes(c)+"' } ",!1!==e.opts.messages&&(i+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(c)+"' "),e.opts.verbose&&(i+=" , schema: "+e.util.toQuotedString(c)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),i+=" } "):i+=" {} ";var m=i;i=v.pop(),!e.compositeRule&&p?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",p&&(i+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,c,f);e.logger.warn(f),p&&(i+=" if (true) { ")}}else if(h.inline){var g=e.util.copy(e);g.level++;var y="valid"+g.level;g.schema=h.schema,g.schemaPath="",g.errSchemaPath=c,i+=" "+e.validate(g).replace(/validate\.schema/g,h.code)+" ",p&&(i+=" if ("+y+") { ")}else n=!0===h.$async||e.async&&!1!==h.$async,o=h.code}if(o){var v;(v=v||[]).push(i),i="",e.opts.passContext?i+=" "+o+".call(this, ":i+=" "+o+"( ",i+=" "+l+", (dataPath || '')",'""'!=e.errorPath&&(i+=" + "+e.errorPath);var b=i+=" , "+(s?"data"+(s-1||""):"parentData")+" , "+(s?e.dataPathArr[s]:"parentDataProperty")+", rootData)  ";if(i=v.pop(),n){if(!e.async)throw new Error("async schema referenced by sync schema");p&&(i+=" var "+d+"; "),i+=" try { await "+b+"; ",p&&(i+=" "+d+" = true; "),i+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",p&&(i+=" "+d+" = false; "),i+=" } ",p&&(i+=" if ("+d+") { ")}else i+=" if (!"+b+") { if (vErrors === null) vErrors = "+o+".errors; else vErrors = vErrors.concat("+o+".errors); errors = vErrors.length; } ",p&&(i+=" else { ")}return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),a=e.errSchemaPath+"/"+t,s=!e.opts.allErrors,c=e.util.copy(e),u="";c.level++;var p="valid"+c.level,l=c.baseId,d=!0,h=o;if(h)for(var f,m=-1,g=h.length-1;m<g;)f=h[m+=1],(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0||!1===f:e.util.schemaHasRules(f,e.RULES.all))&&(d=!1,c.schema=f,c.schemaPath=i+"["+m+"]",c.errSchemaPath=a+"/"+m,n+="  "+e.validate(c)+" ",c.baseId=l,s&&(n+=" if ("+p+") { ",u+="}"));return s&&(n+=d?" if (true) { ":" "+u.slice(0,-1)+" "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d="errs__"+o,h=e.util.copy(e),f="";h.level++;var m="valid"+h.level;if(a.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0||!1===t:e.util.schemaHasRules(t,e.RULES.all)}))){var g=h.baseId;n+=" var "+d+" = errors; var "+l+" = false;  ";var y=e.compositeRule;e.compositeRule=h.compositeRule=!0;var v=a;if(v)for(var b,w=-1,x=v.length-1;w<x;)b=v[w+=1],h.schema=b,h.schemaPath=s+"["+w+"]",h.errSchemaPath=c+"/"+w,n+="  "+e.validate(h)+" ",h.baseId=g,n+=" "+l+" = "+l+" || "+m+"; if (!"+l+") { ",f+="}";e.compositeRule=h.compositeRule=y,n+=" "+f+" if (!"+l+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else u&&(n+=" if (true) { ");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.schema[t],i=e.errSchemaPath+"/"+t,a=(e.opts.allErrors,e.util.toQuotedString(o));return!0===e.opts.$comment?n+=" console.log("+a+");":"function"==typeof e.opts.$comment&&(n+=" self._opts.$comment("+a+", "+e.util.toQuotedString(i)+", validate.root.schema);"),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d=e.opts.$data&&a&&a.$data;d&&(n+=" var schema"+o+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; "),d||(n+=" var schema"+o+" = validate.schema"+s+";"),n+="var "+l+" = equal("+p+", schema"+o+"); if (!"+l+") {   ";var h=h||[];h.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValue: schema"+o+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to constant' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var f=n;return n=h.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d="errs__"+o,h=e.util.copy(e);h.level++;var f="valid"+h.level,m="i"+o,g=h.dataLevel=e.dataLevel+1,y="data"+g,v=e.baseId,b=e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all);if(n+="var "+d+" = errors;var "+l+";",b){var w=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=a,h.schemaPath=s,h.errSchemaPath=c,n+=" var "+f+" = false; for (var "+m+" = 0; "+m+" < "+p+".length; "+m+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var x=p+"["+m+"]";h.dataPathArr[g]=m;var E=e.validate(h);h.baseId=v,e.util.varOccurences(E,y)<2?n+=" "+e.util.varReplace(E,y,x)+" ":n+=" var "+y+" = "+x+"; "+E+" ",n+=" if ("+f+") break; }  ",e.compositeRule=h.compositeRule=w,n+="  if (!"+f+") {"}else n+=" if ("+p+".length == 0) {";var k=k||[];k.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should contain a valid item' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var _=n;return n=k.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+_+"]); ":n+=" validate.errors = ["+_+"]; return false; ":n+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { ",b&&(n+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(n+=" } "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="errs__"+o,d=e.util.copy(e),h="";d.level++;var f="valid"+d.level,m={},g={},y=e.opts.ownProperties;for(x in a)if("__proto__"!=x){var v=a[x],b=Array.isArray(v)?g:m;b[x]=v}n+="var "+l+" = errors;";var w=e.errorPath;for(var x in n+="var missing"+o+";",g)if((b=g[x]).length){if(n+=" if ( "+p+e.util.getProperty(x)+" !== undefined ",y&&(n+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(x)+"') "),u){n+=" && ( ";var E=b;if(E)for(var k=-1,_=E.length-1;k<_;){O=E[k+=1],k&&(n+=" || "),n+=" ( ( "+(I=p+(F=e.util.getProperty(O)))+" === undefined ",y&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),n+=") && (missing"+o+" = "+e.util.toQuotedString(e.opts.jsonPointers?O:F)+") ) "}n+=")) {  ";var S="missing"+o,C="' + "+S+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(w,S,!0):w+" + "+S);var P=P||[];P.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(x)+"', missingProperty: '"+C+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==b.length?n+="property "+e.util.escapeQuotes(b[0]):n+="properties "+e.util.escapeQuotes(b.join(", ")),n+=" when property "+e.util.escapeQuotes(x)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var D=n;n=P.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+D+"]); ":n+=" validate.errors = ["+D+"]; return false; ":n+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{n+=" ) { ";var A=b;if(A)for(var O,j=-1,T=A.length-1;j<T;){O=A[j+=1];var F=e.util.getProperty(O),I=(C=e.util.escapeQuotes(O),p+F);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(w,O,e.opts.jsonPointers)),n+=" if ( "+I+" === undefined ",y&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(x)+"', missingProperty: '"+C+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==b.length?n+="property "+e.util.escapeQuotes(b[0]):n+="properties "+e.util.escapeQuotes(b.join(", ")),n+=" when property "+e.util.escapeQuotes(x)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}n+=" }   ",u&&(h+="}",n+=" else { ")}e.errorPath=w;var N=d.baseId;for(var x in m){v=m[x];(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0||!1===v:e.util.schemaHasRules(v,e.RULES.all))&&(n+=" "+f+" = true; if ( "+p+e.util.getProperty(x)+" !== undefined ",y&&(n+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(x)+"') "),n+=") { ",d.schema=v,d.schemaPath=s+e.util.getProperty(x),d.errSchemaPath=c+"/"+e.util.escapeFragment(x),n+="  "+e.validate(d)+" ",d.baseId=N,n+=" }  ",u&&(n+=" if ("+f+") { ",h+="}"))}return u&&(n+="   "+h+" if ("+l+" == errors) {"),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d=e.opts.$data&&a&&a.$data;d&&(n+=" var schema"+o+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; ");var h="i"+o,f="schema"+o;d||(n+=" var "+f+" = validate.schema"+s+";"),n+="var "+l+";",d&&(n+=" if (schema"+o+" === undefined) "+l+" = true; else if (!Array.isArray(schema"+o+")) "+l+" = false; else {"),n+=l+" = false;for (var "+h+"=0; "+h+"<"+f+".length; "+h+"++) if (equal("+p+", "+f+"["+h+"])) { "+l+" = true; break; }",d&&(n+="  }  "),n+=" if (!"+l+") {   ";var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+o+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var g=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||"");if(!1===e.opts.format)return u&&(n+=" if (true) { "),n;var l,d=e.opts.$data&&a&&a.$data;d?(n+=" var schema"+o+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; ",l="schema"+o):l=a;var h=e.opts.unknownFormats,f=Array.isArray(h);if(d){n+=" var "+(m="format"+o)+" = formats["+l+"]; var "+(g="isObject"+o)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(y="formatType"+o)+" = "+g+" && "+m+".type || 'string'; if ("+g+") { ",e.async&&(n+=" var async"+o+" = "+m+".async; "),n+=" "+m+" = "+m+".validate; } if (  ",d&&(n+=" ("+l+" !== undefined && typeof "+l+" != 'string') || "),n+=" (","ignore"!=h&&(n+=" ("+l+" && !"+m+" ",f&&(n+=" && self._opts.unknownFormats.indexOf("+l+") == -1 "),n+=") || "),n+=" ("+m+" && "+y+" == '"+r+"' && !(typeof "+m+" == 'function' ? ",e.async?n+=" (async"+o+" ? await "+m+"("+p+") : "+m+"("+p+")) ":n+=" "+m+"("+p+") ",n+=" : "+m+".test("+p+"))))) {"}else{var m;if(!(m=e.formats[a])){if("ignore"==h)return e.logger.warn('unknown format "'+a+'" ignored in schema at path "'+e.errSchemaPath+'"'),u&&(n+=" if (true) { "),n;if(f&&h.indexOf(a)>=0)return u&&(n+=" if (true) { "),n;throw new Error('unknown format "'+a+'" is used in schema at path "'+e.errSchemaPath+'"')}var g,y=(g="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(g){var v=!0===m.async;m=m.validate}if(y!=r)return u&&(n+=" if (true) { "),n;if(v){if(!e.async)throw new Error("async format in sync schema");n+=" if (!(await "+(b="formats"+e.util.getProperty(a)+".validate")+"("+p+"))) { "}else{n+=" if (! ";var b="formats"+e.util.getProperty(a);g&&(b+=".validate"),n+="function"==typeof m?" "+b+"("+p+") ":" "+b+".test("+p+") ",n+=") { "}}var w=w||[];w.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",n+=d?""+l:""+e.util.toQuotedString(a),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match format \"",n+=d?"' + "+l+" + '":""+e.util.escapeQuotes(a),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=d?"validate.schema"+s:""+e.util.toQuotedString(a),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var x=n;return n=w.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+x+"]); ":n+=" validate.errors = ["+x+"]; return false; ":n+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d="errs__"+o,h=e.util.copy(e);h.level++;var f="valid"+h.level,m=e.schema.then,g=e.schema.else,y=void 0!==m&&(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0||!1===m:e.util.schemaHasRules(m,e.RULES.all)),v=void 0!==g&&(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0||!1===g:e.util.schemaHasRules(g,e.RULES.all)),b=h.baseId;if(y||v){var w;h.createErrors=!1,h.schema=a,h.schemaPath=s,h.errSchemaPath=c,n+=" var "+d+" = errors; var "+l+" = true;  ";var x=e.compositeRule;e.compositeRule=h.compositeRule=!0,n+="  "+e.validate(h)+" ",h.baseId=b,h.createErrors=!0,n+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=h.compositeRule=x,y?(n+=" if ("+f+") {  ",h.schema=e.schema.then,h.schemaPath=e.schemaPath+".then",h.errSchemaPath=e.errSchemaPath+"/then",n+="  "+e.validate(h)+" ",h.baseId=b,n+=" "+l+" = "+f+"; ",y&&v?n+=" var "+(w="ifClause"+o)+" = 'then'; ":w="'then'",n+=" } ",v&&(n+=" else { ")):n+=" if (!"+f+") { ",v&&(h.schema=e.schema.else,h.schemaPath=e.schemaPath+".else",h.errSchemaPath=e.errSchemaPath+"/else",n+="  "+e.validate(h)+" ",h.baseId=b,n+=" "+l+" = "+f+"; ",y&&v?n+=" var "+(w="ifClause"+o)+" = 'else'; ":w="'else'",n+=" } "),n+=" if (!"+l+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+w+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match \"' + "+w+" + '\" schema' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" }   ",u&&(n+=" else { ")}else u&&(n+=" if (true) { ");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d="errs__"+o,h=e.util.copy(e),f="";h.level++;var m="valid"+h.level,g="i"+o,y=h.dataLevel=e.dataLevel+1,v="data"+y,b=e.baseId;if(n+="var "+d+" = errors;var "+l+";",Array.isArray(a)){var w=e.schema.additionalItems;if(!1===w){n+=" "+l+" = "+p+".length <= "+a.length+"; ";var x=c;c=e.errSchemaPath+"/additionalItems",n+="  if (!"+l+") {   ";var E=E||[];E.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a.length+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have more than "+a.length+" items' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var k=n;n=E.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+k+"]); ":n+=" validate.errors = ["+k+"]; return false; ":n+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",c=x,u&&(f+="}",n+=" else { ")}var _=a;if(_)for(var S,C=-1,P=_.length-1;C<P;)if(S=_[C+=1],e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0||!1===S:e.util.schemaHasRules(S,e.RULES.all)){n+=" "+m+" = true; if ("+p+".length > "+C+") { ";var D=p+"["+C+"]";h.schema=S,h.schemaPath=s+"["+C+"]",h.errSchemaPath=c+"/"+C,h.errorPath=e.util.getPathExpr(e.errorPath,C,e.opts.jsonPointers,!0),h.dataPathArr[y]=C;var A=e.validate(h);h.baseId=b,e.util.varOccurences(A,v)<2?n+=" "+e.util.varReplace(A,v,D)+" ":n+=" var "+v+" = "+D+"; "+A+" ",n+=" }  ",u&&(n+=" if ("+m+") { ",f+="}")}if("object"==typeof w&&(e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0||!1===w:e.util.schemaHasRules(w,e.RULES.all))){h.schema=w,h.schemaPath=e.schemaPath+".additionalItems",h.errSchemaPath=e.errSchemaPath+"/additionalItems",n+=" "+m+" = true; if ("+p+".length > "+a.length+") {  for (var "+g+" = "+a.length+"; "+g+" < "+p+".length; "+g+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);D=p+"["+g+"]";h.dataPathArr[y]=g;A=e.validate(h);h.baseId=b,e.util.varOccurences(A,v)<2?n+=" "+e.util.varReplace(A,v,D)+" ":n+=" var "+v+" = "+D+"; "+A+" ",u&&(n+=" if (!"+m+") break; "),n+=" } }  ",u&&(n+=" if ("+m+") { ",f+="}")}}else if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=c,n+="  for (var "+g+" = 0; "+g+" < "+p+".length; "+g+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);D=p+"["+g+"]";h.dataPathArr[y]=g;A=e.validate(h);h.baseId=b,e.util.varOccurences(A,v)<2?n+=" "+e.util.varReplace(A,v,D)+" ":n+=" var "+v+" = "+D+"; "+A+" ",u&&(n+=" if (!"+m+") break; "),n+=" }"}return u&&(n+=" "+f+" if ("+d+" == errors) {"),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d=e.opts.$data&&s&&s.$data;if(d?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s,!d&&"number"!=typeof s)throw new Error(t+" must be number");o+="var division"+i+";if (",d&&(o+=" "+n+" !== undefined && ( typeof "+n+" != 'number' || "),o+=" (division"+i+" = "+l+" / "+n+", ",e.opts.multipleOfPrecision?o+=" Math.abs(Math.round(division"+i+") - division"+i+") > 1e-"+e.opts.multipleOfPrecision+" ":o+=" division"+i+" !== parseInt(division"+i+") ",o+=" ) ",d&&(o+="  )  "),o+=" ) {   ";var h=h||[];h.push(o),o="",!1!==e.createErrors?(o+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should be multiple of ",o+=d?"' + "+n:n+"'"),e.opts.verbose&&(o+=" , schema:  ",o+=d?"validate.schema"+c:""+s,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var f=o;return o=h.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+f+"]); ":o+=" validate.errors = ["+f+"]; return false; ":o+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",p&&(o+=" else { "),o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="errs__"+o,d=e.util.copy(e);d.level++;var h="valid"+d.level;if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){d.schema=a,d.schemaPath=s,d.errSchemaPath=c,n+=" var "+l+" = errors;  ";var f,m=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1,d.opts.allErrors&&(f=d.opts.allErrors,d.opts.allErrors=!1),n+=" "+e.validate(d)+" ",d.createErrors=!0,f&&(d.opts.allErrors=f),e.compositeRule=d.compositeRule=m,n+=" if ("+h+") {   ";var g=g||[];g.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var y=n;n=g.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  errors = "+l+"; if (vErrors !== null) { if ("+l+") vErrors.length = "+l+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else n+="  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(n+=" if (false) { ");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d="errs__"+o,h=e.util.copy(e),f="";h.level++;var m="valid"+h.level,g=h.baseId,y="prevValid"+o,v="passingSchemas"+o;n+="var "+d+" = errors , "+y+" = false , "+l+" = false , "+v+" = null; ";var b=e.compositeRule;e.compositeRule=h.compositeRule=!0;var w=a;if(w)for(var x,E=-1,k=w.length-1;E<k;)x=w[E+=1],(e.opts.strictKeywords?"object"==typeof x&&Object.keys(x).length>0||!1===x:e.util.schemaHasRules(x,e.RULES.all))?(h.schema=x,h.schemaPath=s+"["+E+"]",h.errSchemaPath=c+"/"+E,n+="  "+e.validate(h)+" ",h.baseId=g):n+=" var "+m+" = true; ",E&&(n+=" if ("+m+" && "+y+") { "+l+" = false; "+v+" = ["+v+", "+E+"]; } else { ",f+="}"),n+=" if ("+m+") { "+l+" = "+y+" = true; "+v+" = "+E+"; }";return e.compositeRule=h.compositeRule=b,n+=f+"if (!"+l+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+v+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(n+=" } "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d=e.opts.$data&&s&&s.$data;d?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s,o+="if ( ",d&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'string') || "),o+=" !"+(d?"(new RegExp("+n+"))":e.usePattern(s))+".test("+l+") ) {   ";var h=h||[];h.push(o),o="",!1!==e.createErrors?(o+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",o+=d?""+n:""+e.util.toQuotedString(s),o+="  } ",!1!==e.opts.messages&&(o+=" , message: 'should match pattern \"",o+=d?"' + "+n+" + '":""+e.util.escapeQuotes(s),o+="\"' "),e.opts.verbose&&(o+=" , schema:  ",o+=d?"validate.schema"+c:""+e.util.toQuotedString(s),o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var f=o;return o=h.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+f+"]); ":o+=" validate.errors = ["+f+"]; return false; ":o+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",p&&(o+=" else { "),o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="errs__"+o,d=e.util.copy(e),h="";d.level++;var f="valid"+d.level,m="key"+o,g="idx"+o,y=d.dataLevel=e.dataLevel+1,v="data"+y,b="dataProperties"+o,w=Object.keys(a||{}).filter(F),x=e.schema.patternProperties||{},E=Object.keys(x).filter(F),k=e.schema.additionalProperties,_=w.length||E.length,S=!1===k,C="object"==typeof k&&Object.keys(k).length,P=e.opts.removeAdditional,D=S||C||P,A=e.opts.ownProperties,O=e.baseId,j=e.schema.required;if(j&&(!e.opts.$data||!j.$data)&&j.length<e.opts.loopRequired)var T=e.util.toHash(j);function F(e){return"__proto__"!==e}if(n+="var "+l+" = errors;var "+f+" = true;",A&&(n+=" var "+b+" = undefined;"),D){if(n+=A?" "+b+" = "+b+" || Object.keys("+p+"); for (var "+g+"=0; "+g+"<"+b+".length; "+g+"++) { var "+m+" = "+b+"["+g+"]; ":" for (var "+m+" in "+p+") { ",_){if(n+=" var isAdditional"+o+" = !(false ",w.length)if(w.length>8)n+=" || validate.schema"+s+".hasOwnProperty("+m+") ";else{var I=w;if(I)for(var N=-1,R=I.length-1;N<R;)K=I[N+=1],n+=" || "+m+" == "+e.util.toQuotedString(K)+" "}if(E.length){var B=E;if(B)for(var L=-1,M=B.length-1;L<M;)ie=B[L+=1],n+=" || "+e.usePattern(ie)+".test("+m+") "}n+=" ); if (isAdditional"+o+") { "}if("all"==P)n+=" delete "+p+"["+m+"]; ";else{var q=e.errorPath,U="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),S)if(P)n+=" delete "+p+"["+m+"]; ";else{n+=" "+f+" = false; ";var $=c;c=e.errSchemaPath+"/additionalProperties",(re=re||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+U+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is an invalid additional property":n+="should NOT have additional properties",n+="' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var z=n;n=re.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+z+"]); ":n+=" validate.errors = ["+z+"]; return false; ":n+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=$,u&&(n+=" break; ")}else if(C)if("failing"==P){n+=" var "+l+" = errors;  ";var G=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=k,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var H=p+"["+m+"]";d.dataPathArr[y]=m;var J=e.validate(d);d.baseId=O,e.util.varOccurences(J,v)<2?n+=" "+e.util.varReplace(J,v,H)+" ":n+=" var "+v+" = "+H+"; "+J+" ",n+=" if (!"+f+") { errors = "+l+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+m+"]; }  ",e.compositeRule=d.compositeRule=G}else{d.schema=k,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);H=p+"["+m+"]";d.dataPathArr[y]=m;J=e.validate(d);d.baseId=O,e.util.varOccurences(J,v)<2?n+=" "+e.util.varReplace(J,v,H)+" ":n+=" var "+v+" = "+H+"; "+J+" ",u&&(n+=" if (!"+f+") break; ")}e.errorPath=q}_&&(n+=" } "),n+=" }  ",u&&(n+=" if ("+f+") { ",h+="}")}var X=e.opts.useDefaults&&!e.compositeRule;if(w.length){var V=w;if(V)for(var K,W=-1,Q=V.length-1;W<Q;){var Y=a[K=V[W+=1]];if(e.opts.strictKeywords?"object"==typeof Y&&Object.keys(Y).length>0||!1===Y:e.util.schemaHasRules(Y,e.RULES.all)){var Z=e.util.getProperty(K),ee=(H=p+Z,X&&void 0!==Y.default);d.schema=Y,d.schemaPath=s+Z,d.errSchemaPath=c+"/"+e.util.escapeFragment(K),d.errorPath=e.util.getPath(e.errorPath,K,e.opts.jsonPointers),d.dataPathArr[y]=e.util.toQuotedString(K);J=e.validate(d);if(d.baseId=O,e.util.varOccurences(J,v)<2){J=e.util.varReplace(J,v,H);var te=H}else{te=v;n+=" var "+v+" = "+H+"; "}if(ee)n+=" "+J+" ";else{if(T&&T[K]){n+=" if ( "+te+" === undefined ",A&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(K)+"') "),n+=") { "+f+" = false; ";q=e.errorPath,$=c;var re,ne=e.util.escapeQuotes(K);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(q,K,e.opts.jsonPointers)),c=e.errSchemaPath+"/required",(re=re||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+ne+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+ne+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";z=n;n=re.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+z+"]); ":n+=" validate.errors = ["+z+"]; return false; ":n+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=$,e.errorPath=q,n+=" } else { "}else u?(n+=" if ( "+te+" === undefined ",A&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(K)+"') "),n+=") { "+f+" = true; } else { "):(n+=" if ("+te+" !== undefined ",A&&(n+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(K)+"') "),n+=" ) { ");n+=" "+J+" } "}}u&&(n+=" if ("+f+") { ",h+="}")}}if(E.length){var oe=E;if(oe)for(var ie,ae=-1,se=oe.length-1;ae<se;){Y=x[ie=oe[ae+=1]];if(e.opts.strictKeywords?"object"==typeof Y&&Object.keys(Y).length>0||!1===Y:e.util.schemaHasRules(Y,e.RULES.all)){d.schema=Y,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ie),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ie),n+=A?" "+b+" = "+b+" || Object.keys("+p+"); for (var "+g+"=0; "+g+"<"+b+".length; "+g+"++) { var "+m+" = "+b+"["+g+"]; ":" for (var "+m+" in "+p+") { ",n+=" if ("+e.usePattern(ie)+".test("+m+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);H=p+"["+m+"]";d.dataPathArr[y]=m;J=e.validate(d);d.baseId=O,e.util.varOccurences(J,v)<2?n+=" "+e.util.varReplace(J,v,H)+" ":n+=" var "+v+" = "+H+"; "+J+" ",u&&(n+=" if (!"+f+") break; "),n+=" } ",u&&(n+=" else "+f+" = true; "),n+=" }  ",u&&(n+=" if ("+f+") { ",h+="}")}}}return u&&(n+=" "+h+" if ("+l+" == errors) {"),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="errs__"+o,d=e.util.copy(e);d.level++;var h="valid"+d.level;if(n+="var "+l+" = errors;",e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){d.schema=a,d.schemaPath=s,d.errSchemaPath=c;var f="key"+o,m="idx"+o,g="i"+o,y="' + "+f+" + '",v="data"+(d.dataLevel=e.dataLevel+1),b="dataProperties"+o,w=e.opts.ownProperties,x=e.baseId;w&&(n+=" var "+b+" = undefined; "),n+=w?" "+b+" = "+b+" || Object.keys("+p+"); for (var "+m+"=0; "+m+"<"+b+".length; "+m+"++) { var "+f+" = "+b+"["+m+"]; ":" for (var "+f+" in "+p+") { ",n+=" var startErrs"+o+" = errors; ";var E=f,k=e.compositeRule;e.compositeRule=d.compositeRule=!0;var _=e.validate(d);d.baseId=x,e.util.varOccurences(_,v)<2?n+=" "+e.util.varReplace(_,v,E)+" ":n+=" var "+v+" = "+E+"; "+_+" ",e.compositeRule=d.compositeRule=k,n+=" if (!"+h+") { for (var "+g+"=startErrs"+o+"; "+g+"<errors; "+g+"++) { vErrors["+g+"].propertyName = "+f+"; }   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(n+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),u&&(n+=" break; "),n+=" } }"}return u&&(n+="  if ("+l+" == errors) {"),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",o=e.level,i=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(i||""),l="valid"+o,d=e.opts.$data&&a&&a.$data;d&&(n+=" var schema"+o+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; ");var h="schema"+o;if(!d)if(a.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var f=[],m=a;if(m)for(var g,y=-1,v=m.length-1;y<v;){g=m[y+=1];var b=e.schema.properties[g];b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0||!1===b:e.util.schemaHasRules(b,e.RULES.all))||(f[f.length]=g)}}else f=a;if(d||f.length){var w=e.errorPath,x=d||f.length>=e.opts.loopRequired,E=e.opts.ownProperties;if(u)if(n+=" var missing"+o+"; ",x){d||(n+=" var "+h+" = validate.schema"+s+"; ");var k="' + "+(A="schema"+o+"["+(C="i"+o)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(w,A,e.opts.jsonPointers)),n+=" var "+l+" = true; ",d&&(n+=" if (schema"+o+" === undefined) "+l+" = true; else if (!Array.isArray(schema"+o+")) "+l+" = false; else {"),n+=" for (var "+C+" = 0; "+C+" < "+h+".length; "+C+"++) { "+l+" = "+p+"["+h+"["+C+"]] !== undefined ",E&&(n+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+h+"["+C+"]) "),n+="; if (!"+l+") break; } ",d&&(n+="  }  "),n+="  if (!"+l+") {   ",(D=D||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+k+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+k+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";var _=n;n=D.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+_+"]); ":n+=" validate.errors = ["+_+"]; return false; ":n+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else{n+=" if ( ";var S=f;if(S)for(var C=-1,P=S.length-1;C<P;){j=S[C+=1],C&&(n+=" || "),n+=" ( ( "+(N=p+(I=e.util.getProperty(j)))+" === undefined ",E&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(j)+"') "),n+=") && (missing"+o+" = "+e.util.toQuotedString(e.opts.jsonPointers?j:I)+") ) "}n+=") {  ";var D;k="' + "+(A="missing"+o)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(w,A,!0):w+" + "+A),(D=D||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+k+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+k+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ";_=n;n=D.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+_+"]); ":n+=" validate.errors = ["+_+"]; return false; ":n+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else if(x){d||(n+=" var "+h+" = validate.schema"+s+"; ");var A;k="' + "+(A="schema"+o+"["+(C="i"+o)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(w,A,e.opts.jsonPointers)),d&&(n+=" if ("+h+" && !Array.isArray("+h+")) {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+k+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+k+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+h+" !== undefined) { "),n+=" for (var "+C+" = 0; "+C+" < "+h+".length; "+C+"++) { if ("+p+"["+h+"["+C+"]] === undefined ",E&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+h+"["+C+"]) "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+k+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+k+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(n+="  }  ")}else{var O=f;if(O)for(var j,T=-1,F=O.length-1;T<F;){j=O[T+=1];var I=e.util.getProperty(j),N=(k=e.util.escapeQuotes(j),p+I);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(w,j,e.opts.jsonPointers)),n+=" if ( "+N+" === undefined ",E&&(n+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(j)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+k+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+k+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=w}else u&&(n+=" if (true) {");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o=" ",i=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,l="data"+(a||""),d="valid"+i,h=e.opts.$data&&s&&s.$data;if(h?(o+=" var schema"+i+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+i):n=s,(s||h)&&!1!==e.opts.uniqueItems){h&&(o+=" var "+d+"; if ("+n+" === false || "+n+" === undefined) "+d+" = true; else if (typeof "+n+" != 'boolean') "+d+" = false; else { "),o+=" var i = "+l+".length , "+d+" = true , j; if (i > 1) { ";var f=e.schema.items&&e.schema.items.type,m=Array.isArray(f);if(!f||"object"==f||"array"==f||m&&(f.indexOf("object")>=0||f.indexOf("array")>=0))o+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+l+"[i], "+l+"[j])) { "+d+" = false; break outer; } } } ";else{o+=" var itemIndices = {}, item; for (;i--;) { var item = "+l+"[i]; ";var g="checkDataType"+(m?"s":"");o+=" if ("+e.util[g](f,"item",e.opts.strictNumbers,!0)+") continue; ",m&&(o+=" if (typeof item == 'string') item = '\"' + item; "),o+=" if (typeof itemIndices[item] == 'number') { "+d+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}o+=" } ",h&&(o+="  }  "),o+=" if (!"+d+") {   ";var y=y||[];y.push(o),o="",!1!==e.createErrors?(o+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+c:""+s,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),o+=" } "):o+=" {} ";var v=o;o=y.pop(),!e.compositeRule&&p?e.async?o+=" throw new ValidationError(["+v+"]); ":o+=" validate.errors = ["+v+"]; return false; ":o+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } ",p&&(o+=" else { ")}else p&&(o+=" if (true) { ");return o}},function(e,t,r){"use strict";var n=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var o,i=t[r].split("/"),a=e;for(o=1;o<i.length;o++)a=a[i[o]];for(o=0;o<n.length;o++){var s=n[o],c=a[s];c&&(a[s]={anyOf:[c,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,r){"use strict";var n=r(91).MissingRef;e.exports=function e(t,r,o){var i=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(o=r,r=void 0);var a=s(t).then((function(){var e=i._addSchema(t,void 0,r);return e.validate||function e(t){try{return i._compile(t)}catch(e){if(e instanceof n)return o(e);throw e}function o(n){var o=n.missingSchema;if(u(o))throw new Error("Schema "+o+" is loaded but "+n.missingRef+" cannot be resolved");var a=i._loadingSchemas[o];return a||(a=i._loadingSchemas[o]=i._opts.loadSchema(o)).then(c,c),a.then((function(e){if(!u(o))return s(e).then((function(){u(o)||i.addSchema(e,o,void 0,r)}))})).then((function(){return e(t)}));function c(){delete i._loadingSchemas[o]}function u(e){return i._refs[e]||i._schemas[e]}}}(e)}));o&&a.then((function(e){o(null,e)}),o);return a;function s(t){var r=t.$schema;return r&&!i.getSchema(r)?e.call(i,{$ref:r},!0):Promise.resolve()}}},function(e,t,r){"use strict";var n=/^[a-z_$][a-z0-9_$-]*$/i,o=r(317),i=r(318);e.exports={add:function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!n.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var i=t.type;if(Array.isArray(i))for(var a=0;a<i.length;a++)c(e,i[a],t);else c(e,i,t);var s=t.metaSchema;s&&(t.$data&&this._opts.$data&&(s={anyOf:[s,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(s,!0))}function c(e,t,n){for(var i,a=0;a<r.length;a++){var s=r[a];if(s.type==t){i=s;break}}i||(i={type:t,rules:[]},r.push(i));var c={keyword:e,definition:n,custom:!0,code:o,implements:n.implements};i.rules.push(c),r.custom[e]=c}return r.keywords[e]=r.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var n=t[r].rules,o=0;o<n.length;o++)if(n[o].keyword==e){n.splice(o,1);break}return this},validate:function e(t,r){e.errors=null;var n=this._validateKeyword=this._validateKeyword||this.compile(i,!0);if(n(t))return!0;if(e.errors=n.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(n.errors));return!1}}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,o,i=" ",a=e.level,s=e.dataLevel,c=e.schema[t],u=e.schemaPath+e.util.getProperty(t),p=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,d="data"+(s||""),h="valid"+a,f="errs__"+a,m=e.opts.$data&&c&&c.$data;m?(i+=" var schema"+a+" = "+e.util.getData(c.$data,s,e.dataPathArr)+"; ",o="schema"+a):o=c;var g,y,v,b,w,x="definition"+a,E=this.definition,k="";if(m&&E.$data){w="keywordValidate"+a;var _=E.validateSchema;i+=" var "+x+" = RULES.custom['"+t+"'].definition; var "+w+" = "+x+".validate;"}else{if(!(b=e.useCustomRule(this,c,e.schema,e)))return;o="validate.schema"+u,w=b.code,g=E.compile,y=E.inline,v=E.macro}var S=w+".errors",C="i"+a,P="ruleErr"+a,D=E.async;if(D&&!e.async)throw new Error("async keyword in sync schema");if(y||v||(i+=S+" = null;"),i+="var "+f+" = errors;var "+h+";",m&&E.$data&&(k+="}",i+=" if ("+o+" === undefined) { "+h+" = true; } else { ",_&&(k+="}",i+=" "+h+" = "+x+".validateSchema("+o+"); if ("+h+") { ")),y)E.statements?i+=" "+b.validate+" ":i+=" "+h+" = "+b.validate+"; ";else if(v){var A=e.util.copy(e);k="";A.level++;var O="valid"+A.level;A.schema=b.validate,A.schemaPath="";var j=e.compositeRule;e.compositeRule=A.compositeRule=!0;var T=e.validate(A).replace(/validate\.schema/g,w);e.compositeRule=A.compositeRule=j,i+=" "+T}else{(R=R||[]).push(i),i="",i+="  "+w+".call( ",e.opts.passContext?i+="this":i+="self",g||!1===E.schema?i+=" , "+d+" ":i+=" , "+o+" , "+d+" , validate.schema"+e.schemaPath+" ",i+=" , (dataPath || '')",'""'!=e.errorPath&&(i+=" + "+e.errorPath);var F=s?"data"+(s-1||""):"parentData",I=s?e.dataPathArr[s]:"parentDataProperty",N=i+=" , "+F+" , "+I+" , rootData )  ";i=R.pop(),!1===E.errors?(i+=" "+h+" = ",D&&(i+="await "),i+=N+"; "):i+=D?" var "+(S="customErrors"+a)+" = null; try { "+h+" = await "+N+"; } catch (e) { "+h+" = false; if (e instanceof ValidationError) "+S+" = e.errors; else throw e; } ":" "+S+" = null; "+h+" = "+N+"; "}if(E.modifying&&(i+=" if ("+F+") "+d+" = "+F+"["+I+"];"),i+=""+k,E.valid)l&&(i+=" if (true) { ");else{var R;i+=" if ( ",void 0===E.valid?(i+=" !",i+=v?""+O:""+h):i+=" "+!E.valid+" ",i+=") { ",n=this.keyword,(R=R||[]).push(i),i="",(R=R||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var B=i;i=R.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+B+"]); ":i+=" validate.errors = ["+B+"]; return false; ":i+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var L=i;i=R.pop(),y?E.errors?"full"!=E.errors&&(i+="  for (var "+C+"="+f+"; "+C+"<errors; "+C+"++) { var "+P+" = vErrors["+C+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+P+".schemaPath === undefined) { "+P+'.schemaPath = "'+p+'"; } ',e.opts.verbose&&(i+=" "+P+".schema = "+o+"; "+P+".data = "+d+"; "),i+=" } "):!1===E.errors?i+=" "+L+" ":(i+=" if ("+f+" == errors) { "+L+" } else {  for (var "+C+"="+f+"; "+C+"<errors; "+C+"++) { var "+P+" = vErrors["+C+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+P+".schemaPath === undefined) { "+P+'.schemaPath = "'+p+'"; } ',e.opts.verbose&&(i+=" "+P+".schema = "+o+"; "+P+".data = "+d+"; "),i+=" } } "):v?(i+="   var err =   ",!1!==e.createErrors?(i+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; ")):!1===E.errors?i+=" "+L+" ":(i+=" if (Array.isArray("+S+")) { if (vErrors === null) vErrors = "+S+"; else vErrors = vErrors.concat("+S+"); errors = vErrors.length;  for (var "+C+"="+f+"; "+C+"<errors; "+C+"++) { var "+P+" = vErrors["+C+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+e.errorPath+";  "+P+'.schemaPath = "'+p+'";  ',e.opts.verbose&&(i+=" "+P+".schema = "+o+"; "+P+".data = "+d+"; "),i+=" } } else { "+L+" } "),i+=" } ",l&&(i+=" else { ")}return i}},function(e,t,r){"use strict";var n=r(136);e.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:n.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:n.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},function(e){e.exports=JSON.parse('{"id":"http://json-schema.org/draft-04/schema#","$schema":"http://json-schema.org/draft-04/schema#","description":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"positiveInteger":{"type":"integer","minimum":0},"positiveIntegerDefault0":{"allOf":[{"$ref":"#/definitions/positiveInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"minItems":1,"uniqueItems":true}},"type":"object","properties":{"id":{"type":"string"},"$schema":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":{},"multipleOf":{"type":"number","minimum":0,"exclusiveMinimum":true},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"boolean","default":false},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"boolean","default":false},"maxLength":{"$ref":"#/definitions/positiveInteger"},"minLength":{"$ref":"#/definitions/positiveIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"anyOf":[{"type":"boolean"},{"$ref":"#"}],"default":{}},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":{}},"maxItems":{"$ref":"#/definitions/positiveInteger"},"minItems":{"$ref":"#/definitions/positiveIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"maxProperties":{"$ref":"#/definitions/positiveInteger"},"minProperties":{"$ref":"#/definitions/positiveIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"anyOf":[{"type":"boolean"},{"$ref":"#"}],"default":{}},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"enum":{"type":"array","minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"dependencies":{"exclusiveMaximum":["maximum"],"exclusiveMinimum":["minimum"]},"default":{}}')},function(e){e.exports=JSON.parse('{"id":"/definition/","type":"object","properties":{"id":{"type":"string","format":"uuid"},"label":{"type":"string"},"address":{"type":"string"},"type":{"type":"string"},"protocol":{"type":"string"},"secret":{"type":"string"},"allCapabilities":{"$ref":"/shared/capabilities"},"capabilities":{"$ref":"/shared/capabilities"}},"required":["address"],"additionalProperties":true}')},function(e,t,r){const n=r(14)("fbp-client:observer"),o=r(14)("fbp-client:observer:ignored");function i(e,t){return"*"===t||e===t}function a(e,t){if("function"==typeof t)return t(e);return t.filter(t=>{const[r,n]=t.split(":");return i(e.protocol,r)&&i(e.command,n)}).length>0}function s(e){const t=`${e.protocol}:${e.command}`;let r=`Unexpected ${t} message`,n="";"runtime:packet"===t&&e.payload.payload&&e.payload.payload.message&&(r=e.payload.payload.message,n=e.payload.payload.stack),"network:data"===t&&e.payload.src&&"error"===e.payload.src.port&&(r=e.payload.data.message||e.payload.data,n=e.payload.data.stack),e.payload.error&&(r=e.payload.error,n=e.payload.stack);const o=new Error(r);return o.signature=t,n&&(o.stack=n),o}class c{constructor(e,t){this.client=e,this.signals=[],this.protocolErrors=[],this.listener=null,this.errorListener=null,this.subscribe(t)}subscribe(e){this.listener=t=>{a(t,e)?(n(`Observed ${t.protocol}:${t.command}`),this.signals.push(t)):o(`${t.protocol}:${t.command}`)},this.client.on("signal",this.listener),this.client.options.skipValidation||(this.errorListener=e=>{this.protocolErrors.push(e)},this.client.on("protocolError",this.errorListener))}unsubscribe(){this.listener&&(this.client.removeListener("signal",this.listener),this.listener=null),this.errorListener&&(this.client.removeListener("protocolError",this.errorListener),this.errorListener=null)}until(e,t){return new Promise((r,o)=>{if(this.protocolErrors.length){const e=this.protocolErrors[0];return n("Failed with protocol error "+e.message),e.signals=this.signals.slice(0),this.unsubscribe(),this.signals=[],void o(e)}for(let i=0;i<this.signals.length;i+=1){const c=this.signals[i];if(a(c,t)){const e=s(c);return n(`Failed with ${c.protocol}:${c.command}`),e.signals=this.signals.slice(0,i+1),this.unsubscribe(),this.signals=[],void o(e)}if(a(c,e)){n(`Succeeded with ${c.protocol}:${c.command}`);const e=this.signals.slice(0,i+1);return this.unsubscribe(),this.signals=[],void r(e)}}let i=null;const c=u=>{if(a(u,t)){n(`Failed with ${u.protocol}:${u.command}`);const e=s(u);return e.signals=this.signals.slice(0),this.unsubscribe(),this.client.removeListener("signal",c),this.client.options.skipValidation||this.client.removeListener("protocolError",i),this.signals=[],void o(e)}if(a(u,e)){n(`Succeeded with ${u.protocol}:${u.command}`);const e=this.signals.slice(0);this.unsubscribe(),this.client.removeListener("signal",c),this.client.options.skipValidation||this.client.removeListener("protocolError",i),this.signals=[],r(e)}};i=e=>{n("Failed with protocol error "+e.message);const t=e;t.signals=this.signals.slice(0),this.unsubscribe(),this.client.removeListener("signal",c),this.client.options.skipValidation||this.client.removeListener("protocolError",i),this.signals=[],o(t)},this.client.on("signal",c),this.client.options.skipValidation||this.client.on("protocolError",i)})}}e.exports=(e,t)=>new c(e,t)},function(e,t,r){const n=r(14)("fbp-client:adapter:signal"),o=r(14)("fbp-client:adapter:request"),i=r(14)("fbp-client:adapter:response");class a{constructor(e,t){this.client=e,this.commands=[],this.listener=null,this.version=t,this.subscribe(),this.tick()}subscribe(){this.client.transport.on("message",e=>{this.listener?this.listener(e):(n(`${e.protocol}:${e.command}`),this.client.validate(`/${e.protocol}/output/${e.command}`,e).then(()=>this.client.canReceive(e.protocol,e.command)).then(()=>this.client.signal(e),e=>this.client.protocolError(e)))}),this.client.transport.on("status",({online:e})=>{e&&this.tick()})}send(e,t,r){return new Promise((a,s)=>{const c=[];this.commands.push(()=>{let u=null;this.listener=r=>{this.client.validate(`/${r.protocol}/output/${r.command}`,r).then(()=>this.client.canReceive(r.protocol,r.command)).then(()=>{if(!(r=>{if(r.protocol!==e)return!1;const n=[];switch(`${e}:${t}`){case"runtime:packet":n.push("packetsent");break;case"component:getsource":n.push("source");break;case"component:source":n.push("component");break;case"component:list":n.push("component"),n.push("componentsready");break;case"network:start":n.push("started");break;case"network:stop":n.push("stopped");break;case"network:getstatus":n.push("status");break;default:n.push(t)}return n.push("error"),-1!==n.indexOf(r.command)})(r))return n(`${r.protocol}:${r.command}`),void this.client.signal(r);if(u&&(clearTimeout(u),u=null),i(`${r.protocol}:${r.command} for request ${e}:${t}`),"error"===r.command){const e=new Error(r.payload.message);return e.stack=r.payload.stack,this.listener=null,s(e),void this.tick()}if("component"===e&&"list"===t)return"componentsready"===r.command?(this.listener=null,a(c),void this.tick()):void c.push(r.payload);this.listener=null,a(r.payload),this.tick()},e=>{this.listener=null,s(e),this.tick()})},o(`${e}:${t}`),this.client.transport.send(e,t,r),"component"!==e&&(u="runtime"===e&&"packet"===t&&this.version<=.6?setTimeout(()=>{this.listener=null,a(r),this.tick()},10):setTimeout(()=>{this.listener=null,s(new Error(`${e}:${t} timed out`)),this.tick()},this.client.options.commandTimeout))}),this.tick()})}tick(){if(!this.commands.length)return;if(!this.client.isConnected())return;if(this.listener)return;this.commands.shift()()}}e.exports=(e,t)=>new a(e,t)},function(e,t,r){e.exports=function(e){function t(e){let r;function i(...e){if(!i.enabled)return;const n=i,o=Number(new Date),a=o-(r||o);n.diff=a,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,o)=>{if("%%"===r)return r;s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r}),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=t.selectColor(e),i.destroy=n,i.extend=o,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function n(){const e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function o(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){const e=t.instances[r];e.enabled=t.enabled(e.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(119),Object.keys(e).forEach(r=>{t[r]=e[r]}),t.instances=[],t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,o,i,a,s,c=1,u={},p=!1,l=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){f(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){f(e.data)},n=function(e){i.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(o=l.documentElement,n=function(e){var t=l.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):n=function(e){setTimeout(f,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&f(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var o={callback:e,args:t};return u[c]=o,n(c),c++},d.clearImmediate=h}function h(e){delete u[e]}function f(e){if(p)setTimeout(f,0,e);else{var t=u[e];if(t){p=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{h(e),p=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(26),r(13))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadHttp=t.loadFile=void 0;const n=r(27);r(139),t.loadString=e=>JSON.parse(e),t.loadFile=function(e,r){n.readFile(e,{encoding:"utf-8"},(e,n)=>{let o;if(e)r(e);else{try{o=t.loadString(n)}catch(e){return void r(e)}r(null,o)}})},t.loadHttp=function(e,t){fetch(e).then(e=>{if(200!==e.status)throw new Error("Received HTTP error "+e.status);return e.json()}).then(e=>{t(null,e)},e=>{t(e)})}},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return f})),r.d(t,"Request",(function(){return x})),r.d(t,"Response",(function(){return k})),r.d(t,"DOMException",(function(){return S})),r.d(t,"fetch",(function(){return C}));var n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==n&&n,o="URLSearchParams"in n,i="Symbol"in n&&"iterator"in Symbol,a="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in n,c="ArrayBuffer"in n;if(c)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function g(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=g(t);return t.readAsArrayBuffer(e),r}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:o&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():c&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c&&(ArrayBuffer.prototype.isPrototypeOf(e)||p(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=m(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(y)}),this.text=function(){var e,t,r,n=m(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=g(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=l(e),t=d(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[l(e)]},f.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},f.prototype.set=function(e,t){this.map[l(e)]=d(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),h(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),h(e)},i&&(f.prototype[Symbol.iterator]=f.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function x(e,t){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n,o=(t=t||{}).body;if(e instanceof x){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),w.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function E(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function k(e,t){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})},b.call(x.prototype),b.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},k.error=function(){var e=new k(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];k.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new k(null,{status:t,headers:{location:e}})};var S=n.DOMException;try{new S}catch(e){(S=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function C(e,t){return new Promise((function(r,o){var i=new x(e,t);if(i.signal&&i.signal.aborted)return o(new S("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;setTimeout((function(){r(new k(o,n))}),0)},s.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){o(new S("Aborted","AbortError"))}),0)},s.open(i.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(t){return e}}(i.url),!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&(a?s.responseType="blob":c&&i.headers.get("Content-Type")&&-1!==i.headers.get("Content-Type").indexOf("application/octet-stream")&&(s.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof f?i.headers.forEach((function(e,t){s.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){s.setRequestHeader(e,d(t.headers[e]))})),i.signal&&(i.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&i.signal.removeEventListener("abort",u)}),s.send(void 0===i._bodyInit?null:i._bodyInit)}))}C.polyfill=!0,n.fetch||(n.fetch=C,n.Headers=f,n.Request=x,n.Response=k)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(23),o=r(140);function i(e){return new Promise((t,r)=>{const o="fbp"===e.language?"loadFBP":"loadJSON";n.graph[o](e.code,(e,n)=>{e?r(e):t(n.toJSON())})})}function a(e,t,r){return e.protocol.component.list().then(e=>e.filter(e=>e.subgraph&&"Graph"!==e.name)).then(n=>{const o=n.map(e=>e.name);-1===o.indexOf(r)&&o.push(r);const a=o.filter(e=>!t.graphs[e]);return Promise.all(a.map(t=>e.protocol.component.getsource({name:t}).then(i).then(e=>({...e,name:t})))).then(e=>{(function e(t,r){let n=[];const o=r.find(e=>e.name===t);if(!o)return n;n.push(o);const i=r.map(e=>e.name);return Object.keys(o.processes).forEach(t=>{const a=o.processes[t];-1!==i.indexOf(a.component)&&(n=n.concat(e(a.component,r)))}),n})(r,e).forEach(e=>{const n=e.name===r;t.addGraph(e.name,e,n)})})})}t.default=class{constructor(e){this.fbpClient=e,this.traces={},this.signalHandlers={}}handleSignal(e){if(this.signalHandlers[e])return this.signalHandlers[e];const t=this.traces[e],r=r=>{if(r.payload.graph!==e)return;const n=`${r.protocol}:${r.command}`;switch(n){case"network:connect":case"network:begingroup":case"network:data":case"network:endgroup":case"network:disconnect":t.addNetworkPacket(n,r.payload.src,r.payload.tgt,r.payload.graph,r.payload);break;case"network:error":t.addNetworkError(r.payload.graph,r.payload);break;case"network:icon":t.addNetworkIcon(r.payload.graph,r.payload.id,r.payload.icon)}};return this.signalHandlers[e]=r,r}start(e){return this.fbpClient.connect().then(()=>{this.traces[e]=new o.default({runtime:this.fbpClient.definition.id,type:this.fbpClient.definition.type,address:this.fbpClient.definition.address,repository:this.fbpClient.definition.repository,repositoryVersion:this.fbpClient.definition.repositoryVersion})}).then(()=>{this.fbpClient.on("signal",this.handleSignal(e))}).then(()=>a(this.fbpClient,this.traces[e],e))}stop(e){return this.traces[e]?(this.fbpClient.removeListener("signal",this.handleSignal(e)),this.traces[e].metadata.end=new Date,Promise.resolve()):Promise.resolve()}dump(e){return this.traces[e]?this.traces[e].toJSON():{}}}},function(e,t,r){const n=r(330),o=r(51)("fbp-spec:protocol"),i=r(92),a=r(67);t.sendGraph=function(e,r,s){if(!r)return void s(new Error("Graph not defined"));let c=r.name||r.properties.id;c||(c="fixture."+a.randomString(10));r.name=c,r instanceof n.Graph?(o("sendgraph",c),i.resolve().then(()=>e.protocol.graph.send(r,!1)).then(()=>c).nodeify(s)):n.graph.loadJSON(r,(r,n)=>{r?s(r):t.sendGraph(e,n,s)})},t.startNetwork=function(e,t,r){o("startnetwork",t),i.resolve().then(()=>e.protocol.network.start({graph:t})).nodeify(r)},t.stopNetwork=function(e,t,r){o("stopnetwork",t),i.resolve().then(()=>e.protocol.network.stop({graph:t})).nodeify(r)},t.sendPackets=function(e,t,r,n){o("sendpackets",t,r),i.all(Object.keys(r).map(n=>e.protocol.runtime.packet({event:"data",port:n,payload:r[n],graph:t}))).nodeify(n)},t.getComponents=function(e,t){o("get components"),i.resolve().then(()=>e.protocol.component.list()).then(e=>{const t={};return e.forEach(e=>{t[e.name]=e}),t}).nodeify(t)},t.getCapabilities=function(e,t){const r=e.definition;r&&r.capabilities&&r.capabilities.length?t(null,r.capabilities):i.resolve().then(()=>e.protocol.runtime.getruntime()).then(e=>e.capabilities).nodeify(t)},t.getComponentTests=function(e,t){o("get component tests"),i.resolve().then(()=>e.protocol.component.list()).then(t=>i.all(t.map(t=>e.protocol.component.getsource({name:t.name}).then(e=>e,()=>({tests:null}))))).then(e=>{const t={};return e.forEach(e=>{if(!e.tests)return;const r=e.library?`${e.library}/${e.name}`:e.name;t[r]=e.tests}),t}).nodeify(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=t.Journal=t.graph=t.journal=void 0;var n=r(142);t.journal=n;var o=r(144);t.graph=o;var i=r(142);Object.defineProperty(t,"Journal",{enumerable:!0,get:function(){return i.Journal}});var a=r(144);Object.defineProperty(t,"Graph",{enumerable:!0,get:function(){return a.Graph}})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(p,e);var t,r,n,c=s(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).transactions=[],t}return t=p,(r=[{key:"countTransactions",value:function(){return this.transactions.length}},{key:"putTransaction",value:function(e,t){i(u(p.prototype),"putTransaction",this).call(this,e,t),this.transactions[e]=t}},{key:"fetchTransaction",value:function(e){return this.transactions[e]}}])&&o(t.prototype,r),n&&o(t,n),p}(r(143).default);t.default=p},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=void 0,t.isBrowser=function(){return void 0===e||!e.execPath||!e.execPath.match(/node|iojs/)}}).call(this,r(13))},function(e){e.exports=JSON.parse('{"id":"base.json","$schema":"http://json-schema.org/draft-04/schema","title":"Base definitions","definitions":{"JsonPath":{"type":"string","description":"JsonPath, see http://goessner.net/articles/JsonPath/","format":"jsonpath","example":"products.book[2]"}}}')},function(e){e.exports=JSON.parse('{"id":"testcase.json","$schema":"http://json-schema.org/draft-04/schema","title":"Testcase","description":"A single test case","type":"object","properties":{"name":{"type":"string","description":"Name of this testcase/scenario"},"assertion":{"type":"string","description":"Description of what this testcase asserts"},"inputs":{"description":"The inputs send to the fixture input ports, or a sequence of such inputs","oneOf":[{"type":"object"},{"type":"array","items":{"type":"object"}}]},"expect":{"description":"Expected data on fixture output ports.\\nCan either be an object, or a sequence of such objects.\\n","oneOf":[{"$ref":"outputdata.json"},{"type":"array","items":[{"$ref":"outputdata.json"}]}]},"timeout":{"type":"number","description":"Timeout (in milliseconds). Overrides that set in the suite","default":2000},"skip":{"type":"string","description":"Flag to skip testcase.\\nShould be a description of the reason for skipping.\\n"}},"required":["name","assertion","inputs","expect"]}')},function(e){e.exports=JSON.parse('{"id":"testsuite.json","$schema":"http://json-schema.org/draft-04/schema","title":"Test suite","description":"A collection of test cases","type":["object"],"properties":{"topic":{"type":"string","description":"The component/graph under test","example":"MyComponent3"},"name":{"type":"string","description":"Name of this test suite. Topic is used if no name is provided.","default":""},"fixture":{"type":"object","description":"The graph fixture to run for each test case"},"cases":{"type":"array","description":"The test cases","items":{"$ref":"testcase.json"},"default":[]},"timeout":{"type":"number","description":"Timeout (in milliseconds) for setup and default for each test case.","default":2000},"skip":{"type":"string","description":"Flag to skip test suite (and all containing test cases).\\nShould be a description of the reason for skipping.\\n"}},"required":["topic"]}')},function(e){e.exports=JSON.parse('{"id":"testsuites.json","$schema":"http://json-schema.org/draft-04/schema","title":"TestSuite list","description":"Array of TestSuite","type":"array","items":{"$ref":"testsuite.json"}}')},function(e){e.exports=JSON.parse('{"id":"testsuites.json","$schema":"http://json-schema.org/draft-04/schema","title":"Expectation list","description":"Array of Expectation","type":"array","items":{"$ref":"expectation.json"}}')},function(e){e.exports=JSON.parse('{"id":"testsfile.json","$schema":"http://json-schema.org/draft-04/schema","title":"Tests file","description":"One or more suites","oneOf":[{"$ref":"testsuites.json"},{"$ref":"testsuite.json"}]}')},function(e,t,r){"use strict";var n=r(340),o=r(359);function i(e){return function(){throw new Error("Function "+e+" is deprecated and cannot be used.")}}e.exports.Type=r(19),e.exports.Schema=r(53),e.exports.FAILSAFE_SCHEMA=r(94),e.exports.JSON_SCHEMA=r(148),e.exports.CORE_SCHEMA=r(147),e.exports.DEFAULT_SAFE_SCHEMA=r(60),e.exports.DEFAULT_FULL_SCHEMA=r(68),e.exports.load=n.load,e.exports.loadAll=n.loadAll,e.exports.safeLoad=n.safeLoad,e.exports.safeLoadAll=n.safeLoadAll,e.exports.dump=o.dump,e.exports.safeDump=o.safeDump,e.exports.YAMLException=r(59),e.exports.MINIMAL_SCHEMA=r(94),e.exports.SAFE_SCHEMA=r(60),e.exports.DEFAULT_SCHEMA=r(68),e.exports.scan=i("scan"),e.exports.parse=i("parse"),e.exports.compose=i("compose"),e.exports.addConstructor=i("addConstructor")},function(e,t,r){"use strict";var n=r(52),o=r(59),i=r(341),a=r(60),s=r(68),c=Object.prototype.hasOwnProperty,u=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,p=/[\x85\u2028\u2029]/,l=/[,\[\]\{\}]/,d=/^(?:!|!!|![a-z\-]+!)$/i,h=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function f(e){return Object.prototype.toString.call(e)}function m(e){return 10===e||13===e}function g(e){return 9===e||32===e}function y(e){return 9===e||32===e||10===e||13===e}function v(e){return 44===e||91===e||93===e||123===e||125===e}function b(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function w(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?"":76===e?"\u2028":80===e?"\u2029":""}function x(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var E=new Array(256),k=new Array(256),_=0;_<256;_++)E[_]=w(_)?1:0,k[_]=w(_);function S(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||s,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function C(e,t){return new o(t,new i(e.filename,e.input,e.position,e.line,e.position-e.lineStart))}function P(e,t){throw C(e,t)}function D(e,t){e.onWarning&&e.onWarning.call(null,C(e,t))}var A={YAML:function(e,t,r){var n,o,i;null!==e.version&&P(e,"duplication of %YAML directive"),1!==r.length&&P(e,"YAML directive accepts exactly one argument"),null===(n=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))&&P(e,"ill-formed argument of the YAML directive"),o=parseInt(n[1],10),i=parseInt(n[2],10),1!==o&&P(e,"unacceptable YAML version of the document"),e.version=r[0],e.checkLineBreaks=i<2,1!==i&&2!==i&&D(e,"unsupported YAML version of the document")},TAG:function(e,t,r){var n,o;2!==r.length&&P(e,"TAG directive accepts exactly two arguments"),n=r[0],o=r[1],d.test(n)||P(e,"ill-formed tag handle (first argument) of the TAG directive"),c.call(e.tagMap,n)&&P(e,'there is a previously declared suffix for "'+n+'" tag handle'),h.test(o)||P(e,"ill-formed tag prefix (second argument) of the TAG directive"),e.tagMap[n]=o}};function O(e,t,r,n){var o,i,a,s;if(t<r){if(s=e.input.slice(t,r),n)for(o=0,i=s.length;o<i;o+=1)9===(a=s.charCodeAt(o))||32<=a&&a<=1114111||P(e,"expected valid JSON character");else u.test(s)&&P(e,"the stream contains non-printable characters");e.result+=s}}function j(e,t,r,o){var i,a,s,u;for(n.isObject(r)||P(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,u=(i=Object.keys(r)).length;s<u;s+=1)a=i[s],c.call(t,a)||(t[a]=r[a],o[a]=!0)}function T(e,t,r,n,o,i,a,s){var u,p;if(Array.isArray(o))for(u=0,p=(o=Array.prototype.slice.call(o)).length;u<p;u+=1)Array.isArray(o[u])&&P(e,"nested arrays are not supported inside keys"),"object"==typeof o&&"[object Object]"===f(o[u])&&(o[u]="[object Object]");if("object"==typeof o&&"[object Object]"===f(o)&&(o="[object Object]"),o=String(o),null===t&&(t={}),"tag:yaml.org,2002:merge"===n)if(Array.isArray(i))for(u=0,p=i.length;u<p;u+=1)j(e,t,i[u],r);else j(e,t,i,r);else e.json||c.call(r,o)||!c.call(t,o)||(e.line=a||e.line,e.position=s||e.position,P(e,"duplicated mapping key")),t[o]=i,delete r[o];return t}function F(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):P(e,"a line break is expected"),e.line+=1,e.lineStart=e.position}function I(e,t,r){for(var n=0,o=e.input.charCodeAt(e.position);0!==o;){for(;g(o);)o=e.input.charCodeAt(++e.position);if(t&&35===o)do{o=e.input.charCodeAt(++e.position)}while(10!==o&&13!==o&&0!==o);if(!m(o))break;for(F(e),o=e.input.charCodeAt(e.position),n++,e.lineIndent=0;32===o;)e.lineIndent++,o=e.input.charCodeAt(++e.position)}return-1!==r&&0!==n&&e.lineIndent<r&&D(e,"deficient indentation"),n}function N(e){var t,r=e.position;return!(45!==(t=e.input.charCodeAt(r))&&46!==t||t!==e.input.charCodeAt(r+1)||t!==e.input.charCodeAt(r+2)||(r+=3,0!==(t=e.input.charCodeAt(r))&&!y(t)))}function R(e,t){1===t?e.result+=" ":t>1&&(e.result+=n.repeat("\n",t-1))}function B(e,t){var r,n,o=e.tag,i=e.anchor,a=[],s=!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),n=e.input.charCodeAt(e.position);0!==n&&45===n&&y(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,I(e,!0,-1)&&e.lineIndent<=t)a.push(null),n=e.input.charCodeAt(e.position);else if(r=e.line,q(e,t,3,!1,!0),a.push(e.result),I(e,!0,-1),n=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&0!==n)P(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=o,e.anchor=i,e.kind="sequence",e.result=a,!0)}function L(e){var t,r,n,o,i=!1,a=!1;if(33!==(o=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&P(e,"duplication of a tag property"),60===(o=e.input.charCodeAt(++e.position))?(i=!0,o=e.input.charCodeAt(++e.position)):33===o?(a=!0,r="!!",o=e.input.charCodeAt(++e.position)):r="!",t=e.position,i){do{o=e.input.charCodeAt(++e.position)}while(0!==o&&62!==o);e.position<e.length?(n=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):P(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==o&&!y(o);)33===o&&(a?P(e,"tag suffix cannot contain exclamation marks"):(r=e.input.slice(t-1,e.position+1),d.test(r)||P(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);n=e.input.slice(t,e.position),l.test(n)&&P(e,"tag suffix cannot contain flow indicator characters")}return n&&!h.test(n)&&P(e,"tag name cannot contain such characters: "+n),i?e.tag=n:c.call(e.tagMap,r)?e.tag=e.tagMap[r]+n:"!"===r?e.tag="!"+n:"!!"===r?e.tag="tag:yaml.org,2002:"+n:P(e,'undeclared tag handle "'+r+'"'),!0}function M(e){var t,r;if(38!==(r=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&P(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!y(r)&&!v(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&P(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function q(e,t,r,o,i){var a,s,u,p,l,d,h,f,w=1,_=!1,S=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=s=u=4===r||3===r,o&&I(e,!0,-1)&&(_=!0,e.lineIndent>t?w=1:e.lineIndent===t?w=0:e.lineIndent<t&&(w=-1)),1===w)for(;L(e)||M(e);)I(e,!0,-1)?(_=!0,u=a,e.lineIndent>t?w=1:e.lineIndent===t?w=0:e.lineIndent<t&&(w=-1)):u=!1;if(u&&(u=_||i),1!==w&&4!==r||(h=1===r||2===r?t:t+1,f=e.position-e.lineStart,1===w?u&&(B(e,f)||function(e,t,r){var n,o,i,a,s,c=e.tag,u=e.anchor,p={},l={},d=null,h=null,f=null,m=!1,v=!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),s=e.input.charCodeAt(e.position);0!==s;){if(n=e.input.charCodeAt(e.position+1),i=e.line,a=e.position,63!==s&&58!==s||!y(n)){if(!q(e,r,2,!1,!0))break;if(e.line===i){for(s=e.input.charCodeAt(e.position);g(s);)s=e.input.charCodeAt(++e.position);if(58===s)y(s=e.input.charCodeAt(++e.position))||P(e,"a whitespace character is expected after the key-value separator within a block mapping"),m&&(T(e,p,l,d,h,null),d=h=f=null),v=!0,m=!1,o=!1,d=e.tag,h=e.result;else{if(!v)return e.tag=c,e.anchor=u,!0;P(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return e.tag=c,e.anchor=u,!0;P(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===s?(m&&(T(e,p,l,d,h,null),d=h=f=null),v=!0,m=!0,o=!0):m?(m=!1,o=!0):P(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,s=n;if((e.line===i||e.lineIndent>t)&&(q(e,t,4,!0,o)&&(m?h=e.result:f=e.result),m||(T(e,p,l,d,h,f,i,a),d=h=f=null),I(e,!0,-1),s=e.input.charCodeAt(e.position)),e.lineIndent>t&&0!==s)P(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return m&&T(e,p,l,d,h,null),v&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=p),v}(e,f,h))||function(e,t){var r,n,o,i,a,s,c,u,p,l,d=!0,h=e.tag,f=e.anchor,m={};if(91===(l=e.input.charCodeAt(e.position)))o=93,s=!1,n=[];else{if(123!==l)return!1;o=125,s=!0,n={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=n),l=e.input.charCodeAt(++e.position);0!==l;){if(I(e,!0,t),(l=e.input.charCodeAt(e.position))===o)return e.position++,e.tag=h,e.anchor=f,e.kind=s?"mapping":"sequence",e.result=n,!0;d||P(e,"missed comma between flow collection entries"),p=null,i=a=!1,63===l&&y(e.input.charCodeAt(e.position+1))&&(i=a=!0,e.position++,I(e,!0,t)),r=e.line,q(e,t,1,!1,!0),u=e.tag,c=e.result,I(e,!0,t),l=e.input.charCodeAt(e.position),!a&&e.line!==r||58!==l||(i=!0,l=e.input.charCodeAt(++e.position),I(e,!0,t),q(e,t,1,!1,!0),p=e.result),s?T(e,n,m,u,c,p):i?n.push(T(e,null,m,u,c,p)):n.push(c),I(e,!0,t),44===(l=e.input.charCodeAt(e.position))?(d=!0,l=e.input.charCodeAt(++e.position)):d=!1}P(e,"unexpected end of the stream within a flow collection")}(e,h)?S=!0:(s&&function(e,t){var r,o,i,a,s,c=1,u=!1,p=!1,l=t,d=0,h=!1;if(124===(a=e.input.charCodeAt(e.position)))o=!1;else{if(62!==a)return!1;o=!0}for(e.kind="scalar",e.result="";0!==a;)if(43===(a=e.input.charCodeAt(++e.position))||45===a)1===c?c=43===a?3:2:P(e,"repeat of a chomping mode identifier");else{if(!((i=48<=(s=a)&&s<=57?s-48:-1)>=0))break;0===i?P(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):p?P(e,"repeat of an indentation width identifier"):(l=t+i-1,p=!0)}if(g(a)){do{a=e.input.charCodeAt(++e.position)}while(g(a));if(35===a)do{a=e.input.charCodeAt(++e.position)}while(!m(a)&&0!==a)}for(;0!==a;){for(F(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!p||e.lineIndent<l)&&32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!p&&e.lineIndent>l&&(l=e.lineIndent),m(a))d++;else{if(e.lineIndent<l){3===c?e.result+=n.repeat("\n",u?1+d:d):1===c&&u&&(e.result+="\n");break}for(o?g(a)?(h=!0,e.result+=n.repeat("\n",u?1+d:d)):h?(h=!1,e.result+=n.repeat("\n",d+1)):0===d?u&&(e.result+=" "):e.result+=n.repeat("\n",d):e.result+=n.repeat("\n",u?1+d:d),u=!0,p=!0,d=0,r=e.position;!m(a)&&0!==a;)a=e.input.charCodeAt(++e.position);O(e,r,e.position,!1)}}return!0}(e,h)||function(e,t){var r,n,o;if(39!==(r=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=o=e.position;0!==(r=e.input.charCodeAt(e.position));)if(39===r){if(O(e,n,e.position,!0),39!==(r=e.input.charCodeAt(++e.position)))return!0;n=e.position,e.position++,o=e.position}else m(r)?(O(e,n,o,!0),R(e,I(e,!1,t)),n=o=e.position):e.position===e.lineStart&&N(e)?P(e,"unexpected end of the document within a single quoted scalar"):(e.position++,o=e.position);P(e,"unexpected end of the stream within a single quoted scalar")}(e,h)||function(e,t){var r,n,o,i,a,s,c;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return O(e,r,e.position,!0),e.position++,!0;if(92===s){if(O(e,r,e.position,!0),m(s=e.input.charCodeAt(++e.position)))I(e,!1,t);else if(s<256&&E[s])e.result+=k[s],e.position++;else if((a=120===(c=s)?2:117===c?4:85===c?8:0)>0){for(o=a,i=0;o>0;o--)(a=b(s=e.input.charCodeAt(++e.position)))>=0?i=(i<<4)+a:P(e,"expected hexadecimal character");e.result+=x(i),e.position++}else P(e,"unknown escape sequence");r=n=e.position}else m(s)?(O(e,r,n,!0),R(e,I(e,!1,t)),r=n=e.position):e.position===e.lineStart&&N(e)?P(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}P(e,"unexpected end of the stream within a double quoted scalar")}(e,h)?S=!0:!function(e){var t,r,n;if(42!==(n=e.input.charCodeAt(e.position)))return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!y(n)&&!v(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&P(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),c.call(e.anchorMap,r)||P(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],I(e,!0,-1),!0}(e)?function(e,t,r){var n,o,i,a,s,c,u,p,l=e.kind,d=e.result;if(y(p=e.input.charCodeAt(e.position))||v(p)||35===p||38===p||42===p||33===p||124===p||62===p||39===p||34===p||37===p||64===p||96===p)return!1;if((63===p||45===p)&&(y(n=e.input.charCodeAt(e.position+1))||r&&v(n)))return!1;for(e.kind="scalar",e.result="",o=i=e.position,a=!1;0!==p;){if(58===p){if(y(n=e.input.charCodeAt(e.position+1))||r&&v(n))break}else if(35===p){if(y(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&N(e)||r&&v(p))break;if(m(p)){if(s=e.line,c=e.lineStart,u=e.lineIndent,I(e,!1,-1),e.lineIndent>=t){a=!0,p=e.input.charCodeAt(e.position);continue}e.position=i,e.line=s,e.lineStart=c,e.lineIndent=u;break}}a&&(O(e,o,i,!1),R(e,e.line-s),o=i=e.position,a=!1),g(p)||(i=e.position+1),p=e.input.charCodeAt(++e.position)}return O(e,o,i,!1),!!e.result||(e.kind=l,e.result=d,!1)}(e,h,1===r)&&(S=!0,null===e.tag&&(e.tag="?")):(S=!0,null===e.tag&&null===e.anchor||P(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===w&&(S=u&&B(e,f))),null!==e.tag&&"!"!==e.tag)if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&P(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),p=0,l=e.implicitTypes.length;p<l;p+=1)if((d=e.implicitTypes[p]).resolve(e.result)){e.result=d.construct(e.result),e.tag=d.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else c.call(e.typeMap[e.kind||"fallback"],e.tag)?(d=e.typeMap[e.kind||"fallback"][e.tag],null!==e.result&&d.kind!==e.kind&&P(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+d.kind+'", not "'+e.kind+'"'),d.resolve(e.result)?(e.result=d.construct(e.result),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):P(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")):P(e,"unknown tag !<"+e.tag+">");return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||S}function U(e){var t,r,n,o,i=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap={},e.anchorMap={};0!==(o=e.input.charCodeAt(e.position))&&(I(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==o));){for(a=!0,o=e.input.charCodeAt(++e.position),t=e.position;0!==o&&!y(o);)o=e.input.charCodeAt(++e.position);for(n=[],(r=e.input.slice(t,e.position)).length<1&&P(e,"directive name must not be less than one character in length");0!==o;){for(;g(o);)o=e.input.charCodeAt(++e.position);if(35===o){do{o=e.input.charCodeAt(++e.position)}while(0!==o&&!m(o));break}if(m(o))break;for(t=e.position;0!==o&&!y(o);)o=e.input.charCodeAt(++e.position);n.push(e.input.slice(t,e.position))}0!==o&&F(e),c.call(A,r)?A[r](e,r,n):D(e,'unknown document directive "'+r+'"')}I(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,I(e,!0,-1)):a&&P(e,"directives end mark is expected"),q(e,e.lineIndent-1,4,!1,!0),I(e,!0,-1),e.checkLineBreaks&&p.test(e.input.slice(i,e.position))&&D(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&N(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,I(e,!0,-1)):e.position<e.length-1&&P(e,"end of the stream or a document separator is expected")}function $(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var r=new S(e,t),n=e.indexOf("\0");for(-1!==n&&(r.position=n,P(r,"null byte is not allowed in input")),r.input+="\0";32===r.input.charCodeAt(r.position);)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)U(r);return r.documents}function z(e,t,r){null!==t&&"object"==typeof t&&void 0===r&&(r=t,t=null);var n=$(e,r);if("function"!=typeof t)return n;for(var o=0,i=n.length;o<i;o+=1)t(n[o])}function G(e,t){var r=$(e,t);if(0!==r.length){if(1===r.length)return r[0];throw new o("expected a single document in the stream, but found more")}}e.exports.loadAll=z,e.exports.load=G,e.exports.safeLoadAll=function(e,t,r){return"object"==typeof t&&null!==t&&void 0===r&&(r=t,t=null),z(e,t,n.extend({schema:a},r))},e.exports.safeLoad=function(e,t){return G(e,n.extend({schema:a},t))}},function(e,t,r){"use strict";var n=r(52);function o(e,t,r,n,o){this.name=e,this.buffer=t,this.position=r,this.line=n,this.column=o}o.prototype.getSnippet=function(e,t){var r,o,i,a,s;if(!this.buffer)return null;for(e=e||4,t=t||75,r="",o=this.position;o>0&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o-1));)if(o-=1,this.position-o>t/2-1){r=" ... ",o+=5;break}for(i="",a=this.position;a<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(a));)if((a+=1)-this.position>t/2-1){i=" ... ",a-=5;break}return s=this.buffer.slice(o,a),n.repeat(" ",e)+r+s+i+"\n"+n.repeat(" ",e+this.position-o+r.length)+"^"},o.prototype.toString=function(e){var t,r="";return this.name&&(r+='in "'+this.name+'" '),r+="at line "+(this.line+1)+", column "+(this.column+1),e||(t=this.getSnippet())&&(r+=":\n"+t),r},e.exports=o},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"})},function(e,t,r){"use strict";var n=r(52),o=r(19);function i(e){return 48<=e&&e<=55}function a(e){return 48<=e&&e<=57}e.exports=new o("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,n=e.length,o=0,s=!1;if(!n)return!1;if("-"!==(t=e[o])&&"+"!==t||(t=e[++o]),"0"===t){if(o+1===n)return!0;if("b"===(t=e[++o])){for(o++;o<n;o++)if("_"!==(t=e[o])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(o++;o<n;o++)if("_"!==(t=e[o])){if(!(48<=(r=e.charCodeAt(o))&&r<=57||65<=r&&r<=70||97<=r&&r<=102))return!1;s=!0}return s&&"_"!==t}for(;o<n;o++)if("_"!==(t=e[o])){if(!i(e.charCodeAt(o)))return!1;s=!0}return s&&"_"!==t}if("_"===t)return!1;for(;o<n;o++)if("_"!==(t=e[o])){if(":"===t)break;if(!a(e.charCodeAt(o)))return!1;s=!0}return!(!s||"_"===t)&&(":"!==t||/^(:[0-5]?[0-9])+$/.test(e.slice(o)))},construct:function(e){var t,r,n=e,o=1,i=[];return-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(o=-1),t=(n=n.slice(1))[0]),"0"===n?0:"0"===t?"b"===n[1]?o*parseInt(n.slice(2),2):"x"===n[1]?o*parseInt(n,16):o*parseInt(n,8):-1!==n.indexOf(":")?(n.split(":").forEach((function(e){i.unshift(parseInt(e,10))})),n=0,r=1,i.forEach((function(e){n+=e*r,r*=60})),o*n):o*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!n.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0"+e.toString(8):"-0"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},function(e,t,r){"use strict";var n=r(52),o=r(19),i=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var a=/^[-+]?[0-9]+e/;e.exports=new o("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!i.test(e)||"_"===e[e.length-1])},construct:function(e){var t,r,n,o;return r="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,o=[],"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===r?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:t.indexOf(":")>=0?(t.split(":").forEach((function(e){o.unshift(parseFloat(e,10))})),t=0,n=1,o.forEach((function(e){t+=e*n,n*=60})),r*t):r*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||n.isNegativeZero(e))},represent:function(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(n.isNegativeZero(e))return"-0.0";return r=e.toString(10),a.test(r)?r.replace("e",".e"):r},defaultStyle:"lowercase"})},function(e,t,r){"use strict";var n=r(19),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),i=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");e.exports=new n("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==o.exec(e)||null!==i.exec(e))},construct:function(e){var t,r,n,a,s,c,u,p,l=0,d=null;if(null===(t=o.exec(e))&&(t=i.exec(e)),null===t)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(r,n,a));if(s=+t[4],c=+t[5],u=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(d=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(d=-d)),p=new Date(Date.UTC(r,n,a,s,c,u,l)),d&&p.setTime(p.getTime()-d),p},instanceOf:Date,represent:function(e){return e.toISOString()}})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}})},function(e,t,r){"use strict";var n;try{n=r(34).Buffer}catch(e){}var o=r(19),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";e.exports=new o("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,n=0,o=e.length,a=i;for(r=0;r<o;r++)if(!((t=a.indexOf(e.charAt(r)))>64)){if(t<0)return!1;n+=6}return n%8==0},construct:function(e){var t,r,o=e.replace(/[\r\n=]/g,""),a=o.length,s=i,c=0,u=[];for(t=0;t<a;t++)t%4==0&&t&&(u.push(c>>16&255),u.push(c>>8&255),u.push(255&c)),c=c<<6|s.indexOf(o.charAt(t));return 0===(r=a%4*6)?(u.push(c>>16&255),u.push(c>>8&255),u.push(255&c)):18===r?(u.push(c>>10&255),u.push(c>>2&255)):12===r&&u.push(c>>4&255),n?n.from?n.from(u):new n(u):u},predicate:function(e){return n&&n.isBuffer(e)},represent:function(e){var t,r,n="",o=0,a=e.length,s=i;for(t=0;t<a;t++)t%3==0&&t&&(n+=s[o>>18&63],n+=s[o>>12&63],n+=s[o>>6&63],n+=s[63&o]),o=(o<<8)+e[t];return 0===(r=a%3)?(n+=s[o>>18&63],n+=s[o>>12&63],n+=s[o>>6&63],n+=s[63&o]):2===r?(n+=s[o>>10&63],n+=s[o>>4&63],n+=s[o<<2&63],n+=s[64]):1===r&&(n+=s[o>>2&63],n+=s[o<<4&63],n+=s[64],n+=s[64]),n}})},function(e,t,r){"use strict";var n=r(19),o=Object.prototype.hasOwnProperty,i=Object.prototype.toString;e.exports=new n("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,n,a,s,c=[],u=e;for(t=0,r=u.length;t<r;t+=1){if(n=u[t],s=!1,"[object Object]"!==i.call(n))return!1;for(a in n)if(o.call(n,a)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==c.indexOf(a))return!1;c.push(a)}return!0},construct:function(e){return null!==e?e:[]}})},function(e,t,r){"use strict";var n=r(19),o=Object.prototype.toString;e.exports=new n("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,n,i,a,s=e;for(a=new Array(s.length),t=0,r=s.length;t<r;t+=1){if(n=s[t],"[object Object]"!==o.call(n))return!1;if(1!==(i=Object.keys(n)).length)return!1;a[t]=[i[0],n[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,r,n,o,i,a=e;for(i=new Array(a.length),t=0,r=a.length;t<r;t+=1)n=a[t],o=Object.keys(n),i[t]=[o[0],n[o[0]]];return i}})},function(e,t,r){"use strict";var n=r(19),o=Object.prototype.hasOwnProperty;e.exports=new n("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,r=e;for(t in r)if(o.call(r,t)&&null!==r[t])return!1;return!0},construct:function(e){return null!==e?e:{}}})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(e){return void 0===e},represent:function(){return""}})},function(e,t,r){"use strict";var n=r(19);e.exports=new n("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(e){if(null===e)return!1;if(0===e.length)return!1;var t=e,r=/\/([gim]*)$/.exec(e),n="";if("/"===t[0]){if(r&&(n=r[1]),n.length>3)return!1;if("/"!==t[t.length-n.length-1])return!1}return!0},construct:function(e){var t=e,r=/\/([gim]*)$/.exec(e),n="";return"/"===t[0]&&(r&&(n=r[1]),t=t.slice(1,t.length-n.length-1)),new RegExp(t,n)},predicate:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},represent:function(e){var t="/"+e.source+"/";return e.global&&(t+="g"),e.multiline&&(t+="m"),e.ignoreCase&&(t+="i"),t}})},function(e,t,r){"use strict";var n;try{n=r(358)}catch(e){"undefined"!=typeof window&&(n=window.esprima)}var o=r(19);e.exports=new o("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(e){if(null===e)return!1;try{var t="("+e+")",r=n.parse(t,{range:!0});return"Program"===r.type&&1===r.body.length&&"ExpressionStatement"===r.body[0].type&&("ArrowFunctionExpression"===r.body[0].expression.type||"FunctionExpression"===r.body[0].expression.type)}catch(e){return!1}},construct:function(e){var t,r="("+e+")",o=n.parse(r,{range:!0}),i=[];if("Program"!==o.type||1!==o.body.length||"ExpressionStatement"!==o.body[0].type||"ArrowFunctionExpression"!==o.body[0].expression.type&&"FunctionExpression"!==o.body[0].expression.type)throw new Error("Failed to resolve function");return o.body[0].expression.params.forEach((function(e){i.push(e.name)})),t=o.body[0].expression.body.range,"BlockStatement"===o.body[0].expression.body.type?new Function(i,r.slice(t[0]+1,t[1]-1)):new Function(i,"return "+r.slice(t[0],t[1]))},predicate:function(e){return"[object Function]"===Object.prototype.toString.call(e)},represent:function(e){return e.toString()}})},function(e,t,r){var n;n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(8),a=r(15);function s(e,t,r){var a=null,s=function(e,t){r&&r(e,t),a&&a.visit(e,t)},c="function"==typeof r?s:null,u=!1;if(t){u="boolean"==typeof t.comment&&t.comment;var p="boolean"==typeof t.attachComment&&t.attachComment;(u||p)&&((a=new n.CommentHandler).attach=p,t.comment=!0,c=s)}var l,d=!1;t&&"string"==typeof t.sourceType&&(d="module"===t.sourceType),l=t&&"boolean"==typeof t.jsx&&t.jsx?new o.JSXParser(e,t,c):new i.Parser(e,t,c);var h=d?l.parseModule():l.parseScript();return u&&a&&(h.comments=a.comments),l.config.tokens&&(h.tokens=l.tokens),l.config.tolerant&&(h.errors=l.errorHandler.errors),h}t.parse=s,t.parseModule=function(e,t,r){var n=t||{};return n.sourceType="module",s(e,n,r)},t.parseScript=function(e,t,r){var n=t||{};return n.sourceType="script",s(e,n,r)},t.tokenize=function(e,t,r){var n,o=new a.Tokenizer(e,t);n=[];try{for(;;){var i=o.getNextToken();if(!i)break;r&&(i=r(i)),n.push(i)}}catch(e){o.errorHandler.tolerate(e)}return o.errorHandler.tolerant&&(n.errors=o.errors()),n};var c=r(2);t.Syntax=c.Syntax,t.version="4.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return e.prototype.insertInnerComments=function(e,t){if(e.type===n.Syntax.BlockStatement&&0===e.body.length){for(var r=[],o=this.leading.length-1;o>=0;--o){var i=this.leading[o];t.end.offset>=i.start&&(r.unshift(i.comment),this.leading.splice(o,1),this.trailing.splice(o,1))}r.length&&(e.innerComments=r)}},e.prototype.findTrailingComments=function(e){var t=[];if(this.trailing.length>0){for(var r=this.trailing.length-1;r>=0;--r){var n=this.trailing[r];n.start>=e.end.offset&&t.unshift(n.comment)}return this.trailing.length=0,t}var o=this.stack[this.stack.length-1];if(o&&o.node.trailingComments){var i=o.node.trailingComments[0];i&&i.range[0]>=e.end.offset&&(t=o.node.trailingComments,delete o.node.trailingComments)}return t},e.prototype.findLeadingComments=function(e){for(var t,r=[];this.stack.length>0&&((i=this.stack[this.stack.length-1])&&i.start>=e.start.offset);)t=i.node,this.stack.pop();if(t){for(var n=(t.leadingComments?t.leadingComments.length:0)-1;n>=0;--n){var o=t.leadingComments[n];o.range[1]<=e.start.offset&&(r.unshift(o),t.leadingComments.splice(n,1))}return t.leadingComments&&0===t.leadingComments.length&&delete t.leadingComments,r}for(n=this.leading.length-1;n>=0;--n){var i;(i=this.leading[n]).start<=e.start.offset&&(r.unshift(i.comment),this.leading.splice(n,1))}return r},e.prototype.visitNode=function(e,t){if(!(e.type===n.Syntax.Program&&e.body.length>0)){this.insertInnerComments(e,t);var r=this.findTrailingComments(t),o=this.findLeadingComments(t);o.length>0&&(e.leadingComments=o),r.length>0&&(e.trailingComments=r),this.stack.push({node:e,start:t.start.offset})}},e.prototype.visitComment=function(e,t){var r="L"===e.type[0]?"Line":"Block",n={type:r,value:e.value};if(e.range&&(n.range=e.range),e.loc&&(n.loc=e.loc),this.comments.push(n),this.attach){var o={comment:{type:r,value:e.value,range:[t.start.offset,t.end.offset]},start:t.start.offset};e.loc&&(o.comment.loc=e.loc),e.type=r,this.leading.push(o),this.trailing.push(o)}},e.prototype.visit=function(e,t){"LineComment"===e.type||"BlockComment"===e.type?this.visitComment(e,t):this.attach&&this.visitNode(e,t)},e}();t.CommentHandler=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),a=r(5),s=r(6),c=r(7),u=r(8),p=r(13),l=r(14);function d(e){var t;switch(e.type){case s.JSXSyntax.JSXIdentifier:t=e.name;break;case s.JSXSyntax.JSXNamespacedName:var r=e;t=d(r.namespace)+":"+d(r.name);break;case s.JSXSyntax.JSXMemberExpression:var n=e;t=d(n.object)+"."+d(n.property)}return t}p.TokenName[100]="JSXIdentifier",p.TokenName[101]="JSXText";var h=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return o(t,e),t.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():e.prototype.parsePrimaryExpression.call(this)},t.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},t.prototype.finishJSX=function(){this.nextToken()},t.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},t.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},t.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},t.prototype.scanXHTMLEntity=function(e){for(var t="&",r=!0,n=!1,o=!1,a=!1;!this.scanner.eof()&&r&&!n;){var s=this.scanner.source[this.scanner.index];if(s===e)break;if(n=";"===s,t+=s,++this.scanner.index,!n)switch(t.length){case 2:o="#"===s;break;case 3:o&&(r=(a="x"===s)||i.Character.isDecimalDigit(s.charCodeAt(0)),o=o&&!a);break;default:r=(r=r&&!(o&&!i.Character.isDecimalDigit(s.charCodeAt(0))))&&!(a&&!i.Character.isHexDigit(s.charCodeAt(0)))}}if(r&&n&&t.length>2){var c=t.substr(1,t.length-2);o&&c.length>1?t=String.fromCharCode(parseInt(c.substr(1),10)):a&&c.length>2?t=String.fromCharCode(parseInt("0"+c.substr(1),16)):o||a||!l.XHTMLEntities[c]||(t=l.XHTMLEntities[c])}return t},t.prototype.lexJSX=function(){var e=this.scanner.source.charCodeAt(this.scanner.index);if(60===e||62===e||47===e||58===e||61===e||123===e||125===e)return{type:7,value:s=this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(34===e||39===e){for(var t=this.scanner.index,r=this.scanner.source[this.scanner.index++],n="";!this.scanner.eof()&&(c=this.scanner.source[this.scanner.index++])!==r;)n+="&"===c?this.scanXHTMLEntity(r):c;return{type:8,value:n,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}if(46===e){var o=this.scanner.source.charCodeAt(this.scanner.index+1),a=this.scanner.source.charCodeAt(this.scanner.index+2),s=46===o&&46===a?"...":".";return t=this.scanner.index,this.scanner.index+=s.length,{type:7,value:s,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}if(96===e)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(i.Character.isIdentifierStart(e)&&92!==e){for(t=this.scanner.index,++this.scanner.index;!this.scanner.eof();){var c=this.scanner.source.charCodeAt(this.scanner.index);if(i.Character.isIdentifierPart(c)&&92!==c)++this.scanner.index;else{if(45!==c)break;++this.scanner.index}}return{type:100,value:this.scanner.source.slice(t,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}return this.scanner.lex()},t.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var e=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(e)),e},t.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var e=this.scanner.index,t="";!this.scanner.eof();){var r=this.scanner.source[this.scanner.index];if("{"===r||"<"===r)break;++this.scanner.index,t+=r,i.Character.isLineTerminator(r.charCodeAt(0))&&(++this.scanner.lineNumber,"\r"===r&&"\n"===this.scanner.source[this.scanner.index]&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var n={type:101,value:t,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:e,end:this.scanner.index};return t.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(n)),n},t.prototype.peekJSXToken=function(){var e=this.scanner.saveState();this.scanner.scanComments();var t=this.lexJSX();return this.scanner.restoreState(e),t},t.prototype.expectJSX=function(e){var t=this.nextJSXToken();7===t.type&&t.value===e||this.throwUnexpectedToken(t)},t.prototype.matchJSX=function(e){var t=this.peekJSXToken();return 7===t.type&&t.value===e},t.prototype.parseJSXIdentifier=function(){var e=this.createJSXNode(),t=this.nextJSXToken();return 100!==t.type&&this.throwUnexpectedToken(t),this.finalize(e,new a.JSXIdentifier(t.value))},t.prototype.parseJSXElementName=function(){var e=this.createJSXNode(),t=this.parseJSXIdentifier();if(this.matchJSX(":")){var r=t;this.expectJSX(":");var n=this.parseJSXIdentifier();t=this.finalize(e,new a.JSXNamespacedName(r,n))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var o=t;this.expectJSX(".");var i=this.parseJSXIdentifier();t=this.finalize(e,new a.JSXMemberExpression(o,i))}return t},t.prototype.parseJSXAttributeName=function(){var e,t=this.createJSXNode(),r=this.parseJSXIdentifier();if(this.matchJSX(":")){var n=r;this.expectJSX(":");var o=this.parseJSXIdentifier();e=this.finalize(t,new a.JSXNamespacedName(n,o))}else e=r;return e},t.prototype.parseJSXStringLiteralAttribute=function(){var e=this.createJSXNode(),t=this.nextJSXToken();8!==t.type&&this.throwUnexpectedToken(t);var r=this.getTokenRaw(t);return this.finalize(e,new c.Literal(t.value,r))},t.prototype.parseJSXExpressionAttribute=function(){var e=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var t=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(e,new a.JSXExpressionContainer(t))},t.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},t.prototype.parseJSXNameValueAttribute=function(){var e=this.createJSXNode(),t=this.parseJSXAttributeName(),r=null;return this.matchJSX("=")&&(this.expectJSX("="),r=this.parseJSXAttributeValue()),this.finalize(e,new a.JSXAttribute(t,r))},t.prototype.parseJSXSpreadAttribute=function(){var e=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var t=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(e,new a.JSXSpreadAttribute(t))},t.prototype.parseJSXAttributes=function(){for(var e=[];!this.matchJSX("/")&&!this.matchJSX(">");){var t=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();e.push(t)}return e},t.prototype.parseJSXOpeningElement=function(){var e=this.createJSXNode();this.expectJSX("<");var t=this.parseJSXElementName(),r=this.parseJSXAttributes(),n=this.matchJSX("/");return n&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(e,new a.JSXOpeningElement(t,n,r))},t.prototype.parseJSXBoundaryElement=function(){var e=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var t=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(e,new a.JSXClosingElement(t))}var r=this.parseJSXElementName(),n=this.parseJSXAttributes(),o=this.matchJSX("/");return o&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(e,new a.JSXOpeningElement(r,o,n))},t.prototype.parseJSXEmptyExpression=function(){var e=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(e,new a.JSXEmptyExpression)},t.prototype.parseJSXExpressionContainer=function(){var e,t=this.createJSXNode();return this.expectJSX("{"),this.matchJSX("}")?(e=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),e=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(t,new a.JSXExpressionContainer(e))},t.prototype.parseJSXChildren=function(){for(var e=[];!this.scanner.eof();){var t=this.createJSXChildNode(),r=this.nextJSXText();if(r.start<r.end){var n=this.getTokenRaw(r),o=this.finalize(t,new a.JSXText(r.value,n));e.push(o)}if("{"!==this.scanner.source[this.scanner.index])break;var i=this.parseJSXExpressionContainer();e.push(i)}return e},t.prototype.parseComplexJSXElement=function(e){for(var t=[];!this.scanner.eof();){e.children=e.children.concat(this.parseJSXChildren());var r=this.createJSXChildNode(),n=this.parseJSXBoundaryElement();if(n.type===s.JSXSyntax.JSXOpeningElement){var o=n;if(o.selfClosing){var i=this.finalize(r,new a.JSXElement(o,[],null));e.children.push(i)}else t.push(e),e={node:r,opening:o,closing:null,children:[]}}if(n.type===s.JSXSyntax.JSXClosingElement){e.closing=n;var c=d(e.opening.name);if(c!==d(e.closing.name)&&this.tolerateError("Expected corresponding JSX closing tag for %0",c),!(t.length>0))break;i=this.finalize(e.node,new a.JSXElement(e.opening,e.children,e.closing)),(e=t[t.length-1]).children.push(i),t.pop()}}return e},t.prototype.parseJSXElement=function(){var e=this.createJSXNode(),t=this.parseJSXOpeningElement(),r=[],n=null;if(!t.selfClosing){var o=this.parseComplexJSXElement({node:e,opening:t,closing:n,children:r});r=o.children,n=o.closing}return this.finalize(e,new a.JSXElement(t,r,n))},t.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var e=this.parseJSXElement();return this.finishJSX(),e},t.prototype.isStartOfExpression=function(){return e.prototype.isStartOfExpression.call(this)||this.match("<")},t}(u.Parser);t.JSXParser=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};t.Character={fromCodePoint:function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10))+String.fromCharCode(56320+(e-65536&1023))},isWhiteSpace:function(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0},isLineTerminator:function(e){return 10===e||13===e||8232===e||8233===e},isIdentifierStart:function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&r.NonAsciiIdentifierStart.test(t.Character.fromCodePoint(e))},isIdentifierPart:function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&r.NonAsciiIdentifierPart.test(t.Character.fromCodePoint(e))},isDecimalDigit:function(e){return e>=48&&e<=57},isHexDigit:function(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102},isOctalDigit:function(e){return e>=48&&e<=55}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=function(e){this.type=n.JSXSyntax.JSXClosingElement,this.name=e};t.JSXClosingElement=o;var i=function(e,t,r){this.type=n.JSXSyntax.JSXElement,this.openingElement=e,this.children=t,this.closingElement=r};t.JSXElement=i;var a=function(){this.type=n.JSXSyntax.JSXEmptyExpression};t.JSXEmptyExpression=a;var s=function(e){this.type=n.JSXSyntax.JSXExpressionContainer,this.expression=e};t.JSXExpressionContainer=s;var c=function(e){this.type=n.JSXSyntax.JSXIdentifier,this.name=e};t.JSXIdentifier=c;var u=function(e,t){this.type=n.JSXSyntax.JSXMemberExpression,this.object=e,this.property=t};t.JSXMemberExpression=u;var p=function(e,t){this.type=n.JSXSyntax.JSXAttribute,this.name=e,this.value=t};t.JSXAttribute=p;var l=function(e,t){this.type=n.JSXSyntax.JSXNamespacedName,this.namespace=e,this.name=t};t.JSXNamespacedName=l;var d=function(e,t,r){this.type=n.JSXSyntax.JSXOpeningElement,this.name=e,this.selfClosing=t,this.attributes=r};t.JSXOpeningElement=d;var h=function(e){this.type=n.JSXSyntax.JSXSpreadAttribute,this.argument=e};t.JSXSpreadAttribute=h;var f=function(e,t){this.type=n.JSXSyntax.JSXText,this.value=e,this.raw=t};t.JSXText=f},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(e){this.type=n.Syntax.ArrayExpression,this.elements=e};t.ArrayExpression=o;var i=function(e){this.type=n.Syntax.ArrayPattern,this.elements=e};t.ArrayPattern=i;var a=function(e,t,r){this.type=n.Syntax.ArrowFunctionExpression,this.id=null,this.params=e,this.body=t,this.generator=!1,this.expression=r,this.async=!1};t.ArrowFunctionExpression=a;var s=function(e,t,r){this.type=n.Syntax.AssignmentExpression,this.operator=e,this.left=t,this.right=r};t.AssignmentExpression=s;var c=function(e,t){this.type=n.Syntax.AssignmentPattern,this.left=e,this.right=t};t.AssignmentPattern=c;var u=function(e,t,r){this.type=n.Syntax.ArrowFunctionExpression,this.id=null,this.params=e,this.body=t,this.generator=!1,this.expression=r,this.async=!0};t.AsyncArrowFunctionExpression=u;var p=function(e,t,r){this.type=n.Syntax.FunctionDeclaration,this.id=e,this.params=t,this.body=r,this.generator=!1,this.expression=!1,this.async=!0};t.AsyncFunctionDeclaration=p;var l=function(e,t,r){this.type=n.Syntax.FunctionExpression,this.id=e,this.params=t,this.body=r,this.generator=!1,this.expression=!1,this.async=!0};t.AsyncFunctionExpression=l;var d=function(e){this.type=n.Syntax.AwaitExpression,this.argument=e};t.AwaitExpression=d;var h=function(e,t,r){var o="||"===e||"&&"===e;this.type=o?n.Syntax.LogicalExpression:n.Syntax.BinaryExpression,this.operator=e,this.left=t,this.right=r};t.BinaryExpression=h;var f=function(e){this.type=n.Syntax.BlockStatement,this.body=e};t.BlockStatement=f;var m=function(e){this.type=n.Syntax.BreakStatement,this.label=e};t.BreakStatement=m;var g=function(e,t){this.type=n.Syntax.CallExpression,this.callee=e,this.arguments=t};t.CallExpression=g;var y=function(e,t){this.type=n.Syntax.CatchClause,this.param=e,this.body=t};t.CatchClause=y;var v=function(e){this.type=n.Syntax.ClassBody,this.body=e};t.ClassBody=v;var b=function(e,t,r){this.type=n.Syntax.ClassDeclaration,this.id=e,this.superClass=t,this.body=r};t.ClassDeclaration=b;var w=function(e,t,r){this.type=n.Syntax.ClassExpression,this.id=e,this.superClass=t,this.body=r};t.ClassExpression=w;var x=function(e,t){this.type=n.Syntax.MemberExpression,this.computed=!0,this.object=e,this.property=t};t.ComputedMemberExpression=x;var E=function(e,t,r){this.type=n.Syntax.ConditionalExpression,this.test=e,this.consequent=t,this.alternate=r};t.ConditionalExpression=E;var k=function(e){this.type=n.Syntax.ContinueStatement,this.label=e};t.ContinueStatement=k;var _=function(){this.type=n.Syntax.DebuggerStatement};t.DebuggerStatement=_;var S=function(e,t){this.type=n.Syntax.ExpressionStatement,this.expression=e,this.directive=t};t.Directive=S;var C=function(e,t){this.type=n.Syntax.DoWhileStatement,this.body=e,this.test=t};t.DoWhileStatement=C;var P=function(){this.type=n.Syntax.EmptyStatement};t.EmptyStatement=P;var D=function(e){this.type=n.Syntax.ExportAllDeclaration,this.source=e};t.ExportAllDeclaration=D;var A=function(e){this.type=n.Syntax.ExportDefaultDeclaration,this.declaration=e};t.ExportDefaultDeclaration=A;var O=function(e,t,r){this.type=n.Syntax.ExportNamedDeclaration,this.declaration=e,this.specifiers=t,this.source=r};t.ExportNamedDeclaration=O;var j=function(e,t){this.type=n.Syntax.ExportSpecifier,this.exported=t,this.local=e};t.ExportSpecifier=j;var T=function(e){this.type=n.Syntax.ExpressionStatement,this.expression=e};t.ExpressionStatement=T;var F=function(e,t,r){this.type=n.Syntax.ForInStatement,this.left=e,this.right=t,this.body=r,this.each=!1};t.ForInStatement=F;var I=function(e,t,r){this.type=n.Syntax.ForOfStatement,this.left=e,this.right=t,this.body=r};t.ForOfStatement=I;var N=function(e,t,r,o){this.type=n.Syntax.ForStatement,this.init=e,this.test=t,this.update=r,this.body=o};t.ForStatement=N;var R=function(e,t,r,o){this.type=n.Syntax.FunctionDeclaration,this.id=e,this.params=t,this.body=r,this.generator=o,this.expression=!1,this.async=!1};t.FunctionDeclaration=R;var B=function(e,t,r,o){this.type=n.Syntax.FunctionExpression,this.id=e,this.params=t,this.body=r,this.generator=o,this.expression=!1,this.async=!1};t.FunctionExpression=B;var L=function(e){this.type=n.Syntax.Identifier,this.name=e};t.Identifier=L;var M=function(e,t,r){this.type=n.Syntax.IfStatement,this.test=e,this.consequent=t,this.alternate=r};t.IfStatement=M;var q=function(e,t){this.type=n.Syntax.ImportDeclaration,this.specifiers=e,this.source=t};t.ImportDeclaration=q;var U=function(e){this.type=n.Syntax.ImportDefaultSpecifier,this.local=e};t.ImportDefaultSpecifier=U;var $=function(e){this.type=n.Syntax.ImportNamespaceSpecifier,this.local=e};t.ImportNamespaceSpecifier=$;var z=function(e,t){this.type=n.Syntax.ImportSpecifier,this.local=e,this.imported=t};t.ImportSpecifier=z;var G=function(e,t){this.type=n.Syntax.LabeledStatement,this.label=e,this.body=t};t.LabeledStatement=G;var H=function(e,t){this.type=n.Syntax.Literal,this.value=e,this.raw=t};t.Literal=H;var J=function(e,t){this.type=n.Syntax.MetaProperty,this.meta=e,this.property=t};t.MetaProperty=J;var X=function(e,t,r,o,i){this.type=n.Syntax.MethodDefinition,this.key=e,this.computed=t,this.value=r,this.kind=o,this.static=i};t.MethodDefinition=X;var V=function(e){this.type=n.Syntax.Program,this.body=e,this.sourceType="module"};t.Module=V;var K=function(e,t){this.type=n.Syntax.NewExpression,this.callee=e,this.arguments=t};t.NewExpression=K;var W=function(e){this.type=n.Syntax.ObjectExpression,this.properties=e};t.ObjectExpression=W;var Q=function(e){this.type=n.Syntax.ObjectPattern,this.properties=e};t.ObjectPattern=Q;var Y=function(e,t,r,o,i,a){this.type=n.Syntax.Property,this.key=t,this.computed=r,this.value=o,this.kind=e,this.method=i,this.shorthand=a};t.Property=Y;var Z=function(e,t,r,o){this.type=n.Syntax.Literal,this.value=e,this.raw=t,this.regex={pattern:r,flags:o}};t.RegexLiteral=Z;var ee=function(e){this.type=n.Syntax.RestElement,this.argument=e};t.RestElement=ee;var te=function(e){this.type=n.Syntax.ReturnStatement,this.argument=e};t.ReturnStatement=te;var re=function(e){this.type=n.Syntax.Program,this.body=e,this.sourceType="script"};t.Script=re;var ne=function(e){this.type=n.Syntax.SequenceExpression,this.expressions=e};t.SequenceExpression=ne;var oe=function(e){this.type=n.Syntax.SpreadElement,this.argument=e};t.SpreadElement=oe;var ie=function(e,t){this.type=n.Syntax.MemberExpression,this.computed=!1,this.object=e,this.property=t};t.StaticMemberExpression=ie;var ae=function(){this.type=n.Syntax.Super};t.Super=ae;var se=function(e,t){this.type=n.Syntax.SwitchCase,this.test=e,this.consequent=t};t.SwitchCase=se;var ce=function(e,t){this.type=n.Syntax.SwitchStatement,this.discriminant=e,this.cases=t};t.SwitchStatement=ce;var ue=function(e,t){this.type=n.Syntax.TaggedTemplateExpression,this.tag=e,this.quasi=t};t.TaggedTemplateExpression=ue;var pe=function(e,t){this.type=n.Syntax.TemplateElement,this.value=e,this.tail=t};t.TemplateElement=pe;var le=function(e,t){this.type=n.Syntax.TemplateLiteral,this.quasis=e,this.expressions=t};t.TemplateLiteral=le;var de=function(){this.type=n.Syntax.ThisExpression};t.ThisExpression=de;var he=function(e){this.type=n.Syntax.ThrowStatement,this.argument=e};t.ThrowStatement=he;var fe=function(e,t,r){this.type=n.Syntax.TryStatement,this.block=e,this.handler=t,this.finalizer=r};t.TryStatement=fe;var me=function(e,t){this.type=n.Syntax.UnaryExpression,this.operator=e,this.argument=t,this.prefix=!0};t.UnaryExpression=me;var ge=function(e,t,r){this.type=n.Syntax.UpdateExpression,this.operator=e,this.argument=t,this.prefix=r};t.UpdateExpression=ge;var ye=function(e,t){this.type=n.Syntax.VariableDeclaration,this.declarations=e,this.kind=t};t.VariableDeclaration=ye;var ve=function(e,t){this.type=n.Syntax.VariableDeclarator,this.id=e,this.init=t};t.VariableDeclarator=ve;var be=function(e,t){this.type=n.Syntax.WhileStatement,this.test=e,this.body=t};t.WhileStatement=be;var we=function(e,t){this.type=n.Syntax.WithStatement,this.object=e,this.body=t};t.WithStatement=we;var xe=function(e,t){this.type=n.Syntax.YieldExpression,this.argument=e,this.delegate=t};t.YieldExpression=xe},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(10),i=r(11),a=r(7),s=r(12),c=r(2),u=r(13),p=function(){function e(e,t,r){void 0===t&&(t={}),this.config={range:"boolean"==typeof t.range&&t.range,loc:"boolean"==typeof t.loc&&t.loc,source:null,tokens:"boolean"==typeof t.tokens&&t.tokens,comment:"boolean"==typeof t.comment&&t.comment,tolerant:"boolean"==typeof t.tolerant&&t.tolerant},this.config.loc&&t.source&&null!==t.source&&(this.config.source=String(t.source)),this.delegate=r,this.errorHandler=new o.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new s.Scanner(e,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return e.prototype.throwError=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=Array.prototype.slice.call(arguments,1),i=e.replace(/%(\d)/g,(function(e,t){return n.assert(t<o.length,"Message reference must be in range"),o[t]})),a=this.lastMarker.index,s=this.lastMarker.line,c=this.lastMarker.column+1;throw this.errorHandler.createError(a,s,c,i)},e.prototype.tolerateError=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=Array.prototype.slice.call(arguments,1),i=e.replace(/%(\d)/g,(function(e,t){return n.assert(t<o.length,"Message reference must be in range"),o[t]})),a=this.lastMarker.index,s=this.scanner.lineNumber,c=this.lastMarker.column+1;this.errorHandler.tolerateError(a,s,c,i)},e.prototype.unexpectedTokenError=function(e,t){var r,n=t||i.Messages.UnexpectedToken;if(e?(t||(n=2===e.type?i.Messages.UnexpectedEOS:3===e.type?i.Messages.UnexpectedIdentifier:6===e.type?i.Messages.UnexpectedNumber:8===e.type?i.Messages.UnexpectedString:10===e.type?i.Messages.UnexpectedTemplate:i.Messages.UnexpectedToken,4===e.type&&(this.scanner.isFutureReservedWord(e.value)?n=i.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(e.value)&&(n=i.Messages.StrictReservedWord))),r=e.value):r="ILLEGAL",n=n.replace("%0",r),e&&"number"==typeof e.lineNumber){var o=e.start,a=e.lineNumber,s=this.lastMarker.index-this.lastMarker.column,c=e.start-s+1;return this.errorHandler.createError(o,a,c,n)}return o=this.lastMarker.index,a=this.lastMarker.line,c=this.lastMarker.column+1,this.errorHandler.createError(o,a,c,n)},e.prototype.throwUnexpectedToken=function(e,t){throw this.unexpectedTokenError(e,t)},e.prototype.tolerateUnexpectedToken=function(e,t){this.errorHandler.tolerate(this.unexpectedTokenError(e,t))},e.prototype.collectComments=function(){if(this.config.comment){var e=this.scanner.scanComments();if(e.length>0&&this.delegate)for(var t=0;t<e.length;++t){var r=e[t],n=void 0;n={type:r.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(r.slice[0],r.slice[1])},this.config.range&&(n.range=r.range),this.config.loc&&(n.loc=r.loc);var o={start:{line:r.loc.start.line,column:r.loc.start.column,offset:r.range[0]},end:{line:r.loc.end.line,column:r.loc.end.column,offset:r.range[1]}};this.delegate(n,o)}}else this.scanner.scanComments()},e.prototype.getTokenRaw=function(e){return this.scanner.source.slice(e.start,e.end)},e.prototype.convertToken=function(e){var t={type:u.TokenName[e.type],value:this.getTokenRaw(e)};if(this.config.range&&(t.range=[e.start,e.end]),this.config.loc&&(t.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),9===e.type){var r=e.pattern,n=e.flags;t.regex={pattern:r,flags:n}}return t},e.prototype.nextToken=function(){var e=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var t=this.scanner.lex();return this.hasLineTerminator=e.lineNumber!==t.lineNumber,t&&this.context.strict&&3===t.type&&this.scanner.isStrictModeReservedWord(t.value)&&(t.type=4),this.lookahead=t,this.config.tokens&&2!==t.type&&this.tokens.push(this.convertToken(t)),e},e.prototype.nextRegexToken=function(){this.collectComments();var e=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(e))),this.lookahead=e,this.nextToken(),e},e.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},e.prototype.startNode=function(e,t){void 0===t&&(t=0);var r=e.start-e.lineStart,n=e.lineNumber;return r<0&&(r+=t,n--),{index:e.start,line:n,column:r}},e.prototype.finalize=function(e,t){if(this.config.range&&(t.range=[e.index,this.lastMarker.index]),this.config.loc&&(t.loc={start:{line:e.line,column:e.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(t.loc.source=this.config.source)),this.delegate){var r={start:{line:e.line,column:e.column,offset:e.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(t,r)}return t},e.prototype.expect=function(e){var t=this.nextToken();7===t.type&&t.value===e||this.throwUnexpectedToken(t)},e.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var e=this.lookahead;7===e.type&&","===e.value?this.nextToken():7===e.type&&";"===e.value?(this.nextToken(),this.tolerateUnexpectedToken(e)):this.tolerateUnexpectedToken(e,i.Messages.UnexpectedToken)}else this.expect(",")},e.prototype.expectKeyword=function(e){var t=this.nextToken();4===t.type&&t.value===e||this.throwUnexpectedToken(t)},e.prototype.match=function(e){return 7===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchKeyword=function(e){return 4===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchContextualKeyword=function(e){return 3===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchAssign=function(){if(7!==this.lookahead.type)return!1;var e=this.lookahead.value;return"="===e||"*="===e||"**="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e},e.prototype.isolateCoverGrammar=function(e){var t=this.context.isBindingElement,r=this.context.isAssignmentTarget,n=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var o=e.call(this);return null!==this.context.firstCoverInitializedNameError&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=t,this.context.isAssignmentTarget=r,this.context.firstCoverInitializedNameError=n,o},e.prototype.inheritCoverGrammar=function(e){var t=this.context.isBindingElement,r=this.context.isAssignmentTarget,n=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var o=e.call(this);return this.context.isBindingElement=this.context.isBindingElement&&t,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&r,this.context.firstCoverInitializedNameError=n||this.context.firstCoverInitializedNameError,o},e.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(2===this.lookahead.type||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},e.prototype.parsePrimaryExpression=function(){var e,t,r,n=this.createNode();switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&"await"===this.lookahead.value&&this.tolerateUnexpectedToken(this.lookahead),e=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(n,new a.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,i.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),r=this.getTokenRaw(t),e=this.finalize(n,new a.Literal(t.value,r));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),r=this.getTokenRaw(t),e=this.finalize(n,new a.Literal("true"===t.value,r));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),r=this.getTokenRaw(t),e=this.finalize(n,new a.Literal(null,r));break;case 10:e=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,e=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":e=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":e=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,t=this.nextRegexToken(),r=this.getTokenRaw(t),e=this.finalize(n,new a.RegexLiteral(t.regex,r,t.pattern,t.flags));break;default:e=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?e=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?e=this.finalize(n,new a.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?e=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),e=this.finalize(n,new a.ThisExpression)):e=this.matchKeyword("class")?this.parseClassExpression():this.throwUnexpectedToken(this.nextToken()));break;default:e=this.throwUnexpectedToken(this.nextToken())}return e},e.prototype.parseSpreadElement=function(){var e=this.createNode();this.expect("...");var t=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(e,new a.SpreadElement(t))},e.prototype.parseArrayInitializer=function(){var e=this.createNode(),t=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),t.push(null);else if(this.match("...")){var r=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),t.push(r)}else t.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(e,new a.ArrayExpression(t))},e.prototype.parsePropertyMethod=function(e){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var t=this.context.strict,r=this.context.allowStrictDirective;this.context.allowStrictDirective=e.simple;var n=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&e.firstRestricted&&this.tolerateUnexpectedToken(e.firstRestricted,e.message),this.context.strict&&e.stricted&&this.tolerateUnexpectedToken(e.stricted,e.message),this.context.strict=t,this.context.allowStrictDirective=r,n},e.prototype.parsePropertyMethodFunction=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters(),n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,r.params,n,!1))},e.prototype.parsePropertyMethodAsyncFunction=function(){var e=this.createNode(),t=this.context.allowYield,r=this.context.await;this.context.allowYield=!1,this.context.await=!0;var n=this.parseFormalParameters(),o=this.parsePropertyMethod(n);return this.context.allowYield=t,this.context.await=r,this.finalize(e,new a.AsyncFunctionExpression(null,n.params,o))},e.prototype.parseObjectPropertyKey=function(){var e,t=this.createNode(),r=this.nextToken();switch(r.type){case 8:case 6:this.context.strict&&r.octal&&this.tolerateUnexpectedToken(r,i.Messages.StrictOctalLiteral);var n=this.getTokenRaw(r);e=this.finalize(t,new a.Literal(r.value,n));break;case 3:case 1:case 5:case 4:e=this.finalize(t,new a.Identifier(r.value));break;case 7:"["===r.value?(e=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):e=this.throwUnexpectedToken(r);break;default:e=this.throwUnexpectedToken(r)}return e},e.prototype.isPropertyKey=function(e,t){return e.type===c.Syntax.Identifier&&e.name===t||e.type===c.Syntax.Literal&&e.value===t},e.prototype.parseObjectProperty=function(e){var t,r=this.createNode(),n=this.lookahead,o=null,s=null,c=!1,u=!1,p=!1,l=!1;if(3===n.type){var d=n.value;this.nextToken(),c=this.match("["),o=(l=!(this.hasLineTerminator||"async"!==d||this.match(":")||this.match("(")||this.match("*")||this.match(",")))?this.parseObjectPropertyKey():this.finalize(r,new a.Identifier(d))}else this.match("*")?this.nextToken():(c=this.match("["),o=this.parseObjectPropertyKey());var h=this.qualifiedPropertyName(this.lookahead);if(3===n.type&&!l&&"get"===n.value&&h)t="get",c=this.match("["),o=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod();else if(3===n.type&&!l&&"set"===n.value&&h)t="set",c=this.match("["),o=this.parseObjectPropertyKey(),s=this.parseSetterMethod();else if(7===n.type&&"*"===n.value&&h)t="init",c=this.match("["),o=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(),u=!0;else if(o||this.throwUnexpectedToken(this.lookahead),t="init",this.match(":")&&!l)!c&&this.isPropertyKey(o,"__proto__")&&(e.value&&this.tolerateError(i.Messages.DuplicateProtoProperty),e.value=!0),this.nextToken(),s=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))s=l?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),u=!0;else if(3===n.type)if(d=this.finalize(r,new a.Identifier(n.value)),this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),p=!0;var f=this.isolateCoverGrammar(this.parseAssignmentExpression);s=this.finalize(r,new a.AssignmentPattern(d,f))}else p=!0,s=d;else this.throwUnexpectedToken(this.nextToken());return this.finalize(r,new a.Property(t,o,c,s,u,p))},e.prototype.parseObjectInitializer=function(){var e=this.createNode();this.expect("{");for(var t=[],r={value:!1};!this.match("}");)t.push(this.parseObjectProperty(r)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(e,new a.ObjectExpression(t))},e.prototype.parseTemplateHead=function(){n.assert(this.lookahead.head,"Template literal must start with a template head");var e=this.createNode(),t=this.nextToken(),r=t.value,o=t.cooked;return this.finalize(e,new a.TemplateElement({raw:r,cooked:o},t.tail))},e.prototype.parseTemplateElement=function(){10!==this.lookahead.type&&this.throwUnexpectedToken();var e=this.createNode(),t=this.nextToken(),r=t.value,n=t.cooked;return this.finalize(e,new a.TemplateElement({raw:r,cooked:n},t.tail))},e.prototype.parseTemplateLiteral=function(){var e=this.createNode(),t=[],r=[],n=this.parseTemplateHead();for(r.push(n);!n.tail;)t.push(this.parseExpression()),n=this.parseTemplateElement(),r.push(n);return this.finalize(e,new a.TemplateLiteral(r,t))},e.prototype.reinterpretExpressionAsPattern=function(e){switch(e.type){case c.Syntax.Identifier:case c.Syntax.MemberExpression:case c.Syntax.RestElement:case c.Syntax.AssignmentPattern:break;case c.Syntax.SpreadElement:e.type=c.Syntax.RestElement,this.reinterpretExpressionAsPattern(e.argument);break;case c.Syntax.ArrayExpression:e.type=c.Syntax.ArrayPattern;for(var t=0;t<e.elements.length;t++)null!==e.elements[t]&&this.reinterpretExpressionAsPattern(e.elements[t]);break;case c.Syntax.ObjectExpression:for(e.type=c.Syntax.ObjectPattern,t=0;t<e.properties.length;t++)this.reinterpretExpressionAsPattern(e.properties[t].value);break;case c.Syntax.AssignmentExpression:e.type=c.Syntax.AssignmentPattern,delete e.operator,this.reinterpretExpressionAsPattern(e.left)}},e.prototype.parseGroupExpression=function(){var e;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),e={type:"ArrowParameterPlaceHolder",params:[],async:!1};else{var t=this.lookahead,r=[];if(this.match("..."))e=this.parseRestElement(r),this.expect(")"),this.match("=>")||this.expect("=>"),e={type:"ArrowParameterPlaceHolder",params:[e],async:!1};else{var n=!1;if(this.context.isBindingElement=!0,e=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var o=[];for(this.context.isAssignmentTarget=!1,o.push(e);2!==this.lookahead.type&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var i=0;i<o.length;i++)this.reinterpretExpressionAsPattern(o[i]);n=!0,e={type:"ArrowParameterPlaceHolder",params:o,async:!1}}else if(this.match("...")){for(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),o.push(this.parseRestElement(r)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1,i=0;i<o.length;i++)this.reinterpretExpressionAsPattern(o[i]);n=!0,e={type:"ArrowParameterPlaceHolder",params:o,async:!1}}else o.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(n)break}n||(e=this.finalize(this.startNode(t),new a.SequenceExpression(o)))}if(!n){if(this.expect(")"),this.match("=>")&&(e.type===c.Syntax.Identifier&&"yield"===e.name&&(n=!0,e={type:"ArrowParameterPlaceHolder",params:[e],async:!1}),!n)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),e.type===c.Syntax.SequenceExpression)for(i=0;i<e.expressions.length;i++)this.reinterpretExpressionAsPattern(e.expressions[i]);else this.reinterpretExpressionAsPattern(e);e={type:"ArrowParameterPlaceHolder",params:e.type===c.Syntax.SequenceExpression?e.expressions:[e],async:!1}}this.context.isBindingElement=!1}}}return e},e.prototype.parseArguments=function(){this.expect("(");var e=[];if(!this.match(")"))for(;;){var t=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(e.push(t),this.match(")"))break;if(this.expectCommaSeparator(),this.match(")"))break}return this.expect(")"),e},e.prototype.isIdentifierName=function(e){return 3===e.type||4===e.type||1===e.type||5===e.type},e.prototype.parseIdentifierName=function(){var e=this.createNode(),t=this.nextToken();return this.isIdentifierName(t)||this.throwUnexpectedToken(t),this.finalize(e,new a.Identifier(t.value))},e.prototype.parseNewExpression=function(){var e,t=this.createNode(),r=this.parseIdentifierName();if(n.assert("new"===r.name,"New expression must start with `new`"),this.match("."))if(this.nextToken(),3===this.lookahead.type&&this.context.inFunctionBody&&"target"===this.lookahead.value){var o=this.parseIdentifierName();e=new a.MetaProperty(r,o)}else this.throwUnexpectedToken(this.lookahead);else{var i=this.isolateCoverGrammar(this.parseLeftHandSideExpression),s=this.match("(")?this.parseArguments():[];e=new a.NewExpression(i,s),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(t,e)},e.prototype.parseAsyncArgument=function(){var e=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,e},e.prototype.parseAsyncArguments=function(){this.expect("(");var e=[];if(!this.match(")"))for(;;){var t=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(e.push(t),this.match(")"))break;if(this.expectCommaSeparator(),this.match(")"))break}return this.expect(")"),e},e.prototype.parseLeftHandSideExpressionAllowCall=function(){var e,t=this.lookahead,r=this.matchContextualKeyword("async"),n=this.context.allowIn;for(this.context.allowIn=!0,this.matchKeyword("super")&&this.context.inFunctionBody?(e=this.createNode(),this.nextToken(),e=this.finalize(e,new a.Super),this.match("(")||this.match(".")||this.match("[")||this.throwUnexpectedToken(this.lookahead)):e=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var o=this.parseIdentifierName();e=this.finalize(this.startNode(t),new a.StaticMemberExpression(e,o))}else if(this.match("(")){var i=r&&t.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var s=i?this.parseAsyncArguments():this.parseArguments();if(e=this.finalize(this.startNode(t),new a.CallExpression(e,s)),i&&this.match("=>")){for(var c=0;c<s.length;++c)this.reinterpretExpressionAsPattern(s[c]);e={type:"ArrowParameterPlaceHolder",params:s,async:!0}}}else if(this.match("["))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("["),o=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),e=this.finalize(this.startNode(t),new a.ComputedMemberExpression(e,o));else{if(10!==this.lookahead.type||!this.lookahead.head)break;var u=this.parseTemplateLiteral();e=this.finalize(this.startNode(t),new a.TaggedTemplateExpression(e,u))}return this.context.allowIn=n,e},e.prototype.parseSuper=function(){var e=this.createNode();return this.expectKeyword("super"),this.match("[")||this.match(".")||this.throwUnexpectedToken(this.lookahead),this.finalize(e,new a.Super)},e.prototype.parseLeftHandSideExpression=function(){n.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var e=this.startNode(this.lookahead),t=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var r=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),t=this.finalize(e,new a.ComputedMemberExpression(t,r))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),r=this.parseIdentifierName(),t=this.finalize(e,new a.StaticMemberExpression(t,r));else{if(10!==this.lookahead.type||!this.lookahead.head)break;var o=this.parseTemplateLiteral();t=this.finalize(e,new a.TaggedTemplateExpression(t,o))}return t},e.prototype.parseUpdateExpression=function(){var e,t=this.lookahead;if(this.match("++")||this.match("--")){var r=this.startNode(t),n=this.nextToken();e=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&e.type===c.Syntax.Identifier&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(i.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(i.Messages.InvalidLHSInAssignment);var o=!0;e=this.finalize(r,new a.UpdateExpression(n.value,e,o)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(e=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&7===this.lookahead.type&&(this.match("++")||this.match("--"))){this.context.strict&&e.type===c.Syntax.Identifier&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(i.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(i.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var s=this.nextToken().value;o=!1,e=this.finalize(this.startNode(t),new a.UpdateExpression(s,e,o))}return e},e.prototype.parseAwaitExpression=function(){var e=this.createNode();this.nextToken();var t=this.parseUnaryExpression();return this.finalize(e,new a.AwaitExpression(t))},e.prototype.parseUnaryExpression=function(){var e;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var t=this.startNode(this.lookahead),r=this.nextToken();e=this.inheritCoverGrammar(this.parseUnaryExpression),e=this.finalize(t,new a.UnaryExpression(r.value,e)),this.context.strict&&"delete"===e.operator&&e.argument.type===c.Syntax.Identifier&&this.tolerateError(i.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else e=this.context.await&&this.matchContextualKeyword("await")?this.parseAwaitExpression():this.parseUpdateExpression();return e},e.prototype.parseExponentiationExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseUnaryExpression);if(t.type!==c.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var r=t,n=this.isolateCoverGrammar(this.parseExponentiationExpression);t=this.finalize(this.startNode(e),new a.BinaryExpression("**",r,n))}return t},e.prototype.binaryPrecedence=function(e){var t=e.value;return 7===e.type?this.operatorPrecedence[t]||0:4===e.type&&("instanceof"===t||this.context.allowIn&&"in"===t)?7:0},e.prototype.parseBinaryExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseExponentiationExpression),r=this.lookahead,n=this.binaryPrecedence(r);if(n>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var o=[e,this.lookahead],i=t,s=this.isolateCoverGrammar(this.parseExponentiationExpression),c=[i,r.value,s],u=[n];!((n=this.binaryPrecedence(this.lookahead))<=0);){for(;c.length>2&&n<=u[u.length-1];){s=c.pop();var p=c.pop();u.pop(),i=c.pop(),o.pop();var l=this.startNode(o[o.length-1]);c.push(this.finalize(l,new a.BinaryExpression(p,i,s)))}c.push(this.nextToken().value),u.push(n),o.push(this.lookahead),c.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var d=c.length-1;t=c[d];for(var h=o.pop();d>1;){var f=o.pop(),m=h&&h.lineStart;l=this.startNode(f,m),p=c[d-1],t=this.finalize(l,new a.BinaryExpression(p,c[d-2],t)),d-=2,h=f}}return t},e.prototype.parseConditionalExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var r=this.context.allowIn;this.context.allowIn=!0;var n=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=r,this.expect(":");var o=this.isolateCoverGrammar(this.parseAssignmentExpression);t=this.finalize(this.startNode(e),new a.ConditionalExpression(t,n,o)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return t},e.prototype.checkPatternParam=function(e,t){switch(t.type){case c.Syntax.Identifier:this.validateParam(e,t,t.name);break;case c.Syntax.RestElement:this.checkPatternParam(e,t.argument);break;case c.Syntax.AssignmentPattern:this.checkPatternParam(e,t.left);break;case c.Syntax.ArrayPattern:for(var r=0;r<t.elements.length;r++)null!==t.elements[r]&&this.checkPatternParam(e,t.elements[r]);break;case c.Syntax.ObjectPattern:for(r=0;r<t.properties.length;r++)this.checkPatternParam(e,t.properties[r].value)}e.simple=e.simple&&t instanceof a.Identifier},e.prototype.reinterpretAsCoverFormalsList=function(e){var t,r=[e],n=!1;switch(e.type){case c.Syntax.Identifier:break;case"ArrowParameterPlaceHolder":r=e.params,n=e.async;break;default:return null}t={simple:!0,paramSet:{}};for(var o=0;o<r.length;++o)(a=r[o]).type===c.Syntax.AssignmentPattern?a.right.type===c.Syntax.YieldExpression&&(a.right.argument&&this.throwUnexpectedToken(this.lookahead),a.right.type=c.Syntax.Identifier,a.right.name="yield",delete a.right.argument,delete a.right.delegate):n&&a.type===c.Syntax.Identifier&&"await"===a.name&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(t,a),r[o]=a;if(this.context.strict||!this.context.allowYield)for(o=0;o<r.length;++o){var a;(a=r[o]).type===c.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(t.message===i.Messages.StrictParamDupe){var s=this.context.strict?t.stricted:t.firstRestricted;this.throwUnexpectedToken(s,t.message)}return{simple:t.simple,params:r,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}},e.prototype.parseAssignmentExpression=function(){var e;if(!this.context.allowYield&&this.matchKeyword("yield"))e=this.parseYieldExpression();else{var t=this.lookahead,r=t;if(e=this.parseConditionalExpression(),3===r.type&&r.lineNumber===this.lookahead.lineNumber&&"async"===r.value&&(3===this.lookahead.type||this.matchKeyword("yield"))){var n=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(n),e={type:"ArrowParameterPlaceHolder",params:[n],async:!0}}if("ArrowParameterPlaceHolder"===e.type||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var o=e.async,s=this.reinterpretAsCoverFormalsList(e);if(s){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var u=this.context.strict,p=this.context.allowStrictDirective;this.context.allowStrictDirective=s.simple;var l=this.context.allowYield,d=this.context.await;this.context.allowYield=!0,this.context.await=o;var h=this.startNode(t);this.expect("=>");var f=void 0;if(this.match("{")){var m=this.context.allowIn;this.context.allowIn=!0,f=this.parseFunctionSourceElements(),this.context.allowIn=m}else f=this.isolateCoverGrammar(this.parseAssignmentExpression);var g=f.type!==c.Syntax.BlockStatement;this.context.strict&&s.firstRestricted&&this.throwUnexpectedToken(s.firstRestricted,s.message),this.context.strict&&s.stricted&&this.tolerateUnexpectedToken(s.stricted,s.message),e=o?this.finalize(h,new a.AsyncArrowFunctionExpression(s.params,f,g)):this.finalize(h,new a.ArrowFunctionExpression(s.params,f,g)),this.context.strict=u,this.context.allowStrictDirective=p,this.context.allowYield=l,this.context.await=d}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(i.Messages.InvalidLHSInAssignment),this.context.strict&&e.type===c.Syntax.Identifier){var y=e;this.scanner.isRestrictedWord(y.name)&&this.tolerateUnexpectedToken(r,i.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(y.name)&&this.tolerateUnexpectedToken(r,i.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(e):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);var v=(r=this.nextToken()).value,b=this.isolateCoverGrammar(this.parseAssignmentExpression);e=this.finalize(this.startNode(t),new a.AssignmentExpression(v,e,b)),this.context.firstCoverInitializedNameError=null}}return e},e.prototype.parseExpression=function(){var e=this.lookahead,t=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var r=[];for(r.push(t);2!==this.lookahead.type&&this.match(",");)this.nextToken(),r.push(this.isolateCoverGrammar(this.parseAssignmentExpression));t=this.finalize(this.startNode(e),new a.SequenceExpression(r))}return t},e.prototype.parseStatementListItem=function(){var e;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,4===this.lookahead.type)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,i.Messages.IllegalExportDeclaration),e=this.parseExportDeclaration();break;case"import":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,i.Messages.IllegalImportDeclaration),e=this.parseImportDeclaration();break;case"const":e=this.parseLexicalDeclaration({inFor:!1});break;case"function":e=this.parseFunctionDeclaration();break;case"class":e=this.parseClassDeclaration();break;case"let":e=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:e=this.parseStatement()}else e=this.parseStatement();return e},e.prototype.parseBlock=function(){var e=this.createNode();this.expect("{");for(var t=[];!this.match("}");)t.push(this.parseStatementListItem());return this.expect("}"),this.finalize(e,new a.BlockStatement(t))},e.prototype.parseLexicalBinding=function(e,t){var r=this.createNode(),n=this.parsePattern([],e);this.context.strict&&n.type===c.Syntax.Identifier&&this.scanner.isRestrictedWord(n.name)&&this.tolerateError(i.Messages.StrictVarName);var o=null;return"const"===e?this.matchKeyword("in")||this.matchContextualKeyword("of")||(this.match("=")?(this.nextToken(),o=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(i.Messages.DeclarationMissingInitializer,"const")):(!t.inFor&&n.type!==c.Syntax.Identifier||this.match("="))&&(this.expect("="),o=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(r,new a.VariableDeclarator(n,o))},e.prototype.parseBindingList=function(e,t){for(var r=[this.parseLexicalBinding(e,t)];this.match(",");)this.nextToken(),r.push(this.parseLexicalBinding(e,t));return r},e.prototype.isLexicalDeclaration=function(){var e=this.scanner.saveState();this.scanner.scanComments();var t=this.scanner.lex();return this.scanner.restoreState(e),3===t.type||7===t.type&&"["===t.value||7===t.type&&"{"===t.value||4===t.type&&"let"===t.value||4===t.type&&"yield"===t.value},e.prototype.parseLexicalDeclaration=function(e){var t=this.createNode(),r=this.nextToken().value;n.assert("let"===r||"const"===r,"Lexical declaration must be either let or const");var o=this.parseBindingList(r,e);return this.consumeSemicolon(),this.finalize(t,new a.VariableDeclaration(o,r))},e.prototype.parseBindingRestElement=function(e,t){var r=this.createNode();this.expect("...");var n=this.parsePattern(e,t);return this.finalize(r,new a.RestElement(n))},e.prototype.parseArrayPattern=function(e,t){var r=this.createNode();this.expect("[");for(var n=[];!this.match("]");)if(this.match(","))this.nextToken(),n.push(null);else{if(this.match("...")){n.push(this.parseBindingRestElement(e,t));break}n.push(this.parsePatternWithDefault(e,t)),this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(r,new a.ArrayPattern(n))},e.prototype.parsePropertyPattern=function(e,t){var r,n,o=this.createNode(),i=!1,s=!1;if(3===this.lookahead.type){var c=this.lookahead;r=this.parseVariableIdentifier();var u=this.finalize(o,new a.Identifier(c.value));if(this.match("=")){e.push(c),s=!0,this.nextToken();var p=this.parseAssignmentExpression();n=this.finalize(this.startNode(c),new a.AssignmentPattern(u,p))}else this.match(":")?(this.expect(":"),n=this.parsePatternWithDefault(e,t)):(e.push(c),s=!0,n=u)}else i=this.match("["),r=this.parseObjectPropertyKey(),this.expect(":"),n=this.parsePatternWithDefault(e,t);return this.finalize(o,new a.Property("init",r,i,n,!1,s))},e.prototype.parseObjectPattern=function(e,t){var r=this.createNode(),n=[];for(this.expect("{");!this.match("}");)n.push(this.parsePropertyPattern(e,t)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(r,new a.ObjectPattern(n))},e.prototype.parsePattern=function(e,t){var r;return this.match("[")?r=this.parseArrayPattern(e,t):this.match("{")?r=this.parseObjectPattern(e,t):(!this.matchKeyword("let")||"const"!==t&&"let"!==t||this.tolerateUnexpectedToken(this.lookahead,i.Messages.LetInLexicalBinding),e.push(this.lookahead),r=this.parseVariableIdentifier(t)),r},e.prototype.parsePatternWithDefault=function(e,t){var r=this.lookahead,n=this.parsePattern(e,t);if(this.match("=")){this.nextToken();var o=this.context.allowYield;this.context.allowYield=!0;var i=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=o,n=this.finalize(this.startNode(r),new a.AssignmentPattern(n,i))}return n},e.prototype.parseVariableIdentifier=function(e){var t=this.createNode(),r=this.nextToken();return 4===r.type&&"yield"===r.value?this.context.strict?this.tolerateUnexpectedToken(r,i.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(r):3!==r.type?this.context.strict&&4===r.type&&this.scanner.isStrictModeReservedWord(r.value)?this.tolerateUnexpectedToken(r,i.Messages.StrictReservedWord):(this.context.strict||"let"!==r.value||"var"!==e)&&this.throwUnexpectedToken(r):(this.context.isModule||this.context.await)&&3===r.type&&"await"===r.value&&this.tolerateUnexpectedToken(r),this.finalize(t,new a.Identifier(r.value))},e.prototype.parseVariableDeclaration=function(e){var t=this.createNode(),r=this.parsePattern([],"var");this.context.strict&&r.type===c.Syntax.Identifier&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(i.Messages.StrictVarName);var n=null;return this.match("=")?(this.nextToken(),n=this.isolateCoverGrammar(this.parseAssignmentExpression)):r.type===c.Syntax.Identifier||e.inFor||this.expect("="),this.finalize(t,new a.VariableDeclarator(r,n))},e.prototype.parseVariableDeclarationList=function(e){var t={inFor:e.inFor},r=[];for(r.push(this.parseVariableDeclaration(t));this.match(",");)this.nextToken(),r.push(this.parseVariableDeclaration(t));return r},e.prototype.parseVariableStatement=function(){var e=this.createNode();this.expectKeyword("var");var t=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(e,new a.VariableDeclaration(t,"var"))},e.prototype.parseEmptyStatement=function(){var e=this.createNode();return this.expect(";"),this.finalize(e,new a.EmptyStatement)},e.prototype.parseExpressionStatement=function(){var e=this.createNode(),t=this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new a.ExpressionStatement(t))},e.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(i.Messages.StrictFunction),this.parseStatement()},e.prototype.parseIfStatement=function(){var e,t=this.createNode(),r=null;this.expectKeyword("if"),this.expect("(");var n=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new a.EmptyStatement)):(this.expect(")"),e=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),r=this.parseIfClause())),this.finalize(t,new a.IfStatement(n,e,r))},e.prototype.parseDoWhileStatement=function(){var e=this.createNode();this.expectKeyword("do");var t=this.context.inIteration;this.context.inIteration=!0;var r=this.parseStatement();this.context.inIteration=t,this.expectKeyword("while"),this.expect("(");var n=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(e,new a.DoWhileStatement(r,n))},e.prototype.parseWhileStatement=function(){var e,t=this.createNode();this.expectKeyword("while"),this.expect("(");var r=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new a.EmptyStatement);else{this.expect(")");var n=this.context.inIteration;this.context.inIteration=!0,e=this.parseStatement(),this.context.inIteration=n}return this.finalize(t,new a.WhileStatement(r,e))},e.prototype.parseForStatement=function(){var e,t,r,n=null,o=null,s=null,u=!0,p=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){n=this.createNode(),this.nextToken();var l=this.context.allowIn;this.context.allowIn=!1;var d=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=l,1===d.length&&this.matchKeyword("in")){var h=d[0];h.init&&(h.id.type===c.Syntax.ArrayPattern||h.id.type===c.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(i.Messages.ForInOfLoopInitializer,"for-in"),n=this.finalize(n,new a.VariableDeclaration(d,"var")),this.nextToken(),e=n,t=this.parseExpression(),n=null}else 1===d.length&&null===d[0].init&&this.matchContextualKeyword("of")?(n=this.finalize(n,new a.VariableDeclaration(d,"var")),this.nextToken(),e=n,t=this.parseAssignmentExpression(),n=null,u=!1):(n=this.finalize(n,new a.VariableDeclaration(d,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){n=this.createNode();var f=this.nextToken().value;this.context.strict||"in"!==this.lookahead.value?(l=this.context.allowIn,this.context.allowIn=!1,d=this.parseBindingList(f,{inFor:!0}),this.context.allowIn=l,1===d.length&&null===d[0].init&&this.matchKeyword("in")?(n=this.finalize(n,new a.VariableDeclaration(d,f)),this.nextToken(),e=n,t=this.parseExpression(),n=null):1===d.length&&null===d[0].init&&this.matchContextualKeyword("of")?(n=this.finalize(n,new a.VariableDeclaration(d,f)),this.nextToken(),e=n,t=this.parseAssignmentExpression(),n=null,u=!1):(this.consumeSemicolon(),n=this.finalize(n,new a.VariableDeclaration(d,f)))):(n=this.finalize(n,new a.Identifier(f)),this.nextToken(),e=n,t=this.parseExpression(),n=null)}else{var m=this.lookahead;if(l=this.context.allowIn,this.context.allowIn=!1,n=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=l,this.matchKeyword("in"))this.context.isAssignmentTarget&&n.type!==c.Syntax.AssignmentExpression||this.tolerateError(i.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(n),e=n,t=this.parseExpression(),n=null;else if(this.matchContextualKeyword("of"))this.context.isAssignmentTarget&&n.type!==c.Syntax.AssignmentExpression||this.tolerateError(i.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(n),e=n,t=this.parseAssignmentExpression(),n=null,u=!1;else{if(this.match(",")){for(var g=[n];this.match(",");)this.nextToken(),g.push(this.isolateCoverGrammar(this.parseAssignmentExpression));n=this.finalize(this.startNode(m),new a.SequenceExpression(g))}this.expect(";")}}if(void 0===e&&(this.match(";")||(o=this.parseExpression()),this.expect(";"),this.match(")")||(s=this.parseExpression())),!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),r=this.finalize(this.createNode(),new a.EmptyStatement);else{this.expect(")");var y=this.context.inIteration;this.context.inIteration=!0,r=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=y}return void 0===e?this.finalize(p,new a.ForStatement(n,o,s,r)):u?this.finalize(p,new a.ForInStatement(e,t,r)):this.finalize(p,new a.ForOfStatement(e,t,r))},e.prototype.parseContinueStatement=function(){var e=this.createNode();this.expectKeyword("continue");var t=null;if(3===this.lookahead.type&&!this.hasLineTerminator){var r=this.parseVariableIdentifier();t=r;var n="$"+r.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,n)||this.throwError(i.Messages.UnknownLabel,r.name)}return this.consumeSemicolon(),null!==t||this.context.inIteration||this.throwError(i.Messages.IllegalContinue),this.finalize(e,new a.ContinueStatement(t))},e.prototype.parseBreakStatement=function(){var e=this.createNode();this.expectKeyword("break");var t=null;if(3===this.lookahead.type&&!this.hasLineTerminator){var r=this.parseVariableIdentifier(),n="$"+r.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,n)||this.throwError(i.Messages.UnknownLabel,r.name),t=r}return this.consumeSemicolon(),null!==t||this.context.inIteration||this.context.inSwitch||this.throwError(i.Messages.IllegalBreak),this.finalize(e,new a.BreakStatement(t))},e.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(i.Messages.IllegalReturn);var e=this.createNode();this.expectKeyword("return");var t=(this.match(";")||this.match("}")||this.hasLineTerminator||2===this.lookahead.type)&&8!==this.lookahead.type&&10!==this.lookahead.type?null:this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new a.ReturnStatement(t))},e.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(i.Messages.StrictModeWith);var e,t=this.createNode();this.expectKeyword("with"),this.expect("(");var r=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new a.EmptyStatement)):(this.expect(")"),e=this.parseStatement()),this.finalize(t,new a.WithStatement(r,e))},e.prototype.parseSwitchCase=function(){var e,t=this.createNode();this.matchKeyword("default")?(this.nextToken(),e=null):(this.expectKeyword("case"),e=this.parseExpression()),this.expect(":");for(var r=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)r.push(this.parseStatementListItem());return this.finalize(t,new a.SwitchCase(e,r))},e.prototype.parseSwitchStatement=function(){var e=this.createNode();this.expectKeyword("switch"),this.expect("(");var t=this.parseExpression();this.expect(")");var r=this.context.inSwitch;this.context.inSwitch=!0;var n=[],o=!1;for(this.expect("{");!this.match("}");){var s=this.parseSwitchCase();null===s.test&&(o&&this.throwError(i.Messages.MultipleDefaultsInSwitch),o=!0),n.push(s)}return this.expect("}"),this.context.inSwitch=r,this.finalize(e,new a.SwitchStatement(t,n))},e.prototype.parseLabelledStatement=function(){var e,t=this.createNode(),r=this.parseExpression();if(r.type===c.Syntax.Identifier&&this.match(":")){this.nextToken();var n=r,o="$"+n.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,o)&&this.throwError(i.Messages.Redeclaration,"Label",n.name),this.context.labelSet[o]=!0;var s=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),s=this.parseClassDeclaration();else if(this.matchKeyword("function")){var u=this.lookahead,p=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(u,i.Messages.StrictFunction):p.generator&&this.tolerateUnexpectedToken(u,i.Messages.GeneratorInLegacyContext),s=p}else s=this.parseStatement();delete this.context.labelSet[o],e=new a.LabeledStatement(n,s)}else this.consumeSemicolon(),e=new a.ExpressionStatement(r);return this.finalize(t,e)},e.prototype.parseThrowStatement=function(){var e=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(i.Messages.NewlineAfterThrow);var t=this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new a.ThrowStatement(t))},e.prototype.parseCatchClause=function(){var e=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var t=[],r=this.parsePattern(t),n={},o=0;o<t.length;o++){var s="$"+t[o].value;Object.prototype.hasOwnProperty.call(n,s)&&this.tolerateError(i.Messages.DuplicateBinding,t[o].value),n[s]=!0}this.context.strict&&r.type===c.Syntax.Identifier&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(i.Messages.StrictCatchVariable),this.expect(")");var u=this.parseBlock();return this.finalize(e,new a.CatchClause(r,u))},e.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},e.prototype.parseTryStatement=function(){var e=this.createNode();this.expectKeyword("try");var t=this.parseBlock(),r=this.matchKeyword("catch")?this.parseCatchClause():null,n=this.matchKeyword("finally")?this.parseFinallyClause():null;return r||n||this.throwError(i.Messages.NoCatchOrFinally),this.finalize(e,new a.TryStatement(t,r,n))},e.prototype.parseDebuggerStatement=function(){var e=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(e,new a.DebuggerStatement)},e.prototype.parseStatement=function(){var e;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:e=this.parseExpressionStatement();break;case 7:var t=this.lookahead.value;e="{"===t?this.parseBlock():"("===t?this.parseExpressionStatement():";"===t?this.parseEmptyStatement():this.parseExpressionStatement();break;case 3:e=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":e=this.parseBreakStatement();break;case"continue":e=this.parseContinueStatement();break;case"debugger":e=this.parseDebuggerStatement();break;case"do":e=this.parseDoWhileStatement();break;case"for":e=this.parseForStatement();break;case"function":e=this.parseFunctionDeclaration();break;case"if":e=this.parseIfStatement();break;case"return":e=this.parseReturnStatement();break;case"switch":e=this.parseSwitchStatement();break;case"throw":e=this.parseThrowStatement();break;case"try":e=this.parseTryStatement();break;case"var":e=this.parseVariableStatement();break;case"while":e=this.parseWhileStatement();break;case"with":e=this.parseWithStatement();break;default:e=this.parseExpressionStatement()}break;default:e=this.throwUnexpectedToken(this.lookahead)}return e},e.prototype.parseFunctionSourceElements=function(){var e=this.createNode();this.expect("{");var t=this.parseDirectivePrologues(),r=this.context.labelSet,n=this.context.inIteration,o=this.context.inSwitch,i=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;2!==this.lookahead.type&&!this.match("}");)t.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=r,this.context.inIteration=n,this.context.inSwitch=o,this.context.inFunctionBody=i,this.finalize(e,new a.BlockStatement(t))},e.prototype.validateParam=function(e,t,r){var n="$"+r;this.context.strict?(this.scanner.isRestrictedWord(r)&&(e.stricted=t,e.message=i.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.stricted=t,e.message=i.Messages.StrictParamDupe)):e.firstRestricted||(this.scanner.isRestrictedWord(r)?(e.firstRestricted=t,e.message=i.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(r)?(e.firstRestricted=t,e.message=i.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.stricted=t,e.message=i.Messages.StrictParamDupe)),"function"==typeof Object.defineProperty?Object.defineProperty(e.paramSet,n,{value:!0,enumerable:!0,writable:!0,configurable:!0}):e.paramSet[n]=!0},e.prototype.parseRestElement=function(e){var t=this.createNode();this.expect("...");var r=this.parsePattern(e);return this.match("=")&&this.throwError(i.Messages.DefaultRestParameter),this.match(")")||this.throwError(i.Messages.ParameterAfterRestParameter),this.finalize(t,new a.RestElement(r))},e.prototype.parseFormalParameter=function(e){for(var t=[],r=this.match("...")?this.parseRestElement(t):this.parsePatternWithDefault(t),n=0;n<t.length;n++)this.validateParam(e,t[n],t[n].value);e.simple=e.simple&&r instanceof a.Identifier,e.params.push(r)},e.prototype.parseFormalParameters=function(e){var t;if(t={simple:!0,params:[],firstRestricted:e},this.expect("("),!this.match(")"))for(t.paramSet={};2!==this.lookahead.type&&(this.parseFormalParameter(t),!this.match(")"))&&(this.expect(","),!this.match(")")););return this.expect(")"),{simple:t.simple,params:t.params,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}},e.prototype.matchAsyncFunction=function(){var e=this.matchContextualKeyword("async");if(e){var t=this.scanner.saveState();this.scanner.scanComments();var r=this.scanner.lex();this.scanner.restoreState(t),e=t.lineNumber===r.lineNumber&&4===r.type&&"function"===r.value}return e},e.prototype.parseFunctionDeclaration=function(e){var t=this.createNode(),r=this.matchContextualKeyword("async");r&&this.nextToken(),this.expectKeyword("function");var n,o=!r&&this.match("*");o&&this.nextToken();var s=null,c=null;if(!e||!this.match("(")){var u=this.lookahead;s=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(u.value)&&this.tolerateUnexpectedToken(u,i.Messages.StrictFunctionName):this.scanner.isRestrictedWord(u.value)?(c=u,n=i.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(u.value)&&(c=u,n=i.Messages.StrictReservedWord)}var p=this.context.await,l=this.context.allowYield;this.context.await=r,this.context.allowYield=!o;var d=this.parseFormalParameters(c),h=d.params,f=d.stricted;c=d.firstRestricted,d.message&&(n=d.message);var m=this.context.strict,g=this.context.allowStrictDirective;this.context.allowStrictDirective=d.simple;var y=this.parseFunctionSourceElements();return this.context.strict&&c&&this.throwUnexpectedToken(c,n),this.context.strict&&f&&this.tolerateUnexpectedToken(f,n),this.context.strict=m,this.context.allowStrictDirective=g,this.context.await=p,this.context.allowYield=l,r?this.finalize(t,new a.AsyncFunctionDeclaration(s,h,y)):this.finalize(t,new a.FunctionDeclaration(s,h,y,o))},e.prototype.parseFunctionExpression=function(){var e=this.createNode(),t=this.matchContextualKeyword("async");t&&this.nextToken(),this.expectKeyword("function");var r,n=!t&&this.match("*");n&&this.nextToken();var o,s=null,c=this.context.await,u=this.context.allowYield;if(this.context.await=t,this.context.allowYield=!n,!this.match("(")){var p=this.lookahead;s=this.context.strict||n||!this.matchKeyword("yield")?this.parseVariableIdentifier():this.parseIdentifierName(),this.context.strict?this.scanner.isRestrictedWord(p.value)&&this.tolerateUnexpectedToken(p,i.Messages.StrictFunctionName):this.scanner.isRestrictedWord(p.value)?(o=p,r=i.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(p.value)&&(o=p,r=i.Messages.StrictReservedWord)}var l=this.parseFormalParameters(o),d=l.params,h=l.stricted;o=l.firstRestricted,l.message&&(r=l.message);var f=this.context.strict,m=this.context.allowStrictDirective;this.context.allowStrictDirective=l.simple;var g=this.parseFunctionSourceElements();return this.context.strict&&o&&this.throwUnexpectedToken(o,r),this.context.strict&&h&&this.tolerateUnexpectedToken(h,r),this.context.strict=f,this.context.allowStrictDirective=m,this.context.await=c,this.context.allowYield=u,t?this.finalize(e,new a.AsyncFunctionExpression(s,d,g)):this.finalize(e,new a.FunctionExpression(s,d,g,n))},e.prototype.parseDirective=function(){var e=this.lookahead,t=this.createNode(),r=this.parseExpression(),n=r.type===c.Syntax.Literal?this.getTokenRaw(e).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(t,n?new a.Directive(r,n):new a.ExpressionStatement(r))},e.prototype.parseDirectivePrologues=function(){for(var e=null,t=[];;){var r=this.lookahead;if(8!==r.type)break;var n=this.parseDirective();t.push(n);var o=n.directive;if("string"!=typeof o)break;"use strict"===o?(this.context.strict=!0,e&&this.tolerateUnexpectedToken(e,i.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(r,i.Messages.IllegalLanguageModeDirective)):!e&&r.octal&&(e=r)}return t},e.prototype.qualifiedPropertyName=function(e){switch(e.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return"["===e.value}return!1},e.prototype.parseGetterMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters();r.params.length>0&&this.tolerateError(i.Messages.BadGetterArity);var n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,r.params,n,!1))},e.prototype.parseSetterMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters();1!==r.params.length?this.tolerateError(i.Messages.BadSetterArity):r.params[0]instanceof a.RestElement&&this.tolerateError(i.Messages.BadSetterRestParameter);var n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,r.params,n,!1))},e.prototype.parseGeneratorMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters();this.context.allowYield=!1;var n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,r.params,n,!0))},e.prototype.isStartOfExpression=function(){var e=!0,t=this.lookahead.value;switch(this.lookahead.type){case 7:e="["===t||"("===t||"{"===t||"+"===t||"-"===t||"!"===t||"~"===t||"++"===t||"--"===t||"/"===t||"/="===t;break;case 4:e="class"===t||"delete"===t||"function"===t||"let"===t||"new"===t||"super"===t||"this"===t||"typeof"===t||"void"===t||"yield"===t}return e},e.prototype.parseYieldExpression=function(){var e=this.createNode();this.expectKeyword("yield");var t=null,r=!1;if(!this.hasLineTerminator){var n=this.context.allowYield;this.context.allowYield=!1,(r=this.match("*"))?(this.nextToken(),t=this.parseAssignmentExpression()):this.isStartOfExpression()&&(t=this.parseAssignmentExpression()),this.context.allowYield=n}return this.finalize(e,new a.YieldExpression(t,r))},e.prototype.parseClassElement=function(e){var t=this.lookahead,r=this.createNode(),n="",o=null,s=null,c=!1,u=!1,p=!1,l=!1;if(this.match("*"))this.nextToken();else if(c=this.match("["),"static"===(o=this.parseObjectPropertyKey()).name&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(t=this.lookahead,p=!0,c=this.match("["),this.match("*")?this.nextToken():o=this.parseObjectPropertyKey()),3===t.type&&!this.hasLineTerminator&&"async"===t.value){var d=this.lookahead.value;":"!==d&&"("!==d&&"*"!==d&&(l=!0,t=this.lookahead,o=this.parseObjectPropertyKey(),3===t.type&&"constructor"===t.value&&this.tolerateUnexpectedToken(t,i.Messages.ConstructorIsAsync))}var h=this.qualifiedPropertyName(this.lookahead);return 3===t.type?"get"===t.value&&h?(n="get",c=this.match("["),o=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod()):"set"===t.value&&h&&(n="set",c=this.match("["),o=this.parseObjectPropertyKey(),s=this.parseSetterMethod()):7===t.type&&"*"===t.value&&h&&(n="init",c=this.match("["),o=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(),u=!0),!n&&o&&this.match("(")&&(n="init",s=l?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),u=!0),n||this.throwUnexpectedToken(this.lookahead),"init"===n&&(n="method"),c||(p&&this.isPropertyKey(o,"prototype")&&this.throwUnexpectedToken(t,i.Messages.StaticPrototype),!p&&this.isPropertyKey(o,"constructor")&&(("method"!==n||!u||s&&s.generator)&&this.throwUnexpectedToken(t,i.Messages.ConstructorSpecialMethod),e.value?this.throwUnexpectedToken(t,i.Messages.DuplicateConstructor):e.value=!0,n="constructor")),this.finalize(r,new a.MethodDefinition(o,c,s,n,p))},e.prototype.parseClassElementList=function(){var e=[],t={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():e.push(this.parseClassElement(t));return this.expect("}"),e},e.prototype.parseClassBody=function(){var e=this.createNode(),t=this.parseClassElementList();return this.finalize(e,new a.ClassBody(t))},e.prototype.parseClassDeclaration=function(e){var t=this.createNode(),r=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var n=e&&3!==this.lookahead.type?null:this.parseVariableIdentifier(),o=null;this.matchKeyword("extends")&&(this.nextToken(),o=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var i=this.parseClassBody();return this.context.strict=r,this.finalize(t,new a.ClassDeclaration(n,o,i))},e.prototype.parseClassExpression=function(){var e=this.createNode(),t=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var r=3===this.lookahead.type?this.parseVariableIdentifier():null,n=null;this.matchKeyword("extends")&&(this.nextToken(),n=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var o=this.parseClassBody();return this.context.strict=t,this.finalize(e,new a.ClassExpression(r,n,o))},e.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;for(var e=this.createNode(),t=this.parseDirectivePrologues();2!==this.lookahead.type;)t.push(this.parseStatementListItem());return this.finalize(e,new a.Module(t))},e.prototype.parseScript=function(){for(var e=this.createNode(),t=this.parseDirectivePrologues();2!==this.lookahead.type;)t.push(this.parseStatementListItem());return this.finalize(e,new a.Script(t))},e.prototype.parseModuleSpecifier=function(){var e=this.createNode();8!==this.lookahead.type&&this.throwError(i.Messages.InvalidModuleSpecifier);var t=this.nextToken(),r=this.getTokenRaw(t);return this.finalize(e,new a.Literal(t.value,r))},e.prototype.parseImportSpecifier=function(){var e,t,r=this.createNode();return 3===this.lookahead.type?(t=e=this.parseVariableIdentifier(),this.matchContextualKeyword("as")&&(this.nextToken(),t=this.parseVariableIdentifier())):(t=e=this.parseIdentifierName(),this.matchContextualKeyword("as")?(this.nextToken(),t=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(r,new a.ImportSpecifier(t,e))},e.prototype.parseNamedImports=function(){this.expect("{");for(var e=[];!this.match("}");)e.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),e},e.prototype.parseImportDefaultSpecifier=function(){var e=this.createNode(),t=this.parseIdentifierName();return this.finalize(e,new a.ImportDefaultSpecifier(t))},e.prototype.parseImportNamespaceSpecifier=function(){var e=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(i.Messages.NoAsAfterImportNamespace),this.nextToken();var t=this.parseIdentifierName();return this.finalize(e,new a.ImportNamespaceSpecifier(t))},e.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(i.Messages.IllegalImportDeclaration);var e,t=this.createNode();this.expectKeyword("import");var r=[];if(8===this.lookahead.type)e=this.parseModuleSpecifier();else{if(this.match("{")?r=r.concat(this.parseNamedImports()):this.match("*")?r.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(r.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?r.push(this.parseImportNamespaceSpecifier()):this.match("{")?r=r.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var n=this.lookahead.value?i.Messages.UnexpectedToken:i.Messages.MissingFromClause;this.throwError(n,this.lookahead.value)}this.nextToken(),e=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(t,new a.ImportDeclaration(r,e))},e.prototype.parseExportSpecifier=function(){var e=this.createNode(),t=this.parseIdentifierName(),r=t;return this.matchContextualKeyword("as")&&(this.nextToken(),r=this.parseIdentifierName()),this.finalize(e,new a.ExportSpecifier(t,r))},e.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(i.Messages.IllegalExportDeclaration);var e,t=this.createNode();if(this.expectKeyword("export"),this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var r=this.parseFunctionDeclaration(!0);e=this.finalize(t,new a.ExportDefaultDeclaration(r))}else this.matchKeyword("class")?(r=this.parseClassDeclaration(!0),e=this.finalize(t,new a.ExportDefaultDeclaration(r))):this.matchContextualKeyword("async")?(r=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression(),e=this.finalize(t,new a.ExportDefaultDeclaration(r))):(this.matchContextualKeyword("from")&&this.throwError(i.Messages.UnexpectedToken,this.lookahead.value),r=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression(),this.consumeSemicolon(),e=this.finalize(t,new a.ExportDefaultDeclaration(r)));else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var n=this.lookahead.value?i.Messages.UnexpectedToken:i.Messages.MissingFromClause;this.throwError(n,this.lookahead.value)}this.nextToken();var o=this.parseModuleSpecifier();this.consumeSemicolon(),e=this.finalize(t,new a.ExportAllDeclaration(o))}else if(4===this.lookahead.type){switch(r=void 0,this.lookahead.value){case"let":case"const":r=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":r=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}e=this.finalize(t,new a.ExportNamedDeclaration(r,[],null))}else if(this.matchAsyncFunction())r=this.parseFunctionDeclaration(),e=this.finalize(t,new a.ExportNamedDeclaration(r,[],null));else{var s=[],c=null,u=!1;for(this.expect("{");!this.match("}");)u=u||this.matchKeyword("default"),s.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");this.expect("}"),this.matchContextualKeyword("from")?(this.nextToken(),c=this.parseModuleSpecifier(),this.consumeSemicolon()):u?(n=this.lookahead.value?i.Messages.UnexpectedToken:i.Messages.MissingFromClause,this.throwError(n,this.lookahead.value)):this.consumeSemicolon(),e=this.finalize(t,new a.ExportNamedDeclaration(null,s,c))}return e},e}();t.Parser=p},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assert=function(e,t){if(!e)throw new Error("ASSERT: "+t)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.errors=[],this.tolerant=!1}return e.prototype.recordError=function(e){this.errors.push(e)},e.prototype.tolerate=function(e){if(!this.tolerant)throw e;this.recordError(e)},e.prototype.constructError=function(e,t){var r=new Error(e);try{throw r}catch(e){Object.create&&Object.defineProperty&&(r=Object.create(e),Object.defineProperty(r,"column",{value:t}))}return r},e.prototype.createError=function(e,t,r,n){var o="Line "+t+": "+n,i=this.constructError(o,r);return i.index=e,i.lineNumber=t,i.description=n,i},e.prototype.throwError=function(e,t,r,n){throw this.createError(e,t,r,n)},e.prototype.tolerateError=function(e,t,r,n){var o=this.createError(e,t,r,n);if(!this.tolerant)throw o;this.recordError(o)},e}();t.ErrorHandler=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Messages={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(4),i=r(11);function a(e){return"0123456789abcdef".indexOf(e.toLowerCase())}function s(e){return"01234567".indexOf(e)}var c=function(){function e(e,t){this.source=e,this.errorHandler=t,this.trackComment=!1,this.isModule=!1,this.length=e.length,this.index=0,this.lineNumber=e.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return e.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},e.prototype.restoreState=function(e){this.index=e.index,this.lineNumber=e.lineNumber,this.lineStart=e.lineStart},e.prototype.eof=function(){return this.index>=this.length},e.prototype.throwUnexpectedToken=function(e){return void 0===e&&(e=i.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,e)},e.prototype.tolerateUnexpectedToken=function(e){void 0===e&&(e=i.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,e)},e.prototype.skipSingleLineComment=function(e){var t,r,n=[];for(this.trackComment&&(n=[],t=this.index-e,r={start:{line:this.lineNumber,column:this.index-this.lineStart-e},end:{}});!this.eof();){var i=this.source.charCodeAt(this.index);if(++this.index,o.Character.isLineTerminator(i)){if(this.trackComment){r.end={line:this.lineNumber,column:this.index-this.lineStart-1};var a={multiLine:!1,slice:[t+e,this.index-1],range:[t,this.index-1],loc:r};n.push(a)}return 13===i&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,n}}return this.trackComment&&(r.end={line:this.lineNumber,column:this.index-this.lineStart},a={multiLine:!1,slice:[t+e,this.index],range:[t,this.index],loc:r},n.push(a)),n},e.prototype.skipMultiLineComment=function(){var e,t,r=[];for(this.trackComment&&(r=[],e=this.index-2,t={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var n=this.source.charCodeAt(this.index);if(o.Character.isLineTerminator(n))13===n&&10===this.source.charCodeAt(this.index+1)&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(42===n){if(47===this.source.charCodeAt(this.index+1)){if(this.index+=2,this.trackComment){t.end={line:this.lineNumber,column:this.index-this.lineStart};var i={multiLine:!0,slice:[e+2,this.index-2],range:[e,this.index],loc:t};r.push(i)}return r}++this.index}else++this.index}return this.trackComment&&(t.end={line:this.lineNumber,column:this.index-this.lineStart},i={multiLine:!0,slice:[e+2,this.index],range:[e,this.index],loc:t},r.push(i)),this.tolerateUnexpectedToken(),r},e.prototype.scanComments=function(){var e;this.trackComment&&(e=[]);for(var t=0===this.index;!this.eof();){var r=this.source.charCodeAt(this.index);if(o.Character.isWhiteSpace(r))++this.index;else if(o.Character.isLineTerminator(r))++this.index,13===r&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,t=!0;else if(47===r)if(47===(r=this.source.charCodeAt(this.index+1))){this.index+=2;var n=this.skipSingleLineComment(2);this.trackComment&&(e=e.concat(n)),t=!0}else{if(42!==r)break;this.index+=2,n=this.skipMultiLineComment(),this.trackComment&&(e=e.concat(n))}else if(t&&45===r){if(45!==this.source.charCodeAt(this.index+1)||62!==this.source.charCodeAt(this.index+2))break;this.index+=3,n=this.skipSingleLineComment(3),this.trackComment&&(e=e.concat(n))}else{if(60!==r||this.isModule)break;if("!--"!==this.source.slice(this.index+1,this.index+4))break;this.index+=4,n=this.skipSingleLineComment(4),this.trackComment&&(e=e.concat(n))}}return e},e.prototype.isFutureReservedWord=function(e){switch(e){case"enum":case"export":case"import":case"super":return!0;default:return!1}},e.prototype.isStrictModeReservedWord=function(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},e.prototype.isRestrictedWord=function(e){return"eval"===e||"arguments"===e},e.prototype.isKeyword=function(e){switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}},e.prototype.codePointAt=function(e){var t=this.source.charCodeAt(e);if(t>=55296&&t<=56319){var r=this.source.charCodeAt(e+1);r>=56320&&r<=57343&&(t=1024*(t-55296)+r-56320+65536)}return t},e.prototype.scanHexEscape=function(e){for(var t="u"===e?4:2,r=0,n=0;n<t;++n){if(this.eof()||!o.Character.isHexDigit(this.source.charCodeAt(this.index)))return null;r=16*r+a(this.source[this.index++])}return String.fromCharCode(r)},e.prototype.scanUnicodeCodePointEscape=function(){var e=this.source[this.index],t=0;for("}"===e&&this.throwUnexpectedToken();!this.eof()&&(e=this.source[this.index++],o.Character.isHexDigit(e.charCodeAt(0)));)t=16*t+a(e);return(t>1114111||"}"!==e)&&this.throwUnexpectedToken(),o.Character.fromCodePoint(t)},e.prototype.getIdentifier=function(){for(var e=this.index++;!this.eof();){var t=this.source.charCodeAt(this.index);if(92===t)return this.index=e,this.getComplexIdentifier();if(t>=55296&&t<57343)return this.index=e,this.getComplexIdentifier();if(!o.Character.isIdentifierPart(t))break;++this.index}return this.source.slice(e,this.index)},e.prototype.getComplexIdentifier=function(){var e,t=this.codePointAt(this.index),r=o.Character.fromCodePoint(t);for(this.index+=r.length,92===t&&(117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,e=this.scanUnicodeCodePointEscape()):null!==(e=this.scanHexEscape("u"))&&"\\"!==e&&o.Character.isIdentifierStart(e.charCodeAt(0))||this.throwUnexpectedToken(),r=e);!this.eof()&&(t=this.codePointAt(this.index),o.Character.isIdentifierPart(t));)r+=e=o.Character.fromCodePoint(t),this.index+=e.length,92===t&&(r=r.substr(0,r.length-1),117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,e=this.scanUnicodeCodePointEscape()):null!==(e=this.scanHexEscape("u"))&&"\\"!==e&&o.Character.isIdentifierPart(e.charCodeAt(0))||this.throwUnexpectedToken(),r+=e);return r},e.prototype.octalToDecimal=function(e){var t="0"!==e,r=s(e);return!this.eof()&&o.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(t=!0,r=8*r+s(this.source[this.index++]),"0123".indexOf(e)>=0&&!this.eof()&&o.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(r=8*r+s(this.source[this.index++]))),{code:r,octal:t}},e.prototype.scanIdentifier=function(){var e,t=this.index,r=92===this.source.charCodeAt(t)?this.getComplexIdentifier():this.getIdentifier();if(3!=(e=1===r.length?3:this.isKeyword(r)?4:"null"===r?5:"true"===r||"false"===r?1:3)&&t+r.length!==this.index){var n=this.index;this.index=t,this.tolerateUnexpectedToken(i.Messages.InvalidEscapedReservedWord),this.index=n}return{type:e,value:r,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}},e.prototype.scanPunctuator=function(){var e=this.index,t=this.source[this.index];switch(t){case"(":case"{":"{"===t&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,"."===this.source[this.index]&&"."===this.source[this.index+1]&&(this.index+=2,t="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:">>>="===(t=this.source.substr(this.index,4))?this.index+=4:"==="===(t=t.substr(0,3))||"!=="===t||">>>"===t||"<<="===t||">>="===t||"**="===t?this.index+=3:"&&"===(t=t.substr(0,2))||"||"===t||"=="===t||"!="===t||"+="===t||"-="===t||"*="===t||"/="===t||"++"===t||"--"===t||"<<"===t||">>"===t||"&="===t||"|="===t||"^="===t||"%="===t||"<="===t||">="===t||"=>"===t||"**"===t?this.index+=2:(t=this.source[this.index],"<>=!+-*%&|^/".indexOf(t)>=0&&++this.index)}return this.index===e&&this.throwUnexpectedToken(),{type:7,value:t,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanHexLiteral=function(e){for(var t="";!this.eof()&&o.Character.isHexDigit(this.source.charCodeAt(this.index));)t+=this.source[this.index++];return 0===t.length&&this.throwUnexpectedToken(),o.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+t,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanBinaryLiteral=function(e){for(var t,r="";!this.eof()&&("0"===(t=this.source[this.index])||"1"===t);)r+=this.source[this.index++];return 0===r.length&&this.throwUnexpectedToken(),this.eof()||(t=this.source.charCodeAt(this.index),(o.Character.isIdentifierStart(t)||o.Character.isDecimalDigit(t))&&this.throwUnexpectedToken()),{type:6,value:parseInt(r,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanOctalLiteral=function(e,t){var r="",n=!1;for(o.Character.isOctalDigit(e.charCodeAt(0))?(n=!0,r="0"+this.source[this.index++]):++this.index;!this.eof()&&o.Character.isOctalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];return n||0!==r.length||this.throwUnexpectedToken(),(o.Character.isIdentifierStart(this.source.charCodeAt(this.index))||o.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(r,8),octal:n,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}},e.prototype.isImplicitOctalLiteral=function(){for(var e=this.index+1;e<this.length;++e){var t=this.source[e];if("8"===t||"9"===t)return!1;if(!o.Character.isOctalDigit(t.charCodeAt(0)))return!0}return!0},e.prototype.scanNumericLiteral=function(){var e=this.index,t=this.source[e];n.assert(o.Character.isDecimalDigit(t.charCodeAt(0))||"."===t,"Numeric literal must start with a decimal digit or a decimal point");var r="";if("."!==t){if(r=this.source[this.index++],t=this.source[this.index],"0"===r){if("x"===t||"X"===t)return++this.index,this.scanHexLiteral(e);if("b"===t||"B"===t)return++this.index,this.scanBinaryLiteral(e);if("o"===t||"O"===t)return this.scanOctalLiteral(t,e);if(t&&o.Character.isOctalDigit(t.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(t,e)}for(;o.Character.isDecimalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];t=this.source[this.index]}if("."===t){for(r+=this.source[this.index++];o.Character.isDecimalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];t=this.source[this.index]}if("e"===t||"E"===t)if(r+=this.source[this.index++],"+"!==(t=this.source[this.index])&&"-"!==t||(r+=this.source[this.index++]),o.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;o.Character.isDecimalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];else this.throwUnexpectedToken();return o.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(r),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanStringLiteral=function(){var e=this.index,t=this.source[e];n.assert("'"===t||'"'===t,"String literal must starts with a quote"),++this.index;for(var r=!1,a="";!this.eof();){var s=this.source[this.index++];if(s===t){t="";break}if("\\"===s)if((s=this.source[this.index++])&&o.Character.isLineTerminator(s.charCodeAt(0)))++this.lineNumber,"\r"===s&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(s){case"u":if("{"===this.source[this.index])++this.index,a+=this.scanUnicodeCodePointEscape();else{var c=this.scanHexEscape(s);null===c&&this.throwUnexpectedToken(),a+=c}break;case"x":var u=this.scanHexEscape(s);null===u&&this.throwUnexpectedToken(i.Messages.InvalidHexEscapeSequence),a+=u;break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;case"8":case"9":a+=s,this.tolerateUnexpectedToken();break;default:if(s&&o.Character.isOctalDigit(s.charCodeAt(0))){var p=this.octalToDecimal(s);r=p.octal||r,a+=String.fromCharCode(p.code)}else a+=s}else{if(o.Character.isLineTerminator(s.charCodeAt(0)))break;a+=s}}return""!==t&&(this.index=e,this.throwUnexpectedToken()),{type:8,value:a,octal:r,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanTemplate=function(){var e="",t=!1,r=this.index,n="`"===this.source[r],a=!1,s=2;for(++this.index;!this.eof();){var c=this.source[this.index++];if("`"===c){s=1,a=!0,t=!0;break}if("$"===c){if("{"===this.source[this.index]){this.curlyStack.push("${"),++this.index,t=!0;break}e+=c}else if("\\"===c)if(c=this.source[this.index++],o.Character.isLineTerminator(c.charCodeAt(0)))++this.lineNumber,"\r"===c&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(c){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"u":if("{"===this.source[this.index])++this.index,e+=this.scanUnicodeCodePointEscape();else{var u=this.index,p=this.scanHexEscape(c);null!==p?e+=p:(this.index=u,e+=c)}break;case"x":var l=this.scanHexEscape(c);null===l&&this.throwUnexpectedToken(i.Messages.InvalidHexEscapeSequence),e+=l;break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:"0"===c?(o.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(i.Messages.TemplateOctalLiteral),e+="\0"):o.Character.isOctalDigit(c.charCodeAt(0))?this.throwUnexpectedToken(i.Messages.TemplateOctalLiteral):e+=c}else o.Character.isLineTerminator(c.charCodeAt(0))?(++this.lineNumber,"\r"===c&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index,e+="\n"):e+=c}return t||this.throwUnexpectedToken(),n||this.curlyStack.pop(),{type:10,value:this.source.slice(r+1,this.index-s),cooked:e,head:n,tail:a,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}},e.prototype.testRegExp=function(e,t){var r=e,n=this;t.indexOf("u")>=0&&(r=r.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,(function(e,t,r){var o=parseInt(t||r,16);return o>1114111&&n.throwUnexpectedToken(i.Messages.InvalidRegExp),o<=65535?String.fromCharCode(o):""})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,""));try{RegExp(r)}catch(e){this.throwUnexpectedToken(i.Messages.InvalidRegExp)}try{return new RegExp(e,t)}catch(e){return null}},e.prototype.scanRegExpBody=function(){var e=this.source[this.index];n.assert("/"===e,"Regular expression literal must start with a slash");for(var t=this.source[this.index++],r=!1,a=!1;!this.eof();)if(t+=e=this.source[this.index++],"\\"===e)e=this.source[this.index++],o.Character.isLineTerminator(e.charCodeAt(0))&&this.throwUnexpectedToken(i.Messages.UnterminatedRegExp),t+=e;else if(o.Character.isLineTerminator(e.charCodeAt(0)))this.throwUnexpectedToken(i.Messages.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else{if("/"===e){a=!0;break}"["===e&&(r=!0)}return a||this.throwUnexpectedToken(i.Messages.UnterminatedRegExp),t.substr(1,t.length-2)},e.prototype.scanRegExpFlags=function(){for(var e="";!this.eof();){var t=this.source[this.index];if(!o.Character.isIdentifierPart(t.charCodeAt(0)))break;if(++this.index,"\\"!==t||this.eof())e+=t;else if("u"===(t=this.source[this.index])){++this.index;var r=this.index,n=this.scanHexEscape("u");if(null!==n)for(e+=n;r<this.index;++r)this.source[r];else this.index=r,e+="u";this.tolerateUnexpectedToken()}else this.tolerateUnexpectedToken()}return e},e.prototype.scanRegExp=function(){var e=this.index,t=this.scanRegExpBody(),r=this.scanRegExpFlags();return{type:9,value:"",pattern:t,flags:r,regex:this.testRegExp(t,r),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var e=this.source.charCodeAt(this.index);return o.Character.isIdentifierStart(e)?this.scanIdentifier():40===e||41===e||59===e?this.scanPunctuator():39===e||34===e?this.scanStringLiteral():46===e?o.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():o.Character.isDecimalDigit(e)?this.scanNumericLiteral():96===e||125===e&&"${"===this.curlyStack[this.curlyStack.length-1]?this.scanTemplate():e>=55296&&e<57343&&o.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},e}();t.Scanner=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenName={},t.TokenName[1]="Boolean",t.TokenName[2]="<end>",t.TokenName[3]="Identifier",t.TokenName[4]="Keyword",t.TokenName[5]="Null",t.TokenName[6]="Numeric",t.TokenName[7]="Punctuator",t.TokenName[8]="String",t.TokenName[9]="RegularExpression",t.TokenName[10]="Template"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",frasl:"",euro:"",image:"",weierp:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",lang:"",rang:""}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=r(12),i=r(13),a=function(){function e(){this.values=[],this.curly=this.paren=-1}return e.prototype.beforeFunctionExpression=function(e){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(e)>=0},e.prototype.isRegexStart=function(){var e=this.values[this.values.length-1],t=null!==e;switch(e){case"this":case"]":t=!1;break;case")":var r=this.values[this.paren-1];t="if"===r||"while"===r||"for"===r||"with"===r;break;case"}":if(t=!1,"function"===this.values[this.curly-3])t=!!(n=this.values[this.curly-4])&&!this.beforeFunctionExpression(n);else if("function"===this.values[this.curly-4]){var n;t=!(n=this.values[this.curly-5])||!this.beforeFunctionExpression(n)}}return t},e.prototype.push=function(e){7===e.type||4===e.type?("{"===e.value?this.curly=this.values.length:"("===e.value&&(this.paren=this.values.length),this.values.push(e.value)):this.values.push(null)},e}(),s=function(){function e(e,t){this.errorHandler=new n.ErrorHandler,this.errorHandler.tolerant=!!t&&"boolean"==typeof t.tolerant&&t.tolerant,this.scanner=new o.Scanner(e,this.errorHandler),this.scanner.trackComment=!!t&&"boolean"==typeof t.comment&&t.comment,this.trackRange=!!t&&"boolean"==typeof t.range&&t.range,this.trackLoc=!!t&&"boolean"==typeof t.loc&&t.loc,this.buffer=[],this.reader=new a}return e.prototype.errors=function(){return this.errorHandler.errors},e.prototype.getNextToken=function(){if(0===this.buffer.length){var e=this.scanner.scanComments();if(this.scanner.trackComment)for(var t=0;t<e.length;++t){var r=e[t],n=this.scanner.source.slice(r.slice[0],r.slice[1]),o={type:r.multiLine?"BlockComment":"LineComment",value:n};this.trackRange&&(o.range=r.range),this.trackLoc&&(o.loc=r.loc),this.buffer.push(o)}if(!this.scanner.eof()){var a=void 0;this.trackLoc&&(a={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var s="/"===this.scanner.source[this.scanner.index]&&this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.lex();this.reader.push(s);var c={type:i.TokenName[s.type],value:this.scanner.source.slice(s.start,s.end)};if(this.trackRange&&(c.range=[s.start,s.end]),this.trackLoc&&(a.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},c.loc=a),9===s.type){var u=s.pattern,p=s.flags;c.regex={pattern:u,flags:p}}this.buffer.push(c)}}return this.buffer.shift()},e}();t.Tokenizer=s}])},e.exports=n()},function(e,t,r){"use strict";var n=r(52),o=r(59),i=r(68),a=r(60),s=Object.prototype.toString,c=Object.prototype.hasOwnProperty,u={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},p=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function l(e){var t,r,i;if(t=e.toString(16).toUpperCase(),e<=255)r="x",i=2;else if(e<=65535)r="u",i=4;else{if(!(e<=4294967295))throw new o("code point within a string may not be greater than 0xFFFFFFFF");r="U",i=8}return"\\"+r+n.repeat("0",i-t.length)+t}function d(e){this.schema=e.schema||i,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=n.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var r,n,o,i,a,s,u;if(null===t)return{};for(r={},o=0,i=(n=Object.keys(t)).length;o<i;o+=1)a=n[o],s=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(u=e.compiledTypeMap.fallback[a])&&c.call(u.styleAliases,s)&&(s=u.styleAliases[s]),r[a]=s;return r}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function h(e,t){for(var r,o=n.repeat(" ",t),i=0,a=-1,s="",c=e.length;i<c;)-1===(a=e.indexOf("\n",i))?(r=e.slice(i),i=c):(r=e.slice(i,a+1),i=a+1),r.length&&"\n"!==r&&(s+=o),s+=r;return s}function f(e,t){return"\n"+n.repeat(" ",e.indent*t)}function m(e){return 32===e||9===e}function g(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&65279!==e||65536<=e&&e<=1114111}function y(e,t){return g(e)&&65279!==e&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e&&58!==e&&(35!==e||t&&function(e){return g(e)&&!m(e)&&65279!==e&&13!==e&&10!==e}(t))}function v(e){return/^\n* /.test(e)}function b(e,t,r,n,o){var i,a,s,c,u=!1,p=!1,l=-1!==n,d=-1,h=g(c=e.charCodeAt(0))&&65279!==c&&!m(c)&&45!==c&&63!==c&&58!==c&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c&&35!==c&&38!==c&&42!==c&&33!==c&&124!==c&&61!==c&&62!==c&&39!==c&&34!==c&&37!==c&&64!==c&&96!==c&&!m(e.charCodeAt(e.length-1));if(t)for(i=0;i<e.length;i++){if(!g(a=e.charCodeAt(i)))return 5;s=i>0?e.charCodeAt(i-1):null,h=h&&y(a,s)}else{for(i=0;i<e.length;i++){if(10===(a=e.charCodeAt(i)))u=!0,l&&(p=p||i-d-1>n&&" "!==e[d+1],d=i);else if(!g(a))return 5;s=i>0?e.charCodeAt(i-1):null,h=h&&y(a,s)}p=p||l&&i-d-1>n&&" "!==e[d+1]}return u||p?r>9&&v(e)?5:p?4:3:h&&!o(e)?1:2}function w(e,t,r,n){e.dump=function(){if(0===t.length)return"''";if(!e.noCompatMode&&-1!==p.indexOf(t))return"'"+t+"'";var i=e.indent*Math.max(1,r),a=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),s=n||e.flowLevel>-1&&r>=e.flowLevel;switch(b(t,s,e.indent,a,(function(t){return function(e,t){var r,n;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(e.implicitTypes[r].resolve(t))return!0;return!1}(e,t)}))){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+x(t,e.indent)+E(h(t,i));case 4:return">"+x(t,e.indent)+E(h(function(e,t){var r,n,o=/(\n+)([^\n]*)/g,i=(s=e.indexOf("\n"),s=-1!==s?s:e.length,o.lastIndex=s,k(e.slice(0,s),t)),a="\n"===e[0]||" "===e[0];var s;for(;n=o.exec(e);){var c=n[1],u=n[2];r=" "===u[0],i+=c+(a||r||""===u?"":"\n")+k(u,t),a=r}return i}(t,a),i));case 5:return'"'+function(e){for(var t,r,n,o="",i=0;i<e.length;i++)(t=e.charCodeAt(i))>=55296&&t<=56319&&(r=e.charCodeAt(i+1))>=56320&&r<=57343?(o+=l(1024*(t-55296)+r-56320+65536),i++):(n=u[t],o+=!n&&g(t)?e[i]:n||l(t));return o}(t)+'"';default:throw new o("impossible error: invalid scalar style")}}()}function x(e,t){var r=v(e)?String(t):"",n="\n"===e[e.length-1];return r+(n&&("\n"===e[e.length-2]||"\n"===e)?"+":n?"":"-")+"\n"}function E(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function k(e,t){if(""===e||" "===e[0])return e;for(var r,n,o=/ [^ ]/g,i=0,a=0,s=0,c="";r=o.exec(e);)(s=r.index)-i>t&&(n=a>i?a:s,c+="\n"+e.slice(i,n),i=n+1),a=s;return c+="\n",e.length-i>t&&a>i?c+=e.slice(i,a)+"\n"+e.slice(a+1):c+=e.slice(i),c.slice(1)}function _(e,t,r){var n,i,a,u,p,l;for(a=0,u=(i=r?e.explicitTypes:e.implicitTypes).length;a<u;a+=1)if(((p=i[a]).instanceOf||p.predicate)&&(!p.instanceOf||"object"==typeof t&&t instanceof p.instanceOf)&&(!p.predicate||p.predicate(t))){if(e.tag=r?p.tag:"?",p.represent){if(l=e.styleMap[p.tag]||p.defaultStyle,"[object Function]"===s.call(p.represent))n=p.represent(t,l);else{if(!c.call(p.represent,l))throw new o("!<"+p.tag+'> tag resolver accepts not "'+l+'" style');n=p.represent[l](t,l)}e.dump=n}return!0}return!1}function S(e,t,r,n,i,a){e.tag=null,e.dump=r,_(e,r,!1)||_(e,r,!0);var c=s.call(e.dump);n&&(n=e.flowLevel<0||e.flowLevel>t);var u,p,l="[object Object]"===c||"[object Array]"===c;if(l&&(p=-1!==(u=e.duplicates.indexOf(r))),(null!==e.tag&&"?"!==e.tag||p||2!==e.indent&&t>0)&&(i=!1),p&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(l&&p&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),"[object Object]"===c)n&&0!==Object.keys(e.dump).length?(!function(e,t,r,n){var i,a,s,c,u,p,l="",d=e.tag,h=Object.keys(r);if(!0===e.sortKeys)h.sort();else if("function"==typeof e.sortKeys)h.sort(e.sortKeys);else if(e.sortKeys)throw new o("sortKeys must be a boolean or a function");for(i=0,a=h.length;i<a;i+=1)p="",n&&0===i||(p+=f(e,t)),c=r[s=h[i]],S(e,t+1,s,!0,!0,!0)&&((u=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,u&&(p+=f(e,t)),S(e,t+1,c,!0,u)&&(e.dump&&10===e.dump.charCodeAt(0)?p+=":":p+=": ",l+=p+=e.dump));e.tag=d,e.dump=l||"{}"}(e,t,e.dump,i),p&&(e.dump="&ref_"+u+e.dump)):(!function(e,t,r){var n,o,i,a,s,c="",u=e.tag,p=Object.keys(r);for(n=0,o=p.length;n<o;n+=1)s="",0!==n&&(s+=", "),e.condenseFlow&&(s+='"'),a=r[i=p[n]],S(e,t,i,!1,!1)&&(e.dump.length>1024&&(s+="? "),s+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),S(e,t,a,!1,!1)&&(c+=s+=e.dump));e.tag=u,e.dump="{"+c+"}"}(e,t,e.dump),p&&(e.dump="&ref_"+u+" "+e.dump));else if("[object Array]"===c){var d=e.noArrayIndent&&t>0?t-1:t;n&&0!==e.dump.length?(!function(e,t,r,n){var o,i,a="",s=e.tag;for(o=0,i=r.length;o<i;o+=1)S(e,t+1,r[o],!0,!0)&&(n&&0===o||(a+=f(e,t)),e.dump&&10===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=s,e.dump=a||"[]"}(e,d,e.dump,i),p&&(e.dump="&ref_"+u+e.dump)):(!function(e,t,r){var n,o,i="",a=e.tag;for(n=0,o=r.length;n<o;n+=1)S(e,t,r[n],!1,!1)&&(0!==n&&(i+=","+(e.condenseFlow?"":" ")),i+=e.dump);e.tag=a,e.dump="["+i+"]"}(e,d,e.dump),p&&(e.dump="&ref_"+u+" "+e.dump))}else{if("[object String]"!==c){if(e.skipInvalid)return!1;throw new o("unacceptable kind of an object to dump "+c)}"?"!==e.tag&&w(e,e.dump,t,a)}null!==e.tag&&"?"!==e.tag&&(e.dump="!<"+e.tag+"> "+e.dump)}return!0}function C(e,t){var r,n,o=[],i=[];for(function e(t,r,n){var o,i,a;if(null!==t&&"object"==typeof t)if(-1!==(i=r.indexOf(t)))-1===n.indexOf(i)&&n.push(i);else if(r.push(t),Array.isArray(t))for(i=0,a=t.length;i<a;i+=1)e(t[i],r,n);else for(o=Object.keys(t),i=0,a=o.length;i<a;i+=1)e(t[o[i]],r,n)}(e,o,i),r=0,n=i.length;r<n;r+=1)t.duplicates.push(o[i[r]]);t.usedDuplicates=new Array(n)}function P(e,t){var r=new d(t=t||{});return r.noRefs||C(e,r),S(r,0,e,!0,!0)?r.dump+"\n":""}e.exports.dump=P,e.exports.safeDump=function(e,t){return P(e,n.extend({schema:a},t))}},function(e,t,r){e.exports=r(42)},function(e,t,r){
/*!
 * chai
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Dependencies that are used for multiple exports are required here only once
 */
var n=r(362);
/*!
 * test utility
 */t.test=r(363),
/*!
 * type utility
 */
t.type=r(95),
/*!
 * expectTypes utility
 */
t.expectTypes=r(364),
/*!
 * message utility
 */
t.getMessage=r(365),
/*!
 * actual utility
 */
t.getActual=r(151),
/*!
 * Inspect util
 */
t.inspect=r(96),
/*!
 * Object Display util
 */
t.objDisplay=r(152),
/*!
 * Flag utility
 */
t.flag=r(31),
/*!
 * Flag transferring utility
 */
t.transferFlags=r(43),
/*!
 * Deep equal utility
 */
t.eql=r(367),
/*!
 * Deep path info
 */
t.getPathInfo=n.getPathInfo,
/*!
 * Check if a property exists
 */
t.hasProperty=n.hasProperty,
/*!
 * Function name
 */
t.getName=r(153),
/*!
 * add Property
 */
t.addProperty=r(368),
/*!
 * add Method
 */
t.addMethod=r(369),
/*!
 * overwrite Property
 */
t.overwriteProperty=r(370),
/*!
 * overwrite Method
 */
t.overwriteMethod=r(371),
/*!
 * Add a chainable method
 */
t.addChainableMethod=r(372),
/*!
 * Overwrite chainable method
 */
t.overwriteChainableMethod=r(373),
/*!
 * Compare by inspect method
 */
t.compareByInspect=r(374),
/*!
 * Get own enumerable property symbols method
 */
t.getOwnEnumerablePropertySymbols=r(155),
/*!
 * Get own enumerable properties method
 */
t.getOwnEnumerableProperties=r(375),
/*!
 * Checks error against a given set of criteria
 */
t.checkError=r(376),
/*!
 * Proxify util
 */
t.proxify=r(71),
/*!
 * addLengthGuard util
 */
t.addLengthGuard=r(70),
/*!
 * isProxyEnabled helper
 */
t.isProxyEnabled=r(69),
/*!
 * isNaN method
 */
t.isNaN=r(377)},function(e,t,r){"use strict";function n(e,t){return null!=e&&t in Object(e)}function o(e){return e.replace(/([^\\])\[/g,"$1.[").match(/(\\\.|[^.]+?)+/g).map((function(e){if("constructor"===e||"__proto__"===e||"prototype"===e)return{};var t=/^\[(\d+)\]$/.exec(e);return t?{i:parseFloat(t[1])}:{p:e.replace(/\\([.[\]])/g,"$1")}}))}function i(e,t,r){var n=e,o=null;r=void 0===r?t.length:r;for(var i=0;i<r;i++){var a=t[i];n&&(n=void 0===a.p?n[a.i]:n[a.p],i===r-1&&(o=n))}return o}function a(e,t){var r=o(t),a=r[r.length-1],s={parent:r.length>1?i(e,r,r.length-1):e,name:a.p||a.i,value:i(e,r)};return s.exists=n(s.parent,s.name),s}e.exports={hasProperty:n,getPathInfo:a,getPathValue:function(e,t){return a(e,t).value},setPathValue:function(e,t,r){return function(e,t,r){for(var n=e,o=r.length,i=null,a=0;a<o;a++){var s=null,c=null;if(i=r[a],a===o-1)n[s=void 0===i.p?i.i:i.p]=t;else if(void 0!==i.p&&n[i.p])n=n[i.p];else if(void 0!==i.i&&n[i.i])n=n[i.i];else{var u=r[a+1];s=void 0===i.p?i.i:i.p,c=void 0===u.p?[]:{},n[s]=c,n=n[s]}}}(e,r,o(t)),e}}},function(e,t,r){
/*!
 * Chai - test utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var n=r(31);e.exports=function(e,t){var r=n(e,"negate"),o=t[0];return r?!o:o}},function(e,t,r){
/*!
 * Chai - expectTypes utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(150),o=r(31),i=r(95);e.exports=function(e,t){var r=o(e,"message"),a=o(e,"ssfi");r=r?r+": ":"",e=o(e,"object"),(t=t.map((function(e){return e.toLowerCase()}))).sort();var s=t.map((function(e,r){var n=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an":"a";return(t.length>1&&r===t.length-1?"or ":"")+n+" "+e})).join(", "),c=i(e).toLowerCase();if(!t.some((function(e){return c===e})))throw new n(r+"object tested must be "+s+", but "+c+" given",void 0,a)}},function(e,t,r){
/*!
 * Chai - message composition utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var n=r(31),o=r(151),i=r(152);e.exports=function(e,t){var r=n(e,"negate"),a=n(e,"object"),s=t[3],c=o(e,t),u=r?t[2]:t[1],p=n(e,"message");return"function"==typeof u&&(u=u()),u=(u=u||"").replace(/#\{this\}/g,(function(){return i(a)})).replace(/#\{act\}/g,(function(){return i(c)})).replace(/#\{exp\}/g,(function(){return i(s)})),p?p+": "+u:u}},function(e,t){
/*!
 * Chai - getEnumerableProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=[];for(var r in e)t.push(r);return t}},function(e,t,r){"use strict";
/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */var n=r(95);function o(){this._key="chai/deep-eql__"+Math.random()+Date.now()}o.prototype={get:function(e){return e[this._key]},set:function(e,t){Object.isExtensible(e)&&Object.defineProperty(e,this._key,{value:t,configurable:!0})}};var i="function"==typeof WeakMap?WeakMap:o;
/*!
 * Check to see if the MemoizeMap has recorded a result of the two operands
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @returns {Boolean|null} result
*/function a(e,t,r){if(!r||g(e)||g(t))return null;var n=r.get(e);if(n){var o=n.get(t);if("boolean"==typeof o)return o}return null}
/*!
 * Set the result of the equality into the MemoizeMap
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @param {Boolean} result
*/function s(e,t,r,n){if(r&&!g(e)&&!g(t)){var o=r.get(e);o?o.set(t,n):((o=new i).set(t,n),r.set(e,o))}}
/*!
 * Primary Export
 */function c(e,t,r){if(r&&r.comparator)return p(e,t,r);var n=u(e,t);return null!==n?n:p(e,t,r)}function u(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t||!g(e)&&!g(t)&&null}
/*!
 * The main logic of the `deepEqual` function.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (optional) Additional options
 * @param {Array} [options.comparator] (optional) Override default algorithm, determining custom equality.
 * @param {Array} [options.memoize] (optional) Provide a custom memoization object which will cache the results of
    complex objects for a speed boost. By passing `false` you can disable memoization, but this will cause circular
    references to blow the stack.
 * @return {Boolean} equal match
*/function p(e,t,r){(r=r||{}).memoize=!1!==r.memoize&&(r.memoize||new i);var o=r&&r.comparator,p=a(e,t,r.memoize);if(null!==p)return p;var g=a(t,e,r.memoize);if(null!==g)return g;if(o){var y=o(e,t);if(!1===y||!0===y)return s(e,t,r.memoize,y),y;var v=u(e,t);if(null!==v)return v}var b=n(e);if(b!==n(t))return s(e,t,r.memoize,!1),!1;s(e,t,r.memoize,!0);var w=function(e,t,r,n){switch(r){case"String":case"Number":case"Boolean":case"Date":return c(e.valueOf(),t.valueOf());case"Promise":case"Symbol":case"function":case"WeakMap":case"WeakSet":case"Error":return e===t;case"Arguments":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"Array":return d(e,t,n);case"RegExp":
/*!
 * Compare two Regular Expressions for equality.
 *
 * @param {RegExp} leftHandOperand
 * @param {RegExp} rightHandOperand
 * @return {Boolean} result
 */
return function(e,t){return e.toString()===t.toString()}
/*!
 * Compare two Sets/Maps for equality. Faster than other equality functions.
 *
 * @param {Set} leftHandOperand
 * @param {Set} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */(e,t);case"Generator":
/*!
 * Simple equality for generator objects such as those returned by generator functions.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
return function(e,t,r){return d(f(e),f(t),r)}
/*!
 * Determine if the given object has an @@iterator function.
 *
 * @param {Object} target
 * @return {Boolean} `true` if the object has an @@iterator function.
 */(e,t,n);case"DataView":return d(new Uint8Array(e.buffer),new Uint8Array(t.buffer),n);case"ArrayBuffer":return d(new Uint8Array(e),new Uint8Array(t),n);case"Set":case"Map":return l(e,t,n);default:
/*!
 * Recursively check the equality of two Objects. Once basic sameness has been established it will defer to `deepEqual`
 * for each enumerable key in the object.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
return function(e,t,r){var n=m(e),o=m(t);if(n.length&&n.length===o.length)return n.sort(),o.sort(),!1!==d(n,o)&&
/*!
 * Determines if two objects have matching values, given a set of keys. Defers to deepEqual for the equality check of
 * each key. If any value of the given key is not equal, the function will return false (early).
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Array} keys An array of keys to compare the values of leftHandOperand and rightHandOperand against
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
function(e,t,r,n){var o=r.length;if(0===o)return!0;for(var i=0;i<o;i+=1)if(!1===c(e[r[i]],t[r[i]],n))return!1;return!0}(e,t,n,r);var i=h(e),a=h(t);if(i.length&&i.length===a.length)return i.sort(),a.sort(),d(i,a,r);if(0===n.length&&0===i.length&&0===o.length&&0===a.length)return!0;return!1}
/*!
 * Returns true if the argument is a primitive.
 *
 * This intentionally returns true for all objects that can be compared by reference,
 * including functions and symbols.
 *
 * @param {Mixed} value
 * @return {Boolean} result
 */(e,t,n)}}(e,t,b,r);return s(e,t,r.memoize,w),w}function l(e,t,r){if(e.size!==t.size)return!1;if(0===e.size)return!0;var n=[],o=[];return e.forEach((function(e,t){n.push([e,t])})),t.forEach((function(e,t){o.push([e,t])})),d(n.sort(),o.sort(),r)}
/*!
 * Simple equality for flat iterable objects such as Arrays, TypedArrays or Node.js buffers.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function d(e,t,r){var n=e.length;if(n!==t.length)return!1;if(0===n)return!0;for(var o=-1;++o<n;)if(!1===c(e[o],t[o],r))return!1;return!0}
/*!
 * Gets all iterator entries from the given Object. If the Object has no @@iterator function, returns an empty array.
 * This will consume the iterator - which could have side effects depending on the @@iterator implementation.
 *
 * @param {Object} target
 * @returns {Array} an array of entries from the @@iterator function
 */
function h(e){if(function(e){return"undefined"!=typeof Symbol&&"object"==typeof e&&void 0!==Symbol.iterator&&"function"==typeof e[Symbol.iterator]}(e))try{return f(e[Symbol.iterator]())}catch(e){return[]}return[]}
/*!
 * Gets all entries from a Generator. This will consume the generator - which could have side effects.
 *
 * @param {Generator} target
 * @returns {Array} an array of entries from the Generator.
 */function f(e){for(var t=e.next(),r=[t.value];!1===t.done;)t=e.next(),r.push(t.value);return r}
/*!
 * Gets all own and inherited enumerable keys from a target.
 *
 * @param {Object} target
 * @returns {Array} an array of own and inherited enumerable keys from the target.
 */function m(e){var t=[];for(var r in e)t.push(r);return t}function g(e){return null===e||"object"!=typeof e}e.exports=c,e.exports.MemoizeMap=i},function(e,t,r){
/*!
 * Chai - addProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(42),o=r(31),i=r(69),a=r(43);e.exports=function(e,t,r){r=void 0===r?function(){}:r,Object.defineProperty(e,t,{get:function e(){i()||o(this,"lockSsfi")||o(this,"ssfi",e);var t=r.call(this);if(void 0!==t)return t;var s=new n.Assertion;return a(this,s),s},configurable:!0})}},function(e,t,r){
/*!
 * Chai - addMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(70),o=r(42),i=r(31),a=r(71),s=r(43);e.exports=function(e,t,r){var c=function(){i(this,"lockSsfi")||i(this,"ssfi",c);var e=r.apply(this,arguments);if(void 0!==e)return e;var t=new o.Assertion;return s(this,t),t};n(c,t,!1),e[t]=a(c,t)}},function(e,t,r){
/*!
 * Chai - overwriteProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(42),o=r(31),i=r(69),a=r(43);e.exports=function(e,t,r){var s=Object.getOwnPropertyDescriptor(e,t),c=function(){};s&&"function"==typeof s.get&&(c=s.get),Object.defineProperty(e,t,{get:function e(){i()||o(this,"lockSsfi")||o(this,"ssfi",e);var t=o(this,"lockSsfi");o(this,"lockSsfi",!0);var s=r(c).call(this);if(o(this,"lockSsfi",t),void 0!==s)return s;var u=new n.Assertion;return a(this,u),u},configurable:!0})}},function(e,t,r){
/*!
 * Chai - overwriteMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(70),o=r(42),i=r(31),a=r(71),s=r(43);e.exports=function(e,t,r){var c=e[t],u=function(){throw new Error(t+" is not a function")};c&&"function"==typeof c&&(u=c);var p=function(){i(this,"lockSsfi")||i(this,"ssfi",p);var e=i(this,"lockSsfi");i(this,"lockSsfi",!0);var t=r(u).apply(this,arguments);if(i(this,"lockSsfi",e),void 0!==t)return t;var n=new o.Assertion;return s(this,n),n};n(p,t,!1),e[t]=a(p,t)}},function(e,t,r){
/*!
 * Chai - addChainingMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var n=r(70),o=r(42),i=r(31),a=r(71),s=r(43),c="function"==typeof Object.setPrototypeOf,u=function(){},p=Object.getOwnPropertyNames(u).filter((function(e){var t=Object.getOwnPropertyDescriptor(u,e);return"object"!=typeof t||!t.configurable})),l=Function.prototype.call,d=Function.prototype.apply;e.exports=function(e,t,r,u){"function"!=typeof u&&(u=function(){});var h={method:r,chainingBehavior:u};e.__methods||(e.__methods={}),e.__methods[t]=h,Object.defineProperty(e,t,{get:function(){h.chainingBehavior.call(this);var r=function(){i(this,"lockSsfi")||i(this,"ssfi",r);var e=h.method.apply(this,arguments);if(void 0!==e)return e;var t=new o.Assertion;return s(this,t),t};if(n(r,t,!0),c){var u=Object.create(this);u.call=l,u.apply=d,Object.setPrototypeOf(r,u)}else{Object.getOwnPropertyNames(e).forEach((function(t){if(-1===p.indexOf(t)){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n)}}))}return s(this,r),a(r)},configurable:!0})}},function(e,t,r){
/*!
 * Chai - overwriteChainableMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(42),o=r(43);e.exports=function(e,t,r,i){var a=e.__methods[t],s=a.chainingBehavior;a.chainingBehavior=function(){var e=i(s).call(this);if(void 0!==e)return e;var t=new n.Assertion;return o(this,t),t};var c=a.method;a.method=function(){var e=r(c).apply(this,arguments);if(void 0!==e)return e;var t=new n.Assertion;return o(this,t),t}}},function(e,t,r){
/*!
 * Chai - compareByInspect utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var n=r(96);e.exports=function(e,t){return n(e)<n(t)?-1:1}},function(e,t,r){
/*!
 * Chai - getOwnEnumerableProperties utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var n=r(155);e.exports=function(e){return Object.keys(e).concat(n(e))}},function(e,t,r){"use strict";var n=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\(\/]+)/;function o(e){var t="";if(void 0===e.name){var r=String(e).match(n);r&&(t=r[1])}else t=e.name;return t}e.exports={compatibleInstance:function(e,t){return t instanceof Error&&e===t},compatibleConstructor:function(e,t){return t instanceof Error?e.constructor===t.constructor||e instanceof t.constructor:(t.prototype instanceof Error||t===Error)&&(e.constructor===t||e instanceof t)},compatibleMessage:function(e,t){var r="string"==typeof e?e:e.message;return t instanceof RegExp?t.test(r):"string"==typeof t&&-1!==r.indexOf(t)},getMessage:function(e){var t="";return e&&e.message?t=e.message:"string"==typeof e&&(t=e),t},getConstructorName:function(e){var t=e;return e instanceof Error?t=o(e.constructor):"function"==typeof e&&(t=o(e).trim()||o(new e)),t}}},function(e,t){e.exports=Number.isNaN||
/*!
 * Chai - isNaN utility
 * Copyright(c) 2012-2015 Sakthipriyan Vairamani <thechargingvolcano@gmail.com>
 * MIT Licensed
 */
function(e){return e!=e}},function(e,t,r){
/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var n=r(54);e.exports=function(e,t){
/*!
   * Module dependencies.
   */
var r=e.AssertionError,o=t.flag;
/*!
   * Module export.
   */
/*!
   * Assertion Constructor
   *
   * Creates object for chaining.
   *
   * `Assertion` objects contain metadata in the form of flags. Three flags can
   * be assigned during instantiation by passing arguments to this constructor:
   *
   * - `object`: This flag contains the target of the assertion. For example, in
   *   the assertion `expect(numKittens).to.equal(7);`, the `object` flag will
   *   contain `numKittens` so that the `equal` assertion can reference it when
   *   needed.
   *
   * - `message`: This flag contains an optional custom error message to be
   *   prepended to the error message that's generated by the assertion when it
   *   fails.
   *
   * - `ssfi`: This flag stands for "start stack function indicator". It
   *   contains a function reference that serves as the starting point for
   *   removing frames from the stack trace of the error that's created by the
   *   assertion when it fails. The goal is to provide a cleaner stack trace to
   *   end users by removing Chai's internal functions. Note that it only works
   *   in environments that support `Error.captureStackTrace`, and only when
   *   `Chai.config.includeStack` hasn't been set to `false`.
   *
   * - `lockSsfi`: This flag controls whether or not the given `ssfi` flag
   *   should retain its current value, even as assertions are chained off of
   *   this object. This is usually set to `true` when creating a new assertion
   *   from within another assertion. It's also temporarily set to `true` before
   *   an overwritten assertion gets called by the overwriting assertion.
   *
   * @param {Mixed} obj target of the assertion
   * @param {String} msg (optional) custom error message
   * @param {Function} ssfi (optional) starting point for removing stack frames
   * @param {Boolean} lockSsfi (optional) whether or not the ssfi flag is locked
   * @api private
   */
function i(e,r,n,a){return o(this,"ssfi",n||i),o(this,"lockSsfi",a),o(this,"object",e),o(this,"message",r),t.proxify(this)}e.Assertion=i,Object.defineProperty(i,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),n.includeStack},set:function(e){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),n.includeStack=e}}),Object.defineProperty(i,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),n.showDiff},set:function(e){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),n.showDiff=e}}),i.addProperty=function(e,r){t.addProperty(this.prototype,e,r)},i.addMethod=function(e,r){t.addMethod(this.prototype,e,r)},i.addChainableMethod=function(e,r,n){t.addChainableMethod(this.prototype,e,r,n)},i.overwriteProperty=function(e,r){t.overwriteProperty(this.prototype,e,r)},i.overwriteMethod=function(e,r){t.overwriteMethod(this.prototype,e,r)},i.overwriteChainableMethod=function(e,r,n){t.overwriteChainableMethod(this.prototype,e,r,n)},i.prototype.assert=function(e,i,a,s,c,u){var p=t.test(this,arguments);if(!1!==u&&(u=!0),void 0===s&&void 0===c&&(u=!1),!0!==n.showDiff&&(u=!1),!p){i=t.getMessage(this,arguments);var l=t.getActual(this,arguments);throw new r(i,{actual:l,expected:s,showDiff:u},n.includeStack?this.assert:o(this,"ssfi"))}},
/*!
   * ### ._obj
   *
   * Quick reference to stored `actual` value for plugin developers.
   *
   * @api private
   */
Object.defineProperty(i.prototype,"_obj",{get:function(){return o(this,"object")},set:function(e){o(this,"object",e)}})}},function(e,t){
/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){var r=e.Assertion,n=e.AssertionError,o=t.flag;function i(e,r){r&&o(this,"message",r),e=e.toLowerCase();var n=o(this,"object"),i=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an ":"a ";this.assert(e===t.type(n).toLowerCase(),"expected #{this} to be "+i+e,"expected #{this} not to be "+i+e)}function a(e,r){return t.isNaN(e)&&t.isNaN(r)||e===r}function s(){o(this,"contains",!0)}function c(e,i){i&&o(this,"message",i);var s=o(this,"object"),c=t.type(s).toLowerCase(),u=o(this,"message"),p=o(this,"negate"),l=o(this,"ssfi"),d=o(this,"deep"),h=d?"deep ":"";u=u?u+": ":"";var f=!1;switch(c){case"string":f=-1!==s.indexOf(e);break;case"weakset":if(d)throw new n(u+"unable to use .deep.include with WeakSet",void 0,l);f=s.has(e);break;case"map":var m=d?t.eql:a;s.forEach((function(t){f=f||m(t,e)}));break;case"set":d?s.forEach((function(r){f=f||t.eql(r,e)})):f=s.has(e);break;case"array":f=d?s.some((function(r){return t.eql(r,e)})):-1!==s.indexOf(e);break;default:if(e!==Object(e))throw new n(u+"object tested must be an array, a map, an object, a set, a string, or a weakset, but "+c+" given",void 0,l);var g=Object.keys(e),y=null,v=0;if(g.forEach((function(i){var a=new r(s);if(t.transferFlags(this,a,!0),o(a,"lockSsfi",!0),p&&1!==g.length)try{a.property(i,e[i])}catch(e){if(!t.checkError.compatibleConstructor(e,n))throw e;null===y&&(y=e),v++}else a.property(i,e[i])}),this),p&&g.length>1&&v===g.length)throw y;return}this.assert(f,"expected #{this} to "+h+"include "+t.inspect(e),"expected #{this} to not "+h+"include "+t.inspect(e))}function u(){var e=o(this,"object"),r=t.type(e);this.assert("Arguments"===r,"expected #{this} to be arguments but got "+r,"expected #{this} to not be arguments")}function p(e,t){t&&o(this,"message",t);var r=o(this,"object");if(o(this,"deep")){var n=o(this,"lockSsfi");o(this,"lockSsfi",!0),this.eql(e),o(this,"lockSsfi",n)}else this.assert(e===r,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",e,this._obj,!0)}function l(e,r){r&&o(this,"message",r),this.assert(t.eql(e,o(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",e,this._obj,!0)}function d(e,i){i&&o(this,"message",i);var a,s=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),p=u?u+": ":"",l=o(this,"ssfi"),d=t.type(s).toLowerCase(),h=t.type(e).toLowerCase(),f=!0;if(c&&"map"!==d&&"set"!==d&&new r(s,u,l,!0).to.have.property("length"),c||"date"!==d||"date"===h)if("number"===h||!c&&"number"!==d)if(c||"date"===d||"number"===d)f=!1;else{a=p+"expected "+("string"===d?"'"+s+"'":s)+" to be a number or a date"}else a=p+"the argument to above must be a number";else a=p+"the argument to above must be a date";if(f)throw new n(a,void 0,l);if(c){var m,g="length";"map"===d||"set"===d?(g="size",m=s.size):m=s.length,this.assert(m>e,"expected #{this} to have a "+g+" above #{exp} but got #{act}","expected #{this} to not have a "+g+" above #{exp}",e,m)}else this.assert(s>e,"expected #{this} to be above #{exp}","expected #{this} to be at most #{exp}",e)}function h(e,i){i&&o(this,"message",i);var a,s=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),p=u?u+": ":"",l=o(this,"ssfi"),d=t.type(s).toLowerCase(),h=t.type(e).toLowerCase(),f=!0;if(c&&"map"!==d&&"set"!==d&&new r(s,u,l,!0).to.have.property("length"),c||"date"!==d||"date"===h)if("number"===h||!c&&"number"!==d)if(c||"date"===d||"number"===d)f=!1;else{a=p+"expected "+("string"===d?"'"+s+"'":s)+" to be a number or a date"}else a=p+"the argument to least must be a number";else a=p+"the argument to least must be a date";if(f)throw new n(a,void 0,l);if(c){var m,g="length";"map"===d||"set"===d?(g="size",m=s.size):m=s.length,this.assert(m>=e,"expected #{this} to have a "+g+" at least #{exp} but got #{act}","expected #{this} to have a "+g+" below #{exp}",e,m)}else this.assert(s>=e,"expected #{this} to be at least #{exp}","expected #{this} to be below #{exp}",e)}function f(e,i){i&&o(this,"message",i);var a,s=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),p=u?u+": ":"",l=o(this,"ssfi"),d=t.type(s).toLowerCase(),h=t.type(e).toLowerCase(),f=!0;if(c&&"map"!==d&&"set"!==d&&new r(s,u,l,!0).to.have.property("length"),c||"date"!==d||"date"===h)if("number"===h||!c&&"number"!==d)if(c||"date"===d||"number"===d)f=!1;else{a=p+"expected "+("string"===d?"'"+s+"'":s)+" to be a number or a date"}else a=p+"the argument to below must be a number";else a=p+"the argument to below must be a date";if(f)throw new n(a,void 0,l);if(c){var m,g="length";"map"===d||"set"===d?(g="size",m=s.size):m=s.length,this.assert(m<e,"expected #{this} to have a "+g+" below #{exp} but got #{act}","expected #{this} to not have a "+g+" below #{exp}",e,m)}else this.assert(s<e,"expected #{this} to be below #{exp}","expected #{this} to be at least #{exp}",e)}function m(e,i){i&&o(this,"message",i);var a,s=o(this,"object"),c=o(this,"doLength"),u=o(this,"message"),p=u?u+": ":"",l=o(this,"ssfi"),d=t.type(s).toLowerCase(),h=t.type(e).toLowerCase(),f=!0;if(c&&"map"!==d&&"set"!==d&&new r(s,u,l,!0).to.have.property("length"),c||"date"!==d||"date"===h)if("number"===h||!c&&"number"!==d)if(c||"date"===d||"number"===d)f=!1;else{a=p+"expected "+("string"===d?"'"+s+"'":s)+" to be a number or a date"}else a=p+"the argument to most must be a number";else a=p+"the argument to most must be a date";if(f)throw new n(a,void 0,l);if(c){var m,g="length";"map"===d||"set"===d?(g="size",m=s.size):m=s.length,this.assert(m<=e,"expected #{this} to have a "+g+" at most #{exp} but got #{act}","expected #{this} to have a "+g+" above #{exp}",e,m)}else this.assert(s<=e,"expected #{this} to be at most #{exp}","expected #{this} to be above #{exp}",e)}function g(e,r){r&&o(this,"message",r);var i=o(this,"object"),a=o(this,"ssfi"),s=o(this,"message");try{var c=i instanceof e}catch(r){if(r instanceof TypeError)throw new n((s=s?s+": ":"")+"The instanceof assertion needs a constructor but "+t.type(e)+" was given.",void 0,a);throw r}var u=t.getName(e);null===u&&(u="an unnamed constructor"),this.assert(c,"expected #{this} to be an instance of "+u,"expected #{this} to not be an instance of "+u)}function y(e,r,i){i&&o(this,"message",i);var a=o(this,"nested"),s=o(this,"own"),c=o(this,"message"),u=o(this,"object"),p=o(this,"ssfi"),l=typeof e;if(c=c?c+": ":"",a){if("string"!==l)throw new n(c+"the argument to property must be a string when using nested syntax",void 0,p)}else if("string"!==l&&"number"!==l&&"symbol"!==l)throw new n(c+"the argument to property must be a string, number, or symbol",void 0,p);if(a&&s)throw new n(c+'The "nested" and "own" flags cannot be combined.',void 0,p);if(null==u)throw new n(c+"Target cannot be null or undefined.",void 0,p);var d,h=o(this,"deep"),f=o(this,"negate"),m=a?t.getPathInfo(u,e):null,g=a?m.value:u[e],y="";h&&(y+="deep "),s&&(y+="own "),a&&(y+="nested "),y+="property ",d=s?Object.prototype.hasOwnProperty.call(u,e):a?m.exists:t.hasProperty(u,e),f&&1!==arguments.length||this.assert(d,"expected #{this} to have "+y+t.inspect(e),"expected #{this} to not have "+y+t.inspect(e)),arguments.length>1&&this.assert(d&&(h?t.eql(r,g):r===g),"expected #{this} to have "+y+t.inspect(e)+" of #{exp}, but got #{act}","expected #{this} to not have "+y+t.inspect(e)+" of #{act}",r,g),o(this,"object",g)}function v(e,t,r){o(this,"own",!0),y.apply(this,arguments)}function b(e,r,n){"string"==typeof r&&(n=r,r=null),n&&o(this,"message",n);var i=o(this,"object"),a=Object.getOwnPropertyDescriptor(Object(i),e);a&&r?this.assert(t.eql(r,a),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to match "+t.inspect(r)+", got "+t.inspect(a),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to not match "+t.inspect(r),r,a,!0):this.assert(a,"expected #{this} to have an own property descriptor for "+t.inspect(e),"expected #{this} to not have an own property descriptor for "+t.inspect(e)),o(this,"object",a)}function w(){o(this,"doLength",!0)}function x(e,n){n&&o(this,"message",n);var i,a=o(this,"object"),s=t.type(a).toLowerCase(),c=o(this,"message"),u=o(this,"ssfi"),p="length";switch(s){case"map":case"set":p="size",i=a.size;break;default:new r(a,c,u,!0).to.have.property("length"),i=a.length}this.assert(i==e,"expected #{this} to have a "+p+" of #{exp} but got #{act}","expected #{this} to not have a "+p+" of #{act}",e,i)}function E(e,t){t&&o(this,"message",t);var r=o(this,"object");this.assert(e.exec(r),"expected #{this} to match "+e,"expected #{this} not to match "+e)}function k(e){var r,i,a=o(this,"object"),s=t.type(a),c=t.type(e),u=o(this,"ssfi"),p=o(this,"deep"),l="",d=!0,h=o(this,"message"),f=(h=h?h+": ":"")+"when testing keys against an object or an array you must give a single Array|Object|String argument or multiple String arguments";if("Map"===s||"Set"===s)l=p?"deeply ":"",i=[],a.forEach((function(e,t){i.push(t)})),"Array"!==c&&(e=Array.prototype.slice.call(arguments));else{switch(i=t.getOwnEnumerableProperties(a),c){case"Array":if(arguments.length>1)throw new n(f,void 0,u);break;case"Object":if(arguments.length>1)throw new n(f,void 0,u);e=Object.keys(e);break;default:e=Array.prototype.slice.call(arguments)}e=e.map((function(e){return"symbol"==typeof e?e:String(e)}))}if(!e.length)throw new n(h+"keys required",void 0,u);var m=e.length,g=o(this,"any"),y=o(this,"all"),v=e;if(g||y||(y=!0),g&&(d=v.some((function(e){return i.some((function(r){return p?t.eql(e,r):e===r}))}))),y&&(d=v.every((function(e){return i.some((function(r){return p?t.eql(e,r):e===r}))})),o(this,"contains")||(d=d&&e.length==i.length)),m>1){var b=(e=e.map((function(e){return t.inspect(e)}))).pop();y&&(r=e.join(", ")+", and "+b),g&&(r=e.join(", ")+", or "+b)}else r=t.inspect(e[0]);r=(m>1?"keys ":"key ")+r,r=(o(this,"contains")?"contain ":"have ")+r,this.assert(d,"expected #{this} to "+l+r,"expected #{this} to not "+l+r,v.slice(0).sort(t.compareByInspect),i.sort(t.compareByInspect),!0)}function _(e,n,i){i&&o(this,"message",i);var a,s=o(this,"object"),c=o(this,"ssfi"),u=o(this,"message"),p=o(this,"negate")||!1;new r(s,u,c,!0).is.a("function"),(e instanceof RegExp||"string"==typeof e)&&(n=e,e=null);try{s()}catch(e){a=e}var l=void 0===e&&void 0===n,d=Boolean(e&&n),h=!1,f=!1;if(l||!l&&!p){var m="an error";e instanceof Error?m="#{exp}":e&&(m=t.checkError.getConstructorName(e)),this.assert(a,"expected #{this} to throw "+m,"expected #{this} to not throw an error but #{act} was thrown",e&&e.toString(),a instanceof Error?a.toString():"string"==typeof a?a:a&&t.checkError.getConstructorName(a))}if(e&&a){if(e instanceof Error)t.checkError.compatibleInstance(a,e)===p&&(d&&p?h=!0:this.assert(p,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(a&&!p?" but #{act} was thrown":""),e.toString(),a.toString()));t.checkError.compatibleConstructor(a,e)===p&&(d&&p?h=!0:this.assert(p,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(a?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),a instanceof Error?a.toString():a&&t.checkError.getConstructorName(a)))}if(a&&null!=n){var g="including";n instanceof RegExp&&(g="matching"),t.checkError.compatibleMessage(a,n)===p&&(d&&p?f=!0:this.assert(p,"expected #{this} to throw error "+g+" #{exp} but got #{act}","expected #{this} to throw error not "+g+" #{exp}",n,t.checkError.getMessage(a)))}h&&f&&this.assert(p,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(a?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),a instanceof Error?a.toString():a&&t.checkError.getConstructorName(a)),o(this,"object",a)}function S(e,r){r&&o(this,"message",r);var n=o(this,"object"),i=o(this,"itself"),a="function"!=typeof n||i?n[e]:n.prototype[e];this.assert("function"==typeof a,"expected #{this} to respond to "+t.inspect(e),"expected #{this} to not respond to "+t.inspect(e))}function C(e,r){r&&o(this,"message",r);var n=e(o(this,"object"));this.assert(n,"expected #{this} to satisfy "+t.objDisplay(e),"expected #{this} to not satisfy"+t.objDisplay(e),!o(this,"negate"),n)}function P(e,t,i){i&&o(this,"message",i);var a=o(this,"object"),s=o(this,"message"),c=o(this,"ssfi");if(new r(a,s,c,!0).is.a("number"),"number"!=typeof e||"number"!=typeof t)throw new n((s=s?s+": ":"")+"the arguments to closeTo or approximately must be numbers",void 0,c);this.assert(Math.abs(a-e)<=t,"expected #{this} to be close to "+e+" +/- "+t,"expected #{this} not to be close to "+e+" +/- "+t)}function D(e,t,n){n&&o(this,"message",n);var i,a=o(this,"object"),s=o(this,"message"),c=o(this,"ssfi");new r(a,s,c,!0).is.a("function"),t?(new r(e,s,c,!0).to.have.property(t),i=e[t]):(new r(e,s,c,!0).is.a("function"),i=e()),a();var u=null==t?e():e[t],p=null==t?i:"."+t;o(this,"deltaMsgObj",p),o(this,"initialDeltaValue",i),o(this,"finalDeltaValue",u),o(this,"deltaBehavior","change"),o(this,"realDelta",u!==i),this.assert(i!==u,"expected "+p+" to change","expected "+p+" to not change")}function A(e,t,n){n&&o(this,"message",n);var i,a=o(this,"object"),s=o(this,"message"),c=o(this,"ssfi");new r(a,s,c,!0).is.a("function"),t?(new r(e,s,c,!0).to.have.property(t),i=e[t]):(new r(e,s,c,!0).is.a("function"),i=e()),new r(i,s,c,!0).is.a("number"),a();var u=null==t?e():e[t],p=null==t?i:"."+t;o(this,"deltaMsgObj",p),o(this,"initialDeltaValue",i),o(this,"finalDeltaValue",u),o(this,"deltaBehavior","increase"),o(this,"realDelta",u-i),this.assert(u-i>0,"expected "+p+" to increase","expected "+p+" to not increase")}function O(e,t,n){n&&o(this,"message",n);var i,a=o(this,"object"),s=o(this,"message"),c=o(this,"ssfi");new r(a,s,c,!0).is.a("function"),t?(new r(e,s,c,!0).to.have.property(t),i=e[t]):(new r(e,s,c,!0).is.a("function"),i=e()),new r(i,s,c,!0).is.a("number"),a();var u=null==t?e():e[t],p=null==t?i:"."+t;o(this,"deltaMsgObj",p),o(this,"initialDeltaValue",i),o(this,"finalDeltaValue",u),o(this,"deltaBehavior","decrease"),o(this,"realDelta",i-u),this.assert(u-i<0,"expected "+p+" to decrease","expected "+p+" to not decrease")}["to","be","been","is","and","has","have","with","that","which","at","of","same","but","does","still"].forEach((function(e){r.addProperty(e)})),r.addProperty("not",(function(){o(this,"negate",!0)})),r.addProperty("deep",(function(){o(this,"deep",!0)})),r.addProperty("nested",(function(){o(this,"nested",!0)})),r.addProperty("own",(function(){o(this,"own",!0)})),r.addProperty("ordered",(function(){o(this,"ordered",!0)})),r.addProperty("any",(function(){o(this,"any",!0),o(this,"all",!1)})),r.addProperty("all",(function(){o(this,"all",!0),o(this,"any",!1)})),r.addChainableMethod("an",i),r.addChainableMethod("a",i),r.addChainableMethod("include",c,s),r.addChainableMethod("contain",c,s),r.addChainableMethod("contains",c,s),r.addChainableMethod("includes",c,s),r.addProperty("ok",(function(){this.assert(o(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")})),r.addProperty("true",(function(){this.assert(!0===o(this,"object"),"expected #{this} to be true","expected #{this} to be false",!o(this,"negate"))})),r.addProperty("false",(function(){this.assert(!1===o(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!o(this,"negate"))})),r.addProperty("null",(function(){this.assert(null===o(this,"object"),"expected #{this} to be null","expected #{this} not to be null")})),r.addProperty("undefined",(function(){this.assert(void 0===o(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")})),r.addProperty("NaN",(function(){this.assert(t.isNaN(o(this,"object")),"expected #{this} to be NaN","expected #{this} not to be NaN")})),r.addProperty("exist",(function(){var e=o(this,"object");this.assert(null!=e,"expected #{this} to exist","expected #{this} to not exist")})),r.addProperty("empty",(function(){var e,r=o(this,"object"),i=o(this,"ssfi"),a=o(this,"message");switch(a=a?a+": ":"",t.type(r).toLowerCase()){case"array":case"string":e=r.length;break;case"map":case"set":e=r.size;break;case"weakmap":case"weakset":throw new n(a+".empty was passed a weak collection",void 0,i);case"function":var s=a+".empty was passed a function "+t.getName(r);throw new n(s.trim(),void 0,i);default:if(r!==Object(r))throw new n(a+".empty was passed non-string primitive "+t.inspect(r),void 0,i);e=Object.keys(r).length}this.assert(0===e,"expected #{this} to be empty","expected #{this} not to be empty")})),r.addProperty("arguments",u),r.addProperty("Arguments",u),r.addMethod("equal",p),r.addMethod("equals",p),r.addMethod("eq",p),r.addMethod("eql",l),r.addMethod("eqls",l),r.addMethod("above",d),r.addMethod("gt",d),r.addMethod("greaterThan",d),r.addMethod("least",h),r.addMethod("gte",h),r.addMethod("below",f),r.addMethod("lt",f),r.addMethod("lessThan",f),r.addMethod("most",m),r.addMethod("lte",m),r.addMethod("within",(function(e,i,a){a&&o(this,"message",a);var s,c=o(this,"object"),u=o(this,"doLength"),p=o(this,"message"),l=p?p+": ":"",d=o(this,"ssfi"),h=t.type(c).toLowerCase(),f=t.type(e).toLowerCase(),m=t.type(i).toLowerCase(),g=!0,y="date"===f&&"date"===m?e.toUTCString()+".."+i.toUTCString():e+".."+i;if(u&&"map"!==h&&"set"!==h&&new r(c,p,d,!0).to.have.property("length"),u||"date"!==h||"date"===f&&"date"===m)if("number"===f&&"number"===m||!u&&"number"!==h)if(u||"date"===h||"number"===h)g=!1;else{s=l+"expected "+("string"===h?"'"+c+"'":c)+" to be a number or a date"}else s=l+"the arguments to within must be numbers";else s=l+"the arguments to within must be dates";if(g)throw new n(s,void 0,d);if(u){var v,b="length";"map"===h||"set"===h?(b="size",v=c.size):v=c.length,this.assert(v>=e&&v<=i,"expected #{this} to have a "+b+" within "+y,"expected #{this} to not have a "+b+" within "+y)}else this.assert(c>=e&&c<=i,"expected #{this} to be within "+y,"expected #{this} to not be within "+y)})),r.addMethod("instanceof",g),r.addMethod("instanceOf",g),r.addMethod("property",y),r.addMethod("ownProperty",v),r.addMethod("haveOwnProperty",v),r.addMethod("ownPropertyDescriptor",b),r.addMethod("haveOwnPropertyDescriptor",b),r.addChainableMethod("length",x,w),r.addChainableMethod("lengthOf",x,w),r.addMethod("match",E),r.addMethod("matches",E),r.addMethod("string",(function(e,n){n&&o(this,"message",n);var i=o(this,"object"),a=o(this,"message"),s=o(this,"ssfi");new r(i,a,s,!0).is.a("string"),this.assert(~i.indexOf(e),"expected #{this} to contain "+t.inspect(e),"expected #{this} to not contain "+t.inspect(e))})),r.addMethod("keys",k),r.addMethod("key",k),r.addMethod("throw",_),r.addMethod("throws",_),r.addMethod("Throw",_),r.addMethod("respondTo",S),r.addMethod("respondsTo",S),r.addProperty("itself",(function(){o(this,"itself",!0)})),r.addMethod("satisfy",C),r.addMethod("satisfies",C),r.addMethod("closeTo",P),r.addMethod("approximately",P),r.addMethod("members",(function(e,n){n&&o(this,"message",n);var i=o(this,"object"),a=o(this,"message"),s=o(this,"ssfi");new r(i,a,s,!0).to.be.an("array"),new r(e,a,s,!0).to.be.an("array");var c,u,p,l=o(this,"contains"),d=o(this,"ordered");l?(u="expected #{this} to be "+(c=d?"an ordered superset":"a superset")+" of #{exp}",p="expected #{this} to not be "+c+" of #{exp}"):(u="expected #{this} to have the same "+(c=d?"ordered members":"members")+" as #{exp}",p="expected #{this} to not have the same "+c+" as #{exp}");var h=o(this,"deep")?t.eql:void 0;this.assert(function(e,t,r,n,o){if(!n){if(e.length!==t.length)return!1;t=t.slice()}return e.every((function(e,i){if(o)return r?r(e,t[i]):e===t[i];if(!r){var a=t.indexOf(e);return-1!==a&&(n||t.splice(a,1),!0)}return t.some((function(o,i){return!!r(e,o)&&(n||t.splice(i,1),!0)}))}))}(e,i,h,l,d),u,p,e,i,!0)})),r.addMethod("oneOf",(function(e,t){t&&o(this,"message",t);var n=o(this,"object"),i=o(this,"message"),a=o(this,"ssfi");new r(e,i,a,!0).to.be.an("array"),this.assert(e.indexOf(n)>-1,"expected #{this} to be one of #{exp}","expected #{this} to not be one of #{exp}",e,n)})),r.addMethod("change",D),r.addMethod("changes",D),r.addMethod("increase",A),r.addMethod("increases",A),r.addMethod("decrease",O),r.addMethod("decreases",O),r.addMethod("by",(function(e,t){t&&o(this,"message",t);var r,n=o(this,"deltaMsgObj"),i=o(this,"initialDeltaValue"),a=o(this,"finalDeltaValue"),s=o(this,"deltaBehavior"),c=o(this,"realDelta");r="change"===s?Math.abs(a-i)===Math.abs(e):c===Math.abs(e),this.assert(r,"expected "+n+" to "+s+" by "+e,"expected "+n+" to not "+s+" by "+e)})),r.addProperty("extensible",(function(){var e=o(this,"object"),t=e===Object(e)&&Object.isExtensible(e);this.assert(t,"expected #{this} to be extensible","expected #{this} to not be extensible")})),r.addProperty("sealed",(function(){var e=o(this,"object"),t=e!==Object(e)||Object.isSealed(e);this.assert(t,"expected #{this} to be sealed","expected #{this} to not be sealed")})),r.addProperty("frozen",(function(){var e=o(this,"object"),t=e!==Object(e)||Object.isFrozen(e);this.assert(t,"expected #{this} to be frozen","expected #{this} to not be frozen")})),r.addProperty("finite",(function(e){var t=o(this,"object");this.assert("number"==typeof t&&isFinite(t),"expected #{this} to be a finite number","expected #{this} to not be a finite number")}))}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){e.expect=function(t,r){return new e.Assertion(t,r)},e.expect.fail=function(t,r,n,o){throw arguments.length<2&&(n=t,t=void 0),n=n||"expect.fail()",new e.AssertionError(n,{actual:t,expected:r,operator:o},e.expect.fail)}}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){var r=e.Assertion;function n(){Object.defineProperty(Object.prototype,"should",{set:function(e){Object.defineProperty(this,"should",{value:e,enumerable:!0,configurable:!0,writable:!0})},get:function e(){return this instanceof String||this instanceof Number||this instanceof Boolean||"function"==typeof Symbol&&this instanceof Symbol?new r(this.valueOf(),null,e):new r(this,null,e)},configurable:!0});var t={fail:function(r,n,o,i){throw arguments.length<2&&(o=r,r=void 0),o=o||"should.fail()",new e.AssertionError(o,{actual:r,expected:n,operator:i},t.fail)},equal:function(e,t,n){new r(e,n).to.equal(t)},Throw:function(e,t,n,o){new r(e,o).to.Throw(t,n)},exist:function(e,t){new r(e,t).to.exist},not:{}};return t.not.equal=function(e,t,n){new r(e,n).to.not.equal(t)},t.not.Throw=function(e,t,n,o){new r(e,o).to.not.Throw(t,n)},t.not.exist=function(e,t){new r(e,t).to.not.exist},t.throw=t.Throw,t.not.throw=t.not.Throw,t}e.should=n,e.Should=n}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){
/*!
   * Chai dependencies.
   */
var r=e.Assertion,n=t.flag,o=e.assert=function(t,n){new r(null,null,e.assert,!0).assert(t,n,"[ negation message unavailable ]")};
/*!
   * Module export.
   */o.fail=function(t,r,n,i){throw arguments.length<2&&(n=t,t=void 0),n=n||"assert.fail()",new e.AssertionError(n,{actual:t,expected:r,operator:i},o.fail)},o.isOk=function(e,t){new r(e,t,o.isOk,!0).is.ok},o.isNotOk=function(e,t){new r(e,t,o.isNotOk,!0).is.not.ok},o.equal=function(e,t,i){var a=new r(e,i,o.equal,!0);a.assert(t==n(a,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",t,e,!0)},o.notEqual=function(e,t,i){var a=new r(e,i,o.notEqual,!0);a.assert(t!=n(a,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",t,e,!0)},o.strictEqual=function(e,t,n){new r(e,n,o.strictEqual,!0).to.equal(t)},o.notStrictEqual=function(e,t,n){new r(e,n,o.notStrictEqual,!0).to.not.equal(t)},o.deepEqual=o.deepStrictEqual=function(e,t,n){new r(e,n,o.deepEqual,!0).to.eql(t)},o.notDeepEqual=function(e,t,n){new r(e,n,o.notDeepEqual,!0).to.not.eql(t)},o.isAbove=function(e,t,n){new r(e,n,o.isAbove,!0).to.be.above(t)},o.isAtLeast=function(e,t,n){new r(e,n,o.isAtLeast,!0).to.be.least(t)},o.isBelow=function(e,t,n){new r(e,n,o.isBelow,!0).to.be.below(t)},o.isAtMost=function(e,t,n){new r(e,n,o.isAtMost,!0).to.be.most(t)},o.isTrue=function(e,t){new r(e,t,o.isTrue,!0).is.true},o.isNotTrue=function(e,t){new r(e,t,o.isNotTrue,!0).to.not.equal(!0)},o.isFalse=function(e,t){new r(e,t,o.isFalse,!0).is.false},o.isNotFalse=function(e,t){new r(e,t,o.isNotFalse,!0).to.not.equal(!1)},o.isNull=function(e,t){new r(e,t,o.isNull,!0).to.equal(null)},o.isNotNull=function(e,t){new r(e,t,o.isNotNull,!0).to.not.equal(null)},o.isNaN=function(e,t){new r(e,t,o.isNaN,!0).to.be.NaN},o.isNotNaN=function(e,t){new r(e,t,o.isNotNaN,!0).not.to.be.NaN},o.exists=function(e,t){new r(e,t,o.exists,!0).to.exist},o.notExists=function(e,t){new r(e,t,o.notExists,!0).to.not.exist},o.isUndefined=function(e,t){new r(e,t,o.isUndefined,!0).to.equal(void 0)},o.isDefined=function(e,t){new r(e,t,o.isDefined,!0).to.not.equal(void 0)},o.isFunction=function(e,t){new r(e,t,o.isFunction,!0).to.be.a("function")},o.isNotFunction=function(e,t){new r(e,t,o.isNotFunction,!0).to.not.be.a("function")},o.isObject=function(e,t){new r(e,t,o.isObject,!0).to.be.a("object")},o.isNotObject=function(e,t){new r(e,t,o.isNotObject,!0).to.not.be.a("object")},o.isArray=function(e,t){new r(e,t,o.isArray,!0).to.be.an("array")},o.isNotArray=function(e,t){new r(e,t,o.isNotArray,!0).to.not.be.an("array")},o.isString=function(e,t){new r(e,t,o.isString,!0).to.be.a("string")},o.isNotString=function(e,t){new r(e,t,o.isNotString,!0).to.not.be.a("string")},o.isNumber=function(e,t){new r(e,t,o.isNumber,!0).to.be.a("number")},o.isNotNumber=function(e,t){new r(e,t,o.isNotNumber,!0).to.not.be.a("number")},o.isFinite=function(e,t){new r(e,t,o.isFinite,!0).to.be.finite},o.isBoolean=function(e,t){new r(e,t,o.isBoolean,!0).to.be.a("boolean")},o.isNotBoolean=function(e,t){new r(e,t,o.isNotBoolean,!0).to.not.be.a("boolean")},o.typeOf=function(e,t,n){new r(e,n,o.typeOf,!0).to.be.a(t)},o.notTypeOf=function(e,t,n){new r(e,n,o.notTypeOf,!0).to.not.be.a(t)},o.instanceOf=function(e,t,n){new r(e,n,o.instanceOf,!0).to.be.instanceOf(t)},o.notInstanceOf=function(e,t,n){new r(e,n,o.notInstanceOf,!0).to.not.be.instanceOf(t)},o.include=function(e,t,n){new r(e,n,o.include,!0).include(t)},o.notInclude=function(e,t,n){new r(e,n,o.notInclude,!0).not.include(t)},o.deepInclude=function(e,t,n){new r(e,n,o.deepInclude,!0).deep.include(t)},o.notDeepInclude=function(e,t,n){new r(e,n,o.notDeepInclude,!0).not.deep.include(t)},o.nestedInclude=function(e,t,n){new r(e,n,o.nestedInclude,!0).nested.include(t)},o.notNestedInclude=function(e,t,n){new r(e,n,o.notNestedInclude,!0).not.nested.include(t)},o.deepNestedInclude=function(e,t,n){new r(e,n,o.deepNestedInclude,!0).deep.nested.include(t)},o.notDeepNestedInclude=function(e,t,n){new r(e,n,o.notDeepNestedInclude,!0).not.deep.nested.include(t)},o.ownInclude=function(e,t,n){new r(e,n,o.ownInclude,!0).own.include(t)},o.notOwnInclude=function(e,t,n){new r(e,n,o.notOwnInclude,!0).not.own.include(t)},o.deepOwnInclude=function(e,t,n){new r(e,n,o.deepOwnInclude,!0).deep.own.include(t)},o.notDeepOwnInclude=function(e,t,n){new r(e,n,o.notDeepOwnInclude,!0).not.deep.own.include(t)},o.match=function(e,t,n){new r(e,n,o.match,!0).to.match(t)},o.notMatch=function(e,t,n){new r(e,n,o.notMatch,!0).to.not.match(t)},o.property=function(e,t,n){new r(e,n,o.property,!0).to.have.property(t)},o.notProperty=function(e,t,n){new r(e,n,o.notProperty,!0).to.not.have.property(t)},o.propertyVal=function(e,t,n,i){new r(e,i,o.propertyVal,!0).to.have.property(t,n)},o.notPropertyVal=function(e,t,n,i){new r(e,i,o.notPropertyVal,!0).to.not.have.property(t,n)},o.deepPropertyVal=function(e,t,n,i){new r(e,i,o.deepPropertyVal,!0).to.have.deep.property(t,n)},o.notDeepPropertyVal=function(e,t,n,i){new r(e,i,o.notDeepPropertyVal,!0).to.not.have.deep.property(t,n)},o.ownProperty=function(e,t,n){new r(e,n,o.ownProperty,!0).to.have.own.property(t)},o.notOwnProperty=function(e,t,n){new r(e,n,o.notOwnProperty,!0).to.not.have.own.property(t)},o.ownPropertyVal=function(e,t,n,i){new r(e,i,o.ownPropertyVal,!0).to.have.own.property(t,n)},o.notOwnPropertyVal=function(e,t,n,i){new r(e,i,o.notOwnPropertyVal,!0).to.not.have.own.property(t,n)},o.deepOwnPropertyVal=function(e,t,n,i){new r(e,i,o.deepOwnPropertyVal,!0).to.have.deep.own.property(t,n)},o.notDeepOwnPropertyVal=function(e,t,n,i){new r(e,i,o.notDeepOwnPropertyVal,!0).to.not.have.deep.own.property(t,n)},o.nestedProperty=function(e,t,n){new r(e,n,o.nestedProperty,!0).to.have.nested.property(t)},o.notNestedProperty=function(e,t,n){new r(e,n,o.notNestedProperty,!0).to.not.have.nested.property(t)},o.nestedPropertyVal=function(e,t,n,i){new r(e,i,o.nestedPropertyVal,!0).to.have.nested.property(t,n)},o.notNestedPropertyVal=function(e,t,n,i){new r(e,i,o.notNestedPropertyVal,!0).to.not.have.nested.property(t,n)},o.deepNestedPropertyVal=function(e,t,n,i){new r(e,i,o.deepNestedPropertyVal,!0).to.have.deep.nested.property(t,n)},o.notDeepNestedPropertyVal=function(e,t,n,i){new r(e,i,o.notDeepNestedPropertyVal,!0).to.not.have.deep.nested.property(t,n)},o.lengthOf=function(e,t,n){new r(e,n,o.lengthOf,!0).to.have.lengthOf(t)},o.hasAnyKeys=function(e,t,n){new r(e,n,o.hasAnyKeys,!0).to.have.any.keys(t)},o.hasAllKeys=function(e,t,n){new r(e,n,o.hasAllKeys,!0).to.have.all.keys(t)},o.containsAllKeys=function(e,t,n){new r(e,n,o.containsAllKeys,!0).to.contain.all.keys(t)},o.doesNotHaveAnyKeys=function(e,t,n){new r(e,n,o.doesNotHaveAnyKeys,!0).to.not.have.any.keys(t)},o.doesNotHaveAllKeys=function(e,t,n){new r(e,n,o.doesNotHaveAllKeys,!0).to.not.have.all.keys(t)},o.hasAnyDeepKeys=function(e,t,n){new r(e,n,o.hasAnyDeepKeys,!0).to.have.any.deep.keys(t)},o.hasAllDeepKeys=function(e,t,n){new r(e,n,o.hasAllDeepKeys,!0).to.have.all.deep.keys(t)},o.containsAllDeepKeys=function(e,t,n){new r(e,n,o.containsAllDeepKeys,!0).to.contain.all.deep.keys(t)},o.doesNotHaveAnyDeepKeys=function(e,t,n){new r(e,n,o.doesNotHaveAnyDeepKeys,!0).to.not.have.any.deep.keys(t)},o.doesNotHaveAllDeepKeys=function(e,t,n){new r(e,n,o.doesNotHaveAllDeepKeys,!0).to.not.have.all.deep.keys(t)},o.throws=function(e,t,i,a){("string"==typeof t||t instanceof RegExp)&&(i=t,t=null);var s=new r(e,a,o.throws,!0).to.throw(t,i);return n(s,"object")},o.doesNotThrow=function(e,t,n,i){("string"==typeof t||t instanceof RegExp)&&(n=t,t=null),new r(e,i,o.doesNotThrow,!0).to.not.throw(t,n)},o.operator=function(i,a,s,c){var u;switch(a){case"==":u=i==s;break;case"===":u=i===s;break;case">":u=i>s;break;case">=":u=i>=s;break;case"<":u=i<s;break;case"<=":u=i<=s;break;case"!=":u=i!=s;break;case"!==":u=i!==s;break;default:throw c=c?c+": ":c,new e.AssertionError(c+'Invalid operator "'+a+'"',void 0,o.operator)}var p=new r(u,c,o.operator,!0);p.assert(!0===n(p,"object"),"expected "+t.inspect(i)+" to be "+a+" "+t.inspect(s),"expected "+t.inspect(i)+" to not be "+a+" "+t.inspect(s))},o.closeTo=function(e,t,n,i){new r(e,i,o.closeTo,!0).to.be.closeTo(t,n)},o.approximately=function(e,t,n,i){new r(e,i,o.approximately,!0).to.be.approximately(t,n)},o.sameMembers=function(e,t,n){new r(e,n,o.sameMembers,!0).to.have.same.members(t)},o.notSameMembers=function(e,t,n){new r(e,n,o.notSameMembers,!0).to.not.have.same.members(t)},o.sameDeepMembers=function(e,t,n){new r(e,n,o.sameDeepMembers,!0).to.have.same.deep.members(t)},o.notSameDeepMembers=function(e,t,n){new r(e,n,o.notSameDeepMembers,!0).to.not.have.same.deep.members(t)},o.sameOrderedMembers=function(e,t,n){new r(e,n,o.sameOrderedMembers,!0).to.have.same.ordered.members(t)},o.notSameOrderedMembers=function(e,t,n){new r(e,n,o.notSameOrderedMembers,!0).to.not.have.same.ordered.members(t)},o.sameDeepOrderedMembers=function(e,t,n){new r(e,n,o.sameDeepOrderedMembers,!0).to.have.same.deep.ordered.members(t)},o.notSameDeepOrderedMembers=function(e,t,n){new r(e,n,o.notSameDeepOrderedMembers,!0).to.not.have.same.deep.ordered.members(t)},o.includeMembers=function(e,t,n){new r(e,n,o.includeMembers,!0).to.include.members(t)},o.notIncludeMembers=function(e,t,n){new r(e,n,o.notIncludeMembers,!0).to.not.include.members(t)},o.includeDeepMembers=function(e,t,n){new r(e,n,o.includeDeepMembers,!0).to.include.deep.members(t)},o.notIncludeDeepMembers=function(e,t,n){new r(e,n,o.notIncludeDeepMembers,!0).to.not.include.deep.members(t)},o.includeOrderedMembers=function(e,t,n){new r(e,n,o.includeOrderedMembers,!0).to.include.ordered.members(t)},o.notIncludeOrderedMembers=function(e,t,n){new r(e,n,o.notIncludeOrderedMembers,!0).to.not.include.ordered.members(t)},o.includeDeepOrderedMembers=function(e,t,n){new r(e,n,o.includeDeepOrderedMembers,!0).to.include.deep.ordered.members(t)},o.notIncludeDeepOrderedMembers=function(e,t,n){new r(e,n,o.notIncludeDeepOrderedMembers,!0).to.not.include.deep.ordered.members(t)},o.oneOf=function(e,t,n){new r(e,n,o.oneOf,!0).to.be.oneOf(t)},o.changes=function(e,t,n,i){3===arguments.length&&"function"==typeof t&&(i=n,n=null),new r(e,i,o.changes,!0).to.change(t,n)},o.changesBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);new r(e,a,o.changesBy,!0).to.change(t,n).by(i)},o.doesNotChange=function(e,t,n,i){return 3===arguments.length&&"function"==typeof t&&(i=n,n=null),new r(e,i,o.doesNotChange,!0).to.not.change(t,n)},o.changesButNotBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);new r(e,a,o.changesButNotBy,!0).to.change(t,n).but.not.by(i)},o.increases=function(e,t,n,i){return 3===arguments.length&&"function"==typeof t&&(i=n,n=null),new r(e,i,o.increases,!0).to.increase(t,n)},o.increasesBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);new r(e,a,o.increasesBy,!0).to.increase(t,n).by(i)},o.doesNotIncrease=function(e,t,n,i){return 3===arguments.length&&"function"==typeof t&&(i=n,n=null),new r(e,i,o.doesNotIncrease,!0).to.not.increase(t,n)},o.increasesButNotBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);new r(e,a,o.increasesButNotBy,!0).to.increase(t,n).but.not.by(i)},o.decreases=function(e,t,n,i){return 3===arguments.length&&"function"==typeof t&&(i=n,n=null),new r(e,i,o.decreases,!0).to.decrease(t,n)},o.decreasesBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);new r(e,a,o.decreasesBy,!0).to.decrease(t,n).by(i)},o.doesNotDecrease=function(e,t,n,i){return 3===arguments.length&&"function"==typeof t&&(i=n,n=null),new r(e,i,o.doesNotDecrease,!0).to.not.decrease(t,n)},o.doesNotDecreaseBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);return new r(e,a,o.doesNotDecreaseBy,!0).to.not.decrease(t,n).by(i)},o.decreasesButNotBy=function(e,t,n,i,a){if(4===arguments.length&&"function"==typeof t){var s=i;i=n,a=s}else 3===arguments.length&&(i=n,n=null);new r(e,a,o.decreasesButNotBy,!0).to.decrease(t,n).but.not.by(i)}
/*!
   * ### .ifError(object)
   *
   * Asserts if value is not a false value, and throws if it is a true value.
   * This is added to allow for chai to be a drop-in replacement for Node's
   * assert class.
   *
   *     var err = new Error('I am a custom error');
   *     assert.ifError(err); // Rethrows err!
   *
   * @name ifError
   * @param {Object} object
   * @namespace Assert
   * @api public
   */,o.ifError=function(e){if(e)throw e},o.isExtensible=function(e,t){new r(e,t,o.isExtensible,!0).to.be.extensible},o.isNotExtensible=function(e,t){new r(e,t,o.isNotExtensible,!0).to.not.be.extensible},o.isSealed=function(e,t){new r(e,t,o.isSealed,!0).to.be.sealed},o.isNotSealed=function(e,t){new r(e,t,o.isNotSealed,!0).to.not.be.sealed},o.isFrozen=function(e,t){new r(e,t,o.isFrozen,!0).to.be.frozen},o.isNotFrozen=function(e,t){new r(e,t,o.isNotFrozen,!0).to.not.be.frozen},o.isEmpty=function(e,t){new r(e,t,o.isEmpty,!0).to.be.empty},o.isNotEmpty=function(e,t){new r(e,t,o.isNotEmpty,!0).to.not.be.empty},
/*!
   * Aliases.
   */
function e(t,r){return o[r]=o[t],e}("isOk","ok")("isNotOk","notOk")("throws","throw")("throws","Throw")("isExtensible","extensible")("isNotExtensible","notExtensible")("isSealed","sealed")("isNotSealed","notSealed")("isFrozen","frozen")("isNotFrozen","notFrozen")("isEmpty","empty")("isNotEmpty","notEmpty")}},function(e,t,r){(function(t){e.exports=function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[a]={exports:{}};t[a][0].call(u.exports,(function(e){var r=t[a][1][e];return o(r||e)}),u,u.exports,e,t,r,n)}return r[a].exports}for(var i=!1,a=0;a<n.length;a++)o(n[a]);return o}({"./aesprim":[function(e,t,r){!function(e,t){"use strict";t(void 0!==r?r:e.esprima={})}(this,(function(e){"use strict";var t,r,n,o,i,a,s,c,u,p,l,d,h,f,m,g,y,v;function b(e,t){if(!e)throw new Error("ASSERT: "+t)}function w(e){return e>=48&&e<=57}function x(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function E(e){return"01234567".indexOf(e)>=0}function k(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function _(e){return 10===e||13===e||8232===e||8233===e}function S(e){return 64==e||36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&s.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function C(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&s.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function P(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function D(e){return"eval"===e||"arguments"===e}function A(e,t,r,n,o){var i;b("number"==typeof r,"Comment must have valid position"),y.lastCommentStart>=r||(y.lastCommentStart=r,i={type:e,value:t},v.range&&(i.range=[r,n]),v.loc&&(i.loc=o),v.comments.push(i),v.attachComment&&(v.leadingComments.push(i),v.trailingComments.push(i)))}function O(e){var t,r,n,o;for(t=l-e,r={start:{line:d,column:l-h-e}};l<f;)if(n=u.charCodeAt(l),++l,_(n))return v.comments&&(o=u.slice(t+e,l-1),r.end={line:d,column:l-h-1},A("Line",o,t,l-1,r)),13===n&&10===u.charCodeAt(l)&&++l,++d,void(h=l);v.comments&&(o=u.slice(t+e,l),r.end={line:d,column:l-h},A("Line",o,t,l,r))}function j(){var e,t,r,n;for(v.comments&&(e=l-2,t={start:{line:d,column:l-h-2}});l<f;)if(_(r=u.charCodeAt(l)))13===r&&10===u.charCodeAt(l+1)&&++l,++d,++l,h=l,l>=f&&X({},a.UnexpectedToken,"ILLEGAL");else if(42===r){if(47===u.charCodeAt(l+1))return++l,++l,void(v.comments&&(n=u.slice(e+2,l-2),t.end={line:d,column:l-h},A("Block",n,e,l,t)));++l}else++l;X({},a.UnexpectedToken,"ILLEGAL")}function T(){var e,t;for(t=0===l;l<f;)if(k(e=u.charCodeAt(l)))++l;else if(_(e))++l,13===e&&10===u.charCodeAt(l)&&++l,++d,h=l,t=!0;else if(47===e)if(47===(e=u.charCodeAt(l+1)))++l,++l,O(2),t=!0;else{if(42!==e)break;++l,++l,j()}else if(t&&45===e){if(45!==u.charCodeAt(l+1)||62!==u.charCodeAt(l+2))break;l+=3,O(3)}else{if(60!==e)break;if("!--"!==u.slice(l+1,l+4))break;++l,++l,++l,++l,O(4)}}function F(e){var t,r,n,o=0;for(r="u"===e?4:2,t=0;t<r;++t){if(!(l<f&&x(u[l])))return"";n=u[l++],o=16*o+"0123456789abcdef".indexOf(n.toLowerCase())}return String.fromCharCode(o)}function I(){var e,t;for(e=u.charCodeAt(l++),t=String.fromCharCode(e),92===e&&(117!==u.charCodeAt(l)&&X({},a.UnexpectedToken,"ILLEGAL"),++l,(e=F("u"))&&"\\"!==e&&S(e.charCodeAt(0))||X({},a.UnexpectedToken,"ILLEGAL"),t=e);l<f&&C(e=u.charCodeAt(l));)++l,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==u.charCodeAt(l)&&X({},a.UnexpectedToken,"ILLEGAL"),++l,(e=F("u"))&&"\\"!==e&&C(e.charCodeAt(0))||X({},a.UnexpectedToken,"ILLEGAL"),t+=e);return t}function N(){var e,r;return e=l,{type:1===(r=92===u.charCodeAt(l)?I():function(){var e,t;for(e=l++;l<f;){if(92===(t=u.charCodeAt(l)))return l=e,I();if(!C(t))break;++l}return u.slice(e,l)}()).length?t.Identifier:function(e){if(p&&P(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}(r)?t.Keyword:"null"===r?t.NullLiteral:"true"===r||"false"===r?t.BooleanLiteral:t.Identifier,value:r,lineNumber:d,lineStart:h,start:e,end:l}}function R(){var e,r,n,o,i=l,s=u.charCodeAt(l),c=u[l];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++l,v.tokenize&&(40===s?v.openParenToken=v.tokens.length:123===s&&(v.openCurlyToken=v.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(s),lineNumber:d,lineStart:h,start:i,end:l};default:if(61===(e=u.charCodeAt(l+1)))switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return l+=2,{type:t.Punctuator,value:String.fromCharCode(s)+String.fromCharCode(e),lineNumber:d,lineStart:h,start:i,end:l};case 33:case 61:return l+=2,61===u.charCodeAt(l)&&++l,{type:t.Punctuator,value:u.slice(i,l),lineNumber:d,lineStart:h,start:i,end:l}}}return">>>="===(o=u.substr(l,4))?{type:t.Punctuator,value:o,lineNumber:d,lineStart:h,start:i,end:l+=4}:">>>"===(n=o.substr(0,3))||"<<="===n||">>="===n?{type:t.Punctuator,value:n,lineNumber:d,lineStart:h,start:i,end:l+=3}:c===(r=n.substr(0,2))[1]&&"+-<>&|".indexOf(c)>=0||"=>"===r?{type:t.Punctuator,value:r,lineNumber:d,lineStart:h,start:i,end:l+=2}:"<>=!+-*%&|^/".indexOf(c)>=0?(++l,{type:t.Punctuator,value:c,lineNumber:d,lineStart:h,start:i,end:l}):void X({},a.UnexpectedToken,"ILLEGAL")}function B(){var e,r,n;if(b(w((n=u[l]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),r=l,e="","."!==n){if(e=u[l++],n=u[l],"0"===e){if("x"===n||"X"===n)return++l,function(e){for(var r="";l<f&&x(u[l]);)r+=u[l++];return 0===r.length&&X({},a.UnexpectedToken,"ILLEGAL"),S(u.charCodeAt(l))&&X({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+r,16),lineNumber:d,lineStart:h,start:e,end:l}}(r);if(E(n))return function(e){for(var r="0"+u[l++];l<f&&E(u[l]);)r+=u[l++];return(S(u.charCodeAt(l))||w(u.charCodeAt(l)))&&X({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(r,8),octal:!0,lineNumber:d,lineStart:h,start:e,end:l}}(r);n&&w(n.charCodeAt(0))&&X({},a.UnexpectedToken,"ILLEGAL")}for(;w(u.charCodeAt(l));)e+=u[l++];n=u[l]}if("."===n){for(e+=u[l++];w(u.charCodeAt(l));)e+=u[l++];n=u[l]}if("e"===n||"E"===n)if(e+=u[l++],"+"!==(n=u[l])&&"-"!==n||(e+=u[l++]),w(u.charCodeAt(l)))for(;w(u.charCodeAt(l));)e+=u[l++];else X({},a.UnexpectedToken,"ILLEGAL");return S(u.charCodeAt(l))&&X({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:d,lineStart:h,start:r,end:l}}function L(){var e,r,n,o;return g=null,T(),e=l,r=function(){var e,t,r,n;for(b("/"===(e=u[l]),"Regular expression literal must start with a slash"),t=u[l++],r=!1,n=!1;l<f;)if(t+=e=u[l++],"\\"===e)_((e=u[l++]).charCodeAt(0))&&X({},a.UnterminatedRegExp),t+=e;else if(_(e.charCodeAt(0)))X({},a.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else{if("/"===e){n=!0;break}"["===e&&(r=!0)}return n||X({},a.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,r,n;for(t="",r="";l<f&&C((e=u[l]).charCodeAt(0));)if(++l,"\\"===e&&l<f)if("u"===(e=u[l])){if(n=++l,e=F("u"))for(r+=e,t+="\\u";n<l;++n)t+=u[n];else l=n,r+="u",t+="\\u";V({},a.UnexpectedToken,"ILLEGAL")}else t+="\\",V({},a.UnexpectedToken,"ILLEGAL");else r+=e,t+=e;return{value:r,literal:t}}(),o=function(e,t){var r;try{r=new RegExp(e,t)}catch(e){X({},a.InvalidRegExp)}return r}(r.value,n.value),v.tokenize?{type:t.RegularExpression,value:o,lineNumber:d,lineStart:h,start:e,end:l}:{literal:r.literal+n.literal,value:o,start:e,end:l}}function M(){var e,t,r,n;return T(),e=l,t={start:{line:d,column:l-h}},r=L(),t.end={line:d,column:l-h},v.tokenize||(v.tokens.length>0&&(n=v.tokens[v.tokens.length-1]).range[0]===e&&"Punctuator"===n.type&&("/"!==n.value&&"/="!==n.value||v.tokens.pop()),v.tokens.push({type:"RegularExpression",value:r.literal,range:[e,l],loc:t})),r}function q(){var e;return T(),l>=f?{type:t.EOF,lineNumber:d,lineStart:h,start:l,end:l}:S(e=u.charCodeAt(l))?N():40===e||41===e||59===e?R():39===e||34===e?function(){var e,r,n,o,i,s,c,p,m="",g=!1;for(c=d,p=h,b("'"===(e=u[l])||'"'===e,"String literal must starts with a quote"),r=l,++l;l<f;){if((n=u[l++])===e){e="";break}if("\\"===n)if((n=u[l++])&&_(n.charCodeAt(0)))++d,"\r"===n&&"\n"===u[l]&&++l,h=l;else switch(n){case"u":case"x":s=l,(i=F(n))?m+=i:(l=s,m+=n);break;case"n":m+="\n";break;case"r":m+="\r";break;case"t":m+="\t";break;case"b":m+="\b";break;case"f":m+="\f";break;case"v":m+="\v";break;default:E(n)?(0!==(o="01234567".indexOf(n))&&(g=!0),l<f&&E(u[l])&&(g=!0,o=8*o+"01234567".indexOf(u[l++]),"0123".indexOf(n)>=0&&l<f&&E(u[l])&&(o=8*o+"01234567".indexOf(u[l++]))),m+=String.fromCharCode(o)):m+=n}else{if(_(n.charCodeAt(0)))break;m+=n}}return""!==e&&X({},a.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:m,octal:g,startLineNumber:c,startLineStart:p,lineNumber:d,lineStart:h,start:r,end:l}}():46===e?w(u.charCodeAt(l+1))?B():R():w(e)?B():v.tokenize&&47===e?function(){var e,t;if(!(e=v.tokens[v.tokens.length-1]))return M();if("Punctuator"===e.type){if("]"===e.value)return R();if(")"===e.value)return!(t=v.tokens[v.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?R():M();if("}"===e.value){if(v.tokens[v.openCurlyToken-3]&&"Keyword"===v.tokens[v.openCurlyToken-3].type){if(!(t=v.tokens[v.openCurlyToken-4]))return R()}else{if(!v.tokens[v.openCurlyToken-4]||"Keyword"!==v.tokens[v.openCurlyToken-4].type)return R();if(!(t=v.tokens[v.openCurlyToken-5]))return M()}return n.indexOf(t.value)>=0?R():M()}return M()}return"Keyword"===e.type?M():R()}():R()}function U(){var e,n,o;return T(),e={start:{line:d,column:l-h}},n=q(),e.end={line:d,column:l-h},n.type!==t.EOF&&(o=u.slice(n.start,n.end),v.tokens.push({type:r[n.type],value:o,range:[n.start,n.end],loc:e})),n}function $(){var e;return l=(e=g).end,d=e.lineNumber,h=e.lineStart,g=void 0!==v.tokens?U():q(),l=e.end,d=e.lineNumber,h=e.lineStart,e}function z(){var e,t,r;e=l,t=d,r=h,g=void 0!==v.tokens?U():q(),l=e,d=t,h=r}function G(e,t){this.line=e,this.column=t}function H(e,t,r,n){this.start=new G(e,t),this.end=new G(r,n)}function J(){var e,t,r,n;return e=l,t=d,r=h,T(),n=d!==t,l=e,d=t,h=r,n}function X(e,t){var r,n=Array.prototype.slice.call(arguments,2),o=t.replace(/%(\d)/g,(function(e,t){return b(t<n.length,"Message reference must be in range"),n[t]}));throw"number"==typeof e.lineNumber?((r=new Error("Line "+e.lineNumber+": "+o)).index=e.start,r.lineNumber=e.lineNumber,r.column=e.start-h+1):((r=new Error("Line "+d+": "+o)).index=l,r.lineNumber=d,r.column=l-h+1),r.description=o,r}function V(){try{X.apply(null,arguments)}catch(e){if(!v.errors)throw e;v.errors.push(e)}}function K(e){if(e.type===t.EOF&&X(e,a.UnexpectedEOS),e.type===t.NumericLiteral&&X(e,a.UnexpectedNumber),e.type===t.StringLiteral&&X(e,a.UnexpectedString),e.type===t.Identifier&&X(e,a.UnexpectedIdentifier),e.type===t.Keyword){if(function(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}(e.value))X(e,a.UnexpectedReserved);else if(p&&P(e.value))return void V(e,a.StrictReservedWord);X(e,a.UnexpectedToken,e.value)}X(e,a.UnexpectedToken,e.value)}function W(e){var r=$();r.type===t.Punctuator&&r.value===e||K(r)}function Q(e){var r=$();r.type===t.Keyword&&r.value===e||K(r)}function Y(e){return g.type===t.Punctuator&&g.value===e}function Z(e){return g.type===t.Keyword&&g.value===e}function ee(){var e;59===u.charCodeAt(l)||Y(";")?$():(e=d,T(),d===e&&(g.type===t.EOF||Y("}")||K(g)))}function te(e){return e.type===o.Identifier||e.type===o.MemberExpression}function re(e,t){var r,n,o;return r=p,o=g,n=Se(),t&&p&&D(e[0].name)&&V(t,a.StrictParamName),p=r,m.markEnd(m.createFunctionExpression(null,e,[],n),o)}function ne(){var e,r;return r=g,(e=$()).type===t.StringLiteral||e.type===t.NumericLiteral?(p&&e.octal&&V(e,a.StrictOctalLiteral),m.markEnd(m.createLiteral(e),r)):m.markEnd(m.createIdentifier(e.value),r)}function oe(){var e,r,n,o,i,s;return s=g,(e=g).type===t.Identifier?(n=ne(),"get"!==e.value||Y(":")?"set"!==e.value||Y(":")?(W(":"),o=me(),m.markEnd(m.createProperty("init",n,o),s)):(r=ne(),W("("),(e=g).type!==t.Identifier?(W(")"),V(e,a.UnexpectedToken,e.value),o=re([])):(i=[ve()],W(")"),o=re(i,e)),m.markEnd(m.createProperty("set",r,o),s)):(r=ne(),W("("),W(")"),o=re([]),m.markEnd(m.createProperty("get",r,o),s))):e.type!==t.EOF&&e.type!==t.Punctuator?(r=ne(),W(":"),o=me(),m.markEnd(m.createProperty("init",r,o),s)):void K(e)}function ie(){var e,r,n,s;if(Y("("))return function(){var e;return W("("),e=ge(),W(")"),e}();if(Y("["))return function(){var e,t=[];for(e=g,W("[");!Y("]");)Y(",")?($(),t.push(null)):(t.push(me()),Y("]")||W(","));return $(),m.markEnd(m.createArrayExpression(t),e)}();if(Y("{"))return function(){var e,t,r,n,s,c=[],u={},l=String;for(s=g,W("{");!Y("}");)t=(e=oe()).key.type===o.Identifier?e.key.name:l(e.key.value),n="init"===e.kind?i.Data:"get"===e.kind?i.Get:i.Set,r="$"+t,Object.prototype.hasOwnProperty.call(u,r)?(u[r]===i.Data?p&&n===i.Data?V({},a.StrictDuplicateProperty):n!==i.Data&&V({},a.AccessorDataProperty):n===i.Data?V({},a.AccessorDataProperty):u[r]&n&&V({},a.AccessorGetSet),u[r]|=n):u[r]=n,c.push(e),Y("}")||W(",");return W("}"),m.markEnd(m.createObjectExpression(c),s)}();if(e=g.type,s=g,e===t.Identifier)n=m.createIdentifier($().value);else if(e===t.StringLiteral||e===t.NumericLiteral)p&&g.octal&&V(g,a.StrictOctalLiteral),n=m.createLiteral($());else if(e===t.Keyword){if(Z("function"))return function(){var e,t,r,n,o,i,s,c,u,l=null;return u=g,Q("function"),Y("(")||(e=g,l=ve(),p?D(e.value)&&V(e,a.StrictFunctionName):D(e.value)?(r=e,n=a.StrictFunctionName):P(e.value)&&(r=e,n=a.StrictReservedWord)),o=Ce(r),i=o.params,t=o.stricted,r=o.firstRestricted,o.message&&(n=o.message),c=p,s=Se(),p&&r&&X(r,n),p&&t&&V(t,n),p=c,m.markEnd(m.createFunctionExpression(l,i,[],s),u)}();Z("this")?($(),n=m.createThisExpression()):K($())}else e===t.BooleanLiteral?((r=$()).value="true"===r.value,n=m.createLiteral(r)):e===t.NullLiteral?((r=$()).value=null,n=m.createLiteral(r)):Y("/")||Y("/=")?(n=void 0!==v.tokens?m.createLiteral(M()):m.createLiteral(L()),z()):K($());return m.markEnd(n,s)}function ae(){var e=[];if(W("("),!Y(")"))for(;l<f&&(e.push(me()),!Y(")"));)W(",");return W(")"),e}function se(){var e,r;return r=g,function(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}(e=$())||K(e),m.markEnd(m.createIdentifier(e.value),r)}function ce(){return W("."),se()}function ue(){var e;return W("["),e=ge(),W("]"),e}function pe(){var e,t,r;return r=g,Q("new"),e=function(){var e,t,r,n;for(n=g,e=y.allowIn,t=Z("new")?pe():ie(),y.allowIn=e;Y(".")||Y("[");)Y("[")?(r=ue(),t=m.createMemberExpression("[",t,r)):(r=ce(),t=m.createMemberExpression(".",t,r)),m.markEnd(t,n);return t}(),t=Y("(")?ae():[],m.markEnd(m.createNewExpression(e,t),r)}function le(){var e,r,n=g;return e=function(){var e,t,r,n,o;for(o=g,e=y.allowIn,y.allowIn=!0,t=Z("new")?pe():ie(),y.allowIn=e;;){if(Y("."))n=ce(),t=m.createMemberExpression(".",t,n);else if(Y("("))r=ae(),t=m.createCallExpression(t,r);else{if(!Y("["))break;n=ue(),t=m.createMemberExpression("[",t,n)}m.markEnd(t,o)}return t}(),g.type===t.Punctuator&&(!Y("++")&&!Y("--")||J()||(p&&e.type===o.Identifier&&D(e.name)&&V({},a.StrictLHSPostfix),te(e)||V({},a.InvalidLHSInAssignment),r=$(),e=m.markEnd(m.createPostfixExpression(r.value,e),n))),e}function de(){var e,r,n;return g.type!==t.Punctuator&&g.type!==t.Keyword?r=le():Y("++")||Y("--")?(n=g,e=$(),r=de(),p&&r.type===o.Identifier&&D(r.name)&&V({},a.StrictLHSPrefix),te(r)||V({},a.InvalidLHSInAssignment),r=m.createUnaryExpression(e.value,r),r=m.markEnd(r,n)):Y("+")||Y("-")||Y("~")||Y("!")?(n=g,e=$(),r=de(),r=m.createUnaryExpression(e.value,r),r=m.markEnd(r,n)):Z("delete")||Z("void")||Z("typeof")?(n=g,e=$(),r=de(),r=m.createUnaryExpression(e.value,r),r=m.markEnd(r,n),p&&"delete"===r.operator&&r.argument.type===o.Identifier&&V({},a.StrictDelete)):r=le(),r}function he(e,r){var n=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":n=1;break;case"&&":n=2;break;case"|":n=3;break;case"^":n=4;break;case"&":n=5;break;case"==":case"!=":case"===":case"!==":n=6;break;case"<":case">":case"<=":case">=":case"instanceof":n=7;break;case"in":n=r?7:0;break;case"<<":case">>":case">>>":n=8;break;case"+":case"-":n=9;break;case"*":case"/":case"%":n=11}return n}function fe(){var e,t,r,n,o;return o=g,e=function(){var e,t,r,n,o,i,a,s,c,u;if(e=g,c=de(),0===(o=he(n=g,y.allowIn)))return c;for(n.prec=o,$(),t=[e,g],i=[c,n,a=de()];(o=he(g,y.allowIn))>0;){for(;i.length>2&&o<=i[i.length-2].prec;)a=i.pop(),s=i.pop().value,c=i.pop(),r=m.createBinaryExpression(s,c,a),t.pop(),e=t[t.length-1],m.markEnd(r,e),i.push(r);(n=$()).prec=o,i.push(n),t.push(g),r=de(),i.push(r)}for(r=i[u=i.length-1],t.pop();u>1;)r=m.createBinaryExpression(i[u-1].value,i[u-2],r),u-=2,e=t.pop(),m.markEnd(r,e);return r}(),Y("?")&&($(),t=y.allowIn,y.allowIn=!0,r=me(),y.allowIn=t,W(":"),n=me(),e=m.createConditionalExpression(e,r,n),m.markEnd(e,o)),e}function me(){var e,r,n,i,s,c;return e=g,s=g,i=r=fe(),g.type!==t.Punctuator||"="!==(c=g.value)&&"*="!==c&&"/="!==c&&"%="!==c&&"+="!==c&&"-="!==c&&"<<="!==c&&">>="!==c&&">>>="!==c&&"&="!==c&&"^="!==c&&"|="!==c||(te(r)||V({},a.InvalidLHSInAssignment),p&&r.type===o.Identifier&&D(r.name)&&V(e,a.StrictLHSAssignment),e=$(),n=me(),i=m.markEnd(m.createAssignmentExpression(e.value,r,n),s)),i}function ge(){var e,t=g;if(e=me(),Y(",")){for(e=m.createSequenceExpression([e]);l<f&&Y(",");)$(),e.expressions.push(me());m.markEnd(e,t)}return e}function ye(){var e,t;return t=g,W("{"),e=function(){for(var e,t=[];l<f&&!Y("}")&&void 0!==(e=De());)t.push(e);return t}(),W("}"),m.markEnd(m.createBlockStatement(e),t)}function ve(){var e,r;return r=g,(e=$()).type!==t.Identifier&&K(e),m.markEnd(m.createIdentifier(e.value),r)}function be(e){var t,r,n=null;return r=g,t=ve(),p&&D(t.name)&&V({},a.StrictVarName),"const"===e?(W("="),n=me()):Y("=")&&($(),n=me()),m.markEnd(m.createVariableDeclarator(t,n),r)}function we(e){var t=[];do{if(t.push(be(e)),!Y(","))break;$()}while(l<f);return t}function xe(){var e,t,r,n,o,i,s,c,u,p;return e=t=r=null,Q("for"),W("("),Y(";")?$():(Z("var")||Z("let")?(y.allowIn=!1,p=g,c=$(),u=we(),e=m.markEnd(m.createVariableDeclaration(u,c.value),p),y.allowIn=!0,1===e.declarations.length&&Z("in")&&($(),n=e,o=ge(),e=null)):(y.allowIn=!1,e=ge(),y.allowIn=!0,Z("in")&&(te(e)||V({},a.InvalidLHSInForIn),$(),n=e,o=ge(),e=null)),void 0===n&&W(";")),void 0===n&&(Y(";")||(t=ge()),W(";"),Y(")")||(r=ge())),W(")"),s=y.inIteration,y.inIteration=!0,i=_e(),y.inIteration=s,void 0===n?m.createForStatement(e,t,r,i):m.createForInStatement(n,o,i)}function Ee(){var e,t,r,n=[];for(r=g,Z("default")?($(),e=null):(Q("case"),e=ge()),W(":");l<f&&!(Y("}")||Z("default")||Z("case"));)t=_e(),n.push(t);return m.markEnd(m.createSwitchCase(e,n),r)}function ke(){var e,t,r,n,o=[],i=null;return Q("try"),e=ye(),Z("catch")&&o.push((n=g,Q("catch"),W("("),Y(")")&&K(g),t=ve(),p&&D(t.name)&&V({},a.StrictCatchVariable),W(")"),r=ye(),m.markEnd(m.createCatchClause(t,r),n))),Z("finally")&&($(),i=ye()),0!==o.length||i||X({},a.NoCatchOrFinally),m.createTryStatement(e,[],o,i)}function _e(){var e,r,n,i,s,c,d,h,v,b=g.type;if(b===t.EOF&&K(g),b===t.Punctuator&&"{"===g.value)return ye();if(i=g,b===t.Punctuator)switch(g.value){case";":return m.markEnd((W(";"),m.createEmptyStatement()),i);case"(":return m.markEnd(function(){var e=ge();return ee(),m.createExpressionStatement(e)}(),i)}if(b===t.Keyword)switch(g.value){case"break":return m.markEnd(function(){var e,r=null;return Q("break"),59===u.charCodeAt(l)?($(),y.inIteration||y.inSwitch||X({},a.IllegalBreak),m.createBreakStatement(null)):J()?(y.inIteration||y.inSwitch||X({},a.IllegalBreak),m.createBreakStatement(null)):(g.type===t.Identifier&&(e="$"+(r=ve()).name,Object.prototype.hasOwnProperty.call(y.labelSet,e)||X({},a.UnknownLabel,r.name)),ee(),null!==r||y.inIteration||y.inSwitch||X({},a.IllegalBreak),m.createBreakStatement(r))}(),i);case"continue":return m.markEnd(function(){var e,r=null;return Q("continue"),59===u.charCodeAt(l)?($(),y.inIteration||X({},a.IllegalContinue),m.createContinueStatement(null)):J()?(y.inIteration||X({},a.IllegalContinue),m.createContinueStatement(null)):(g.type===t.Identifier&&(e="$"+(r=ve()).name,Object.prototype.hasOwnProperty.call(y.labelSet,e)||X({},a.UnknownLabel,r.name)),ee(),null!==r||y.inIteration||X({},a.IllegalContinue),m.createContinueStatement(r))}(),i);case"debugger":return m.markEnd((Q("debugger"),ee(),m.createDebuggerStatement()),i);case"do":return m.markEnd((Q("do"),v=y.inIteration,y.inIteration=!0,d=_e(),y.inIteration=v,Q("while"),W("("),h=ge(),W(")"),Y(";")&&$(),m.createDoWhileStatement(d,h)),i);case"for":return m.markEnd(xe(),i);case"function":return m.markEnd(Pe(),i);case"if":return m.markEnd(function(){var e,t,r;return Q("if"),W("("),e=ge(),W(")"),t=_e(),Z("else")?($(),r=_e()):r=null,m.createIfStatement(e,t,r)}(),i);case"return":return m.markEnd((c=null,Q("return"),y.inFunctionBody||V({},a.IllegalReturn),32===u.charCodeAt(l)&&S(u.charCodeAt(l+1))?(c=ge(),ee(),m.createReturnStatement(c)):J()?m.createReturnStatement(null):(Y(";")||Y("}")||g.type===t.EOF||(c=ge()),ee(),m.createReturnStatement(c))),i);case"switch":return m.markEnd(function(){var e,t,r,n,o;if(Q("switch"),W("("),e=ge(),W(")"),W("{"),t=[],Y("}"))return $(),m.createSwitchStatement(e,t);for(n=y.inSwitch,y.inSwitch=!0,o=!1;l<f&&!Y("}");)null===(r=Ee()).test&&(o&&X({},a.MultipleDefaultsInSwitch),o=!0),t.push(r);return y.inSwitch=n,W("}"),m.createSwitchStatement(e,t)}(),i);case"throw":return m.markEnd(function(){var e;return Q("throw"),J()&&X({},a.NewlineAfterThrow),e=ge(),ee(),m.createThrowStatement(e)}(),i);case"try":return m.markEnd(ke(),i);case"var":return m.markEnd((Q("var"),s=we(),ee(),m.createVariableDeclaration(s,"var")),i);case"while":return m.markEnd(function(){var e,t,r;return Q("while"),W("("),e=ge(),W(")"),r=y.inIteration,y.inIteration=!0,t=_e(),y.inIteration=r,m.createWhileStatement(e,t)}(),i);case"with":return m.markEnd(function(){var e,t;return p&&(T(),V({},a.StrictModeWith)),Q("with"),W("("),e=ge(),W(")"),t=_e(),m.createWithStatement(e,t)}(),i)}return(e=ge()).type===o.Identifier&&Y(":")?($(),n="$"+e.name,Object.prototype.hasOwnProperty.call(y.labelSet,n)&&X({},a.Redeclaration,"Label",e.name),y.labelSet[n]=!0,r=_e(),delete y.labelSet[n],m.markEnd(m.createLabeledStatement(e,r),i)):(ee(),m.markEnd(m.createExpressionStatement(e),i))}function Se(){var e,r,n,i,s,c,d,h,v=[];for(h=g,W("{");l<f&&g.type===t.StringLiteral&&(r=g,e=De(),v.push(e),e.expression.type===o.Literal);)"use strict"===u.slice(r.start+1,r.end-1)?(p=!0,n&&V(n,a.StrictOctalLiteral)):!n&&r.octal&&(n=r);for(i=y.labelSet,s=y.inIteration,c=y.inSwitch,d=y.inFunctionBody,y.labelSet={},y.inIteration=!1,y.inSwitch=!1,y.inFunctionBody=!0;l<f&&!Y("}")&&void 0!==(e=De());)v.push(e);return W("}"),y.labelSet=i,y.inIteration=s,y.inSwitch=c,y.inFunctionBody=d,m.markEnd(m.createBlockStatement(v),h)}function Ce(e){var t,r,n,o,i,s,c=[];if(W("("),!Y(")"))for(o={};l<f&&(r=g,t=ve(),i="$"+r.value,p?(D(r.value)&&(n=r,s=a.StrictParamName),Object.prototype.hasOwnProperty.call(o,i)&&(n=r,s=a.StrictParamDupe)):e||(D(r.value)?(e=r,s=a.StrictParamName):P(r.value)?(e=r,s=a.StrictReservedWord):Object.prototype.hasOwnProperty.call(o,i)&&(e=r,s=a.StrictParamDupe)),c.push(t),o[i]=!0,!Y(")"));)W(",");return W(")"),{params:c,stricted:n,firstRestricted:e,message:s}}function Pe(){var e,t,r,n,o,i,s,c,u,l;return l=g,Q("function"),n=g,e=ve(),p?D(n.value)&&V(n,a.StrictFunctionName):D(n.value)?(s=n,c=a.StrictFunctionName):P(n.value)&&(s=n,c=a.StrictReservedWord),t=(i=Ce(s)).params,o=i.stricted,s=i.firstRestricted,i.message&&(c=i.message),u=p,r=Se(),p&&s&&X(s,c),p&&o&&V(o,c),p=u,m.markEnd(m.createFunctionDeclaration(e,t,[],r),l)}function De(){if(g.type===t.Keyword)switch(g.value){case"const":case"let":return e=g.value,n=g,Q(e),r=we(e),ee(),m.markEnd(m.createVariableDeclaration(r,e),n);case"function":return Pe();default:return _e()}var e,r,n;if(g.type!==t.EOF)return _e()}function Ae(){var e,r;return T(),z(),r=g,p=!1,e=function(){for(var e,r,n,i=[];l<f&&(r=g).type===t.StringLiteral&&(e=De(),i.push(e),e.expression.type===o.Literal);)"use strict"===u.slice(r.start+1,r.end-1)?(p=!0,n&&V(n,a.StrictOctalLiteral)):!n&&r.octal&&(n=r);for(;l<f&&void 0!==(e=De());)i.push(e);return i}(),m.markEnd(m.createProgram(e),r)}function Oe(){var e,t,r,n=[];for(e=0;e<v.tokens.length;++e)r={type:(t=v.tokens[e]).type,value:t.value},v.range&&(r.range=t.range),v.loc&&(r.loc=t.loc),n.push(r);v.tokens=n}(r={})[(t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",r[t.EOF]="<end>",r[t.Identifier]="Identifier",r[t.Keyword]="Keyword",r[t.NullLiteral]="Null",r[t.NumericLiteral]="Numeric",r[t.Punctuator]="Punctuator",r[t.StringLiteral]="String",r[t.RegularExpression]="RegularExpression",n=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],o={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},i={Data:1,Get:2,Set:4},a={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},s={NonAsciiIdentifierStart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]"),NonAsciiIdentifierPart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]")},c={name:"SyntaxTree",processComment:function(e){var t,r;if(!(e.type===o.Program&&e.body.length>0)){for(v.trailingComments.length>0?v.trailingComments[0].range[0]>=e.range[1]?(r=v.trailingComments,v.trailingComments=[]):v.trailingComments.length=0:v.bottomRightStack.length>0&&v.bottomRightStack[v.bottomRightStack.length-1].trailingComments&&v.bottomRightStack[v.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(r=v.bottomRightStack[v.bottomRightStack.length-1].trailingComments,delete v.bottomRightStack[v.bottomRightStack.length-1].trailingComments);v.bottomRightStack.length>0&&v.bottomRightStack[v.bottomRightStack.length-1].range[0]>=e.range[0];)t=v.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):v.leadingComments.length>0&&v.leadingComments[v.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=v.leadingComments,v.leadingComments=[]),r&&(e.trailingComments=r),v.bottomRightStack.push(e)}},markEnd:function(e,t){return v.range&&(e.range=[t.start,l]),v.loc&&(e.loc=new H(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),d,l-h),this.postProcess(e)),v.attachComment&&this.processComment(e),e},postProcess:function(e){return v.source&&(e.loc.source=v.source),e},createArrayExpression:function(e){return{type:o.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,r){return{type:o.AssignmentExpression,operator:e,left:t,right:r}},createBinaryExpression:function(e,t,r){return{type:"||"===e||"&&"===e?o.LogicalExpression:o.BinaryExpression,operator:e,left:t,right:r}},createBlockStatement:function(e){return{type:o.BlockStatement,body:e}},createBreakStatement:function(e){return{type:o.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:o.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:o.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,r){return{type:o.ConditionalExpression,test:e,consequent:t,alternate:r}},createContinueStatement:function(e){return{type:o.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:o.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:o.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:o.EmptyStatement}},createExpressionStatement:function(e){return{type:o.ExpressionStatement,expression:e}},createForStatement:function(e,t,r,n){return{type:o.ForStatement,init:e,test:t,update:r,body:n}},createForInStatement:function(e,t,r){return{type:o.ForInStatement,left:e,right:t,body:r,each:!1}},createFunctionDeclaration:function(e,t,r,n){return{type:o.FunctionDeclaration,id:e,params:t,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,r,n){return{type:o.FunctionExpression,id:e,params:t,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:o.Identifier,name:e}},createIfStatement:function(e,t,r){return{type:o.IfStatement,test:e,consequent:t,alternate:r}},createLabeledStatement:function(e,t){return{type:o.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:o.Literal,value:e.value,raw:u.slice(e.start,e.end)}},createMemberExpression:function(e,t,r){return{type:o.MemberExpression,computed:"["===e,object:t,property:r}},createNewExpression:function(e,t){return{type:o.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:o.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:o.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:o.Program,body:e}},createProperty:function(e,t,r){return{type:o.Property,key:t,value:r,kind:e}},createReturnStatement:function(e){return{type:o.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:o.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:o.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:o.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:o.ThisExpression}},createThrowStatement:function(e){return{type:o.ThrowStatement,argument:e}},createTryStatement:function(e,t,r,n){return{type:o.TryStatement,block:e,guardedHandlers:t,handlers:r,finalizer:n}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:o.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:o.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:o.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:o.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:o.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:o.WithStatement,object:e,body:t}}},e.version="1.2.2",e.tokenize=function(e,r){var n;"string"==typeof e||e instanceof String||(e=String(e)),m=c,l=0,d=(u=e).length>0?1:0,h=0,f=u.length,g=null,y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},v={},(r=r||{}).tokens=!0,v.tokens=[],v.tokenize=!0,v.openParenToken=-1,v.openCurlyToken=-1,v.range="boolean"==typeof r.range&&r.range,v.loc="boolean"==typeof r.loc&&r.loc,"boolean"==typeof r.comment&&r.comment&&(v.comments=[]),"boolean"==typeof r.tolerant&&r.tolerant&&(v.errors=[]);try{if(z(),g.type===t.EOF)return v.tokens;for($();g.type!==t.EOF;)try{$()}catch(e){if(v.errors){v.errors.push(e);break}throw e}Oe(),n=v.tokens,void 0!==v.comments&&(n.comments=v.comments),void 0!==v.errors&&(n.errors=v.errors)}catch(e){throw e}finally{v={}}return n},e.parse=function(e,t){var r,n;n=String,"string"==typeof e||e instanceof String||(e=n(e)),m=c,l=0,d=(u=e).length>0?1:0,h=0,f=u.length,g=null,y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},v={},void 0!==t&&(v.range="boolean"==typeof t.range&&t.range,v.loc="boolean"==typeof t.loc&&t.loc,v.attachComment="boolean"==typeof t.attachComment&&t.attachComment,v.loc&&null!==t.source&&void 0!==t.source&&(v.source=n(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(v.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(v.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(v.errors=[]),v.attachComment&&(v.range=!0,v.comments=[],v.bottomRightStack=[],v.trailingComments=[],v.leadingComments=[]));try{r=Ae(),void 0!==v.comments&&(r.comments=v.comments),void 0!==v.tokens&&(Oe(),r.tokens=v.tokens),void 0!==v.errors&&(r.errors=v.errors)}catch(e){throw e}finally{v={}}return r},e.Syntax=function(){var e,t={};for(e in"function"==typeof Object.create&&(t=Object.create(null)),o)o.hasOwnProperty(e)&&(t[e]=o[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()}))},{}],1:[function(e,t,r){(function(n){var o=function(){var e={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(e,r,n,o,i,a,s){o.ast||(o.ast=t,t.initialize());var c=a.length-1;switch(i){case 1:return o.ast.set({expression:{type:"root",value:a[c]}}),o.ast.unshift(),o.ast.yield();case 2:return o.ast.set({expression:{type:"root",value:a[c-1]}}),o.ast.unshift(),o.ast.yield();case 3:return o.ast.unshift(),o.ast.yield();case 4:return o.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:a[c-1]}}),o.ast.unshift(),o.ast.yield();case 5:case 6:break;case 7:o.ast.set({operation:"member"}),o.ast.push();break;case 8:o.ast.set({operation:"subscript"}),o.ast.push();break;case 9:o.ast.set({scope:"child"});break;case 10:o.ast.set({scope:"descendant"});break;case 11:break;case 12:o.ast.set({scope:"child",operation:"member"});break;case 13:break;case 14:o.ast.set({expression:{type:"wildcard",value:a[c]}});break;case 15:o.ast.set({expression:{type:"identifier",value:a[c]}});break;case 16:o.ast.set({expression:{type:"script_expression",value:a[c]}});break;case 17:o.ast.set({expression:{type:"numeric_literal",value:parseInt(a[c])}});break;case 18:break;case 19:o.ast.set({scope:"child"});break;case 20:o.ast.set({scope:"descendant"});break;case 21:case 22:case 23:break;case 24:a[c].length>1?o.ast.set({expression:{type:"union",value:a[c]}}):this.$=a[c];break;case 25:this.$=[a[c]];break;case 26:this.$=a[c-2].concat(a[c]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(a[c])}},o.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:a[c]}},o.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:a[c]}},o.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:a[c]}},o.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:a[c]}},o.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:a[c]}},o.ast.set(this.$);break;case 33:case 34:this.$=a[c]}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],o=[],i=this.table,a="",s=0,c=0,u=0,p=2,l=1,d=o.slice.call(arguments,1);this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;o.push(h);var f=this.lexer.options&&this.lexer.options.ranges;function m(){var e;return"number"!=typeof(e=t.lexer.lex()||l)&&(e=t.symbols_[e]||e),e}"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,y,v,b,w,x,E,k,_,S={};;){if(v=r[r.length-1],this.defaultActions[v]?b=this.defaultActions[v]:(null==g&&(g=m()),b=i[v]&&i[v][g]),void 0===b||!b.length||!b[0]){var C="";for(x in _=[],i[v])this.terminals_[x]&&x>p&&_.push("'"+this.terminals_[x]+"'");C=this.lexer.showPosition?"Parse error on line "+(s+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(s+1)+": Unexpected "+(g==l?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:h,expected:_})}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+g);switch(b[0]){case 1:r.push(g),n.push(this.lexer.yytext),o.push(this.lexer.yylloc),r.push(b[1]),g=null,y?(g=y,y=null):(c=this.lexer.yyleng,a=this.lexer.yytext,s=this.lexer.yylineno,h=this.lexer.yylloc,u>0&&u--);break;case 2:if(E=this.productions_[b[1]][1],S.$=n[n.length-E],S._$={first_line:o[o.length-(E||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(E||1)].first_column,last_column:o[o.length-1].last_column},f&&(S._$.range=[o[o.length-(E||1)].range[0],o[o.length-1].range[1]]),void 0!==(w=this.performAction.apply(S,[a,c,s,this.yy,b[1],n,o].concat(d))))return w;E&&(r=r.slice(0,-1*E*2),n=n.slice(0,-1*E),o=o.slice(0,-1*E)),r.push(this.productions_[b[1]][0]),n.push(S.$),o.push(S._$),k=i[r[r.length-2]][r[r.length-1]],r.push(k);break;case 3:return!0}}return!0}},t={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(e){for(var t in e)this._node[t]=e[t];return this._node},node:function(e){return arguments.length&&(this._node=e),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var e=this._nodes;return this.initialize(),e}},r={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((r=this._input.match(this.rules[o[i]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=i,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,o[i])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,o[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return t.yytext=t.yytext.substr(1,t.yyleng-2),32;case 11:return t.yytext=t.yytext.substr(1,t.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function n(){this.yy={}}return e.lexer=r,n.prototype=e,e.Parser=n,new n}();void 0!==e&&void 0!==r&&(r.parser=o,r.Parser=o.Parser,r.parse=function(){return o.parse.apply(o,arguments)},r.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),n.exit(1));var o=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return r.parser.parse(o)},void 0!==t&&e.main===t&&r.main(n.argv.slice(1)))}).call(this,e("_process"))},{_process:14,fs:12,path:13}],2:[function(e,t,r){t.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(e,t,r){var n=e("./dict"),o=e("fs"),i={lex:{macros:{esc:"\\\\",int:n.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[n.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[n.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[n.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};o.readFileSync&&(i.moduleInclude=o.readFileSync(e.resolve("../include/module.js")),i.actionInclude=o.readFileSync(e.resolve("../include/action.js"))),t.exports=i},{"./dict":2,fs:12}],4:[function(e,t,r){var n=e("./aesprim"),o=e("./slice"),i=e("static-eval"),a=e("underscore").uniq,s=function(){return this.initialize.apply(this,arguments)};function c(t,r,o){var i=e("./index"),a=h(n.parse(r).body[0].expression,{"@":t.value}),s=o.replace(/\{\{\s*value\s*\}\}/g,a),c=i.nodes(t.value,s);return c.forEach((function(e){e.path=t.path.concat(e.path.slice(1))})),c}function u(e){return Array.isArray(e)}function p(e){return function(t,r,n,o){var i=t.value,a=t.path,s=[],c=function(t,i){var a;u(t)?(t.forEach((function(e,t){s.length>=o||n(t,e,r)&&s.push({path:i.concat(t),value:e})})),t.forEach((function(t,r){s.length>=o||e&&c(t,i.concat(r))}))):(a=t)&&!(a instanceof Array)&&a instanceof Object&&(this.keys(t).forEach((function(e){s.length>=o||n(e,t[e],r)&&s.push({path:i.concat(e),value:t[e]})})),this.keys(t).forEach((function(r){s.length>=o||e&&c(t[r],i.concat(r))})))}.bind(this);return c(i,a),s}}function l(e){return function(t,r,n){return this.descend(r,t.expression.value,e,n)}}function d(e){return function(t,r,n){return this.traverse(r,t.expression.value,e,n)}}function h(){try{return i.apply(this,arguments)}catch(e){}}function f(e){return e=e.filter((function(e){return e})),a(e,(function(e){return e.path.map((function(e){return String(e).replace("-","--")})).join("-")}))}function m(e){var t=String(e);return t.match(/^-?[0-9]+$/)?parseInt(t):null}s.prototype.initialize=function(){this.traverse=p(!0),this.descend=p()},s.prototype.keys=Object.keys,s.prototype.resolve=function(e){var t=[e.operation,e.scope,e.expression.type].join("-"),r=this._fns[t];if(!r)throw new Error("couldn't resolve key: "+t);return r.bind(this)},s.prototype.register=function(e,t){if(!t instanceof Function)throw new Error("handler must be a function");this._fns[e]=t},s.prototype._fns={"member-child-identifier":function(e,t){var r=e.expression.value,n=t.value;if(n instanceof Object&&r in n)return[{value:n[r],path:t.path.concat(r)}]},"member-descendant-identifier":d((function(e,t,r){return e==r})),"subscript-child-numeric_literal":l((function(e,t,r){return e===r})),"member-child-numeric_literal":l((function(e,t,r){return String(e)===String(r)})),"subscript-descendant-numeric_literal":d((function(e,t,r){return e===r})),"member-child-wildcard":l((function(){return!0})),"member-descendant-wildcard":d((function(){return!0})),"subscript-descendant-wildcard":d((function(){return!0})),"subscript-child-wildcard":l((function(){return!0})),"subscript-child-slice":function(e,t){if(u(t.value)){var r=e.expression.value.split(":").map(m),n=t.value.map((function(e,r){return{value:e,path:t.path.concat(r)}}));return o.apply(null,[n].concat(r))}},"subscript-child-union":function(e,t){var r=[];return e.expression.value.forEach((function(e){var n={operation:"subscript",scope:"child",expression:e.expression},o=this.resolve(n)(n,t);o&&(r=r.concat(o))}),this),f(r)},"subscript-descendant-union":function(t,r,n){var o=e(".."),i=this,a=[];return o.nodes(r,"$..*").slice(1).forEach((function(e){a.length>=n||t.expression.value.forEach((function(t){var r={operation:"subscript",scope:"child",expression:t.expression},n=i.resolve(r)(r,e);a=a.concat(n)}))})),f(a)},"subscript-child-filter_expression":function(e,t,r){var o=e.expression.value.slice(2,-1),i=n.parse(o).body[0].expression;return this.descend(t,null,(function(e,t){return h(i,{"@":t})}),r)},"subscript-descendant-filter_expression":function(e,t,r){var o=e.expression.value.slice(2,-1),i=n.parse(o).body[0].expression;return this.traverse(t,null,(function(e,t){return h(i,{"@":t})}),r)},"subscript-child-script_expression":function(e,t){return c(t,e.expression.value.slice(1,-1),"$[{{value}}]")},"member-child-script_expression":function(e,t){return c(t,e.expression.value.slice(1,-1),"$.{{value}}")},"member-descendant-script_expression":function(e,t){return c(t,e.expression.value.slice(1,-1),"$..value")}},s.prototype._fns["subscript-child-string_literal"]=s.prototype._fns["member-child-identifier"],s.prototype._fns["member-descendant-numeric_literal"]=s.prototype._fns["subscript-descendant-string_literal"]=s.prototype._fns["member-descendant-identifier"],t.exports=s},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(e,t,r){var n=e("assert"),o=e("./dict"),i=e("./parser"),a=e("./handlers"),s=function(){this.initialize.apply(this,arguments)};function c(e){return"[object String]"==Object.prototype.toString.call(e)}s.prototype.initialize=function(){this.parser=new i,this.handlers=new a},s.prototype.parse=function(e){return n.ok(c(e),"we need a path"),this.parser.parse(e)},s.prototype.parent=function(e,t){n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path");var r=this.nodes(e,t)[0];return r.path.pop(),this.value(e,r.path)},s.prototype.apply=function(e,t,r){n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),n.equal(typeof r,"function","fn needs to be function");var o=this.nodes(e,t).sort((function(e,t){return t.path.length-e.path.length}));return o.forEach((function(t){var n=t.path.pop(),o=this.value(e,this.stringify(t.path)),i=t.value=r.call(e,o[n]);o[n]=i}),this),o},s.prototype.value=function(e,t,r){if(n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),arguments.length>=3){var o=this.nodes(e,t).shift();if(!o)return this._vivify(e,t,r);var i=o.path.slice(-1).shift(),a=this.parent(e,this.stringify(o.path));a[i]=r}return this.query(e,this.stringify(t),1).shift()},s.prototype._vivify=function(e,t,r){var o=this;n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path");var i=this.parser.parse(t).map((function(e){return e.expression.value})),a=function(t,r){var n=t.pop(),i=o.value(e,t);i||(a(t.concat(),"string"==typeof n?{}:[]),i=o.value(e,t)),i[n]=r};return a(i,r),this.query(e,t)[0]},s.prototype.query=function(e,t,r){return n.ok(e instanceof Object,"obj needs to be an object"),n.ok(c(t),"we need a path"),this.nodes(e,t,r).map((function(e){return e.value}))},s.prototype.paths=function(e,t,r){return n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),this.nodes(e,t,r).map((function(e){return e.path}))},s.prototype.nodes=function(e,t,r){if(n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),0===r)return[];var o=this.parser.parse(t),i=this.handlers,a=[{path:["$"],value:e}],s=[];return o.length&&"root"==o[0].expression.type&&o.shift(),o.length?(o.forEach((function(e,t){if(!(s.length>=r)){var n=i.resolve(e),c=[];a.forEach((function(i){if(!(s.length>=r)){var a=n(e,i,r);t==o.length-1?s=s.concat(a||[]):c=c.concat(a||[])}})),a=c}})),r?s.slice(0,r):s):a},s.prototype.stringify=function(e){n.ok(e,"we need a path");var t="$",r={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return(e=this._normalize(e)).forEach((function(e){if("root"!=e.expression.type){var n,o=[e.scope,e.operation].join("-"),i=r[o];if(n="string_literal"==e.expression.type?JSON.stringify(e.expression.value):e.expression.value,!i)throw new Error("couldn't find template "+o);t+=i.replace(/{{value}}/,n)}})),t},s.prototype._normalize=function(e){if(n.ok(e,"we need a path"),"string"==typeof e)return this.parser.parse(e);if(Array.isArray(e)&&"string"==typeof e[0]){var t=[{expression:{type:"root",value:"$"}}];return e.forEach((function(e,r){if("$"!=e||0!==r)if("string"==typeof e&&e.match("^"+o.identifier+"$"))t.push({operation:"member",scope:"child",expression:{value:e,type:"identifier"}});else{var n="number"==typeof e?"numeric_literal":"string_literal";t.push({operation:"subscript",scope:"child",expression:{value:e,type:n}})}})),t}if(Array.isArray(e)&&"object"==typeof e[0])return e;throw new Error("couldn't understand path "+e)},s.Handlers=a,s.Parser=i;var u=new s;u.JSONPath=s,t.exports=u},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(e,t,r){var n=e("./grammar"),o=e("../generated/parser"),i=function(){var e=new o.Parser,t=e.parseError;return e.yy.parseError=function(){e.yy.ast&&e.yy.ast.initialize(),t.apply(e,arguments)},e};i.grammar=n,t.exports=i},{"../generated/parser":1,"./grammar":3}],7:[function(e,t,r){function n(e){return String(e).match(/^[0-9]+$/)?parseInt(e):Number.isFinite(e)?parseInt(e,10):0}t.exports=function(e,t,r,o){if("string"==typeof t)throw new Error("start cannot be a string");if("string"==typeof r)throw new Error("end cannot be a string");if("string"==typeof o)throw new Error("step cannot be a string");var i=e.length;if(0===o)throw new Error("step cannot be zero");if(o=o?n(o):1,r=r<0?i+r:r,t=n(0===(t=t<0?i+t:t)?0:t||(o>0?0:i-1)),r=n(0===r?0:r||(o>0?i:-1)),t=o>0?Math.max(0,t):Math.min(i,t),r=o>0?Math.min(r,i):Math.max(-1,r),o>0&&r<=t)return[];if(o<0&&t<=r)return[];for(var a=[],s=t;s!=r&&!(o<0&&s<=r||o>0&&s>=r);s+=o)a.push(e[s]);return a}},{}],8:[function(e,t,r){var n=e("util/"),o=Array.prototype.slice,i=Object.prototype.hasOwnProperty,a=t.exports=p;function s(e,t){return n.isUndefined(t)?""+t:n.isNumber(t)&&!isFinite(t)||n.isFunction(t)||n.isRegExp(t)?t.toString():t}function c(e,t){return n.isString(e)?e.length<t?e:e.slice(0,t):e}function u(e,t,r,n,o){throw new a.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:o})}function p(e,t){e||u(e,!0,t,"==",a.ok)}function l(e,t){if(e===t)return!0;if(n.isBuffer(e)&&n.isBuffer(t)){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return n.isDate(e)&&n.isDate(t)?e.getTime()===t.getTime():n.isRegExp(e)&&n.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:n.isObject(e)||n.isObject(t)?function(e,t){if(n.isNullOrUndefined(e)||n.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(n.isPrimitive(e)||n.isPrimitive(t))return e===t;var r=d(e),i=d(t);if(r&&!i||!r&&i)return!1;if(r)return e=o.call(e),t=o.call(t),l(e,t);var a,s,c=m(e),u=m(t);if(c.length!=u.length)return!1;for(c.sort(),u.sort(),s=c.length-1;s>=0;s--)if(c[s]!=u[s])return!1;for(s=c.length-1;s>=0;s--)if(a=c[s],!l(e[a],t[a]))return!1;return!0}(e,t):e==t}function d(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function h(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function f(e,t,r,o){var i;n.isString(r)&&(o=r,r=null);try{t()}catch(e){i=e}if(o=(r&&r.name?" ("+r.name+").":".")+(o?" "+o:"."),e&&!i&&u(i,r,"Missing expected exception"+o),!e&&h(i,r)&&u(i,r,"Got unwanted exception"+o),e&&i&&r&&!h(i,r)||!e&&i)throw i}a.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return c(JSON.stringify(e.actual,s),128)+" "+e.operator+" "+c(JSON.stringify(e.expected,s),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,o=t.name,i=n.indexOf("\n"+o);if(i>=0){var a=n.indexOf("\n",i+1);n=n.substring(a+1)}this.stack=n}}},n.inherits(a.AssertionError,Error),a.fail=u,a.ok=p,a.equal=function(e,t,r){e!=t&&u(e,t,r,"==",a.equal)},a.notEqual=function(e,t,r){e==t&&u(e,t,r,"!=",a.notEqual)},a.deepEqual=function(e,t,r){l(e,t)||u(e,t,r,"deepEqual",a.deepEqual)},a.notDeepEqual=function(e,t,r){l(e,t)&&u(e,t,r,"notDeepEqual",a.notDeepEqual)},a.strictEqual=function(e,t,r){e!==t&&u(e,t,r,"===",a.strictEqual)},a.notStrictEqual=function(e,t,r){e===t&&u(e,t,r,"!==",a.notStrictEqual)},a.throws=function(e,t,r){f.apply(this,[!0].concat(o.call(arguments)))},a.doesNotThrow=function(e,t){f.apply(this,[!1].concat(o.call(arguments)))},a.ifError=function(e){if(e)throw e};var m=Object.keys||function(e){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t}},{"util/":11}],9:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],10:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],11:[function(e,r,n){(function(t,r){var o=/%[sdj%]/g;n.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),c=n[r];r<i;c=n[++r])m(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},n.deprecate=function(e,o){if(v(r.process))return function(){return n.deprecate(e,o).apply(this,arguments)};if(!0===t.noDeprecation)return e;var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(o);t.traceDeprecation?console.trace(o):console.error(o),i=!0}return e.apply(this,arguments)}};var i,a={};function s(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(t)?r.showHidden=t:t&&n._extend(r,t),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),p(r,e,r.depth)}function c(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function u(e,t){return e}function p(e,t,r){if(e.customInspect&&t&&k(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(r,e);return y(o)||(o=p(e,o,r)),o}var i=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,t);if(i)return i;var a=Object.keys(t),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),E(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(t);if(0===a.length){if(k(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return l(t)}var u,w="",_=!1,S=["{","}"];return h(t)&&(_=!0,S=["[","]"]),k(t)&&(w=" [Function"+(t.name?": "+t.name:"")+"]"),b(t)&&(w=" "+RegExp.prototype.toString.call(t)),x(t)&&(w=" "+Date.prototype.toUTCString.call(t)),E(t)&&(w=" "+l(t)),0!==a.length||_&&0!=t.length?r<0?b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=_?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)D(t,String(a))?i.push(d(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,r,n,o,!0))})),i}(e,t,r,s,a):a.map((function(n){return d(e,t,r,s,n,_)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(u,w,S)):S[0]+w+S[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),D(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(r)?p(e,c.value,null):p(e,c.value,r-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===_(e)}function w(e){return"object"==typeof e&&null!==e}function x(e){return w(e)&&"[object Date]"===_(e)}function E(e){return w(e)&&("[object Error]"===_(e)||e instanceof Error)}function k(e){return"function"==typeof e}function _(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(v(i)&&(i=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var r=t.pid;a[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else a[e]=function(){};return a[e]},n.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=f,n.isNull=m,n.isNullOrUndefined=function(e){return null==e},n.isNumber=g,n.isString=y,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=v,n.isRegExp=b,n.isObject=w,n.isDate=x,n.isError=E,n.isFunction=k,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){console.log("%s - %s",P(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(e,t,r){},{}],13:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(r=a+"/"+r,o="/"===a.charAt(0))}return(o?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!o).join("/"))||"."},r.normalize=function(e){var i=r.isAbsolute(e),a="/"===o(e,-1);return(e=t(n(e.split("/"),(function(e){return!!e})),!i).join("/"))||i||(e="."),e&&a&&(e+="/"),(i?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var o=n(e.split("/")),i=n(t.split("/")),a=Math.min(o.length,i.length),s=a,c=0;c<a;c++)if(o[c]!==i[c]){s=c;break}var u=[];for(c=s;c<o.length;c++)u.push("..");return(u=u.concat(i.slice(s))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,o=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!o){n=i;break}}else o=!1;return-1===n?r?"/":".":r&&1===n?"/":e.slice(0,n)},r.basename=function(e,t){var r=function(e){"string"!=typeof e&&(e+="");var t,r=0,n=-1,o=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!o){r=t+1;break}}else-1===n&&(o=!1,n=t+1);return-1===n?"":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,o=!0,i=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===n&&(o=!1,n=a+1),46===s?-1===t?t=a:1!==i&&(i=1):-1!==t&&(i=-1);else if(!o){r=a+1;break}}return-1===t||-1===n||0===i||1===i&&t===n-1&&t===r+1?"":e.slice(t,n)};var o="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:14}],14:[function(e,t,r){var n,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,p=[],l=!1,d=-1;function h(){l&&u&&(l=!1,u.length?p=u.concat(p):d=-1,p.length&&f())}function f(){if(!l){var e=c(h);l=!0;for(var t=p.length;t;){for(u=p,p=[];++d<t;)u&&u[d].run();d=-1,t=p.length}u=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new m(e,t)),1!==p.length||l||c(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],15:[function(e,t,r){var n=e("escodegen").generate;t.exports=function(e,t){t||(t={});var r={},o=function e(o,i){if("Literal"===o.type)return o.value;if("UnaryExpression"===o.type){var a=e(o.argument);return"+"===o.operator?+a:"-"===o.operator?-a:"~"===o.operator?~a:"!"===o.operator?!a:r}if("ArrayExpression"===o.type){for(var s=[],c=0,u=o.elements.length;c<u;c++){if((y=e(o.elements[c]))===r)return r;s.push(y)}return s}if("ObjectExpression"===o.type){var p={};for(c=0;c<o.properties.length;c++){var l=null===(v=o.properties[c]).value?v.value:e(v.value);if(l===r)return r;p[v.key.value||v.key.name]=l}return p}if("BinaryExpression"===o.type||"LogicalExpression"===o.type){if((u=e(o.left))===r)return r;var d=e(o.right);if(d===r)return r;var h=o.operator;return"=="===h?u==d:"==="===h?u===d:"!="===h?u!=d:"!=="===h?u!==d:"+"===h?u+d:"-"===h?u-d:"*"===h?u*d:"/"===h?u/d:"%"===h?u%d:"<"===h?u<d:"<="===h?u<=d:">"===h?u>d:">="===h?u>=d:"|"===h?u|d:"&"===h?u&d:"^"===h?u^d:"&&"===h?u&&d:"||"===h?u||d:r}if("Identifier"===o.type)return{}.hasOwnProperty.call(t,o.name)?t[o.name]:r;if("ThisExpression"===o.type)return{}.hasOwnProperty.call(t,"this")?t.this:r;if("CallExpression"===o.type){var f=e(o.callee);if(f===r)return r;if("function"!=typeof f)return r;var m=o.callee.object?e(o.callee.object):r;m===r&&(m=null);var g=[];for(c=0,u=o.arguments.length;c<u;c++){var y;if((y=e(o.arguments[c]))===r)return r;g.push(y)}return f.apply(m,g)}var v;if("MemberExpression"===o.type)return(p=e(o.object))===r||"function"==typeof p?r:"Identifier"===o.property.type?p[o.property.name]:(v=e(o.property))===r?r:p[v];if("ConditionalExpression"===o.type)return(a=e(o.test))===r?r:e(a?o.consequent:o.alternate);if("ExpressionStatement"===o.type)return(a=e(o.expression))===r?r:a;if("ReturnStatement"===o.type)return e(o.argument);if("FunctionExpression"===o.type){var b=o.body.body,w={};for(Object.keys(t).forEach((function(e){w[e]=t[e]})),c=0;c<o.params.length;c++){var x=o.params[c];if("Identifier"!=x.type)return r;t[x.name]=null}for(var c in b)if(e(b[c])===r)return r;t=w;var E=Object.keys(t),k=E.map((function(e){return t[e]}));return Function(E.join(", "),"return "+n(o)).apply(null,k)}if("TemplateLiteral"===o.type){var _="";for(c=0;c<o.expressions.length;c++)_+=e(o.quasis[c]),_+=e(o.expressions[c]);return _+=e(o.quasis[c])}if("TaggedTemplateExpression"===o.type){var S=e(o.tag),C=o.quasi,P=C.quasis.map(e),D=C.expressions.map(e);return S.apply(null,[P].concat(D))}return"TemplateElement"===o.type?o.value.cooked:r}(e);return o===r?void 0:o}},{escodegen:12}],jsonpath:[function(e,t,r){t.exports=e("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")}).call(this,r(26))},function(e,t,r){const n=r(51)("fbp-spec:mocha"),o=r(117),{Runner:i}=o,a=r(93),s=r(149),c=r(156);t.run=function(e,t,r){let u;const p=r;null==r.starttimeout&&(p.starttimeout=5e3),null==r.fixturetimeout&&(p.fixturetimeout=2e3);const l={connectTimeout:r.starttimeout,commandTimeout:r.commandtimeout},d=new i(e,l);try{u=a.getSuitesSync(t)}catch(e){throw console.log("Unable to get suites:",e),e}let h=null;before((function(t){this.timeout(r.starttimeout+500),function(t){if(!e.command)return void t(null);h=c.start(e.command,{},t)}(e=>{n("started",e),s.noError(e),d.connect(t)})})),after(e=>{var t;t=t=>{n("stopped",t),s.noError(t),d.disconnect(e)},h&&h.kill(),t(null)}),u.forEach(e=>{if(null==e.timeout){e.timeout=r.fixturetimeout}!function(e,t){(t.skip?describe.skip:describe)(""+t.name,()=>{beforeEach((function(r){null!=t.timeout&&this.timeout(t.timeout),e.setupSuite(t,r)})),afterEach(r=>e.teardownSuite(t,r)),t.cases.forEach(r=>{(r.skip?describe.skip:describe)(r.name,()=>it(r.assertion,(function(n){null!=t.timeout&&this.timeout(t.timeout),null!=r.timeout&&this.timeout(r.timeout),o.runTestAndCheck(e,r,(e,t)=>{n(e||t.error)})})))})})}(d,e)})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="This component generates a single packet and sends it to\nthe output port. Mostly usable for debugging, but can also be useful\nfor starting up networks.",e.icon="share",e.inPorts.add("in",{datatype:"bang",description:"Signal to send the data packet"}),e.inPorts.add("data",{datatype:"all",description:"Packet to be sent",control:!0,default:null}),e.outPorts.add("out",{datatype:"all"}),e.process((e,t)=>{if(!e.hasStream("in"))return;if(e.attached("data").length&&!e.hasData("data"))return;e.getData("in");const r=e.getData("data");t.send({out:r}),t.done()})}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="This component receives data on multiple input ports and \nsends the same data out to the connected output port",e.icon="compress",e.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),e.outPorts.add("out",{datatype:"all"}),e.process((e,t)=>{const r=e.get("in");return t.sendDone({out:r})})}},function(e,t,r){const n=r(3),{inspect:o}=r(450);t.getComponent=()=>{const e=new n.Component;return e.description="Sends the data items to console.log",e.icon="bug",e.inPorts.add("in",{datatype:"all",description:"Packet to be printed through console.log"}),e.inPorts.add("options",{datatype:"object",description:"Options to be passed to console.log",control:!0}),e.outPorts.add("out",{datatype:"all"}),e.process((e,t)=>{if(!e.hasData("in"))return;if(e.attached("options").length&&!e.hasData("options"))return;let r=null;e.has("options")&&(r=e.getData("options"));const n=e.getData("in");((e,t)=>{null!=e?console.log(o(t,e.showHidden,e.depth,e.colors)):console.log(t)})(r,n),t.sendDone({out:n})})}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),c=n[r];r<i;c=n[++r])m(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function s(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(r)?n.showHidden=r:r&&t._extend(n,r),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),p(n,e,n.depth)}function c(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function u(e,t){return e}function p(e,r,n){if(e.customInspect&&r&&k(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return y(o)||(o=p(e,o,n)),o}var i=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,r);if(i)return i;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),E(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(r);if(0===a.length){if(k(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(b(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return e.stylize(Date.prototype.toString.call(r),"date");if(E(r))return l(r)}var u,w="",_=!1,S=["{","}"];(h(r)&&(_=!0,S=["[","]"]),k(r))&&(w=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(w=" "+RegExp.prototype.toString.call(r)),x(r)&&(w=" "+Date.prototype.toUTCString.call(r)),E(r)&&(w=" "+l(r)),0!==a.length||_&&0!=r.length?n<0?b(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=_?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)D(t,String(a))?i.push(d(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,r,n,o,!0))})),i}(e,r,n,s,a):a.map((function(t){return d(e,r,n,s,t,_)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,w,S)):S[0]+w+S[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),D(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(r)?p(e,c.value,null):p(e,c.value,r-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===_(e)}function w(e){return"object"==typeof e&&null!==e}function x(e){return w(e)&&"[object Date]"===_(e)}function E(e){return w(e)&&("[object Error]"===_(e)||e instanceof Error)}function k(e){return"function"==typeof e}function _(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(v(i)&&(i=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=w,t.isDate=x,t.isError=E,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(451);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",P(),t.format.apply(t,arguments))},t.inherits=r(452),t._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=A,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,r).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(O,t,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(13))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="Forwards packets and metadata in the same way \nit receives them",e.icon="forward",e.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),e.outPorts.add("out",{datatype:"all"}),e.process((e,t)=>{const r=e.get("in");t.sendDone({out:r})})}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="Like 'Repeat', except repeat on next tick",e.icon="step-forward",e.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),e.outPorts.add("out",{datatype:"all"}),e.process((e,t)=>{const r=e.get("in");setTimeout(()=>t.sendDone({out:r}),0)})}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="Sends next packet in buffer when receiving a bang",e.icon="forward",e.inPorts.add("data",{datatype:"all"}),e.inPorts.add("in",{datatype:"bang"}),e.outPorts.add("out",{datatype:"all"}),e.outPorts.add("empty",{datatype:"bang",required:!1}),e.forwardBrackets={},e.process((t,r)=>{if(!t.hasData("in"))return;const n=t.getData("in");if(!t.hasData("data"))return void r.sendDone({empty:!0});let o=!1;for(;t.has("data");){if(o){if("data"===e.inPorts.data.getBuffer(n.scope)[0].type)break}const i=t.get("data");r.send({out:i}),"data"===i.type&&(o=!0)}r.done()})}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.icon="expand",e.description="This component receives data on a single input port and \nsends the same data out to all connected output ports",e.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),e.outPorts.add("out",{datatype:"all"}),e.process((e,t)=>{const r=e.get("in");t.sendDone({out:r})})}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="Like Promise.race, wait for result from all connected inputs and send first result or an error out",e.icon="compress",e.inPorts.add("in",{datatype:"all",addressable:!0}),e.inPorts.add("error",{datatype:"object"}),e.outPorts.add("out",{datatype:"array"}),e.outPorts.add("error",{datatype:"object"}),e.pending={},e.tearDown=t=>(e.pending={},t()),e.forwardBrackets={},e.process((t,r)=>{if(t.hasData("error")){const n=t.getData("error");return e.pending[t.scope]||(e.pending[t.scope]={resolved:!1,rejected:!1}),e.pending[t.scope].rejected||e.pending[t.scope].resolved?void r.done():(e.pending[t.scope].rejected=!0,void r.sendDone({error:n}))}const n=t.attached("in").filter(e=>t.hasStream(["in",e]));if(!n.length)return;if(e.pending[t.scope]||(e.pending[t.scope]={resolved:!1,rejected:!1}),e.pending[t.scope].rejected||e.pending[t.scope].resolved)return n.forEach(e=>{const r=t.getStream(["in",e]);return Array.from(r).map(e=>e.drop())}),void r.done();const o=t.getStream(["in",n[0]]).filter(e=>"data"===e.type);e.pending[t.scope].resolved=!0;const i=o.map(e=>e.data);r.sendDone({out:i})})}},function(e,t,r){const n=r(3);t.getComponent=()=>{const e=new n.Component;return e.description="Convert a Graph JSON structure into a NoFlo Graph",e.inPorts.add("in",{datatype:"object"}),e.outPorts.add("out",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.process((e,t)=>{if(!e.hasData("in"))return;const r=e.getData("in");n.graph.loadJSON(r).then(e=>{(r.id&&e.properties.id!==r.id||r.project&&e.properties.project!==r.project)&&e.setProperties({id:r.id,project:r.project}),t.sendDone({out:e})},t.done)})}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).description="Start an IndexedDB transaction",e.inPorts.add("stores",{datatype:"string"}),e.inPorts.add("db",{datatype:"object"}),e.inPorts.add("mode",{datatype:"string",default:"readwrite",control:!0}),e.outPorts.add("transaction",{datatype:"object"}),e.outPorts.add("db",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.outPorts.add("complete",{datatype:"bang"}),e.forwardBrackets={stores:["transaction","db","error","complete"]},e.process((function(e,t){var r,o,i,a,s;if(e.hasData("db","stores")){i=e.hasData("mode")?e.getData("mode"):"readwrite";var c=n(e.getData("db","stores"),2);r=c[0],"string"==typeof(a=c[1])&&(a=a.split(","));try{s=r.transaction(a,i)}catch(e){return o=e,t.done(o)}return s.oncomplete=function(){return t.send({complete:!0}),s.onerror=null,s.oncomplete=null,t.done()},s.onerror=function(e){return t.done(e)},t.send({transaction:s}),t.send({db:r})}}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).description="Add an index to an IndexedDB database",e.inPorts.add("store",{datatype:"object"}),e.inPorts.add("name",{datatype:"string"}),e.inPorts.add("keypath",{datatype:"string"}),e.inPorts.add("unique",{datatype:"boolean",control:!0,default:!1}),e.inPorts.add("multientry",{datatype:"boolean",control:!0,default:!1}),e.outPorts.add("index",{datatype:"object"}),e.outPorts.add("store",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={name:["index","store","error"]},e.process((function(e,t){var r,o,i,a,s,c;if(e.hasData("store","name","keypath")){c=!!e.hasData("unique")&&e.getData("unique"),i=!!e.hasData("multientry")&&e.getData("multientry");var u=n(e.getData("store","name","keypath"),3);return s=u[0],a=u[1],o=u[2],s.onerror=function(e){return t.done(e)},r=s.createIndex(a,o,{unique:c,multiEntry:i}),s.onerror=null,t.sendDone({index:r,store:s})}}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).description="Add an object store to an IndexedDB database",e.inPorts.add("name",{datatype:"string"}),e.inPorts.add("db",{datatype:"object"}),e.inPorts.add("keypath",{datatype:"string",control:!0}),e.inPorts.add("autoincrement",{datatype:"boolean",control:!0,default:!1}),e.outPorts.add("store",{datatype:"object"}),e.outPorts.add("db",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={name:["store","error"]},e.process((function(e,t){var r,o,i,a,s;if(e.hasData("name","db")){i=e.hasData("keypath")?e.getData("keypath"):"",r=!!e.hasData("autoincrement")&&e.getData("autoincrement");var c=n(e.getData("name","db"),2);return a=c[0],(o=c[1]).transaction.onerror=function(e){return t.done(e)},s=o.createObjectStore(a,{keyPath:i,autoIncrement:r}),o.transaction.onerror=null,t.send({store:s,db:o}),t.done()}}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).description="Remove an item from an IndexedDB database",e.icon="trash",e.inPorts.add("store",{datatype:"object"}),e.inPorts.add("key",{datatype:"string"}),e.outPorts.add("store",{datatype:"object"}),e.outPorts.add("key",{datatype:"string"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={key:["key","error"]},e.process((function(e,t){var r,o,i;if(e.hasData("store","key")){var a=n(e.getData("store","key"),2);return i=a[0],r=a[1],(o=i.delete(r)).onerror=function(e){return t.done(e)},o.onsuccess=function(e){return t.send({store:i,key:r}),t.done()}}}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).description="Get an object store from an IndexedDB database",e.inPorts.add("name",{datatype:"string"}),e.inPorts.add("transaction",{datatype:"object"}),e.outPorts.add("store",{datatype:"object"}),e.outPorts.add("transaction",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={name:["store","error"]},e.process((function(e,t){var r,o,i;if(e.hasData("name","transaction")){var a=n(e.getData("name","transaction"),2);return r=a[0],(i=a[1]).onerror=function(e){return t.done(e)},o=i.objectStore(r),i.onerror=null,t.sendDone({store:o,transaction:i})}}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i,a;a=r(3),i=r(465),t.getComponent=function(){var e;return(e=new a.Component).description="Open an IndexedDB database",e.inPorts.add("name",{datatype:"string"}),e.inPorts.add("version",{datatype:"integer"}),e.outPorts.add("upgrade",{datatype:"object"}),e.outPorts.add("db",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={name:["db","error"]},e.process((function(e,t){var r,o,a;if(e.hasData("name","version")){var s=n(e.getData("name","version"),2);return r=s[0],a=s[1],(o=i.open(r,parseInt(a))).onerror=function(e){return t.done(e)},o.onupgradeneeded=function(e){return t.send({upgrade:{oldVersion:e.oldVersion,newVersion:parseInt(a),db:e.target.result}})},o.onsuccess=function(e){return t.sendDone({db:e.target.result})}}}))}},function(e,t){e.exports=window.overrideIndexedDB||window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).description="Store an object into an IndexedDB store",e.inPorts.add("store",{datatype:"object"}),e.inPorts.add("value",{datatype:"all"}),e.outPorts.add("store",{datatype:"object"}),e.outPorts.add("key",{datatype:"string"}),e.outPorts.add("value",{datatype:"all"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={value:["key","value","error"]},e.process((function(e,t){var r,o,i;if(e.hasData("store","value")){var a=n(e.getData("store","value"),2);return o=a[0],i=a[1],r=o.put(i),t.send({store:o}),r.onerror=function(e){return t.done(e)},r.onsuccess=function(e){return t.sendDone({key:e.target.result,value:i})}}}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i;i=r(3),t.getComponent=function(){var e;return(e=new i.Component).icon="search",e.description="Query a store in an IndexedDB database",e.inPorts.add("store",{datatype:"object"}),e.inPorts.add("range",{datatype:"object"}),e.inPorts.add("all",{datatype:"bang"}),e.outPorts.add("item",{datatype:"all"}),e.outPorts.add("range",{datatype:"object"}),e.outPorts.add("empty",{datatype:"object"}),e.outPorts.add("error",{datatype:"object"}),e.forwardBrackets={all:["item","error"],range:["item","error"]},e.process((function(e,t){var r,o,a,s,c;if(e.hasData("store")){if(r=!1,s=function(e){var n;return(n=e.target.result)?(r||(t.send({item:new i.IP("openBracket")}),r=!0),t.send({item:n.value}),n.continue()):(r?t.send({item:new i.IP("closeBracket")}):t.send({empty:!0}),void t.done())},e.hasData("all")){var u=n(e.getData("store","all"),2);return c=u[0],u[1],(a=c.openCursor()).onerror=function(e){return t.done(e)},void(a.onsuccess=s)}if(e.hasData("range")){var p=n(e.getData("store","range"),2);return c=p[0],o=p[1],t.send({range:o}),(a=c.openCursor(o)).onerror=function(e){return t.done(e)},a.onsuccess=s}}}))}},function(e,t,r){"use strict";var n;n=r(3),t.getComponent=function(){var e;return(e=new n.Component).icon="code-fork",e.description="Route upgrades between IndexeDB database versions",e.inPorts.add("upgrade",{datatype:"object"}),e.outPorts.add("versions",{datatype:"object",addressable:!0}),e.outPorts.add("missed",{datatype:"object"}),e.forwardBrackets={upgrade:["versions","missed"]},e.process((function(t,r){var o,i,a;if(t.hasData("upgrade")){for(a=t.getData("upgrade"),i=!1,o=0;o<a.newVersion;)o<a.oldVersion?o++:e.outPorts.versions.isAttached(o)?(r.send({versions:new n.IP("data",a.db,{index:o})}),o++):(o++,i=!0);return i?r.sendDone({missed:a.db}):r.done()}}))}},function(e,t,r){"use strict";var n;n=r(3),t.getComponent=function(){var e,t;return(e=new n.Component).description="Listen for hash changes in browser's URL bar",e.icon="slack",e.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),e.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),e.outPorts.add("initial",{datatype:"string"}),e.outPorts.add("change",{datatype:"string"}),e.current=null,e.subscriber=null,t=function(){if(e.subscriber)return window.removeEventListener("hashchange",e.subscriber.callback,!1),e.subscriber.ctx.deactivate(),e.subscriber=null},e.tearDown=function(r){return e.current=null,t(),r()},e.forwardBrackets={},e.process((function(r,o,i){var a;if(r.hasData("start"))return r.getData("start"),t(),a=function(t){var r,i;if(r=e.current,e.current=window.location.href.split("#")[1]||"",r&&o.send({change:new n.IP("openBracket",r)}),(i={})[t]=e.current,o.send(i),r)return o.send({change:new n.IP("closeBracket",r)})},e.subscriber={callback:function(e){return a("change")},ctx:i},a("initial"),void window.addEventListener("hashchange",e.subscriber.callback,!1);r.hasData("stop")&&(r.getData("stop"),t(),o.done())}))}},function(e,t,r){"use strict";var n;n=r(3),t.getComponent=function(){var e,t;return(e=new n.Component).description="Listen to window resize events",e.icon="desktop",e.inPorts.add("start",{datatype:"bang",description:"Start listening for screen resizes"}),e.inPorts.add("stop",{datatype:"bang",description:"Stop listening for screen resizes"}),e.outPorts.add("width",{datatype:"number"}),e.outPorts.add("height",{datatype:"number"}),e.subscriber=null,t=function(){if(e.subscriber)return window.removeEventListener("resize",e.subscriber.callback,!1),e.subscriber.ctx.deactivate(),e.subscriber=null},e.tearDown=function(e){return t(),e()},e.forwardBrackets={},e.process((function(r,n,o){if(r.hasData("start"))return r.getData("start"),t(),e.subscriber={callback:function(e){return n.send({width:window.innerWidth,height:window.innerHeight})},ctx:o},n.send({width:window.innerWidth,height:window.innerHeight}),void window.addEventListener("resize",e.subscriber.callback,!1);r.hasData("stop")&&(r.getData("stop"),t(),n.done())}))}},function(e,t,r){const n=r(3);t.getComponent=function(){const e=new n.Component;return e.description="call a method on an object",e.icon="gear",e.inPorts=new n.InPorts({in:{datatype:"object",description:"Object on which a method will be called",required:!0},method:{datatype:"string",description:"Name of the method to call",required:!0,control:!0},arguments:{datatype:"all",description:"Arguments given to the method (one argument per IP)"}}),e.outPorts=new n.OutPorts({out:{datatype:"all",description:"Value returned by the method call",required:!0},error:{datatype:"object"}}),e.process((e,t)=>{if(!e.hasData("method","in"))return;if(e.attached("arguments").length>0&&!e.hasData("arguments"))return;let r=[];const n=e.getStream("arguments").filter(e=>"data"===e.type&&null!=e.data).map(e=>e.data);r=r.concat(n);const o=e.getData("in"),i=e.getData("method");o[i]?t.sendDone({out:o[i].apply(o,r)}):t.sendDone(new Error(`Method '${i}' not available`))})}},function(e,t,r){const n=r(3);t.getComponent=function(){const e=new n.Component({description:"Create an empty object"});return e.inPorts=new n.InPorts({start:{datatype:"bang",description:"Signal to create a new object"}}),e.outPorts=new n.OutPorts({out:{datatype:"object",description:"A new empty object"}}),e.forwardBrackets={start:["out"]},e.process((e,t)=>{e.hasData("start")&&(e.getData("start"),t.sendDone({out:{}}))})}},function(e,t,r){const n=r(3);t.getComponent=function(){const e=new n.Component;return e.icon="indent",e.inPorts=new n.InPorts({in:{datatype:"object",description:"Object to get keys from",required:!0},key:{datatype:"string",description:"Keys to extract from the object (one key per IP)",required:!0},sendgroup:{datatype:"boolean",description:"true to send keys as groups around value IPs, false otherwise",control:!0,default:!1}}),e.outPorts=new n.OutPorts({out:{datatype:"all",description:"Values extracts from the input object given the input keys (one value per IP, potentially grouped using the key names)"},object:{datatype:"object",description:"Object forwarded from input if at least one property matches the input keys"},missed:{datatype:"object",description:"Object forwarded from input if no property matches the input keys"}}),e.process((e,t)=>{if(!e.hasData("in"))return;if(!e.hasStream("key"))return;if(e.attached("sendgroup").length>0&&!e.hasData("sendgroup"))return;const r=e.getStream("key").filter(e=>"data"===e.type).map(e=>e.data),o=e.getData("in");let i=e.getData("sendgroup");i="true"===i||!0===i,"object"==typeof o?null!==o?(r.forEach(e=>{void 0===o[e]&&(i&&t.send({missed:new n.IP("openBracket",e)}),t.send({missed:new n.IP("data",o)}),i&&t.send({missed:new n.IP("closeBracket",e)})),i&&t.send({out:new n.IP("openBracket",e)}),t.send({out:new n.IP("data",o[e])}),i&&t.send({out:new n.IP("closeBracket",e)})}),t.send({object:new n.IP("data",o)}),t.done()):t.sendDone(new Error("Data is NULL")):t.sendDone(new Error("Data is not an object"))})}},function(e,t,r){const n=r(3);t.getComponent=function(){const e=new n.Component;return e.description="Send a string when receiving a packet",e.inPorts.add("string",{datatype:"string",description:"String to send",control:!0}),e.inPorts.add("in",{datatype:"bang",description:"Send the string out"}),e.outPorts.add("out",{datatype:"string"}),e.process((e,t)=>{e.has("string","in")&&(e.getData("in"),t.sendDone({out:e.getData("string")}))})}},function(e,t,r){"use strict";(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getComponent=t.Graph=void 0;var u=r(3),p=r(37),l=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(d,t);var r,s,c,l=a(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=l.call(this)).metadata=e,t.network=null,t.ready=!0,t.started=!1,t.starting=!1,t.baseDir=null,t.loader=null,t.load=0,t.inPorts=new u.InPorts({graph:{datatype:"all",description:"NoFlo graph definition to be used with the subgraph component",required:!0}}),t.outPorts=new u.OutPorts,t.inPorts.ports.graph.on("ip",(function(e){"data"===e.type&&t.setGraph(e.data).catch(t.error)})),t}return r=d,(s=[{key:"setGraph",value:function(t,r){var o,i=this;if(this.ready=!1,"object"===n(t))o="function"==typeof t.addNode?this.createNetwork(t):u.graph.loadJSON(t).then((function(e){return i.createNetwork(e)}));else{var a=t;"/"!==a.substr(0,1)&&":"!==a.substr(1,1)&&e&&e.cwd&&(a="".concat(e.cwd(),"/").concat(a)),o=u.graph.loadFile(a).then((function(e){return i.createNetwork(e)}))}return r&&(p.deprecated("Providing a callback to Graph.setGraph is deprecated, use Promises"),o.then((function(){r(null)}),r)),o}},{key:"createNetwork",value:function(e,t){var r=this;this.description=e.properties.description||"",this.icon=e.properties.icon||this.icon;var n=e;n.name||(n.name=this.nodeId);var o=u.createNetwork(n,{delay:!0,subscribeGraph:!1,componentLoader:this.loader,baseDir:this.baseDir}).then((function(e){return r.network=e,r.emit("network",r.network),r.subscribeNetwork(r.network),e.connect()})).then((function(){Object.keys(r.network.processes).forEach((function(e){var t=r.network.processes[e];r.findEdgePorts(e,t)})),r.setToReady()}));return t&&(p.deprecated("Providing a callback to Graph.createNetwork is deprecated, use Promises"),o.then((function(){t(null)}),t)),o}},{key:"subscribeNetwork",value:function(e){var t=this,r=[];e.on("start",(function(){var e={activated:!1,deactivated:!1,result:{}};r.push(e),t.activate(e)})),e.on("end",(function(){var e=r.pop();e&&t.deactivate(e)}))}},{key:"isExportedInport",value:function(e,t,r){for(var n=Object.keys(this.network.graph.inports),o=0;o<n.length;o+=1){var i=n[o],a=this.network.graph.inports[i];if(a.process===t&&a.port===r)return i}return!1}},{key:"isExportedOutport",value:function(e,t,r){for(var n=Object.keys(this.network.graph.outports),o=0;o<n.length;o+=1){var i=n[o],a=this.network.graph.outports[i];if(a.process===t&&a.port===r)return i}return!1}},{key:"setToReady",value:function(){var t=this;void 0!==e&&e.execPath&&-1!==e.execPath.indexOf("node")?e.nextTick((function(){return t.ready=!0,t.emit("ready")})):setTimeout((function(){return t.ready=!0,t.emit("ready")}),0)}},{key:"findEdgePorts",value:function(e,t){var r=this,n=t.component.inPorts.ports,o=t.component.outPorts.ports;return Object.keys(n).forEach((function(t){var o=n[t],i=r.isExportedInport(o,e,t);!1!==i&&(r.inPorts.add(i,o),r.inPorts[i].on("connect",(function(){r.starting||r.network.isStarted()||(r.network.startupDate?r.network.setStarted(!0):r.setUp((function(){})))})))})),Object.keys(o).forEach((function(t){var n=o[t],i=r.isExportedOutport(n,e,t);!1!==i&&r.outPorts.add(i,n)})),!0}},{key:"isReady",value:function(){return this.ready}},{key:"isSubgraph",value:function(){return!0}},{key:"isLegacy",value:function(){return!1}},{key:"setUp",value:function(e){var t=this;this.starting=!0,this.isReady()?this.network?this.network.start().then((function(){t.starting=!1,e(null)}),e):e(null):this.once("ready",(function(){t.setUp(e)}))}},{key:"tearDown",value:function(e){this.starting=!1,this.network?this.network.stop().then((function(){return e()}),e):e(null)}}])&&o(r.prototype,s),c&&o(r,c),d}(u.Component);t.Graph=l,t.getComponent=function(e){return new l(e)}}).call(this,r(13))},function(e,t,r){const n=r(477);e.exports=(e,t)=>{const r=document.querySelectorAll("noflo-polymer");return[].forEach.call(r,t=>{((e,t)=>{const r=t.getAttribute("name"),o=t.getAttribute("inports");let i=[];o&&(i=o.split(" "));const a=t.getAttribute("outports");let s=[];a&&(s=a.split(" "));const c=n(r,i,s);e.registerComponent("polymer",r,c)})(e,t)}),t(null)}},function(e,t,r){const n=r(3);e.exports=(e,t,r)=>()=>{const o=new n.Component;return o.inPorts.add("selector",{datatype:"string",description:"DOM selector for getting the element"}),o.inPorts.add("element",{datatype:"object",description:"Existing Polymer element instance"}),o.inPorts.add("event",{datatype:"string",description:"Fire an event on polymer element"}),o.outPorts.add("element",{datatype:"object"}),o.outPorts.add("error",{datatype:"object"}),t.forEach(e=>{o.inPorts.add(e,{datatype:"all"})}),r.forEach(e=>{o.outPorts.add(e,{datatype:"all"})}),o.setUp=e=>{o.element=null,o.ctx=null,o.eventHandlers={},e()},o.tearDown=t=>{o.element&&(r.forEach(t=>{"element"!==e&&o.eventHandlers[t]&&o.element.removeEventListener(t,o.eventHandlers[t],!1)}),o.originalFire&&(o.element.fire=o.originalFire,delete o.originalFire),o.element=null,o.eventHandlers={}),o.ctx&&(o.ctx.deactivate(),o.ctx=null),t()},o.bindToElement=(t,n,i)=>{"object"==typeof t?t.tagName===e.toUpperCase()?o.element?n.done(new Error(o.nodeId+" is already bound to an element. Rebinding not allowed")):(o.element=t,o.ctx=i,n.send({element:t}),r.forEach(e=>{if("element"!==e)if("event"!==e)o.eventHandlers[e]=t=>{const r={};r[e]=t.detail,n.send(r)},t.addEventListener(e,o.eventHandlers[e],!1);else{o.originalFire=t.dispatchEvent.bind(t);t.dispatchEvent=e=>{if(-1!==r.indexOf(e.type))return void o.originalFire(e);if(-1!==e.type.indexOf("-changed"))return void o.originalFire(e);const t=e.detail&&e.detail.value?e.detail.value:e.detail;n.send({event:{action:e.type,payload:t}}),o.originalFire(e)}}}),o.element.dispatchEvent(new CustomEvent("noflo:ready",{detail:!0}))):n.done(new Error(`${o.nodeId} received a ${t.tagName} element instead of ${e.toUpperCase()}`)):n.done(new Error(o.nodeId+" received an element that is not an object"))},o.process((e,r,n)=>{if(e.hasData("element")){const t=e.getData("element");return void o.bindToElement(t,r,n)}if(e.hasData("selector")){const t=e.getData("selector"),i=document.querySelector(t);return i?void o.bindToElement(i,r,n):void r.done(new Error(`No element matching '${t}' found`))}if(!o.element)return;let i=!1;if(e.hasData("event")){i=!0;const t=e.getData("event");o.element.fire(e.getData(t))}t.forEach(t=>{if(e.hasData(t)){if("function"==typeof o.element[t])return i=!0,void o.element[t](e.getData(t));if(Array.isArray(o.element[t])){if(!e.hasStream(t))return;i=!0;const r=e.getStream(t).filter(e=>"data"===e.type).map(e=>e.data);o.element.set(t,r)}else i=!0,o.element.set(t,e.getData(t))}}),i&&r.done()}),o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.isArray=t.guessLanguageFromFilename=void 0,t.guessLanguageFromFilename=function(e){return/.*\.coffee$/.test(e)?"coffeescript":/.*\.ts$/.test(e)?"typescript":"javascript"},t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},t.debounce=function(e,t,r){var n,o,i,a,s;function c(){var u=Date.now()-a;u<t&&u>=0?n=setTimeout(c,t-u):(n=null,r||(s=e.apply(i,o),n||(i=null,o=null)))}return function(){i=this,o=arguments,a=Date.now();var u=r&&!n;return n||(n=setTimeout(c,t)),u&&(s=e.apply(i,o),i=null,o=null),s}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyNetwork=void 0;var l=r(112),d=r(37),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,u=c(l);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,l),d.deprecated("subscribeGraph: true is deprecated. Live-edit network graphs via the network methods instead"),u.call(this,e,t)}return t=l,(r=[{key:"connect",value:function(e){var t=this,r=a(p(l.prototype),"connect",this).call(this).then((function(){return t.subscribeGraph(),t}));return e&&(d.deprecated("Providing a callback to Network.connect is deprecated, use Promises"),r.then((function(){e(null)}),e)),r}},{key:"subscribeGraph",value:function(){var e=this,t=[],r=!1,n=function(e,r){t.push({op:e,details:r})},o=function n(o){if(o){if(0===e.listeners("process-error").length)throw o;e.bufferedEmit("process-error",o)}if(t.length){r=!0;var i=t.shift(),a=n;switch(i.op){case"renameNode":e.renameNode(i.details.from,i.details.to,a);break;default:e[i.op](i.details,a)}}else r=!1};return this.graph.on("addNode",(function(e){n("addNode",e),r||o()})),this.graph.on("removeNode",(function(e){n("removeNode",e),r||o()})),this.graph.on("renameNode",(function(e,t){n("renameNode",{from:e,to:t}),r||o()})),this.graph.on("addEdge",(function(e){n("addEdge",e),r||o()})),this.graph.on("removeEdge",(function(e){n("removeEdge",e),r||o()})),this.graph.on("addInitial",(function(e){n("addInitial",e),r||o()})),this.graph.on("removeInitial",(function(e){n("removeInitial",e),r||o()}))}}])&&i(t.prototype,r),n&&i(t,n),l}(l.BaseNetwork);t.LegacyNetwork=h},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ip=t,this.nodeInstance=r,this.port=n,this.result=o,this.scope=this.ip.scope,this.activated=!1,this.deactivated=!1}var t,r,o;return t=e,(r=[{key:"activate",value:function(){(this.result.__resolved||-1===this.nodeInstance.outputQ.indexOf(this.result))&&(this.result={}),this.nodeInstance.activate(this)}},{key:"deactivate",value:function(){this.result.__resolved||(this.result.__resolved=!0),this.nodeInstance.deactivate(this)}}])&&n(t.prototype,r),o&&n(t,o),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(14).default("noflo:component"),p=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ports=t,this.context=r,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.port=this.context.port,this.result=this.context.result,this.scope=this.context.scope}var t,r,i;return t=e,(r=[{key:"activate",value:function(){this.context.activated||(this.nodeInstance.isOrdered()&&(this.result.__resolved=!1),this.nodeInstance.activate(this.context),this.port.isAddressable()?u("".concat(this.nodeInstance.nodeId," packet on '").concat(this.port.name,"[").concat(this.ip.index,"]' caused activation ").concat(this.nodeInstance.load,": ").concat(this.ip.type)):u("".concat(this.nodeInstance.nodeId," packet on '").concat(this.port.name,"' caused activation ").concat(this.nodeInstance.load,": ").concat(this.ip.type)))}},{key:"attached",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r;o.length||(o=["in"]);var i=[];return o.forEach((function(t){if(!e.ports.ports[t])throw new Error("Node ".concat(e.nodeInstance.nodeId," has no port '").concat(t,"'"));i.push(e.ports.ports[t].listAttached())})),1===o.length?i[0]:i}},{key:"has",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r.filter((function(e){return"function"!=typeof e}));o.length||(o=["in"]),e="function"==typeof r[r.length-1]?r[r.length-1]:function(){return!0};for(var i=0;i<o.length;i+=1){var a=o[i];if(Array.isArray(a)){var c=this.ports.ports[a[0]];if(!c)throw new Error("Node ".concat(this.nodeInstance.nodeId," has no port '").concat(a[0],"'"));if(!c.isAddressable())throw new Error("Non-addressable ports, access must be with string ".concat(a[0]));if(!c.has(this.scope,a[1],e))return!1}else{if("string"!=typeof a)throw new Error("Unknown port type ".concat(s(a)));var u=this.ports.ports[a];if(!u)throw new Error("Node ".concat(this.nodeInstance.nodeId," has no port '").concat(a,"'"));if(u.isAddressable())throw new Error("For addressable ports, access must be with array [".concat(a,", idx]"));if(!u.has(this.scope,e))return!1}}return!0}},{key:"hasData",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t;n.length||(n=["in"]);var i=[].concat(o(n),[function(e){return"data"===e.type}]);return this.has.apply(this,o(i))}},{key:"hasStream",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o,i=r;i.length||(i=["in"]),o="function"==typeof i[i.length-1]?i.pop():function(){return!0};for(var a=function(t){var r=i[t],n=[],a=!1;if(!e.has(r,(function(e){return"openBracket"===e.type?(n.push(e.data),!1):"data"===e.type?(a=o(e,n),!n.length&&a):"closeBracket"===e.type&&(n.pop(),!n.length&&!!a)})))return{v:!1}},c=0;c<i.length;c+=1){var u=a(c);if("object"===s(u))return u.v}return!0}},{key:"get",value:function(){this.activate();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=t;o.length||(o=["in"]);for(var i=[],a=0;a<o.length;a+=1){var s=o[a],c=void 0,u=void 0,p=void 0;if(Array.isArray(s)){var l=Array.from(s),d=n(l,2);if(p=d[0],c=d[1],!this.ports.ports[p].isAddressable())throw new Error("Non-addressable ports, access must be with string portname")}else if(p=s,this.ports.ports[p].isAddressable())throw new Error("For addressable ports, access must be with array [portname, idx]");var h=p,f=c;if(this.nodeInstance.isForwardingInport(h))u=this.__getForForwarding(h,f),i.push(u);else{var m=this.ports.ports[h];u=m.get(this.scope,c),i.push(u)}}return 1===o.length?i[0]:i}},{key:"__getForForwarding",value:function(e,t){for(var r,n=[],o=!0;o;){var i=this.ports.ports[e].get(this.scope,t);if(!i)break;if("data"===i.type){r=i,o=!1;break}n.push(i)}for(var a=0;a<n.length;a+=1){var s=n[a];if("closeBracket"===s.type){this.result.__bracketClosingBefore||(this.result.__bracketClosingBefore=[]);var c=this.nodeInstance.getBracketContext("in",e,this.scope,t).pop();c.closeIp=s,this.result.__bracketClosingBefore.push(c)}else"openBracket"===s.type&&this.nodeInstance.getBracketContext("in",e,this.scope,t).push({ip:s,ports:[],source:e})}return this.result.__bracketContext||(this.result.__bracketContext={}),this.result.__bracketContext[e]=this.nodeInstance.getBracketContext("in",e,this.scope,t).slice(0),r}},{key:"getData",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r;o.length||(o=["in"]);var i=[];return o.forEach((function(t){var r=e.get(t);if(null!=r){for(;"data"!==r.type&&(r=e.get(t)););i.push(r.data)}else i.push(r)})),1===o.length?i.pop():i}},{key:"getStream",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t;n.length||(n=["in"]);for(var o=[],i=0;i<n.length;i+=1){var a=n[i],s=[],c=[],u=!1,p=this.get(a);for(p||o.push(void 0);p&&("openBracket"===p.type&&(s.length||(c=[],u=!1),s.push(p.data),c.push(p)),"data"!==p.type||(c.push(p),u=!0,s.length))&&("closeBracket"!==p.type||(c.push(p),s.pop(),!u||s.length));)p=this.get(a);o.push(c)}return 1===n.length?o[0]:o}}])&&c(t.prototype,r),i&&c(t,i),e}();t.default=p},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(14),a=r(46),s=i.default("noflo:component");var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ports=t,this.context=r,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.result=this.context.result,this.scope=this.context.scope}var t,r,i;return t=e,(r=[{key:"error",value:function(e){var t=this,r=Array.isArray(e)?e:[e];!this.ports.ports.error||!this.ports.ports.error.isAttached()&&this.ports.ports.error.isRequired()?r.forEach((function(e){throw e})):(r.length>1&&this.sendIP("error",new a.default("openBracket")),r.forEach((function(e){t.sendIP("error",e)})),r.length>1&&this.sendIP("error",new a.default("closeBracket")))}},{key:"sendIP",value:function(e,t){var r=a.default.isIP(t)?t:new a.default("data",t);if(null!==this.scope&&null===r.scope&&(r.scope=this.scope),!this.nodeInstance.outPorts.ports[e])throw new Error("Node ".concat(this.nodeInstance.nodeId," does not have outport ").concat(e));var n=this.nodeInstance.outPorts.ports[e];if(n.isAddressable()&&null===r.index)throw new Error("Sending packets to addressable port ".concat(this.nodeInstance.nodeId," ").concat(e," requires specifying index"));this.nodeInstance.isOrdered()?this.nodeInstance.addToResult(this.result,e,r):(n.options.scoped||(r.scope=null),n.sendIP(r))}},{key:"send",value:function(e){var t=this;if((o=e)instanceof Error||Array.isArray(o)&&o.length>0&&o[0]instanceof Error){var r=e;this.error(r)}else{var o,i=[],a=!1;if(Object.keys(this.ports.ports).forEach((function(t){"error"!==t&&"ports"!==t&&"_callbacks"!==t&&i.push(t),a||null==e||"object"!==n(e)||-1===Object.keys(e).indexOf(t)||(a=!0)})),1!==i.length||a){if(i.length>1&&!a)throw new Error("Port must be specified for sending output");Object.keys(e).forEach((function(r){var n=e[r];t.sendIP(r,n)}))}else this.sendIP(i[0],e)}}},{key:"sendDone",value:function(e){this.send(e),this.done()}},{key:"pass",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!("out"in this.ports))throw new Error('output.pass() requires port "out" to be present');var r=this;Object.keys(t).forEach((function(e){var n=t[e];r.ip[e]=n})),this.ip.data=e,this.sendIP("out",this.ip),this.done()}},{key:"done",value:function(e){var t,r,n,o,i=this;this.result.__resolved=!0,this.nodeInstance.activate(this.context),e&&this.error(e),this.nodeInstance.isOrdered()&&(t=i.nodeInstance.outputQ.filter((function(e){return!e.__resolved||2!==Object.keys(e).length||!e.__bracketClosingAfter})),r=t.indexOf(i.result),n=t.length,o=i.nodeInstance.load,r===n-1||-1===r&&o===n+1||n<=1&&1===o)&&Object.keys(this.nodeInstance.bracketContext.in).forEach((function(e){var t=i.nodeInstance.bracketContext.in[e];if(t[i.scope]){var r=t[i.scope];if(r.length)for(var n=r[r.length-1],o=i.nodeInstance.inPorts.ports[n.source],a=o.getBuffer(n.ip.scope,n.ip.index);a.length>0&&"closeBracket"===a[0].type;){var s=o.get(n.ip.scope,n.ip.index),c=r.pop();c.closeIp=s,i.result.__bracketClosingAfter||(i.result.__bracketClosingAfter=[]),i.result.__bracketClosingAfter.push(c)}}})),s("".concat(this.nodeInstance.nodeId," finished processing ").concat(this.nodeInstance.load)),this.nodeInstance.deactivate(this.context)}}])&&o(t.prototype,r),i&&o(t,i),e}();t.default=c},function(e,t,r){"use strict";(function(e){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.asCallback=t.asPromise=void 0;var s=r(23),c=r(84),u=r(111),p=r(46),l=r(83);function d(e,t){if(t.raw)return e;var r=[],n=null,o=r;return e.forEach((function(e){"openBracket"===e.type&&(n=o,o=[],n.push(o)),"data"===e.type&&o.push(e.data),"closeBracket"===e.type&&(o=n)})),1===r.length?r[0]:r}function h(t,r){if(!t)throw new Error("No component or graph provided");return r=function(t,r){return t||(t={}),t.name||"string"!=typeof r||(t.name=r),t.loader&&(t.baseDir=t.loader.baseDir),!t.baseDir&&e&&e.cwd&&(t.baseDir=e.cwd()),t.baseDir&&!t.loader&&(t.loader=new c.ComponentLoader(t.baseDir)),t.raw||(t.raw=!1),t}(r,t),function(e){return function(e,t){return"object"===a(e)?new u.Network(e,o(o({},t),{},{componentLoader:t.loader})).connect():t.loader?t.loader.load(e,{}).then((function(r){var n=new s.Graph(t.name),i=t.name||"AsCallback";n.addNode(i,e);var a=r.inPorts.ports,c=r.outPorts.ports;return Object.keys(a).forEach((function(e){n.addInport(e,i,e)})),Object.keys(c).forEach((function(e){n.addOutport(e,i,e)})),new u.Network(n,o(o({},t),{},{componentLoader:t.loader})).connect()})):Promise.reject(new Error("No component loader provided"))}(t,r).then((function(t){r.networkCallback&&r.networkCallback(t);var n=function e(t,r){if("object"!==a(t)||!t)return"simple";if(Array.isArray(t))return t.filter((function(t){return"map"===e(t,r)})).length===t.length?"sequence":"simple";var n=Object.keys(t);if(!n.length)return"simple";for(var o=0;o<n.length;o+=1){var i=n[o];if(!r.graph.inports[i])return"simple"}return"map"}(e,t);return function(e,t){return new Promise((function(r,n){var o={},i=[],a=Object.keys(e.graph.outports),s={};a.forEach((function(t){var r=e.graph.outports[t],n=e.getNode(r.process);n&&n.component&&(s[t]=l.createSocket(),e.subscribeSocket(s[t]),n.component.outPorts[r.port].attach(s[t]),s[t].from={process:n,port:r.port},s[t].on("ip",(function(e){var r={};r[t]=e,i.push(r)})))}));var c,u=null;c=function(t){n(t.error),e.removeListener("end",u)},e.once("process-error",c),u=function(){Object.keys(s).forEach((function(e){var t=s[e];t.from.process.component.outPorts[t.from.port].detach(t)})),s={},o={},r(i),e.removeListener("process-error",c)},e.once("end",u),e.start().then((function(){for(var r=0;r<t.length;r+=1)for(var i=t[r],a=Object.keys(i),s=0;s<a.length;s+=1){var d=a[s],h=i[d];if(!o[d]){var f=e.graph.inports[d];if(!f)return void n(new Error("Port ".concat(d," not available in the graph")));var m=e.getNode(f.process);if(!m||!m.component)return void n(new Error("Process ".concat(f.process," for port ").concat(d," not available in the graph")));o[d]=l.createSocket(),e.subscribeSocket(o[d]),o[d].to={process:m,port:d},m.component.inPorts[f.port].attach(o[d])}try{p.default.isIP(h)?o[d].post(h):o[d].post(new p.default("data",h))}catch(t){return n(t),e.removeListener("process-error",c),void e.removeListener("end",u)}}}),n)}))}(t,function(e,t,r){if("sequence"===t)return e;if("map"===t)return[e];var n=Object.keys(r.graph.inports)[0];if(!n)return{};r.graph.inports.in&&(n="in");var o={};return o[n]=e,[o]}(e,n,t)).then((function(e){return function(e,t,r){var n=e.filter((function(e){return null!=e.error})).map((function(e){return e.error}));if(n.length)return Promise.reject(d(n,r));if("sequence"===t)return Promise.resolve(e.map((function(e){var t={};return Object.keys(e).forEach((function(n){var o=e[n];r.raw?t[n]=o:t[n]=d([o],r)})),t})));var o={};e.forEach((function(e){Object.keys(e).forEach((function(t){var r=e[t];o[t]||(o[t]=[]),o[t].push(r)}))}));var i=Object.keys(o).filter((function(e){return o[e].length>0}));if(0===i.length)return Promise.resolve(null);if(1===i.length&&"simple"===t)return Promise.resolve(d(o[i[0]],r));var a={};return Object.keys(o).forEach((function(e){var t=o[e];a[e]=d(t,r)})),Promise.resolve(a)}(e,n,r)}))}))}}t.asPromise=h,t.asCallback=function(e,t){var r=h(e,t);return function(e,t){r(e).then((function(e){t(null,e)}),t)}}}).call(this,r(13))},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.asComponent=void 0;var a=r(485),s=r(158);t.asComponent=function(e,t){var r=!1,i=a(e).filter((function(e){return"callback"!==e.param||(r=!0,!1)})),c=new s.Component(t);return i.forEach((function(e){var t={required:!0};void 0!==e.default&&(t.default=e.default,t.required=!1),c.inPorts.add(e.param,t),c.forwardBrackets[e.param]=["out","error"]})),i.length||c.inPorts.add("in",{datatype:"bang"}),c.outPorts.add("out"),c.outPorts.add("error"),c.process((function(t,a){var s;if(i.length){for(var c=0;c<i.length;c+=1){var u=i[c];if(!t.hasData(u.param))return}s=i.map((function(e){return t.getData(e.param)}))}else{if(!t.hasData("in"))return;t.getData("in"),s=[]}if(r){return s.push((function(e,t){e?a.done(e):a.sendDone(t)})),void e.apply(void 0,o(s))}var p=e.apply(void 0,o(s));p&&"object"===n(p)&&"function"==typeof p.then?p.then((function(e){return a.sendDone(e)}),(function(e){return a.done(e)})):a.sendDone(p)})),c}},function(e,t,r){var n=r(163),o=r(486),i=r(487),a=r(488);e.exports=function(e){var t=[],r=e.toString().replace(/\/\*.*?\*\//g,"");r=o(t,r);var s=i(t,r,n.prePatterns).replace(/\n/g,"").replace(/\s*async\s*/,"").match(/(?:function\s*\((.*?)\)|\((.*?)\))|(.*?)\s*=>/);return s=s[1]||s[2]||s[3]||"",i(t,s,n.postPatterns).split(",").filter((function(e){return e})).map((function(e){var r=(e=a(t,e,!0)).split("="),n={param:r[0].trim()};return r[1]&&(n.default=a(t,r.slice(1).join("="))),n}))}},function(e,t,r){var n=r(163).stringPatterns,o=r(97);e.exports=function(e,t){for(;;){var r=n.reduce((function(e,r){return e.concat(t.match(r)||[])}),[]).sort((function(e,t){return e.length-t.length}))[0];if(!r)return t;t=t.replace(r,o(e.push(r)))}}},function(e,t,r){var n=r(97);e.exports=function(e,t,r){return r.forEach((function(r){for(;r.test(t);){var o=r.exec(t)[0];t=t.replace(o,n(e.push(o)))}})),t}},function(module,exports,__webpack_require__){var delim=__webpack_require__(97);module.exports=function(cache,string,skipEval){for(var pattern=/:~:(\d+?):~:/;pattern.test(string);){var id=pattern.exec(string)[1];string=string.replace(delim(id),cache[id-1])}return skipEval?string:eval("("+string+")")}},function(e,t,r){e.exports={postMessage:r(98),iframe:r(499),opener:r(500)}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=r(3);function p(e,t,r){var n;if(!e||!e.graph)return null;if(!(null!=(n=r?e.graph.inports[t]:e.graph.outports[t])?n.process:void 0))return null;var o=e.getNode(n.process);if(!o)return null;var i=o.component;return i?r?i.inPorts.ports[n.port]:i.outPorts.ports[n.port]:null}function l(e,t,r,n){var o={id:e,type:"all",description:null!=t.metadata?t.metadata.description:void 0,addressable:!1,required:!1},i=p(r,e,n);return i?(o.type=i.getDataType()||"all",("function"==typeof i.getSchema?i.getSchema():void 0)&&(o.schema=i.getSchema()),o.description=(null!=t.metadata?t.metadata.description:void 0)||i.getDescription()||"",o.addressable=i.isAddressable(),o.required=i.isRequired(),o):o}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).transport=e,t.outputSockets={},t.mainGraph=null,t.transport.network.on("removenetwork",(function(e,r){return t.subscribeOutdata(r,e,!1),t.subscribeOutPorts(r,e),t.subscribeExportedPorts(r,e,!1),t.sendPorts(r,null)})),t}return t=c,(r=[{key:"registerNetwork",value:function(e,t){var r=this;this.subscribeExportedPorts(e,t,!0),this.subscribeOutPorts(e,t),this.sendPorts(e,t),t.isStarted()&&this.subscribeOutdata(e,t,!0),t.once("start",(function(){r.subscribeOutdata(e,t,!0)}))}},{key:"send",value:function(e,t,r){return this.transport.send("runtime",e,t,r)}},{key:"sendAll",value:function(e,t){return this.transport.sendAll("runtime",e,t)}},{key:"sendError",value:function(e,t){return this.send("error",e,t)}},{key:"receive",value:function(e,t,r){var n=this;switch(e){case"getruntime":return this.getRuntime(t,r);case"packet":return this.sendPacket(t).then((function(){n.send("packetsent",{port:t.port,event:t.event,graph:t.graph,payload:t.payload},r)}),(function(e){n.sendError(e,r)}));default:return this.send("error",new Error("runtime:".concat(e," not supported")),r)}}},{key:"getRuntimeDefinition",value:function(){var e=this.transport.options.type;e||(e=u.isBrowser()?"noflo-browser":"noflo-nodejs");var t={type:e,version:this.transport.version};return this.transport.options.id&&(t.id=this.transport.options.id),this.transport.options.label&&(t.label=this.transport.options.label),this.transport.options.namespace&&(t.namespace=this.transport.options.namespace),this.transport.options.repository&&(t.repository=this.transport.options.repository),this.transport.options.repositoryVersion&&(t.repositoryVersion=this.transport.options.repositoryVersion),t}},{key:"getRuntime",value:function(e,t){var r,n=this,o=this.getRuntimeDefinition(),i=this.transport.options.capabilities,a=e?e.secret:null;return o.allCapabilities=i,o.capabilities=i.filter((function(e){return n.transport.canDo(e,a)})),this.mainGraph&&(o.graph=this.mainGraph),this.send("runtime",o,t),r=[],Object.keys(n.transport.network.networks).forEach((function(e){var o=n.transport.network.getNetwork(e);r.push(n.sendPorts(e,o,t))})),r}},{key:"sendPorts",value:function(e,t,r){var n=function(e,t){var r,n={graph:e,inPorts:[],outPorts:[]};return(null!=t?t.graph:void 0)?(Object.keys(t.graph.inports).forEach((function(e){r=t.graph.inports[e],n.inPorts.push(l(e,r,t,!0))})),Object.keys(t.graph.outports).forEach((function(e){r=t.graph.outports[e],n.outPorts.push(l(e,r,t,!1))})),n):n}(e,t);return this.emit("ports",n),r?this.send("ports",n,r):this.sendAll("ports",n)}},{key:"setMainGraph",value:function(e){this.mainGraph=e}},{key:"subscribeExportedPorts",value:function(e,t,r){var n=this,o=function(){return n.sendPorts(e,t)},i=["addInport","addOutport","removeInport","removeOutport"];if(i.forEach((function(e){t.graph.removeListener(e,o)})),r){var a=[];i.forEach((function(e){a.push(t.graph.on(e,o))}))}}},{key:"subscribeOutPorts",value:function(e,t,r){var n=this,o=function(){return n.subscribeOutdata(e,t,!1)},i=function(){return n.subscribeOutdata(e,t,!0)},a=t.graph;a.removeListener("addOutport",i),a.removeListener("removeOutport",o),r&&(a.on("addOutport",i),a.on("removeOutport",o))}},{key:"subscribeOutdata",value:function(e,t,r){var n=this;this.outputSockets[e]||(this.outputSockets[e]={});var o=this.outputSockets[e];Object.keys(o).forEach((function(e){o[e].removeAllListeners("ip")})),o={},r&&Object.keys(t.graph.outports).forEach((function(r){var i=t.graph.outports[r],a=u.internalSocket.createSocket();o[r]=a;var s,c=t.processes[i.process].component;if(!(null!=c?c.outPorts[i.port]:void 0))throw new Error("Exported outport ".concat(i.port," in node ").concat(i.process," not found"));c.outPorts[i.port].attach(a),a.on("ip",(function(t){switch(t.type){case"openBracket":s="begingroup";break;case"closeBracket":s="endgroup";break;default:s=t.type}n.emit("packet",{port:r,event:s,graph:e,payload:t.data}),n.sendAll("packet",{port:r,event:s,graph:e,payload:t.data})}))}))}},{key:"sendPacket",value:function(e){var t=this;return new Promise((function(r,n){var o=t.transport.network.getNetwork(e.graph);if(o){var i=p(o,e.port,!0);i?(function(e,t,r){var n=u.internalSocket.createSocket();switch(e.attach(n),t){case"begingroup":n.beginGroup(r);break;case"endgroup":n.endGroup(r);break;case"data":n.send(r)}e.detach(n)}(i,e.event,e.payload),r()):n(new Error("Cannot find internal port for ".concat(e.port)))}else n(new Error("Cannot find network for graph ".concat(e.graph)))}))}}])&&o(t.prototype,r),n&&o(t,n),c}(r(11).EventEmitter);e.exports=d},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=r(3),h=r(11).EventEmitter,f=r(99).withNamespace,m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,r,n,o=u(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).transport=e,t.graphs={},t}return t=a,(r=[{key:"send",value:function(e,t,r){return this.transport.send("graph",e,t,r)}},{key:"sendAll",value:function(e,t){return this.transport.sendAll("graph",e,t)}},{key:"receive",value:function(e,t,r){var n;if("clear"===e||(n=this.resolveGraph(t,r)))switch(e){case"clear":this.initGraph(t,r);break;case"addnode":this.addNode(n,t,r);break;case"removenode":this.removeNode(n,t,r);break;case"renamenode":this.renameNode(n,t,r);break;case"changenode":this.changeNode(n,t,r);break;case"addedge":this.addEdge(n,t,r);break;case"removeedge":this.removeEdge(n,t,r);break;case"changeedge":this.changeEdge(n,t,r);break;case"addinitial":this.addInitial(n,t,r);break;case"removeinitial":this.removeInitial(n,t,r);break;case"addinport":this.addInport(n,t,r);break;case"removeinport":this.removeInport(n,t,r);break;case"renameinport":this.renameInport(n,t,r);break;case"addoutport":this.addOutport(n,t,r);break;case"removeoutport":this.removeOutport(n,t,r);break;case"renameoutport":this.renameOutport(n,t,r);break;case"addgroup":this.addGroup(n,t,r);break;case"removegroup":this.removeGroup(n,t,r);break;case"renamegroup":this.renameGroup(n,t,r);break;case"changegroup":this.changeGroup(n,t,r);break;default:this.send("error",new Error("graph:".concat(e," not supported")),r)}}},{key:"resolveGraph",value:function(e,t){return e.graph?this.graphs[e.graph]?this.graphs[e.graph]:(this.send("error",new Error("Requested graph not found"),t),null):(this.send("error",new Error("No graph specified"),t),null)}},{key:"getLoader",value:function(e){return this.transport.component.getLoader(e,this.transport.options)}},{key:"sendGraph",value:function(e,t,r){var n={graph:e,description:t.toJSON()};return this.send("graph",n,r)}},{key:"initGraph",value:function(e,t){var r=this;if(e.id){var n=new d.Graph(e.name||"NoFlo runtime");n.properties.id=e.id,n.properties.main=e.main;var o=e.library;o&&(o=o.replace("noflo-",""),n.properties.library=o),e.icon&&(n.properties.icon=e.icon),e.description&&(n.properties.description=e.description),this.registerGraph(e.id,n,t,!0).catch((function(e){r.send("error",e,t)}))}else this.send("error",new Error("No graph ID provided"),t)}},{key:"registerGraph",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.transport.network.initNetwork(t,e,n).then((function(i){if(r.subscribeGraph(e,t,n),r.graphs[e]=t,r.sendAll("clear",{id:e,name:t.name||"",library:t.properties.library,main:t.properties.main,icon:t.properties.icon,description:t.properties.description},n),o){var a=f(e,t.properties.library||r.transport.options.namespace);r.transport.runtime.registerNetwork(e,i),0!==e.indexOf("fixture.")&&("main"===t.name||t.properties.main?r.transport.runtime.setMainGraph(a,t,n):r.transport.component.registerGraph(a,t,n))}}),(function(e){return r.send("error",e,n),Promise.reject(e)}))}},{key:"subscribeGraph",value:function(e,t,r){var n=this;return t.on("addNode",(function(t){n.sendAll("addnode",i(i({},t),{},{graph:e}),r)})),t.on("removeNode",(function(t){var o={id:t.id,graph:e};n.sendAll("removenode",o,r)})),t.on("renameNode",(function(t,o){return n.sendAll("renamenode",{from:t,to:o,graph:e},r)})),t.on("changeNode",(function(t){return n.sendAll("changenode",{id:t.id,metadata:t.metadata,graph:e},r)})),t.on("addEdge",(function(t){var o={src:t.from,tgt:t.to,metadata:t.metadata,graph:e};n.sendAll("addedge",o,r)})),t.on("removeEdge",(function(t){var o={src:t.from,tgt:t.to,graph:e};n.sendAll("removeedge",o,r)})),t.on("changeEdge",(function(t){var o={src:t.from,tgt:t.to,metadata:t.metadata,graph:e};n.sendAll("changeedge",o,r)})),t.on("addInitial",(function(t){var o={src:t.from,tgt:t.to,metadata:t.metadata,graph:e};n.sendAll("addinitial",o,r)})),t.on("removeInitial",(function(t){var o={src:t.from,tgt:t.to,graph:e};n.sendAll("removeinitial",o,r)})),t.on("addGroup",(function(t){var o={name:t.name,nodes:t.nodes,metadata:t.metadata,graph:e};n.sendAll("addgroup",o,r)})),t.on("removeGroup",(function(t){var o={name:t.name,graph:e};n.sendAll("removegroup",o,r)})),t.on("renameGroup",(function(t,o){var i={from:t,to:o,graph:e};n.sendAll("renamegroup",i,r)})),t.on("changeGroup",(function(t){var o={name:t.name,metadata:t.metadata,graph:e};n.sendAll("changegroup",o,r)})),t.on("addInport",(function(t,o){var i={public:t,node:o.process,port:o.port,metadata:o.metadata,graph:e};Object.keys(o.metadata).length||delete i.metadata,n.sendAll("addinport",i,r)})),t.on("addOutport",(function(t,o){var i={public:t,node:o.process,port:o.port,metadata:o.metadata,graph:e};Object.keys(o.metadata).length||delete i.metadata,n.sendAll("addoutport",i,r)})),t.on("removeInport",(function(t){var o={public:t,graph:e};n.sendAll("removeinport",o,r)})),t.on("removeOutport",(function(t){var o={public:t,graph:e};n.sendAll("removeoutport",o,r)})),t.on("renameInport",(function(t,o){var i={from:t,to:o,graph:e};n.sendAll("renameinport",i,r)})),t.on("renameOutport",(function(t,o){var i={from:t,to:o,graph:e};n.sendAll("renameoutport",i,r)})),t.on("endTransaction",(function(){return n.emit("updated",{name:e,graph:t})}))}},{key:"addNode",value:function(e,t,r){var n=this;if(t.id||t.component){var o=this.transport.network.getNetwork(e.properties.id);o?o.addNode(t).catch((function(e){n.send("error",e,r)})):e.addNode(t.id,t.component,t.metadata)}else this.send("error",new Error("No ID or component supplied"),r)}},{key:"removeNode",value:function(e,t,r){var n=this;if(t.id){var o=this.transport.network.getNetwork(e.properties.id);o?o.removeNode(t).catch((function(e){n.send("error",e,r)})):e.removeNode(t.id)}else this.send("error",new Error("No ID supplied"),r)}},{key:"renameNode",value:function(e,t,r){var n=this;if(t.from||t.to){var o=this.transport.network.getNetwork(e.properties.id);o?o.renameNode(t.from,t.to).catch((function(e){n.send("error",e,r)})):e.renameNode(t.from,t.to)}else this.send("error",new Error("No from or to supplied"),r)}},{key:"changeNode",value:function(e,t,r){t.id||t.metadata?e.setNodeMetadata(t.id,t.metadata):this.send("error",new Error("No id or metadata supplied"),r)}},{key:"addEdge",value:function(e,t,r){var n=this;if(t.src||t.tgt){var o=this.transport.network.getNetwork(e.properties.id);o?o.addEdge({from:t.src,to:t.tgt,metadata:t.metadata}).catch((function(e){n.send("error",e,r)})):"number"!=typeof t.src.index&&"number"!=typeof t.tgt.index||!e.addEdgeIndex?e.addEdge(t.src.node,t.src.port,t.tgt.node,t.tgt.port,t.metadata):e.addEdgeIndex(t.src.node,t.src.port,t.src.index,t.tgt.node,t.tgt.port,t.tgt.index,t.metadata)}else this.send("error",new Error("No src or tgt supplied"),r)}},{key:"removeEdge",value:function(e,t,r){var n=this;if(t.src||t.tgt){var o=this.transport.network.getNetwork(e.properties.id);o?o.removeEdge({from:t.src,to:t.tgt}).catch((function(e){n.send("error",e,r)})):e.removeEdge(t.src.node,t.src.port,t.tgt.node,t.tgt.port)}else this.send("error",new Error("No src or tgt supplied"),r)}},{key:"changeEdge",value:function(e,t,r){t.src||t.tgt?e.setEdgeMetadata(t.src.node,t.src.port,t.tgt.node,t.tgt.port,t.metadata):this.send("error",new Error("No src or tgt supplied"),r)}},{key:"addInitial",value:function(e,t,r){var n=this;if(t.src||t.tgt){var o=this.transport.network.getNetwork(e.properties.id);o?o.addInitial({from:t.src,to:t.tgt,metadata:t.metadata}).catch((function(e){n.send("error",e,r)})):e.addInitialIndex&&"number"==typeof t.tgt.index?e.addInitialIndex(t.src.data,t.tgt.node,t.tgt.port,t.tgt.index,t.metadata):e.addInitial(t.src.data,t.tgt.node,t.tgt.port,t.metadata)}else this.send("error",new Error("No src or tgt supplied"),r)}},{key:"removeInitial",value:function(e,t,r){var n=this;if(t.tgt){var o=this.transport.network.getNetwork(e.properties.id);o?o.removeInitial({from:t.src,to:t.tgt,metadata:t.metadata}).catch((function(e){n.send("error",e,r)})):e.removeInitial(t.tgt.node,t.tgt.port)}else this.send("error",new Error("No tgt supplied"),r)}},{key:"addInport",value:function(e,t,r){t.public||t.node||t.port?e.addInport(t.public,t.node,t.port,t.metadata):this.send("error",new Error("Missing exported inport information"),r)}},{key:"removeInport",value:function(e,t,r){t.public?e.removeInport(t.public):this.send("error",new Error("Missing exported inport name"),r)}},{key:"renameInport",value:function(e,t,r){t.from||t.to?e.renameInport(t.from,t.to):this.send("error",new Error("No from or to supplied"),r)}},{key:"addOutport",value:function(e,t,r){t.public||t.node||t.port?e.addOutport(t.public,t.node,t.port,t.metadata):this.send("error",new Error("Missing exported outport information"),r)}},{key:"removeOutport",value:function(e,t,r){t.public?e.removeOutport(t.public):this.send("error",new Error("Missing exported outport name"),r)}},{key:"renameOutport",value:function(e,t,r){t.from||t.to?e.renameOutport(t.from,t.to):this.send("error",new Error("No from or to supplied"),r)}},{key:"addGroup",value:function(e,t,r){t.name||t.nodes||t.metadata?e.addGroup(t.name,t.nodes,t.metadata):this.send("error",new Error("No name or nodes or metadata supplied"),r)}},{key:"removeGroup",value:function(e,t,r){t.name?e.removeGroup(t.name):this.send("error",new Error("No name supplied"),r)}},{key:"renameGroup",value:function(e,t,r){t.from||t.to?e.renameGroup(t.from,t.to):this.send("error",new Error("No from or to supplied"),r)}},{key:"changeGroup",value:function(e,t,r){t.name||t.metadata?e.setGroupMetadata(t.name,t.metadata):this.send("error",new Error("No name or metadata supplied"),r)}}])&&s(t.prototype,r),n&&s(t,n),a}(h);e.exports=m},function(e,t,r){(function(t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=r(3),h=r(11).EventEmitter;var f=function(e){return e?"".concat(e.process,"(").concat(e.port,")"):""},m=function(e){return e?"".concat(e.process.id,"(").concat(e.port,")"):""},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,e);var r,n,o,a=u(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=a.call(this)).transport=e,t.networks={},t}return r=p,(n=[{key:"send",value:function(e,t,r){return this.transport.send("network",e,t,r)}},{key:"sendAll",value:function(e,t){return this.transport.sendAll("network",e,t)}},{key:"receive",value:function(e,t,r){var n=this.resolveGraph(t,r);if(n)switch(e){case"start":this.startNetwork(n,t,r);break;case"stop":this.stopNetwork(n,t,r);break;case"edges":this.updateEdgesFilter(n,t,r);break;case"debug":this.debugNetwork(n,t,r);break;case"getstatus":this.getStatus(n,t,r);break;default:this.send("error",new Error("network:".concat(e," not supported")),r)}}},{key:"resolveGraph",value:function(e,t){return e.graph?this.transport.graph.graphs[e.graph]?this.transport.graph.graphs[e.graph]:(this.send("error",new Error("Requested graph not found"),t),null):(this.send("error",new Error("No graph specified"),t),null)}},{key:"getNetwork",value:function(e){return e&&this.networks[e]&&this.networks[e].network?this.networks[e].network:null}},{key:"updateEdgesFilter",value:function(e,t,r){var n=this.networks[t.graph];n?n.filters={}:(n={network:null,filters:{}},this.networks[t.graph]=n),t.edges.forEach((function(e){var t=function(e){return"".concat(f(e.src)," -> ").concat(f(e.tgt))}(e);n.filters[t]=!0})),this.send("edges",{graph:t.graph,edges:t.edges},r)}},{key:"eventFiltered",value:function(e,t){if(!this.transport.options.filterData)return!0;var r,n=(r=t.socket,"".concat(m(r.from)," -> ").concat(m(r.to)));return this.networks[e].filters[n]}},{key:"initNetwork",value:function(e,t,r){var n=this,o=this.getNetwork(t);return o?o.stop().then((function(){return delete n.networks[t].network,n.emit("removenetwork",o,t,n.networks),n.initNetwork(e,t,r)})):d.createNetwork(e,{subscribeGraph:!1,delay:!0,baseDir:this.transport.options.baseDir,componentLoader:this.transport.component.getLoader(this.transport.options.baseDir,this.transport.options)}).then((function(e){return n.networks[t]&&n.networks[t].network?n.networks[t].network=e:n.networks[t]={network:e,filters:{}},n.emit("addnetwork",e,t,n.networks),n.subscribeNetwork(e,t,r),e.connect()}))}},{key:"subscribeNetwork",value:function(e,r,n){var o=this;e.on("start",(function(t){return o.sendAll("started",{time:t.start,graph:r,running:e.isRunning(),started:e.isStarted()},n)})),e.on("end",(function(t){o.sendAll("stopped",{time:new Date,uptime:t.uptime,graph:r,running:e.isRunning(),started:e.isStarted()},n)})),e.on("icon",(function(e){o.sendAll("icon",i(i({},e),{},{graph:r}),n)})),e.on("ip",(function(e){if(o.eventFiltered(r,e)){var i={id:e.id,socket:e.socket,subgraph:e.subgraph,metadata:e.metadata};switch(e.type){case"openBracket":i.type="begingroup",i.group=e.data||"";break;case"data":i.type="data",i.data=e.data,i.datatype=e.datatype,i.schema=e.schema;break;case"closeBracket":i.type="endgroup",i.group=e.data||""}o.sendAll(i.type,function(e,r){var n={id:e.id,graph:r};if(e.socket.from&&(n.src={node:e.socket.from.process.id,port:e.socket.from.port}),e.socket.to&&(n.tgt={node:e.socket.to.process.id,port:e.socket.to.port}),e.subgraph&&(n.subgraph=e.subgraph),void 0!==e.group&&(n.group=e.group),e.datatype&&(n.type=e.datatype),e.schema&&(n.schema=e.schema),n.data=e.data,void 0!==n.data){if(d.isBrowser()||t.isBuffer(n.data)&&(n.data=n.data.slice(0,20)),(null!=n.data?n.data.toJSON:void 0)&&(n.data=n.data.toJSON()),null!=n.data?n.data.toString:void 0){var o=n.data;if(n.data=n.data.toString(),"[object Object]"===n.data)try{n.data=JSON.parse(JSON.stringify(o))}catch(e){}}(null!=e.metadata?e.metadata.secure:void 0)&&(n.data="DATA")}return n}(i,r),n)}})),e.on("process-error",(function(e){var t=e.error.message;e.error.stack&&e.error.stack.split("\n").slice(0,3).forEach((function(e){t+="\n".concat(e)})),o.sendAll("processerror",{id:e.id,error:t,graph:r},n)}))}},{key:"_startNetwork",value:function(e,t,r){var n=this.getNetwork(t);return n?n.start():this.initNetwork(e,t,r).then((function(e){return e.start()}))}},{key:"startNetwork",value:function(e,t,r){var n=this;this._startNetwork(e,t.graph,r).catch((function(e){n.send("error",e,r)}))}},{key:"stopNetwork",value:function(e,t,r){var n=this,o=this.getNetwork(t.graph);o?o.isStarted()?this.networks[t.graph].network.stop().then((function(){n.send("stopped",{time:new Date,graph:t.graph,running:o.isRunning(),started:o.isStarted()},r)}),(function(e){n.send("error",e,r)})):this.send("stopped",{time:new Date,graph:t.graph,running:o.isRunning(),started:o.isStarted()},r):this.send("error",new Error("Network ".concat(t.graph," not found")),r)}},{key:"debugNetwork",value:function(e,t,r){var n=this.getNetwork(t.graph);n?(n.setDebug(t.enable),this.send("setdebug",{enable:t.enable})):this.send("error",new Error("Network ".concat(t.graph," not found")),r)}},{key:"getStatus",value:function(e,t,r){var n=this.getNetwork(t.graph);n?this.send("status",{graph:t.graph,running:n.isRunning(),started:n.isStarted()},r):this.send("error",new Error("Network ".concat(t.graph," not found")),r)}}])&&s(r.prototype,n),o&&s(r,o),p}(h);e.exports=g}).call(this,r(34).Buffer)},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=r(3),p=r(494),l=r(11).EventEmitter,d=r(99).parseName,h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).transport=e,t}return t=c,n=[{key:"initClass",value:function(){this.prototype.loaders={}}}],(r=[{key:"send",value:function(e,t,r){return this.transport.send("component",e,t,r)}},{key:"receive",value:function(e,t,r){switch(e){case"list":return this.listComponents(t,r);case"getsource":return this.getSource(t,r);case"source":return this.setSource(t,r);default:return this.send("error",new Error("component:".concat(e," not supported")),r)}}},{key:"getLoader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.loaders[e]||(this.loaders[e]=new u.ComponentLoader(e,t)),this.loaders[e]}},{key:"listComponents",value:function(e,t){var r=this,n=this.transport.options.baseDir,o=this.getLoader(n,this.transport.options);o.listComponents().then((function(e){var n=Object.keys(e),i=0;return Promise.all(n.map((function(e){return r.processComponent(o,e,t).then((function(){i+=1}),(function(e){i+=1,r.send("error",e,t)}))}))).then((function(){r.send("componentsready",i,t)}))}),(function(e){r.send("error",e,t)}))}},{key:"getSource",value:function(e,t){var r=this,n=this.transport.options.baseDir;this.getLoader(n,this.transport.options).getSource(e.name).then((function(e){return e}),(function(t){var n=d(e.name),o=r.transport.graph.graphs[e.name]||r.transport.graph.graphs[n.name];return o?{name:n.name,library:n.library||"",code:JSON.stringify(o.toJSON()),language:"json"}:Promise.reject(t)})).then((function(e){r.send("source",e,t)}),(function(e){r.send("error",e,t)}))}},{key:"setSource",value:function(e,t){var r=this,n=this.transport.options.baseDir,o=this.getLoader(n,this.transport.options);o.setSource(e.library,e.name,e.code,e.language).then((function(){return r.emit("updated",{name:e.name,library:e.library,code:e.code,tests:e.tests,language:e.language}),r.processComponent(o,o.normalizeName(e.library,e.name),t)})).catch((function(e){r.send("error",e,t)}))}},{key:"processComponent",value:function(e,t,r){var n=this;return e.load(t).then((function(e){var o=d(t),i=o.library,a=o.name;return e.isReady()?e.isSubgraph()&&i===n.transport.options.namespace&&!n.transport.graph.graphs[t]?n.transport.graph.registerGraph(t,e.network.graph,null,!1).then((function(){n.sendComponent(t,e,r)})):(n.sendComponent(t,e,r),null):new Promise((function(o,s){e.once("ready",(function(){!e.isSubgraph()||i!==n.transport.options.namespace||n.transport.graph.graphs[a]?(n.sendComponent(t,e,r),o()):n.transport.graph.registerGraph(t,e.network.graph,null,!1).then((function(){n.sendComponent(t,e,r),o()}),s)}))}))}))}},{key:"processPort",value:function(e,t){var r={id:e,type:t.getDataType?t.getDataType():"all"};return("function"==typeof t.getSchema?t.getSchema():void 0)&&(r.schema=t.getSchema()),t.isRequired&&(r.required=t.isRequired()),t.isAddressable&&(r.addressable=t.isAddressable()),t.getDescription&&(r.description=t.getDescription()),(null!=t.options?t.options.values:void 0)&&(r.values=t.options.values),("function"==typeof t.hasDefault?t.hasDefault():void 0)&&(r.default=t.options.default),r}},{key:"sendComponent",value:function(e,t,r){var n=this,o=[],i=[];Object.keys(t.inPorts).forEach((function(e){var r=t.inPorts[e];r&&"function"!=typeof r&&r.canAttach&&o.push(n.processPort(e,r))})),Object.keys(t.outPorts).forEach((function(e){var r=t.outPorts[e];r&&"function"!=typeof r&&r.canAttach&&i.push(n.processPort(e,r))}));var a=t.getIcon?t.getIcon():"gear";this.send("component",{name:e,description:t.description,subgraph:t.isSubgraph(),icon:a,inPorts:o,outPorts:i},r)}},{key:"registerGraph",value:function(e,t,r){var n=this,o=this.transport.options.baseDir,i=this.getLoader(o,this.transport.options),a=p((function(){return n.processComponent(i,e,r)}),10);t.on("addNode",a),t.on("removeNode",a),t.on("renameNode",a),t.on("addEdge",a),t.on("removeEdge",a),t.on("addInitial",a),t.on("removeInitial",a),t.on("addInport",a),t.on("removeInport",a),t.on("renameInport",a),t.on("addOutport",a),t.on("removeOutport",a),t.on("renameOutport",a),i.listComponents().then((function(){var r=d(e),n=r.library,o=r.name;i.registerComponent(n,o,t),a()}),(function(e){n.send("error",e,r)}))}}])&&o(t.prototype,r),n&&o(t,n),c}(l);h.initClass(),e.exports=h},function(e,t){function r(e,t,r){var n,o,i,a,s;function c(){var u=Date.now()-a;u<t&&u>=0?n=setTimeout(c,t-u):(n=null,r||(s=e.apply(i,o),i=o=null))}null==t&&(t=100);var u=function(){i=this,o=arguments,a=Date.now();var u=r&&!n;return n||(n=setTimeout(c,t)),u&&(s=e.apply(i,o),i=o=null),s};return u.clear=function(){n&&(clearTimeout(n),n=null)},u.flush=function(){n&&(s=e.apply(i,o),i=o=null,clearTimeout(n),n=null)},u}r.debounce=r,e.exports=r},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(138).Flowtrace,i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.transport=t,this.traces={}}var t,r,i;return t=e,(r=[{key:"send",value:function(e,t,r){return this.transport.send("trace",e,t,r)}},{key:"sendAll",value:function(e,t){return this.transport.sendAll("trace",e,t)}},{key:"receive",value:function(e,t,r){switch(e){case"start":this.start(t,r);break;case"stop":this.stop(t,r);break;case"dump":this.dump(t,r);break;case"clear":this.clear(t,r);break;default:this.send("error",new Error("trace:".concat(e," not supported")),r)}}},{key:"resolveGraph",value:function(e,t){return e.graph?this.traces[e.graph]?this.traces[e.graph]:(this.send("error",new Error("Trace for requested graph '".concat(e.graph,"' not found")),t),null):(this.send("error",new Error("No graph specified"),t),null)}},{key:"startTrace",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400,n=this.transport.runtime.getRuntimeDefinition();return this.traces[e]=this.traces[e]||new o(n,r),t.setFlowtrace(this.traces[e],e,!0),this.traces[e]}},{key:"start",value:function(e,t){var r=this.transport.network.getNetwork(e.graph);if(r){var n=e.buffersize||400;this.startTrace(e.graph,r,n),this.sendAll("start",{graph:e.graph,buffersize:n})}else this.send("error",new Error("Network for requested graph '".concat(e.graph,"' not found")),t)}},{key:"stop",value:function(e,t){if(this.resolveGraph(e,t)){var r=this.transport.network.getNetwork(e.graph);r?(r.setFlowtrace(null),this.sendAll("stop",{graph:e.graph})):this.send("error",new Error("Network for requested graph '".concat(e.graph,"' not found")),t)}}},{key:"dump",value:function(e,t){var r=this.resolveGraph(e,t);r&&this.send("dump",{graph:e.graph,type:"flowtrace.json",flowtrace:r.toJSON()},t)}},{key:"clear",value:function(e,t){var r=this.resolveGraph(e,t);r&&(r.clear(),this.sendAll("clear",{graph:e.graph}))}}])&&n(t.prototype,r),i&&n(t,i),e}();e.exports=i},function(e,t,r){var n=r(497),o=r(498);t.Client=n,t.Runtime=o},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(r=s.call(this)).name=t,r.runtime=e,r.name||(r.name="Unnamed client"),r}return t=c,(r=[{key:"connect",value:function(){return this.runtime._connect(this)}},{key:"disconnect",value:function(){return this.runtime._disconnect(this)}},{key:"send",value:function(e,t,r){var n=this;return new Promise((function(o,i){var a={protocol:e,command:t,payload:r};n.once("message",(function t(r){r.protocol!==e&&n.once("message",t),"error"!==r.command?o(r.payload):i(new Error(r.payload.message))})),n.emit("send",a)}))}},{key:"_receive",value:function(e){var t=this;return setTimeout((function(){t.emit("message",e)}),1)}}])&&o(t.prototype,r),n&&o(t,n),c}(r(11).EventEmitter);e.exports=u},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).clients=[],t}return t=c,(r=[{key:"_connect",value:function(e){var t=this;this.clients.push(e),e.on("send",(function(r){t._receive(r,{client:e})}))}},{key:"_disconnect",value:function(e){-1!==this.clients.indexOf(e)&&(this.clients.splice(this.clients.indexOf(e),1),e.removeAllListeners("send"))}},{key:"_receive",value:function(e,t){this.receive(e.protocol,e.command,e.payload,t)}},{key:"send",value:function(e,t,r,n){if(n&&n.client){var o={protocol:e,command:t,payload:r};n.client._receive(o)}}},{key:"sendAll",value:function(e,t,r){var n={protocol:e,command:t,payload:r};this.clients.forEach((function(e){e._receive(n)}))}}])&&o(t.prototype,r),n&&o(t,n),c}(r(164));e.exports=u},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return a(this,r)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=r(98),u=r(165),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,e);var t=i(r);function r(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this,e)).setClient(window.parent),n}return r}(c);e.exports=function(e){var t=u.normalizeOptions(e),r=new p(t);return u.subscribe(window,(function(e,t){"iframe"!==e.protocol||"setcontent"!==e.command?r.receive(e.protocol,e.command,e.payload,{href:t.origin}):document.body.innerHTML=e.payload})),r}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=r(98),p=r(165),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=a(c);function c(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),r=s.call(this,e),t&&t.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),r.openClient(t.getAttribute("href"))})),r}return t=c,(r=[{key:"openClient",value:function(e){var t=this,r=window.open(e,"_blank");if(!r)throw new Error("Unable to open client window at '".concat(e,"'"));this.context={href:"*"};var n=function(e){var t=e.data;"string"==typeof e.data&&(t=JSON.parse(e.data)),t.protocol&&t.command&&this.receive(t.protocol,t.command,t.payload,this.context)}.bind(this),o=setInterval((function(){r&&!r.closed||(t.setClient(null),window.removeEventListener("message",n),clearInterval(o))}),1e3);this.setClient(r),window.addEventListener("message",n)}}])&&o(t.prototype,r),n&&o(t,n),c}(u);e.exports=function(e,t){var r=p.normalizeOptions(e);return new l(r,t)}}]]);
//# sourceMappingURL=vendors~backend.e80fa1d69dcf260ab4989121b79c81dd.min.js.map